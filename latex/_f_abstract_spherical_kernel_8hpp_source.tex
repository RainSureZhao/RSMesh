\doxysection{FAbstract\+Spherical\+Kernel.\+hpp}
\hypertarget{_f_abstract_spherical_kernel_8hpp_source}{}\label{_f_abstract_spherical_kernel_8hpp_source}\index{third\_party/ScalFMM/include/ScalFMM/Kernels/Spherical/FAbstractSphericalKernel.hpp@{third\_party/ScalFMM/include/ScalFMM/Kernels/Spherical/FAbstractSphericalKernel.hpp}}

\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{comment}{//\ See\ LICENCE\ file\ at\ project\ root}}
\DoxyCodeLine{00002\ \textcolor{preprocessor}{\#ifndef\ FABSTRACTSPHERICALKERNEL\_HPP}}
\DoxyCodeLine{00003\ \textcolor{preprocessor}{\#define\ FABSTRACTSPHERICALKERNEL\_HPP}}
\DoxyCodeLine{00004\ }
\DoxyCodeLine{00005\ \textcolor{preprocessor}{\#include\ <iostream>}}
\DoxyCodeLine{00006\ \textcolor{preprocessor}{\#include\ "{}../../Components/FAbstractKernels.hpp"{}}}
\DoxyCodeLine{00007\ }
\DoxyCodeLine{00008\ \textcolor{preprocessor}{\#include\ "{}../../Utils/FGlobal.hpp"{}}}
\DoxyCodeLine{00009\ }
\DoxyCodeLine{00010\ \textcolor{preprocessor}{\#include\ "{}../../Utils/FMemUtils.hpp"{}}}
\DoxyCodeLine{00011\ \textcolor{preprocessor}{\#include\ "{}../../Utils/FSmartPointer.hpp"{}}}
\DoxyCodeLine{00012\ \textcolor{preprocessor}{\#include\ "{}../../Utils/FPoint.hpp"{}}}
\DoxyCodeLine{00013\ \textcolor{preprocessor}{\#include\ "{}../../Utils/FAssert.hpp"{}}}
\DoxyCodeLine{00014\ }
\DoxyCodeLine{00015\ \textcolor{preprocessor}{\#include\ "{}../../Containers/FTreeCoordinate.hpp"{}}}
\DoxyCodeLine{00016\ }
\DoxyCodeLine{00017\ \textcolor{preprocessor}{\#include\ "{}../P2P/FP2PR.hpp"{}}}
\DoxyCodeLine{00018\ }
\DoxyCodeLine{00019\ \textcolor{preprocessor}{\#include\ "{}FHarmonic.hpp"{}}}
\DoxyCodeLine{00020\ }
\DoxyCodeLine{00025\ \textcolor{keyword}{template}<\ \textcolor{keyword}{class}\ FReal,\ \textcolor{keyword}{class}\ CellClass,\ \textcolor{keyword}{class}\ ContainerClass>}
\DoxyCodeLine{00026\ \textcolor{keyword}{class\ }\mbox{\hyperlink{class_f_abstract_spherical_kernel}{FAbstractSphericalKernel}}\ :\ \textcolor{keyword}{public}\ \mbox{\hyperlink{class_f_abstract_kernels}{FAbstractKernels}}<CellClass,ContainerClass>\ \{}
\DoxyCodeLine{00027\ \textcolor{keyword}{protected}:}
\DoxyCodeLine{00028\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ \ \ devP;\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//<\ The\ P}}
\DoxyCodeLine{00029\ \ \ \ \ \textcolor{keyword}{const}\ FReal\ boxWidth;\ \ \ \ \ \ \ \textcolor{comment}{//<\ the\ box\ width\ at\ leaf\ level}}
\DoxyCodeLine{00030\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ \ \ treeHeight;\ \ \ \ \ \textcolor{comment}{//<\ The\ height\ of\ the\ tree}}
\DoxyCodeLine{00031\ }
\DoxyCodeLine{00032\ \ \ \ \ \textcolor{keyword}{const}\ FReal\ widthAtLeafLevel;\ \ \ \ \ \ \ \textcolor{comment}{//<\ the\ width\ of\ a\ box\ at\ leaf\ level}}
\DoxyCodeLine{00033\ \ \ \ \ \textcolor{keyword}{const}\ FReal\ widthAtLeafLevelDiv2;\ \ \ \textcolor{comment}{//<\ the\ width\ of\ a\ box\ at\ leaf\ level\ divided\ by\ 2}}
\DoxyCodeLine{00034\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_f_point}{FPoint<FReal>}}\ boxCorner;\ \ \ \ \ \ \ \ \textcolor{comment}{//<\ the\ corner\ of\ the\ box\ system}}
\DoxyCodeLine{00035\ }
\DoxyCodeLine{00036\ \ \ \ \ \mbox{\hyperlink{class_f_harmonic}{FHarmonic<FReal>}}\ harmonic;\ \textcolor{comment}{//<\ The\ harmonic\ computation\ class}}
\DoxyCodeLine{00037\ }
\DoxyCodeLine{00038\ \ \ \ \ \textcolor{comment}{//\ For\ normal\ computation}}
\DoxyCodeLine{00039\ \ \ \ \ \mbox{\hyperlink{class_f_smart_pointer}{FSmartPointer<FComplex<FReal>}}*>\ preL2LTransitions;\ \textcolor{comment}{//<\ The\ pre-\/computation\ for\ the\ L2L\ based\ on\ the\ level}}
\DoxyCodeLine{00040\ \ \ \ \ \mbox{\hyperlink{class_f_smart_pointer}{FSmartPointer<FComplex<FReal>}}*>\ preM2MTransitions;\ \textcolor{comment}{//<\ The\ pre-\/computation\ for\ the\ M2M\ based\ on\ the\ level}}
\DoxyCodeLine{00041\ }
\DoxyCodeLine{00042\ }
\DoxyCodeLine{00044\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_f_abstract_spherical_kernel_ac91e7268ab96b0f9d1c0028a732ef0b0}{allocAndInit}}()\{}
\DoxyCodeLine{00045\ \ \ \ \ \ \ \ \ preL2LTransitions\ =\ \textcolor{keyword}{new}\ \mbox{\hyperlink{class_f_complex}{FComplex<FReal>}}*[treeHeight\ ];}
\DoxyCodeLine{00046\ \ \ \ \ \ \ \ \ memset(preL2LTransitions.\mbox{\hyperlink{class_f_smart_pointer_a82a013f34ea6809b1d72da35daff374c}{getPtr}}(),\ 0,\ (treeHeight)\ *\ \textcolor{keyword}{sizeof}(\mbox{\hyperlink{class_f_complex}{FComplex<FReal>}}*));}
\DoxyCodeLine{00047\ \ \ \ \ \ \ \ \ preM2MTransitions\ =\ \textcolor{keyword}{new}\ \mbox{\hyperlink{class_f_complex}{FComplex<FReal>}}*[treeHeight];}
\DoxyCodeLine{00048\ \ \ \ \ \ \ \ \ memset(preM2MTransitions.\mbox{\hyperlink{class_f_smart_pointer_a82a013f34ea6809b1d72da35daff374c}{getPtr}}(),\ 0,\ (treeHeight)\ *\ \textcolor{keyword}{sizeof}(\mbox{\hyperlink{class_f_complex}{FComplex<FReal>}}*));}
\DoxyCodeLine{00049\ }
\DoxyCodeLine{00050\ \ \ \ \ \ \ \ \ FReal\ treeWidthAtLevel\ =\ (boxWidth)/2;}
\DoxyCodeLine{00051\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ idxLevel\ =\ 0\ ;\ idxLevel\ <\ treeHeight\ -\/\ 1\ ;\ ++idxLevel\ )\{}
\DoxyCodeLine{00052\ \ \ \ \ \ \ \ \ \ \ \ \ preL2LTransitions[idxLevel]\ =\ \textcolor{keyword}{new}\ \mbox{\hyperlink{class_f_complex}{FComplex<FReal>}}[\ 8\ *\ harmonic.getExpSize()];}
\DoxyCodeLine{00053\ \ \ \ \ \ \ \ \ \ \ \ \ preM2MTransitions[idxLevel]\ =\ \textcolor{keyword}{new}\ \mbox{\hyperlink{class_f_complex}{FComplex<FReal>}}[\ 8\ *\ harmonic.getExpSize()];}
\DoxyCodeLine{00054\ }
\DoxyCodeLine{00055\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_f_point}{FPoint<FReal>}}\ father(treeWidthAtLevel,treeWidthAtLevel,treeWidthAtLevel);}
\DoxyCodeLine{00056\ \ \ \ \ \ \ \ \ \ \ \ \ treeWidthAtLevel\ /=\ 2;}
\DoxyCodeLine{00057\ }
\DoxyCodeLine{00058\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ idxChild\ =\ 0\ ;\ idxChild\ <\ 8\ ;\ ++idxChild\ )\{}
\DoxyCodeLine{00059\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_f_tree_coordinate}{FTreeCoordinate}}\ childBox;}
\DoxyCodeLine{00060\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ childBox.setPositionFromMorton(idxChild);}
\DoxyCodeLine{00061\ }
\DoxyCodeLine{00062\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_f_point}{FPoint<FReal>}}\ M2MVector\ (}
\DoxyCodeLine{00063\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ father.\mbox{\hyperlink{class_f_point_a58d3859160347552d6a4a94fbdf883c3}{getX}}()\ -\/\ (treeWidthAtLevel\ *\ FReal(1\ +\ (childBox.\mbox{\hyperlink{class_f_point_a58d3859160347552d6a4a94fbdf883c3}{getX}}()\ *\ 2))),}
\DoxyCodeLine{00064\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ father.\mbox{\hyperlink{class_f_point_ae4383512b9b8d216775b3fb92325cfc9}{getY}}()\ -\/\ (treeWidthAtLevel\ *\ FReal(1\ +\ (childBox.\mbox{\hyperlink{class_f_point_ae4383512b9b8d216775b3fb92325cfc9}{getY}}()\ *\ 2))),}
\DoxyCodeLine{00065\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ father.\mbox{\hyperlink{class_f_point_a02208d4db50cbafe597adcbfb152b536}{getZ}}()\ -\/\ (treeWidthAtLevel\ *\ FReal(1\ +\ (childBox.\mbox{\hyperlink{class_f_point_a02208d4db50cbafe597adcbfb152b536}{getZ}}()\ *\ 2)))}
\DoxyCodeLine{00066\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ );}
\DoxyCodeLine{00067\ }
\DoxyCodeLine{00068\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ harmonic.computeInner(\mbox{\hyperlink{class_f_spherical}{FSpherical<FReal>}}(M2MVector));}
\DoxyCodeLine{00069\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ FMemUtils::copyall<FComplex<FReal>>(\&preM2MTransitions[idxLevel][harmonic.getExpSize()\ *\ idxChild],\ harmonic.result(),\ harmonic.getExpSize());}
\DoxyCodeLine{00070\ }
\DoxyCodeLine{00071\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_f_point}{FPoint<FReal>}}\ L2LVector\ (}
\DoxyCodeLine{00072\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (treeWidthAtLevel\ *\ FReal(1\ +\ (childBox.\mbox{\hyperlink{class_f_point_a58d3859160347552d6a4a94fbdf883c3}{getX}}()\ *\ 2)))\ -\/\ father.\mbox{\hyperlink{class_f_point_a58d3859160347552d6a4a94fbdf883c3}{getX}}(),}
\DoxyCodeLine{00073\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (treeWidthAtLevel\ *\ FReal(1\ +\ (childBox.\mbox{\hyperlink{class_f_point_ae4383512b9b8d216775b3fb92325cfc9}{getY}}()\ *\ 2)))\ -\/\ father.\mbox{\hyperlink{class_f_point_ae4383512b9b8d216775b3fb92325cfc9}{getY}}(),}
\DoxyCodeLine{00074\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (treeWidthAtLevel\ *\ FReal(1\ +\ (childBox.\mbox{\hyperlink{class_f_point_a02208d4db50cbafe597adcbfb152b536}{getZ}}()\ *\ 2)))\ -\/\ father.\mbox{\hyperlink{class_f_point_a02208d4db50cbafe597adcbfb152b536}{getZ}}()}
\DoxyCodeLine{00075\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ );}
\DoxyCodeLine{00076\ }
\DoxyCodeLine{00077\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ harmonic.computeInner(\mbox{\hyperlink{class_f_spherical}{FSpherical<FReal>}}(L2LVector));}
\DoxyCodeLine{00078\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ FMemUtils::copyall<FComplex<FReal>>(\&preL2LTransitions[idxLevel][harmonic.getExpSize()\ *\ idxChild],\ harmonic.result(),\ harmonic.getExpSize());}
\DoxyCodeLine{00079\ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00080\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00081\ \ \ \ \ \}}
\DoxyCodeLine{00082\ }
\DoxyCodeLine{00084\ \ \ \ \ \mbox{\hyperlink{class_f_point}{FPoint<FReal>}}\ \mbox{\hyperlink{class_f_abstract_spherical_kernel_a8e2097d3422b40de21f069da98ba2b6b}{getLeafCenter}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{class_f_tree_coordinate}{FTreeCoordinate}}\ coordinate)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00085\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{class_f_point}{FPoint<FReal>}}(}
\DoxyCodeLine{00086\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ FReal(coordinate.\mbox{\hyperlink{class_f_point_a58d3859160347552d6a4a94fbdf883c3}{getX}}())\ *\ widthAtLeafLevel\ +\ widthAtLeafLevelDiv2\ +\ boxCorner.\mbox{\hyperlink{class_f_point_a58d3859160347552d6a4a94fbdf883c3}{getX}}(),}
\DoxyCodeLine{00087\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ FReal(coordinate.\mbox{\hyperlink{class_f_point_ae4383512b9b8d216775b3fb92325cfc9}{getY}}())\ *\ widthAtLeafLevel\ +\ widthAtLeafLevelDiv2\ +\ boxCorner.\mbox{\hyperlink{class_f_point_a58d3859160347552d6a4a94fbdf883c3}{getX}}(),}
\DoxyCodeLine{00088\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ FReal(coordinate.\mbox{\hyperlink{class_f_point_a02208d4db50cbafe597adcbfb152b536}{getZ}}())\ *\ widthAtLeafLevel\ +\ widthAtLeafLevelDiv2\ +\ boxCorner.\mbox{\hyperlink{class_f_point_a58d3859160347552d6a4a94fbdf883c3}{getX}}());}
\DoxyCodeLine{00089\ \ \ \ \ \}}
\DoxyCodeLine{00090\ }
\DoxyCodeLine{00091\ }
\DoxyCodeLine{00092\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00094\ \ \ \ \ \mbox{\hyperlink{class_f_abstract_spherical_kernel_a0b54228b0c735ce7b144b3d8343a73e8}{FAbstractSphericalKernel}}(\textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ inDevP,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ inTreeHeight,\ \textcolor{keyword}{const}\ FReal\ inBoxWidth,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_f_point}{FPoint<FReal>}}\&\ inBoxCenter)}
\DoxyCodeLine{00095\ \ \ \ \ \ \ \ \ :\ devP(inDevP),}
\DoxyCodeLine{00096\ \ \ \ \ \ \ \ \ \ \ boxWidth(inBoxWidth),}
\DoxyCodeLine{00097\ \ \ \ \ \ \ \ \ \ \ treeHeight(inTreeHeight),}
\DoxyCodeLine{00098\ \ \ \ \ \ \ \ \ \ \ widthAtLeafLevel(inBoxWidth/FReal(1\ <<\ (inTreeHeight-\/1))),}
\DoxyCodeLine{00099\ \ \ \ \ \ \ \ \ \ \ widthAtLeafLevelDiv2(widthAtLeafLevel/2),}
\DoxyCodeLine{00100\ \ \ \ \ \ \ \ \ \ \ boxCorner(inBoxCenter.getX()-\/(inBoxWidth/2),inBoxCenter.getY()-\/(inBoxWidth/2),inBoxCenter.getZ()-\/(inBoxWidth/2)),}
\DoxyCodeLine{00101\ \ \ \ \ \ \ \ \ \ \ harmonic(inDevP),}
\DoxyCodeLine{00102\ \ \ \ \ \ \ \ \ \ \ preL2LTransitions(nullptr),}
\DoxyCodeLine{00103\ \ \ \ \ \ \ \ \ \ \ preM2MTransitions(nullptr)\ \{}
\DoxyCodeLine{00104\ }
\DoxyCodeLine{00105\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_f_abstract_spherical_kernel_ac91e7268ab96b0f9d1c0028a732ef0b0}{allocAndInit}}();}
\DoxyCodeLine{00106\ \ \ \ \ \}}
\DoxyCodeLine{00107\ }
\DoxyCodeLine{00109\ \ \ \ \ \mbox{\hyperlink{class_f_abstract_spherical_kernel_ad6870ad19bc54634e737844f347874e7}{FAbstractSphericalKernel}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{class_f_abstract_spherical_kernel}{FAbstractSphericalKernel}}\&\ other)}
\DoxyCodeLine{00110\ \ \ \ \ \ \ \ \ :\ devP(other.devP),}
\DoxyCodeLine{00111\ \ \ \ \ \ \ \ \ \ \ boxWidth(other.boxWidth),}
\DoxyCodeLine{00112\ \ \ \ \ \ \ \ \ \ \ treeHeight(other.treeHeight),}
\DoxyCodeLine{00113\ \ \ \ \ \ \ \ \ \ \ widthAtLeafLevel(other.widthAtLeafLevel),}
\DoxyCodeLine{00114\ \ \ \ \ \ \ \ \ \ \ widthAtLeafLevelDiv2(other.widthAtLeafLevelDiv2),}
\DoxyCodeLine{00115\ \ \ \ \ \ \ \ \ \ \ boxCorner(other.boxCorner),}
\DoxyCodeLine{00116\ \ \ \ \ \ \ \ \ \ \ harmonic(other.devP),}
\DoxyCodeLine{00117\ \ \ \ \ \ \ \ \ \ \ preL2LTransitions(other.preL2LTransitions),}
\DoxyCodeLine{00118\ \ \ \ \ \ \ \ \ \ \ preM2MTransitions(other.preM2MTransitions)\ \{}
\DoxyCodeLine{00119\ }
\DoxyCodeLine{00120\ \ \ \ \ \}}
\DoxyCodeLine{00121\ }
\DoxyCodeLine{00123\ \ \ \ \ \textcolor{keyword}{virtual}\ \mbox{\hyperlink{class_f_abstract_spherical_kernel_a59d56b6e29c28deda9a3e3ac11095ef4}{\string~FAbstractSphericalKernel}}()\{}
\DoxyCodeLine{00124\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(preL2LTransitions.\mbox{\hyperlink{class_f_smart_pointer_a459476d73cfce7884ad33e3ddd879876}{isLast}}())\{}
\DoxyCodeLine{00125\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespace_f_mem_utils_a17fae6253fc1995fc0aeb7b1bc2bef7c}{FMemUtils::DeleteAllArray}}(preL2LTransitions.\mbox{\hyperlink{class_f_smart_pointer_a82a013f34ea6809b1d72da35daff374c}{getPtr}}(),\ treeHeight);}
\DoxyCodeLine{00126\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00127\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(preM2MTransitions.\mbox{\hyperlink{class_f_smart_pointer_a459476d73cfce7884ad33e3ddd879876}{isLast}}())\{}
\DoxyCodeLine{00128\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespace_f_mem_utils_a17fae6253fc1995fc0aeb7b1bc2bef7c}{FMemUtils::DeleteAllArray}}(preM2MTransitions.\mbox{\hyperlink{class_f_smart_pointer_a82a013f34ea6809b1d72da35daff374c}{getPtr}}(),\ treeHeight);}
\DoxyCodeLine{00129\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00130\ \ \ \ \ \}}
\DoxyCodeLine{00131\ }
\DoxyCodeLine{00133\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_f_abstract_spherical_kernel_a99ff8bc846395c53344439b108bda0b8}{P2M}}(CellClass*\ \textcolor{keyword}{const}\ inPole,\ \textcolor{keyword}{const}\ ContainerClass*\ \textcolor{keyword}{const}\ inParticles)\textcolor{keyword}{\ override\ }\{}
\DoxyCodeLine{00134\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_f_complex}{FComplex<FReal>}}*\ FRestrict\ \textcolor{keyword}{const}\ cellMultiPole\ =\ inPole-\/>getMultipole();}
\DoxyCodeLine{00135\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Copying\ the\ position\ is\ faster\ than\ using\ cell\ position}}
\DoxyCodeLine{00136\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_f_point}{FPoint<FReal>}}\ polePosition\ =\ \mbox{\hyperlink{class_f_abstract_spherical_kernel_a8e2097d3422b40de21f069da98ba2b6b}{getLeafCenter}}(inPole-\/>getCoordinate());}
\DoxyCodeLine{00137\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ For\ all\ particles\ in\ the\ leaf\ box}}
\DoxyCodeLine{00138\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ FReal*\textcolor{keyword}{const}\ physicalValues\ =\ inParticles-\/>getPhysicalValues();}
\DoxyCodeLine{00139\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ FReal*\textcolor{keyword}{const}\ positionsX\ =\ inParticles-\/>getPositions()[0];}
\DoxyCodeLine{00140\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ FReal*\textcolor{keyword}{const}\ positionsY\ =\ inParticles-\/>getPositions()[1];}
\DoxyCodeLine{00141\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ FReal*\textcolor{keyword}{const}\ positionsZ\ =\ inParticles-\/>getPositions()[2];}
\DoxyCodeLine{00142\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(FSize\ idxPart\ =\ 0\ ;\ idxPart\ <\ inParticles-\/>getNbParticles()\ ;\ ++idxPart)\{}
\DoxyCodeLine{00143\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ P2M}}
\DoxyCodeLine{00144\ \ \ \ \ \ \ \ \ \ \ \ \ particleToMultiPole(cellMultiPole,\ polePosition,}
\DoxyCodeLine{00145\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_f_point}{FPoint<FReal>}}(positionsX[idxPart],positionsY[idxPart],positionsZ[idxPart]),}
\DoxyCodeLine{00146\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ physicalValues[idxPart]);}
\DoxyCodeLine{00147\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00148\ \ \ \ \ \}}
\DoxyCodeLine{00149\ }
\DoxyCodeLine{00151\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_f_abstract_spherical_kernel_afcaf811c616b31076b38480c34b90cd3}{M2M}}(CellClass*\ \textcolor{keyword}{const}\ FRestrict\ inPole,\ \textcolor{keyword}{const}\ CellClass\ *\textcolor{keyword}{const}\ FRestrict\ *\textcolor{keyword}{const}\ FRestrict\ inChild,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ inLevel)\textcolor{keyword}{\ override\ }\{}
\DoxyCodeLine{00152\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_f_complex}{FComplex<FReal>}}*\ FRestrict\ \textcolor{keyword}{const}\ multipole\_exp\_target\ =\ inPole-\/>getMultipole();}
\DoxyCodeLine{00153\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ iter\ on\ each\ child\ and\ process\ M2M}}
\DoxyCodeLine{00154\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_f_complex}{FComplex<FReal>}}*\ FRestrict\ \textcolor{keyword}{const}\ preM2MTransitionsAtLevel\ =\ preM2MTransitions[inLevel];}
\DoxyCodeLine{00155\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ idxChild\ =\ 0\ ;\ idxChild\ <\ 8\ ;\ ++idxChild)\{}
\DoxyCodeLine{00156\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(inChild[idxChild])\{}
\DoxyCodeLine{00157\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ multipoleToMultipole(multipole\_exp\_target,\ inChild[idxChild]-\/>getMultipole(),\ \&preM2MTransitionsAtLevel[idxChild\ *\ harmonic.getExpSize()]);}
\DoxyCodeLine{00158\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00159\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00160\ \ \ \ \ \}}
\DoxyCodeLine{00161\ }
\DoxyCodeLine{00163\ \ \ \ \ \textcolor{keyword}{virtual}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_f_abstract_spherical_kernel_afbfc38a891e83599b912aa1b5ce6e537}{M2L}}(CellClass*\ \textcolor{keyword}{const}\ FRestrict\ inLocal,\ \textcolor{keyword}{const}\ CellClass*\ inInteractions[],}
\DoxyCodeLine{00164\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ neighborPositions[],\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ inSize,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ inLevel)\ =\ 0;}
\DoxyCodeLine{00165\ }
\DoxyCodeLine{00167\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_f_abstract_spherical_kernel_a60db61f9f00f287c917ead0de7436aed}{L2L}}(\textcolor{keyword}{const}\ CellClass*\ \textcolor{keyword}{const}\ FRestrict\ pole,\ CellClass*\ FRestrict\ *\textcolor{keyword}{const}\ FRestrict\ child,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ inLevel)\textcolor{keyword}{\ override\ }\{}
\DoxyCodeLine{00168\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ iter\ on\ each\ child\ and\ process\ L2L}}
\DoxyCodeLine{00169\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_f_complex}{FComplex<FReal>}}*\ FRestrict\ \textcolor{keyword}{const}\ preL2LTransitionsAtLevel\ =\ preL2LTransitions[inLevel];}
\DoxyCodeLine{00170\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ idxChild\ =\ 0\ ;\ idxChild\ <\ 8\ ;\ ++idxChild)\{}
\DoxyCodeLine{00171\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(child[idxChild])\{}
\DoxyCodeLine{00172\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ localToLocal(child[idxChild]-\/>getLocal(),\ pole-\/>getLocal(),\ \&preL2LTransitionsAtLevel[idxChild\ *\ harmonic.getExpSize()]);}
\DoxyCodeLine{00173\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00174\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00175\ \ \ \ \ \}}
\DoxyCodeLine{00176\ }
\DoxyCodeLine{00178\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_f_abstract_spherical_kernel_ac57a738ac23aa6c99839187d702ad3cc}{L2P}}(\textcolor{keyword}{const}\ CellClass*\ \textcolor{keyword}{const}\ local,\ ContainerClass*\ \textcolor{keyword}{const}\ inParticles)\textcolor{keyword}{override\ }\{}
\DoxyCodeLine{00179\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_f_complex}{FComplex<FReal>}}*\ \textcolor{keyword}{const}\ cellLocal\ =\ local-\/>getLocal();}
\DoxyCodeLine{00180\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Copying\ the\ position\ is\ faster\ than\ using\ cell\ position}}
\DoxyCodeLine{00181\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_f_point}{FPoint<FReal>}}\ localPosition\ =\ \mbox{\hyperlink{class_f_abstract_spherical_kernel_a8e2097d3422b40de21f069da98ba2b6b}{getLeafCenter}}(local-\/>getCoordinate());}
\DoxyCodeLine{00182\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ For\ all\ particles\ in\ the\ leaf\ box}}
\DoxyCodeLine{00183\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ FReal*\textcolor{keyword}{const}\ physicalValues\ =\ inParticles-\/>getPhysicalValues();}
\DoxyCodeLine{00184\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ FReal*\textcolor{keyword}{const}\ positionsX\ =\ inParticles-\/>getPositions()[0];}
\DoxyCodeLine{00185\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ FReal*\textcolor{keyword}{const}\ positionsY\ =\ inParticles-\/>getPositions()[1];}
\DoxyCodeLine{00186\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ FReal*\textcolor{keyword}{const}\ positionsZ\ =\ inParticles-\/>getPositions()[2];}
\DoxyCodeLine{00187\ \ \ \ \ \ \ \ \ FReal*\textcolor{keyword}{const}\ potentials\ =\ inParticles-\/>getPotentials();}
\DoxyCodeLine{00188\ \ \ \ \ \ \ \ \ FReal*\textcolor{keyword}{const}\ forcesX\ =\ inParticles-\/>getForcesX();}
\DoxyCodeLine{00189\ \ \ \ \ \ \ \ \ FReal*\textcolor{keyword}{const}\ forcesY\ =\ inParticles-\/>getForcesY();}
\DoxyCodeLine{00190\ \ \ \ \ \ \ \ \ FReal*\textcolor{keyword}{const}\ forcesZ\ =\ inParticles-\/>getForcesZ();}
\DoxyCodeLine{00191\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(FSize\ idxPart\ =\ 0\ ;\ idxPart\ <\ inParticles-\/>getNbParticles()\ ;\ ++idxPart)\{}
\DoxyCodeLine{00192\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ L2P}}
\DoxyCodeLine{00193\ \ \ \ \ \ \ \ \ \ \ \ \ localToParticle(localPosition,\ cellLocal,}
\DoxyCodeLine{00194\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_f_point}{FPoint<FReal>}}(positionsX[idxPart],positionsY[idxPart],positionsZ[idxPart]),}
\DoxyCodeLine{00195\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ physicalValues[idxPart],\ \&potentials[idxPart],}
\DoxyCodeLine{00196\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \&forcesX[idxPart],\&forcesY[idxPart],\&forcesZ[idxPart]);}
\DoxyCodeLine{00197\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00198\ \ \ \ \ \}}
\DoxyCodeLine{00199\ }
\DoxyCodeLine{00206\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_f_abstract_spherical_kernel_a81799db940bb9bb063793b5fb3707f51}{P2P}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{class_f_tree_coordinate}{FTreeCoordinate}}\&\ inPosition,}
\DoxyCodeLine{00207\ \ \ \ \ \ \ \ \ \ \ \ \ \ ContainerClass*\ \textcolor{keyword}{const}\ FRestrict\ inTargets,\ \textcolor{keyword}{const}\ ContainerClass*\ \textcolor{keyword}{const}\ FRestrict\ inSources,}
\DoxyCodeLine{00208\ \ \ \ \ \ \ \ \ \ \ \ \ \ ContainerClass*\ \textcolor{keyword}{const}\ inNeighbors[],\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ neighborPositions[],}
\DoxyCodeLine{00209\ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ inSize)\textcolor{keyword}{\ override\ }\{}
\DoxyCodeLine{00210\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(inTargets\ ==\ inSources)\{}
\DoxyCodeLine{00211\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{struct_f_p2_p_r_t}{FP2PRT<FReal>::template}}\ Inner<ContainerClass>(inTargets);}
\DoxyCodeLine{00212\ \ \ \ \ \ \ \ \ \ \ \ \ P2POuter(inPosition,\ inTargets,\ inNeighbors,\ neighborPositions,\ inSize);}
\DoxyCodeLine{00213\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00214\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\{}
\DoxyCodeLine{00215\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ ContainerClass*\ \textcolor{keyword}{const}\ srcPtr[1]\ =\ \{inSources\};}
\DoxyCodeLine{00216\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{struct_f_p2_p_r_t}{FP2PRT<FReal>::template}}\ FullRemote<ContainerClass>(inTargets,srcPtr,1);}
\DoxyCodeLine{00217\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{struct_f_p2_p_r_t}{FP2PRT<FReal>::template}}\ FullRemote<ContainerClass>(inTargets,inNeighbors,inSize);}
\DoxyCodeLine{00218\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00219\ \ \ \ \ \}}
\DoxyCodeLine{00220\ }
\DoxyCodeLine{00221\ \ \ \ \ \textcolor{keywordtype}{void}\ P2POuter(\textcolor{keyword}{const}\ \mbox{\hyperlink{class_f_tree_coordinate}{FTreeCoordinate}}\&\ \textcolor{comment}{/*inLeafPosition*/},}
\DoxyCodeLine{00222\ \ \ \ \ \ \ \ \ \ \ \ \ \ ContainerClass*\ \textcolor{keyword}{const}\ FRestrict\ inTargets,}
\DoxyCodeLine{00223\ \ \ \ \ \ \ \ \ \ \ \ \ \ ContainerClass*\ \textcolor{keyword}{const}\ inNeighbors[],\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ neighborPositions[],}
\DoxyCodeLine{00224\ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ inSize)\textcolor{keyword}{\ override\ }\{}
\DoxyCodeLine{00225\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ nbNeighborsToCompute\ =\ 0;}
\DoxyCodeLine{00226\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{while}(nbNeighborsToCompute\ <\ inSize}
\DoxyCodeLine{00227\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \&\&\ neighborPositions[nbNeighborsToCompute]\ <\ 14)\{}
\DoxyCodeLine{00228\ \ \ \ \ \ \ \ \ \ \ \ \ nbNeighborsToCompute\ +=\ 1;}
\DoxyCodeLine{00229\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00230\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{struct_f_p2_p_r_t}{FP2PRT<FReal>::template}}\ FullMutual<ContainerClass>(inTargets,inNeighbors,nbNeighborsToCompute);}
\DoxyCodeLine{00231\ \ \ \ \ \}}
\DoxyCodeLine{00232\ }
\DoxyCodeLine{00233\ }
\DoxyCodeLine{00235\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_f_abstract_spherical_kernel_a2840367a75950077714ea2928829251b}{P2PRemote}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{class_f_tree_coordinate}{FTreeCoordinate}}\&\ \textcolor{comment}{/*inPosition*/},}
\DoxyCodeLine{00236\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ContainerClass*\ \textcolor{keyword}{const}\ FRestrict\ inTargets,\ \textcolor{keyword}{const}\ ContainerClass*\ \textcolor{keyword}{const}\ FRestrict\ \textcolor{comment}{/*inSources*/},}
\DoxyCodeLine{00237\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ ContainerClass*\ \textcolor{keyword}{const}\ inNeighbors[],\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ neighborPositions[],}
\DoxyCodeLine{00238\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ inSize)\textcolor{keyword}{\ override\ }\{}
\DoxyCodeLine{00239\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{struct_f_p2_p_r_t}{FP2PRT<FReal>::template}}\ FullRemote<ContainerClass>(inTargets,inNeighbors,inSize);}
\DoxyCodeLine{00240\ \ \ \ \ \}}
\DoxyCodeLine{00241\ }
\DoxyCodeLine{00242\ \textcolor{keyword}{private}:}
\DoxyCodeLine{00243\ }
\DoxyCodeLine{00244\ }
\DoxyCodeLine{00246\ \ \ \ \ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Computation}}
\DoxyCodeLine{00248\ }
\DoxyCodeLine{00249\ }
\DoxyCodeLine{00268\ \ \ \ \ \textcolor{keywordtype}{void}\ particleToMultiPole(\mbox{\hyperlink{class_f_complex}{FComplex<FReal>}}*\ \textcolor{keyword}{const}\ cellMultiPole,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_f_point}{FPoint<FReal>}}\&\ inPolePosition\ ,}
\DoxyCodeLine{00269\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_f_point}{FPoint<FReal>}}\&\ particlePosition,\ \textcolor{keyword}{const}\ FReal\ particlePhysicalValue)\{}
\DoxyCodeLine{00270\ }
\DoxyCodeLine{00271\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Inner\ of\ Qi\ -\/\ Z0\ =>\ harmonic.result}}
\DoxyCodeLine{00272\ \ \ \ \ \ \ \ \ harmonic.computeInner(\ \mbox{\hyperlink{class_f_spherical}{FSpherical<FReal>}}(particlePosition\ -\/\ inPolePosition)\ );}
\DoxyCodeLine{00273\ }
\DoxyCodeLine{00274\ \ \ \ \ \ \ \ \ FReal\ minus\_one\_pow\_j\ =\ 1.0;\ \ \ \ \textcolor{comment}{//\ (-\/1)\string^j\ =>\ be\ in\ turn\ 1\ and\ -\/1}}
\DoxyCodeLine{00275\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ FReal\ qParticle\ =\ particlePhysicalValue;\ \textcolor{comment}{//\ q\ in\ the\ formula}}
\DoxyCodeLine{00276\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ index\_j\_k\ =\ 0;\ \textcolor{comment}{//\ p\_exp\_term\ \&\ p\_Y\_term}}
\DoxyCodeLine{00277\ }
\DoxyCodeLine{00278\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ J\ from\ 0\ to\ P}}
\DoxyCodeLine{00279\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ j\ =\ 0\ ;\ j\ <=\ devP\ ;\ ++j)\{}
\DoxyCodeLine{00280\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ k\ from\ 0\ to\ J}}
\DoxyCodeLine{00281\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ k\ =\ 0\ ;\ k\ <=\ j\ ;\ ++k,\ ++index\_j\_k)\{}
\DoxyCodeLine{00282\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ harmonic.result(index\_j\_k).mulRealAndImag(\ qParticle\ *\ minus\_one\_pow\_j\ );}
\DoxyCodeLine{00283\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ cellMultiPole[index\_j\_k]\ +=\ harmonic.result(index\_j\_k);}
\DoxyCodeLine{00284\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00285\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ (-\/1)\string^J\ =>\ -\/1\ becomes\ 1\ or\ 1\ becomes\ -\/1}}
\DoxyCodeLine{00286\ \ \ \ \ \ \ \ \ \ \ \ \ minus\_one\_pow\_j\ =\ -\/minus\_one\_pow\_j;}
\DoxyCodeLine{00287\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00288\ \ \ \ \ \}}
\DoxyCodeLine{00289\ }
\DoxyCodeLine{00290\ \ \ \ \ \textcolor{comment}{/*\ M2M}}
\DoxyCodeLine{00291\ \textcolor{comment}{\ \ \ \ *We\ compute\ the\ translation\ of\ multipole\_exp\_src\ from\ *p\_center\_of\_exp\_src\ to}}
\DoxyCodeLine{00292\ \textcolor{comment}{\ \ \ \ *p\_center\_of\_exp\_target,\ and\ add\ the\ result\ to\ multipole\_exp\_target.}}
\DoxyCodeLine{00293\ \textcolor{comment}{\ \ \ \ *}}
\DoxyCodeLine{00294\ \textcolor{comment}{\ \ \ \ *\ O\_n\string^l\ (with\ n=0..P,\ l=-\/n..n)\ being\ the\ former\ multipole\ expansion\ terms}}
\DoxyCodeLine{00295\ \textcolor{comment}{\ \ \ \ *\ (whose\ center\ is\ *p\_center\_of\_multipole\_exp\_src)\ we\ have\ for\ the\ new\ multipole}}
\DoxyCodeLine{00296\ \textcolor{comment}{\ \ \ \ *\ expansion\ terms\ (whose\ center\ is\ *p\_center\_of\_multipole\_exp\_target):}}
\DoxyCodeLine{00297\ \textcolor{comment}{}}
\DoxyCodeLine{00298\ \textcolor{comment}{\ \ \ \ *\ M\_j\string^k\ =\ sum\{n=0..j\}}}
\DoxyCodeLine{00299\ \textcolor{comment}{\ \ \ \ *\ sum\{l=-\/n..n,\ |k-\/l|<=j-\/n\}}}
\DoxyCodeLine{00300\ \textcolor{comment}{\ \ \ \ *\ O\_n\string^l\ Inner\_\{j-\/n\}\string^\{k-\/l\}(rho,\ alpha,\ beta)}}
\DoxyCodeLine{00301\ \textcolor{comment}{\ \ \ \ *}}
\DoxyCodeLine{00302\ \textcolor{comment}{\ \ \ \ *\ where\ (rho,\ alpha,\ beta)\ are\ the\ spherical\ coordinates\ of\ the\ vector\ :}}
\DoxyCodeLine{00303\ \textcolor{comment}{\ \ \ \ *\ p\_center\_of\_multipole\_exp\_target\ -\/\ *p\_center\_of\_multipole\_exp\_src}}
\DoxyCodeLine{00304\ \textcolor{comment}{\ \ \ \ *}}
\DoxyCodeLine{00305\ \textcolor{comment}{\ \ \ \ *\ Warning:\ if\ j-\/n\ <\ |k-\/l|\ we\ do\ nothing.}}
\DoxyCodeLine{00306\ \textcolor{comment}{\ \ \ \ \ */}}
\DoxyCodeLine{00307\ \ \ \ \ \textcolor{keywordtype}{void}\ multipoleToMultipole(\mbox{\hyperlink{class_f_complex}{FComplex<FReal>}}*\ \textcolor{keyword}{const}\ FRestrict\ multipole\_exp\_target,}
\DoxyCodeLine{00308\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_f_complex}{FComplex<FReal>}}*\ \textcolor{keyword}{const}\ FRestrict\ multipole\_exp\_src,}
\DoxyCodeLine{00309\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_f_complex}{FComplex<FReal>}}*\ \textcolor{keyword}{const}\ FRestrict\ M2M\_Inner\_transfer)\{}
\DoxyCodeLine{00310\ }
\DoxyCodeLine{00311\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ n\ from\ 0\ to\ P}}
\DoxyCodeLine{00312\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ n\ =\ 0\ ;\ n\ <=\ devP\ ;\ ++n\ )\{}
\DoxyCodeLine{00313\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ l<0\ //\ (-\/1)\string^l}}
\DoxyCodeLine{00314\ \ \ \ \ \ \ \ \ \ \ \ \ FReal\ pow\_of\_minus\_1\_for\_l\ =\ (\ n\ \&\ 1\ ?\ FReal(-\/1.0)\ :\ FReal(1.0)\ );}
\DoxyCodeLine{00315\ }
\DoxyCodeLine{00316\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ O\_n\string^l\ :\ here\ points\ on\ the\ source\ multipole\ expansion\ term\ of\ degree\ n\ and\ order\ |l|}}
\DoxyCodeLine{00317\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ index\_n\ =\ harmonic.getPreExpRedirJ(n);}
\DoxyCodeLine{00318\ }
\DoxyCodeLine{00319\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ l\ from\ -\/n\ to\ <0}}
\DoxyCodeLine{00320\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ l\ =\ -\/n\ ;\ l\ <\ 0\ ;\ ++l)\{}
\DoxyCodeLine{00321\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_f_complex}{FComplex<FReal>}}\ M\_n\_\_n\_l\ =\ multipole\_exp\_src[index\_n\ -\/l];}
\DoxyCodeLine{00322\ }
\DoxyCodeLine{00323\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ j\ from\ n\ to\ P}}
\DoxyCodeLine{00324\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ j\ =\ n\ ;\ j\ <=\ devP\ ;\ ++j\ )\{}
\DoxyCodeLine{00325\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ M\_j\string^k}}
\DoxyCodeLine{00326\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ index\_j\ =\ harmonic.getPreExpRedirJ(j);}
\DoxyCodeLine{00327\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Inner\_\{j-\/n\}\string^\{k-\/l\}\ :\ here\ points\ on\ the\ M2M\ transfer\ function/expansion\ term\ of\ degree\ n-\/j\ and\ order\ |k-\/l|}}
\DoxyCodeLine{00328\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ index\_j\_n\ =\ harmonic.getPreExpRedirJ(j-\/n);\ \textcolor{comment}{/*\ k==0\ */}}
\DoxyCodeLine{00329\ }
\DoxyCodeLine{00330\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ since\ n-\/j+l<0}}
\DoxyCodeLine{00331\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ k\ =\ 0\ ;\ k\ <=\ (j-\/n+l)\ ;\ ++k\ )\{\ \textcolor{comment}{//\ l<0\ \&\&\ k>=0\ =>\ k-\/l>0}}
\DoxyCodeLine{00332\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_f_complex}{FComplex<FReal>}}\ I\_j\_n\_\_k\_l\ =\ M2M\_Inner\_transfer[index\_j\_n\ +\ k\ -\/\ l];}
\DoxyCodeLine{00333\ }
\DoxyCodeLine{00334\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ multipole\_exp\_target[index\_j\ +\ k].\mbox{\hyperlink{class_f_complex_a239af6b36a7a875cf409af96ed286bf8}{incReal}}(\ pow\_of\_minus\_1\_for\_l\ *}
\DoxyCodeLine{00335\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ((M\_n\_\_n\_l.\mbox{\hyperlink{class_f_complex_a33ec217df0f06432eec174977e0c87ff}{getReal}}()\ *\ I\_j\_n\_\_k\_l.\mbox{\hyperlink{class_f_complex_a33ec217df0f06432eec174977e0c87ff}{getReal}}())\ +}
\DoxyCodeLine{00336\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (M\_n\_\_n\_l.\mbox{\hyperlink{class_f_complex_ab4db8e82d8c014c17b06089163a3c204}{getImag}}()\ *\ I\_j\_n\_\_k\_l.\mbox{\hyperlink{class_f_complex_ab4db8e82d8c014c17b06089163a3c204}{getImag}}())));}
\DoxyCodeLine{00337\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ multipole\_exp\_target[index\_j\ +\ k].\mbox{\hyperlink{class_f_complex_a5da751a7b9af375136091cad0bc8e1d9}{incImag}}(\ pow\_of\_minus\_1\_for\_l\ *}
\DoxyCodeLine{00338\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ((M\_n\_\_n\_l.\mbox{\hyperlink{class_f_complex_a33ec217df0f06432eec174977e0c87ff}{getReal}}()\ *\ I\_j\_n\_\_k\_l.\mbox{\hyperlink{class_f_complex_ab4db8e82d8c014c17b06089163a3c204}{getImag}}())\ -\/}
\DoxyCodeLine{00339\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (M\_n\_\_n\_l.\mbox{\hyperlink{class_f_complex_ab4db8e82d8c014c17b06089163a3c204}{getImag}}()\ *\ I\_j\_n\_\_k\_l.\mbox{\hyperlink{class_f_complex_a33ec217df0f06432eec174977e0c87ff}{getReal}}())));}
\DoxyCodeLine{00340\ }
\DoxyCodeLine{00341\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}\ \textcolor{comment}{//\ for\ k}}
\DoxyCodeLine{00342\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}\ \textcolor{comment}{//\ for\ j}}
\DoxyCodeLine{00343\ }
\DoxyCodeLine{00344\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ pow\_of\_minus\_1\_for\_l\ =\ -\/pow\_of\_minus\_1\_for\_l;}
\DoxyCodeLine{00345\ \ \ \ \ \ \ \ \ \ \ \ \ \}\ \textcolor{comment}{//\ for\ l}}
\DoxyCodeLine{00346\ }
\DoxyCodeLine{00347\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ l\ from\ 0\ to\ n}}
\DoxyCodeLine{00348\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ l\ =\ 0\ ;\ l\ <=\ n\ ;\ ++l)\{}
\DoxyCodeLine{00349\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_f_complex}{FComplex<FReal>}}\ M\_n\_\_n\_l\ =\ multipole\_exp\_src[index\_n\ +\ l];}
\DoxyCodeLine{00350\ }
\DoxyCodeLine{00351\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ j\ from\ n\ to\ P}}
\DoxyCodeLine{00352\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\ \textcolor{keywordtype}{int}\ j\ =\ n\ ;\ j\ <=\ devP\ ;\ ++j\ )\{}
\DoxyCodeLine{00353\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ first\_k\ =\ \mbox{\hyperlink{struct_f_math_ada359f2b021ce4b999c0fd7a6e9daae6}{FMath::Max}}(0,n-\/j+l);}
\DoxyCodeLine{00354\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ (-\/1)\string^k}}
\DoxyCodeLine{00355\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ FReal\ pow\_of\_minus\_1\_for\_k\ =\ \textcolor{keyword}{static\_cast<}FReal\textcolor{keyword}{>}(\ first\_k\&1\ ?\ -\/1.0\ :\ 1.0\ );}
\DoxyCodeLine{00356\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ M\_j\string^k}}
\DoxyCodeLine{00357\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ index\_j\ =\ harmonic.getPreExpRedirJ(j);}
\DoxyCodeLine{00358\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Inner\_\{j-\/n\}\string^\{k-\/l\}\ :\ here\ points\ on\ the\ M2M\ transfer\ function/expansion\ term\ of\ degree\ n-\/j\ and\ order\ |k-\/l|}}
\DoxyCodeLine{00359\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ index\_j\_n\ =\ harmonic.getPreExpRedirJ(j-\/n);}
\DoxyCodeLine{00360\ }
\DoxyCodeLine{00361\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ k\ =\ first\_k;}
\DoxyCodeLine{00362\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(;\ k\ <=\ (j-\/n+l)\ \&\&\ k\ <\ l\ ;\ ++k)\{\ \textcolor{comment}{/*\ l>=0\ \&\&\ k-\/l<0\ */}}
\DoxyCodeLine{00363\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_f_complex}{FComplex<FReal>}}\ I\_j\_n\_\_l\_k\ =\ M2M\_Inner\_transfer[index\_j\_n\ +\ l\ -\/\ k];}
\DoxyCodeLine{00364\ }
\DoxyCodeLine{00365\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ multipole\_exp\_target[index\_j\ +\ k].\mbox{\hyperlink{class_f_complex_a239af6b36a7a875cf409af96ed286bf8}{incReal}}(\ pow\_of\_minus\_1\_for\_k\ *\ pow\_of\_minus\_1\_for\_l\ *}
\DoxyCodeLine{00366\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ((M\_n\_\_n\_l.\mbox{\hyperlink{class_f_complex_a33ec217df0f06432eec174977e0c87ff}{getReal}}()\ *\ I\_j\_n\_\_l\_k.\mbox{\hyperlink{class_f_complex_a33ec217df0f06432eec174977e0c87ff}{getReal}}())\ +}
\DoxyCodeLine{00367\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (M\_n\_\_n\_l.\mbox{\hyperlink{class_f_complex_ab4db8e82d8c014c17b06089163a3c204}{getImag}}()\ *\ I\_j\_n\_\_l\_k.\mbox{\hyperlink{class_f_complex_ab4db8e82d8c014c17b06089163a3c204}{getImag}}())));}
\DoxyCodeLine{00368\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ multipole\_exp\_target[index\_j\ +\ k].\mbox{\hyperlink{class_f_complex_a5da751a7b9af375136091cad0bc8e1d9}{incImag}}(pow\_of\_minus\_1\_for\_k\ *\ pow\_of\_minus\_1\_for\_l\ *}
\DoxyCodeLine{00369\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ((M\_n\_\_n\_l.\mbox{\hyperlink{class_f_complex_ab4db8e82d8c014c17b06089163a3c204}{getImag}}()\ *\ I\_j\_n\_\_l\_k.\mbox{\hyperlink{class_f_complex_a33ec217df0f06432eec174977e0c87ff}{getReal}}())\ -\/}
\DoxyCodeLine{00370\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (M\_n\_\_n\_l.\mbox{\hyperlink{class_f_complex_a33ec217df0f06432eec174977e0c87ff}{getReal}}()\ *\ I\_j\_n\_\_l\_k.\mbox{\hyperlink{class_f_complex_ab4db8e82d8c014c17b06089163a3c204}{getImag}}())));}
\DoxyCodeLine{00371\ }
\DoxyCodeLine{00372\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ pow\_of\_minus\_1\_for\_k\ =\ -\/pow\_of\_minus\_1\_for\_k;}
\DoxyCodeLine{00373\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}\ \textcolor{comment}{//\ for\ k}}
\DoxyCodeLine{00374\ }
\DoxyCodeLine{00375\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{comment}{/*\ k\ =\ l\ */};\ k\ <=\ (j\ -\/\ n\ +\ l)\ ;\ ++k)\{\ \textcolor{comment}{//\ l>=0\ \&\&\ k-\/l>=0}}
\DoxyCodeLine{00376\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_f_complex}{FComplex<FReal>}}\ I\_j\_n\_\_k\_l\ =\ M2M\_Inner\_transfer[index\_j\_n\ +\ k\ -\/\ l];}
\DoxyCodeLine{00377\ }
\DoxyCodeLine{00378\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ multipole\_exp\_target[index\_j\ +\ k].\mbox{\hyperlink{class_f_complex_a239af6b36a7a875cf409af96ed286bf8}{incReal}}(}
\DoxyCodeLine{00379\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (M\_n\_\_n\_l.\mbox{\hyperlink{class_f_complex_a33ec217df0f06432eec174977e0c87ff}{getReal}}()\ *\ I\_j\_n\_\_k\_l.\mbox{\hyperlink{class_f_complex_a33ec217df0f06432eec174977e0c87ff}{getReal}}())\ -\/}
\DoxyCodeLine{00380\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (M\_n\_\_n\_l.\mbox{\hyperlink{class_f_complex_ab4db8e82d8c014c17b06089163a3c204}{getImag}}()\ *\ I\_j\_n\_\_k\_l.\mbox{\hyperlink{class_f_complex_ab4db8e82d8c014c17b06089163a3c204}{getImag}}()));}
\DoxyCodeLine{00381\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ multipole\_exp\_target[index\_j\ +\ k].\mbox{\hyperlink{class_f_complex_a5da751a7b9af375136091cad0bc8e1d9}{incImag}}(}
\DoxyCodeLine{00382\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (M\_n\_\_n\_l.\mbox{\hyperlink{class_f_complex_ab4db8e82d8c014c17b06089163a3c204}{getImag}}()\ *\ I\_j\_n\_\_k\_l.\mbox{\hyperlink{class_f_complex_a33ec217df0f06432eec174977e0c87ff}{getReal}}())\ +}
\DoxyCodeLine{00383\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (M\_n\_\_n\_l.\mbox{\hyperlink{class_f_complex_a33ec217df0f06432eec174977e0c87ff}{getReal}}()\ *\ I\_j\_n\_\_k\_l.\mbox{\hyperlink{class_f_complex_ab4db8e82d8c014c17b06089163a3c204}{getImag}}()));}
\DoxyCodeLine{00384\ }
\DoxyCodeLine{00385\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}\ \textcolor{comment}{//\ for\ k}}
\DoxyCodeLine{00386\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}\ \textcolor{comment}{//\ for\ j}}
\DoxyCodeLine{00387\ }
\DoxyCodeLine{00388\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ pow\_of\_minus\_1\_for\_l\ =\ -\/pow\_of\_minus\_1\_for\_l;}
\DoxyCodeLine{00389\ \ \ \ \ \ \ \ \ \ \ \ \ \}\ \textcolor{comment}{//\ for\ l}}
\DoxyCodeLine{00390\ \ \ \ \ \ \ \ \ \}\ \textcolor{comment}{//\ for\ n}}
\DoxyCodeLine{00391\ \ \ \ \ \}}
\DoxyCodeLine{00392\ }
\DoxyCodeLine{00393\ }
\DoxyCodeLine{00411\ \ \ \ \ \textcolor{keywordtype}{void}\ localToLocal(\mbox{\hyperlink{class_f_complex}{FComplex<FReal>}}*\ \textcolor{keyword}{const}\ FRestrict\ local\_exp\_target,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_f_complex}{FComplex<FReal>}}*\ \textcolor{keyword}{const}\ FRestrict\ local\_exp\_src,}
\DoxyCodeLine{00412\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_f_complex}{FComplex<FReal>}}*\ \textcolor{keyword}{const}\ FRestrict\ L2L\_tranfer)\{}
\DoxyCodeLine{00413\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ L\_j\string^k}}
\DoxyCodeLine{00414\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ index\_j\_k\ =\ 0;}
\DoxyCodeLine{00415\ }
\DoxyCodeLine{00416\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0\ ;\ j\ <=\ devP\ ;\ ++j\ )\{}
\DoxyCodeLine{00417\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ (-\/1)\string^k}}
\DoxyCodeLine{00418\ \ \ \ \ \ \ \ \ \ \ \ \ FReal\ pow\_of\_minus\_1\_for\_k\ =\ 1.0;}
\DoxyCodeLine{00419\ }
\DoxyCodeLine{00420\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ k\ =\ 0\ ;\ k\ <=\ j\ ;\ ++k,\ ++index\_j\_k\ )\{}
\DoxyCodeLine{00421\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_f_complex}{FComplex<FReal>}}\ L\_j\_k\ =\ local\_exp\_target[index\_j\_k];}
\DoxyCodeLine{00422\ }
\DoxyCodeLine{00423\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ n=j;\ n\ <=\ devP;++n)\{}
\DoxyCodeLine{00424\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ O\_n\string^l\ :\ here\ points\ on\ the\ source\ multipole\ expansion\ term\ of\ degree\ n\ and\ order\ |l|}}
\DoxyCodeLine{00425\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ index\_n\ =\ harmonic.getPreExpRedirJ(n);}
\DoxyCodeLine{00426\ }
\DoxyCodeLine{00427\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ l\ =\ n\ -\/\ j\ +\ k;}
\DoxyCodeLine{00428\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Inner\_\{n-\/j\}\string^\{l-\/k\}\ :\ here\ points\ on\ the\ L2L\ transfer\ function/expansion\ term\ of\ degree\ n-\/j\ and\ order\ |l-\/k|}}
\DoxyCodeLine{00429\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ index\_n\_j\ =\ harmonic.getPreExpRedirJ(n-\/j);}
\DoxyCodeLine{00430\ }
\DoxyCodeLine{00431\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{comment}{/*l\ =\ n\ -\/\ j\ +\ k*/}\ ;\ l-\/k\ >\ 0\ ;\ \ -\/-\/l)\{\ \textcolor{comment}{/*\ l>0\ \&\&\ l-\/k>0\ */}}
\DoxyCodeLine{00432\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_f_complex}{FComplex<FReal>}}\ L\_j\_l\ =\ local\_exp\_src[index\_n\ +\ l];}
\DoxyCodeLine{00433\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_f_complex}{FComplex<FReal>}}\ I\_l\_j\_\_l\_k\ =\ L2L\_tranfer[index\_n\_j\ \ +\ l\ -\/\ k];}
\DoxyCodeLine{00434\ }
\DoxyCodeLine{00435\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ L\_j\_k.\mbox{\hyperlink{class_f_complex_a239af6b36a7a875cf409af96ed286bf8}{incReal}}(\ (L\_j\_l.\mbox{\hyperlink{class_f_complex_a33ec217df0f06432eec174977e0c87ff}{getReal}}()\ *\ I\_l\_j\_\_l\_k.\mbox{\hyperlink{class_f_complex_a33ec217df0f06432eec174977e0c87ff}{getReal}}())\ -\/}
\DoxyCodeLine{00436\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (L\_j\_l.\mbox{\hyperlink{class_f_complex_ab4db8e82d8c014c17b06089163a3c204}{getImag}}()\ *\ I\_l\_j\_\_l\_k.\mbox{\hyperlink{class_f_complex_ab4db8e82d8c014c17b06089163a3c204}{getImag}}()));}
\DoxyCodeLine{00437\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ L\_j\_k.\mbox{\hyperlink{class_f_complex_a5da751a7b9af375136091cad0bc8e1d9}{incImag}}(\ (L\_j\_l.\mbox{\hyperlink{class_f_complex_ab4db8e82d8c014c17b06089163a3c204}{getImag}}()\ *\ I\_l\_j\_\_l\_k.\mbox{\hyperlink{class_f_complex_a33ec217df0f06432eec174977e0c87ff}{getReal}}())\ +}
\DoxyCodeLine{00438\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (L\_j\_l.\mbox{\hyperlink{class_f_complex_a33ec217df0f06432eec174977e0c87ff}{getReal}}()\ *\ I\_l\_j\_\_l\_k.\mbox{\hyperlink{class_f_complex_ab4db8e82d8c014c17b06089163a3c204}{getImag}}()));}
\DoxyCodeLine{00439\ }
\DoxyCodeLine{00440\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00441\ }
\DoxyCodeLine{00442\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ (-\/1)\string^l}}
\DoxyCodeLine{00443\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ FReal\ pow\_of\_minus\_1\_for\_l\ =\ ((l\&1)\ ?\ FReal(-\/1.0)\ :\ FReal(1.0));}
\DoxyCodeLine{00444\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{comment}{/*l\ =\ k*/};\ l>0\ \&\&\ l>=j-\/n+k;\ -\/-\/l)\{\ \textcolor{comment}{/*\ l>0\ \&\&\ l-\/k<=0\ */}}
\DoxyCodeLine{00445\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_f_complex}{FComplex<FReal>}}\ L\_j\_l\ =\ local\_exp\_src[index\_n\ +\ l];}
\DoxyCodeLine{00446\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_f_complex}{FComplex<FReal>}}\ I\_l\_j\_\_l\_k\ =\ L2L\_tranfer[index\_n\_j\ \ -\/\ l\ +\ k];}
\DoxyCodeLine{00447\ }
\DoxyCodeLine{00448\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ L\_j\_k.\mbox{\hyperlink{class_f_complex_a239af6b36a7a875cf409af96ed286bf8}{incReal}}(\ pow\_of\_minus\_1\_for\_l\ *\ pow\_of\_minus\_1\_for\_k\ *}
\DoxyCodeLine{00449\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ((L\_j\_l.\mbox{\hyperlink{class_f_complex_a33ec217df0f06432eec174977e0c87ff}{getReal}}()\ *\ I\_l\_j\_\_l\_k.\mbox{\hyperlink{class_f_complex_a33ec217df0f06432eec174977e0c87ff}{getReal}}())\ +}
\DoxyCodeLine{00450\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (L\_j\_l.\mbox{\hyperlink{class_f_complex_ab4db8e82d8c014c17b06089163a3c204}{getImag}}()\ *\ I\_l\_j\_\_l\_k.\mbox{\hyperlink{class_f_complex_ab4db8e82d8c014c17b06089163a3c204}{getImag}}())));}
\DoxyCodeLine{00451\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ L\_j\_k.\mbox{\hyperlink{class_f_complex_a5da751a7b9af375136091cad0bc8e1d9}{incImag}}(\ pow\_of\_minus\_1\_for\_l\ *\ pow\_of\_minus\_1\_for\_k\ *}
\DoxyCodeLine{00452\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ((L\_j\_l.\mbox{\hyperlink{class_f_complex_ab4db8e82d8c014c17b06089163a3c204}{getImag}}()\ *\ I\_l\_j\_\_l\_k.\mbox{\hyperlink{class_f_complex_a33ec217df0f06432eec174977e0c87ff}{getReal}}())\ -\/}
\DoxyCodeLine{00453\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (L\_j\_l.\mbox{\hyperlink{class_f_complex_a33ec217df0f06432eec174977e0c87ff}{getReal}}()\ *\ I\_l\_j\_\_l\_k.\mbox{\hyperlink{class_f_complex_ab4db8e82d8c014c17b06089163a3c204}{getImag}}())));}
\DoxyCodeLine{00454\ }
\DoxyCodeLine{00455\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ pow\_of\_minus\_1\_for\_l\ =\ -\/pow\_of\_minus\_1\_for\_l;}
\DoxyCodeLine{00456\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00457\ }
\DoxyCodeLine{00458\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ l<=0\ \&\&\ l-\/k<=0}}
\DoxyCodeLine{00459\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{comment}{/*l\ =\ 0\ ou\ l\ =\ j-\/n+k-\/1*/};\ l>=j-\/n+k;\ -\/-\/l)\{}
\DoxyCodeLine{00460\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_f_complex}{FComplex<FReal>}}\ L\_j\_l\ =\ local\_exp\_src[index\_n\ -\/\ l];}
\DoxyCodeLine{00461\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_f_complex}{FComplex<FReal>}}\ I\_l\_j\_\_l\_k\ =\ L2L\_tranfer[index\_n\_j\ \ -\/\ l\ +\ k];}
\DoxyCodeLine{00462\ }
\DoxyCodeLine{00463\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ L\_j\_k.\mbox{\hyperlink{class_f_complex_a239af6b36a7a875cf409af96ed286bf8}{incReal}}(\ pow\_of\_minus\_1\_for\_k\ *}
\DoxyCodeLine{00464\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ((L\_j\_l.\mbox{\hyperlink{class_f_complex_a33ec217df0f06432eec174977e0c87ff}{getReal}}()\ *\ I\_l\_j\_\_l\_k.\mbox{\hyperlink{class_f_complex_a33ec217df0f06432eec174977e0c87ff}{getReal}}())\ -\/}
\DoxyCodeLine{00465\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (L\_j\_l.\mbox{\hyperlink{class_f_complex_ab4db8e82d8c014c17b06089163a3c204}{getImag}}()\ *\ I\_l\_j\_\_l\_k.\mbox{\hyperlink{class_f_complex_ab4db8e82d8c014c17b06089163a3c204}{getImag}}())));}
\DoxyCodeLine{00466\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ L\_j\_k.\mbox{\hyperlink{class_f_complex_a221e2f008a120858089b7fda8eeb8984}{decImag}}(\ pow\_of\_minus\_1\_for\_k\ *}
\DoxyCodeLine{00467\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ((L\_j\_l.\mbox{\hyperlink{class_f_complex_ab4db8e82d8c014c17b06089163a3c204}{getImag}}()\ *\ I\_l\_j\_\_l\_k.\mbox{\hyperlink{class_f_complex_a33ec217df0f06432eec174977e0c87ff}{getReal}}())\ +}
\DoxyCodeLine{00468\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (L\_j\_l.\mbox{\hyperlink{class_f_complex_a33ec217df0f06432eec174977e0c87ff}{getReal}}()\ *\ I\_l\_j\_\_l\_k.\mbox{\hyperlink{class_f_complex_ab4db8e82d8c014c17b06089163a3c204}{getImag}}())));}
\DoxyCodeLine{00469\ }
\DoxyCodeLine{00470\ }
\DoxyCodeLine{00471\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00472\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}\textcolor{comment}{//n}}
\DoxyCodeLine{00473\ }
\DoxyCodeLine{00474\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ local\_exp\_target[index\_j\_k]\ =\ L\_j\_k;}
\DoxyCodeLine{00475\ }
\DoxyCodeLine{00476\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ pow\_of\_minus\_1\_for\_k\ =\ -\/pow\_of\_minus\_1\_for\_k;}
\DoxyCodeLine{00477\ \ \ \ \ \ \ \ \ \ \ \ \ \}\textcolor{comment}{//k}}
\DoxyCodeLine{00478\ \ \ \ \ \ \ \ \ \}\textcolor{comment}{//j}}
\DoxyCodeLine{00479\ \ \ \ \ \}}
\DoxyCodeLine{00480\ }
\DoxyCodeLine{00483\ \ \ \ \ \textcolor{keywordtype}{void}\ localToParticle(\textcolor{keyword}{const}\ \mbox{\hyperlink{class_f_point}{FPoint<FReal>}}\&\ local\_position,\textcolor{keyword}{const}\ \mbox{\hyperlink{class_f_complex}{FComplex<FReal>}}*\textcolor{keyword}{const}\ local\_exp,}
\DoxyCodeLine{00484\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_f_point}{FPoint<FReal>}}\&\ particlePosition,}
\DoxyCodeLine{00485\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ FReal\ physicalValue,\ FReal*\textcolor{keyword}{const}\ potential,}
\DoxyCodeLine{00486\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ FReal*\textcolor{keyword}{const}\ forcesX,FReal*\textcolor{keyword}{const}\ forcesY,FReal*\textcolor{keyword}{const}\ forcesZ)\{}
\DoxyCodeLine{00487\ \ \ \ \ \ \ \ \ \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/\ Forces\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\///}}
\DoxyCodeLine{00488\ }
\DoxyCodeLine{00489\ \ \ \ \ \ \ \ \ FReal\ force\_vector\_in\_local\_base\_x\ =\ 0.0;}
\DoxyCodeLine{00490\ \ \ \ \ \ \ \ \ FReal\ force\_vector\_in\_local\_base\_y\ =\ 0.0;}
\DoxyCodeLine{00491\ \ \ \ \ \ \ \ \ FReal\ force\_vector\_in\_local\_base\_z\ =\ 0.0;}
\DoxyCodeLine{00492\ }
\DoxyCodeLine{00493\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_f_spherical}{FSpherical<FReal>}}\ spherical(particlePosition\ -\/\ local\_position);}
\DoxyCodeLine{00494\ \ \ \ \ \ \ \ \ harmonic.\mbox{\hyperlink{class_f_harmonic_aaffc8a0b4c82d5da154e64e42cefd554}{computeInnerTheta}}(\ spherical\ );}
\DoxyCodeLine{00495\ \textcolor{comment}{//\ \ \ \ \ \ \ \ std::cout\ <<\ "{}\ \ L2P:"{}<<std::endl}}
\DoxyCodeLine{00496\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ <<\ "{}\ \ \ \ \ \ \ \ Centre:\ "{}\ <<\ \ \ \ \ \ local\_position\ <<std::endl}}
\DoxyCodeLine{00497\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ <<\ "{}\ \ \ \ \ \ \ \ PArt:\ "{}\ <<\ \ \ \ \ \ \ \ particlePosition\ <<std::endl}}
\DoxyCodeLine{00498\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ <<\ "{}\ \ \ \ \ \ \ \ Diff\ \ \ \ \ \ \ \ \ \ \ "{}\ <<\ \ \ \ \ \ \ particlePosition\ -\/\ local\_position<<std::endl}}
\DoxyCodeLine{00499\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ <<\ "{}\ \ \ \ \ \ \ \ Spherical\ Diff\ "{}\ <<\ \ \ \ \ \ \ spherical\ <<std::endl\ ;}}
\DoxyCodeLine{00500\ }
\DoxyCodeLine{00501\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ index\_j\_k\ =\ 1;}
\DoxyCodeLine{00502\ }
\DoxyCodeLine{00503\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 1\ ;\ j\ <=\ devP\ ;\ ++j\ )\{}
\DoxyCodeLine{00504\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00505\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ k=0:}}
\DoxyCodeLine{00506\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ F\_r:}}
\DoxyCodeLine{00507\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ FReal\ exp\_term\_aux\_real\ =\ (\ (harmonic.result(index\_j\_k).getReal()\ *\ local\_exp[index\_j\_k].\mbox{\hyperlink{class_f_complex_a33ec217df0f06432eec174977e0c87ff}{getReal}}())\ -\/\ (harmonic.result(index\_j\_k).getImag()\ *\ local\_exp[index\_j\_k].\mbox{\hyperlink{class_f_complex_ab4db8e82d8c014c17b06089163a3c204}{getImag}}())\ );}
\DoxyCodeLine{00508\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//const\ FReal\ exp\_term\_aux\_imag\ =\ (\ (harmonic.result(index\_j\_k).getReal()\ *\ local\_exp[index\_j\_k].getImag())\ +\ harmonic.result(index\_j\_k).getImag()\ *\ local\_exp[index\_j\_k].getReal())\ );}}
\DoxyCodeLine{00509\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ force\_vector\_in\_local\_base\_x\ =\ (\ force\_vector\_in\_local\_base\_x\ \ +\ FReal(j)\ *\ exp\_term\_aux\_real\ );}
\DoxyCodeLine{00510\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00511\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00512\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ F\_phi:\ k=0\ =>\ nothing\ to\ do\ for\ F\_phi}}
\DoxyCodeLine{00513\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ F\_theta:}}
\DoxyCodeLine{00514\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ FReal\ exp\_term\_aux\_real\ =\ (\ (harmonic.resultThetaDerivated(index\_j\_k).getReal()\ *\ local\_exp[index\_j\_k].\mbox{\hyperlink{class_f_complex_a33ec217df0f06432eec174977e0c87ff}{getReal}}())\ -\/\ (harmonic.resultThetaDerivated(index\_j\_k).getImag()\ *\ local\_exp[index\_j\_k].\mbox{\hyperlink{class_f_complex_ab4db8e82d8c014c17b06089163a3c204}{getImag}}())\ );}
\DoxyCodeLine{00515\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//const\ FReal\ exp\_term\_aux\_imag\ =\ (\ (harmonic.resultThetaDerivated(index\_j\_k).getReal()\ *\ local\_exp[index\_j\_k].getImag())\ +\ (harmonic.resultThetaDerivated(index\_j\_k).getImag()\ *\ local\_exp[index\_j\_k].getReal())\ );}}
\DoxyCodeLine{00516\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ force\_vector\_in\_local\_base\_y\ =\ (\ force\_vector\_in\_local\_base\_y\ +\ exp\_term\_aux\_real\ );}
\DoxyCodeLine{00517\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00518\ }
\DoxyCodeLine{00519\ \ \ \ \ \ \ \ \ \ \ \ \ ++index\_j\_k;}
\DoxyCodeLine{00520\ }
\DoxyCodeLine{00521\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ k>0:}}
\DoxyCodeLine{00522\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ k=1;\ k<=j\ ;++k,\ ++index\_j\_k)\{}
\DoxyCodeLine{00523\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00524\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ F\_r:}}
\DoxyCodeLine{00525\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ FReal\ exp\_term\_aux\_real\ =\ (\ (harmonic.result(index\_j\_k).getReal()\ *\ local\_exp[index\_j\_k].\mbox{\hyperlink{class_f_complex_a33ec217df0f06432eec174977e0c87ff}{getReal}}())\ -\/\ (harmonic.result(index\_j\_k).getImag()\ *\ local\_exp[index\_j\_k].\mbox{\hyperlink{class_f_complex_ab4db8e82d8c014c17b06089163a3c204}{getImag}}())\ );}
\DoxyCodeLine{00526\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ FReal\ exp\_term\_aux\_imag\ =\ (\ (harmonic.result(index\_j\_k).getReal()\ *\ local\_exp[index\_j\_k].\mbox{\hyperlink{class_f_complex_ab4db8e82d8c014c17b06089163a3c204}{getImag}}())\ +\ (harmonic.result(index\_j\_k).getImag()\ *\ local\_exp[index\_j\_k].\mbox{\hyperlink{class_f_complex_a33ec217df0f06432eec174977e0c87ff}{getReal}}())\ );}
\DoxyCodeLine{00527\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ force\_vector\_in\_local\_base\_x\ =\ (force\_vector\_in\_local\_base\_x\ \ +\ FReal(2\ *\ j)\ *\ exp\_term\_aux\_real\ );}
\DoxyCodeLine{00528\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ F\_phi:}}
\DoxyCodeLine{00529\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ force\_vector\_in\_local\_base\_z\ =\ (\ force\_vector\_in\_local\_base\_z\ -\/\ FReal(2\ *\ k)\ *\ exp\_term\_aux\_imag);}
\DoxyCodeLine{00530\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00531\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00532\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ F\_theta:}}
\DoxyCodeLine{00533\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ FReal\ exp\_term\_aux\_real\ =\ (\ (harmonic.resultThetaDerivated(index\_j\_k).getReal()\ *\ local\_exp[index\_j\_k].\mbox{\hyperlink{class_f_complex_a33ec217df0f06432eec174977e0c87ff}{getReal}}())\ -\/\ (harmonic.resultThetaDerivated(index\_j\_k).getImag()\ *\ local\_exp[index\_j\_k].\mbox{\hyperlink{class_f_complex_ab4db8e82d8c014c17b06089163a3c204}{getImag}}())\ );}
\DoxyCodeLine{00534\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//const\ FReal\ exp\_term\_aux\_imag\ =\ (\ (harmonic.resultThetaDerivated(index\_j\_k).getReal()\ *\ local\_exp[index\_j\_k].getImag())\ +\ (harmonic.resultThetaDerivated(index\_j\_k).getImag()\ *\ local\_exp[index\_j\_k].getReal())\ );}}
\DoxyCodeLine{00535\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ force\_vector\_in\_local\_base\_y\ =\ (force\_vector\_in\_local\_base\_y\ +\ FReal(2.0)\ *\ exp\_term\_aux\_real\ );}
\DoxyCodeLine{00536\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00537\ }
\DoxyCodeLine{00538\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00539\ }
\DoxyCodeLine{00540\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00541\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ We\ want:\ -\/\ gradient(POTENTIAL\_SIGN\ potential).}}
\DoxyCodeLine{00542\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ The\ -\/(-\/\ 1.0)\ computing\ is\ not\ the\ most\ efficient\ programming\ ...}}
\DoxyCodeLine{00543\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ FReal\ signe\ =\ 1.0;}
\DoxyCodeLine{00544\ \ \ \ \ \ \ \ \ \textcolor{comment}{//if(\ FMath::Epsilon\ <\ spherical.getR())\{}}
\DoxyCodeLine{00545\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ The\ derivative\ wrt\ r\ is\ equivalent\ to\ use\ classical\ outer\ expansion\ multiplied\ by\ l\ and\ the\ result\ is\ divided\ by\ r}}
\DoxyCodeLine{00546\ \ \ \ \ \ \ \ \ \ \ \ \ force\_vector\_in\_local\_base\_x\ =\ (\ force\_vector\_in\_local\_base\_x\ \ *\ signe\ /\ spherical.getR());}
\DoxyCodeLine{00547\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ classical\ definition\ of\ the\ derivatives}}
\DoxyCodeLine{00548\ \ \ \ \ \ \ \ \ \ \ \ \ force\_vector\_in\_local\_base\_y\ =\ (\ force\_vector\_in\_local\_base\_y\ *\ signe\ /\ spherical.getR());}
\DoxyCodeLine{00549\ \ \ \ \ \ \ \ \ \ \ \ \ force\_vector\_in\_local\_base\_z\ =\ (\ force\_vector\_in\_local\_base\_z\ *\ signe\ /\ (spherical.getR()\ *\ spherical.getSinTheta()));}
\DoxyCodeLine{00550\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\}}}
\DoxyCodeLine{00552\ \textcolor{comment}{//}}
\DoxyCodeLine{00553\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//spherical\_position\_Set\_ph}}
\DoxyCodeLine{00554\ \ \ \ \ \ \ \ \ FReal\ ph\ =\ \ spherical.getPhiZero2Pi();}
\DoxyCodeLine{00555\ \textcolor{comment}{//\ \ \ \ \ \ \ \ FReal\ ph\ =\ FMath::Fmod(spherical.getPhi(),\ FReal(2)*FMath::FPi<FReal>());}}
\DoxyCodeLine{00556\ \textcolor{comment}{//\ \ \ \ \ \ \ \ if\ (ph\ >\ M\_PI)\ ph\ -\/=\ FReal(2)\ *\ FMath::FPi<FReal>();}}
\DoxyCodeLine{00557\ \textcolor{comment}{//\ \ \ \ \ \ \ \ if\ (ph\ <\ -\/M\_PI\ +\ FMath::Epsilon)\ \ ph\ +=\ FReal(2)\ *\ FMath::FPi<FReal>();}}
\DoxyCodeLine{00558\ \textcolor{comment}{//}}
\DoxyCodeLine{00559\ \textcolor{comment}{//\ \ \ \ \ \ \ \ //spherical\_position\_Set\_th}}
\DoxyCodeLine{00560\ \textcolor{comment}{//\ \ \ \ \ \ \ \ FReal\ th\ =\ FMath::Fmod(spherical.getTheta(),\ FReal(2)\ *\ FMath::FPi<FReal>());}}
\DoxyCodeLine{00561\ \textcolor{comment}{//\ \ \ \ \ \ \ \ //FReal\ th\ =\ spherical.getTheta();}}
\DoxyCodeLine{00562\ \textcolor{comment}{//\ \ \ \ \ \ \ \ if\ (th\ <\ 0.0)\ th\ +=\ 2*FMath::FPi<FReal>();}}
\DoxyCodeLine{00563\ \textcolor{comment}{//\ \ \ \ \ \ \ \ if\ (th\ >\ FMath::FPi<FReal>())\{}}
\DoxyCodeLine{00564\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ th\ =\ 2*FMath::FPi<FReal>()\ -\/\ th;}}
\DoxyCodeLine{00565\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ //spherical\_position\_Set\_ph(p,\ spherical\_position\_Get\_ph(p)\ +\ M\_PI);}}
\DoxyCodeLine{00566\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ ph\ =\ FMath::Fmod(ph\ +\ FMath::FPi<FReal>(),\ 2*FMath::FPi<FReal>());}}
\DoxyCodeLine{00567\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ if\ (ph\ >\ M\_PI)\ ph\ -\/=\ 2*FMath::FPi<FReal>();}}
\DoxyCodeLine{00568\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ if\ (ph\ <\ -\/M\_PI\ +\ FMath::Epsilon)\ \ ph\ +=\ 2\ *\ FMath::FPi<FReal>();}}
\DoxyCodeLine{00569\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \}}}
\DoxyCodeLine{00570\ \textcolor{comment}{//\ \ \ \ \ \ \ \ //spherical\_position\_Set\_r}}
\DoxyCodeLine{00571\ \textcolor{comment}{//\ \ \ \ \ \ \ \ //FReal\ rh\ =\ spherical.r;}}
\DoxyCodeLine{00572\ \ \ \ \ \ \ \ \ FAssertLF(spherical.getR()\ >=\ 0\ ,\ \textcolor{stringliteral}{"{}R\ should\ be\ <\ 0!"{}});}
\DoxyCodeLine{00573\ }
\DoxyCodeLine{00574\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ FReal\ cos\_theta\ \ \ =\ spherical.getCosTheta();\ \textcolor{comment}{//FMath::Cos(th);}}
\DoxyCodeLine{00575\ \ \ \ \ \textcolor{comment}{//\ \ \ \ const\ FReal\ cos\_theta\ \ \ =\ \ FMath::Cos(th);}}
\DoxyCodeLine{00576\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ FReal\ cos\_phi\ \ \ \ \ =\ \mbox{\hyperlink{struct_f_math_a914d36d095fd8cd600ec18e932664fe3}{FMath::Cos}}(ph);}
\DoxyCodeLine{00577\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ FReal\ sin\_theta\ \ \ =\ spherical.getSinTheta()\ ;\textcolor{comment}{//\ FMath::Sin(th);}}
\DoxyCodeLine{00578\ \ \ \ \textcolor{comment}{//\ \ \ \ \ const\ FReal\ sin\_theta\ \ \ =\ \ FMath::Sin(th);}}
\DoxyCodeLine{00579\ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ FReal\ sin\_phi\ \ \ \ \ =\ \mbox{\hyperlink{struct_f_math_a5bdcccf9bf4d10eee66f711044904ace}{FMath::Sin}}(ph);}
\DoxyCodeLine{00580\ \textcolor{comment}{//}}
\DoxyCodeLine{00581\ \ \ \ \ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{00582\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Formulae\ below\ are\ OK}}
\DoxyCodeLine{00583\ \ \ \ \ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{00584\ \ \ \ \ \ \ \ \ FReal\ force\_vector\_tmp\_x\ =\ (}
\DoxyCodeLine{00585\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ cos\_phi\ *\ sin\_theta\ *\ force\_vector\_in\_local\_base\_x\ \ +}
\DoxyCodeLine{00586\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ cos\_phi\ *\ cos\_theta\ *\ force\_vector\_in\_local\_base\_y\ +}
\DoxyCodeLine{00587\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (-\/sin\_phi)\ *\ force\_vector\_in\_local\_base\_z);}
\DoxyCodeLine{00588\ }
\DoxyCodeLine{00589\ \ \ \ \ \ \ \ \ FReal\ force\_vector\_tmp\_y\ =\ (}
\DoxyCodeLine{00590\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ sin\_phi\ *\ sin\_theta\ *\ force\_vector\_in\_local\_base\_x\ \ +}
\DoxyCodeLine{00591\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ sin\_phi\ *\ cos\_theta\ *\ force\_vector\_in\_local\_base\_y\ +}
\DoxyCodeLine{00592\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ cos\_phi\ *\ force\_vector\_in\_local\_base\_z);}
\DoxyCodeLine{00593\ }
\DoxyCodeLine{00594\ \ \ \ \ \ \ \ \ FReal\ force\_vector\_tmp\_z\ =\ (}
\DoxyCodeLine{00595\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ cos\_theta\ *\ force\_vector\_in\_local\_base\_x\ +}
\DoxyCodeLine{00596\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (-\/sin\_theta)\ *\ force\_vector\_in\_local\_base\_y);}
\DoxyCodeLine{00597\ }
\DoxyCodeLine{00598\ \ \ \ \ \ \ \ \ force\_vector\_tmp\_x\ *=\ physicalValue;}
\DoxyCodeLine{00599\ \ \ \ \ \ \ \ \ force\_vector\_tmp\_y\ *=\ physicalValue;}
\DoxyCodeLine{00600\ \ \ \ \ \ \ \ \ force\_vector\_tmp\_z\ *=\ physicalValue;}
\DoxyCodeLine{00601\ }
\DoxyCodeLine{00602\ \ \ \ \ \ \ \ \ (*forcesX)\ +=\ force\_vector\_tmp\_x;}
\DoxyCodeLine{00603\ \ \ \ \ \ \ \ \ (*forcesY)\ +=\ force\_vector\_tmp\_y;}
\DoxyCodeLine{00604\ \ \ \ \ \ \ \ \ (*forcesZ)\ +=\ force\_vector\_tmp\_z;}
\DoxyCodeLine{00605\ \ \ \ \ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{00606\ \ \ \ \ \ \ \ \ \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/\ Potential\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\///}}
\DoxyCodeLine{00607\ \ \ \ \ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{00608\ \ \ \ \ \ \ \ \ FReal\ result\ =\ 0.0;}
\DoxyCodeLine{00609\ \ \ \ \ \ \ \ \ index\_j\_k\ \ \ \ =\ 0;}
\DoxyCodeLine{00610\ }
\DoxyCodeLine{00611\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ j\ =\ 0\ ;\ j<=\ devP\ ;\ ++j)\{}
\DoxyCodeLine{00612\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ k=0}}
\DoxyCodeLine{00613\ \ \ \ \ \ \ \ \ \ \ \ \ harmonic.result(index\_j\_k)\ *=\ local\_exp[index\_j\_k];}
\DoxyCodeLine{00614\ \ \ \ \ \ \ \ \ \ \ \ \ result\ +=\ harmonic.result(index\_j\_k).getReal();}
\DoxyCodeLine{00615\ }
\DoxyCodeLine{00616\ \ \ \ \ \ \ \ \ \ \ \ \ ++index\_j\_k;}
\DoxyCodeLine{00617\ }
\DoxyCodeLine{00618\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ k>0}}
\DoxyCodeLine{00619\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ k\ =\ 1\ ;\ k\ <=\ j\ ;\ ++k,\ ++index\_j\_k)\{}
\DoxyCodeLine{00620\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ harmonic.result(index\_j\_k)\ *=\ local\_exp[index\_j\_k];}
\DoxyCodeLine{00621\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ result\ +=\ 2\ *\ harmonic.result(index\_j\_k).getReal();}
\DoxyCodeLine{00622\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00623\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00624\ }
\DoxyCodeLine{00625\ \ \ \ \ \ \ \ \ (*potential)\ +=\ (result\ \textcolor{comment}{/*\ *\ physicalValue*/});}
\DoxyCodeLine{00626\ \ \ \ \ \}}
\DoxyCodeLine{00627\ }
\DoxyCodeLine{00628\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00632\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_f_abstract_spherical_kernel_a371eaa267f66a73a47c83a5b535ca7f4}{computeVelocity}}(ContainerClass*\textcolor{keyword}{const}\ FRestrict\ inParticles,\ \textcolor{keyword}{const}\ FReal\ DT)\{}
\DoxyCodeLine{00633\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ FReal*\textcolor{keyword}{const}\ physicalValues\ =\ inParticles-\/>getPhysicalValues();}
\DoxyCodeLine{00634\ \ \ \ \ \ \ \ \ FReal*\textcolor{keyword}{const}\ forcesX\ =\ inParticles-\/>getForcesX();}
\DoxyCodeLine{00635\ \ \ \ \ \ \ \ \ FReal*\textcolor{keyword}{const}\ forcesY\ =\ inParticles-\/>getForcesY();}
\DoxyCodeLine{00636\ \ \ \ \ \ \ \ \ FReal*\textcolor{keyword}{const}\ forcesZ\ =\ inParticles-\/>getForcesZ();}
\DoxyCodeLine{00637\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_f_vector}{FVector<FPoint<FReal>}}>\&\ velocities\ =\ inParticles-\/>getVelocities();}
\DoxyCodeLine{00638\ }
\DoxyCodeLine{00639\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(FSize\ idxPart\ =\ 0\ ;\ idxPart\ <\ inParticles-\/>getNbParticles()\ ;\ ++idxPart)\{}
\DoxyCodeLine{00640\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ FReal\ physicalValue\ =\ physicalValues[idxPart];}
\DoxyCodeLine{00641\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Coef\ =\ 1/m\ *\ time/2}}
\DoxyCodeLine{00642\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ FReal\ coef\ =\ (FReal(1.0)/physicalValue)\ *\ (DT/FReal(2.0));}
\DoxyCodeLine{00643\ }
\DoxyCodeLine{00644\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ velocity\ =\ velocity\ +\ forces\ *\ coef}}
\DoxyCodeLine{00645\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_f_point}{FPoint<FReal>}}\ forces\_coef(forcesX[idxPart],\ forcesY[idxPart],\ forcesZ[idxPart]);}
\DoxyCodeLine{00646\ \ \ \ \ \ \ \ \ \ \ \ \ forces\_coef\ *=\ coef;}
\DoxyCodeLine{00647\ \ \ \ \ \ \ \ \ \ \ \ \ velocities[idxPart]\ +=\ (forces\_coef);}
\DoxyCodeLine{00648\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00649\ \ \ \ \ \}}
\DoxyCodeLine{00650\ }
\DoxyCodeLine{00654\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_f_abstract_spherical_kernel_a0e142f8d879c1bdde196f87c400adbf2}{updatePosition}}(ContainerClass*\textcolor{keyword}{const}\ FRestrict\ inParticles,\ \textcolor{keyword}{const}\ FReal\ DT)\{}
\DoxyCodeLine{00655\ \ \ \ \ \ \ \ \ FReal*\textcolor{keyword}{const}\ positionsX\ =\ inParticles-\/>getWPositions()[0];}
\DoxyCodeLine{00656\ \ \ \ \ \ \ \ \ FReal*\textcolor{keyword}{const}\ positionsY\ =\ inParticles-\/>getWPositions()[1];}
\DoxyCodeLine{00657\ \ \ \ \ \ \ \ \ FReal*\textcolor{keyword}{const}\ positionsZ\ =\ inParticles-\/>getWPositions()[2];}
\DoxyCodeLine{00658\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_f_vector}{FVector<FPoint<FReal>}}>\&\ velocities\ =\ inParticles-\/>getVelocities();}
\DoxyCodeLine{00659\ }
\DoxyCodeLine{00660\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(FSize\ idxPart\ =\ 0\ ;\ idxPart\ <\ inParticles-\/>getNbParticles()\ ;\ ++idxPart)\{}
\DoxyCodeLine{00661\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_f_point}{FPoint<FReal>}}\ velocity\_dt(\ velocities[idxPart]\ );}
\DoxyCodeLine{00662\ \ \ \ \ \ \ \ \ \ \ \ \ velocity\_dt\ *=\ DT;}
\DoxyCodeLine{00663\ \ \ \ \ \ \ \ \ \ \ \ \ positionsX[idxPart]\ +=\ velocity\_dt.\mbox{\hyperlink{class_f_point_a58d3859160347552d6a4a94fbdf883c3}{getX}}();}
\DoxyCodeLine{00664\ \ \ \ \ \ \ \ \ \ \ \ \ positionsY[idxPart]\ +=\ velocity\_dt.\mbox{\hyperlink{class_f_point_ae4383512b9b8d216775b3fb92325cfc9}{getY}}();}
\DoxyCodeLine{00665\ \ \ \ \ \ \ \ \ \ \ \ \ positionsZ[idxPart]\ +=\ velocity\_dt.\mbox{\hyperlink{class_f_point_a02208d4db50cbafe597adcbfb152b536}{getZ}}();}
\DoxyCodeLine{00666\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00667\ \ \ \ \ \}}
\DoxyCodeLine{00668\ \};}
\DoxyCodeLine{00669\ }
\DoxyCodeLine{00670\ }
\DoxyCodeLine{00671\ \textcolor{preprocessor}{\#endif\ }\textcolor{comment}{//FABSTRACTSPHERICALKERNEL\_HPP}}

\end{DoxyCode}
