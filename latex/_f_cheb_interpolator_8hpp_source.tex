\doxysection{FCheb\+Interpolator.\+hpp}
\hypertarget{_f_cheb_interpolator_8hpp_source}{}\label{_f_cheb_interpolator_8hpp_source}\index{third\_party/ScalFMM/include/ScalFMM/Kernels/Chebyshev/FChebInterpolator.hpp@{third\_party/ScalFMM/include/ScalFMM/Kernels/Chebyshev/FChebInterpolator.hpp}}

\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{comment}{//\ See\ LICENCE\ file\ at\ project\ root}}
\DoxyCodeLine{00002\ \textcolor{preprocessor}{\#ifndef\ FCHEBINTERPOLATOR\_HPP}}
\DoxyCodeLine{00003\ \textcolor{preprocessor}{\#define\ FCHEBINTERPOLATOR\_HPP}}
\DoxyCodeLine{00004\ }
\DoxyCodeLine{00005\ }
\DoxyCodeLine{00006\ \textcolor{preprocessor}{\#include\ "{}../Interpolation/FInterpMapping.hpp"{}}}
\DoxyCodeLine{00007\ \textcolor{preprocessor}{\#include\ "{}../Interpolation/FInterpMatrixKernel.hpp"{}}\ \textcolor{comment}{//PB}}
\DoxyCodeLine{00008\ \textcolor{preprocessor}{\#include\ "{}FChebTensor.hpp"{}}}
\DoxyCodeLine{00009\ \textcolor{preprocessor}{\#include\ "{}FChebRoots.hpp"{}}}
\DoxyCodeLine{00010\ }
\DoxyCodeLine{00011\ \textcolor{preprocessor}{\#include\ "{}../../Utils/FBlas.hpp"{}}}
\DoxyCodeLine{00012\ }
\DoxyCodeLine{00013\ }
\DoxyCodeLine{00014\ }
\DoxyCodeLine{00030\ \textcolor{keyword}{template}\ <\textcolor{keyword}{class}\ FReal,\ \textcolor{keywordtype}{int}\ ORDER,\ \textcolor{keyword}{class}\ MatrixKernelClass\ =\ struct\ FInterpMatrixKernelR<FReal>,\ \textcolor{keywordtype}{int}\ NVALS\ =\ 1>}
\DoxyCodeLine{00031\ \textcolor{keyword}{class\ }\mbox{\hyperlink{class_f_cheb_interpolator}{FChebInterpolator}}\ :\ \mbox{\hyperlink{class_f_no_copyable}{FNoCopyable}}}
\DoxyCodeLine{00032\ \{}
\DoxyCodeLine{00033\ \ \ \ \ \textcolor{comment}{//\ compile\ time\ constants\ and\ types}}
\DoxyCodeLine{00034\ \ \ \ \ \textcolor{keyword}{enum}\ \{nnodes\ =\ \mbox{\hyperlink{struct_tensor_traits}{TensorTraits<ORDER>::nnodes}},}
\DoxyCodeLine{00035\ \ \ \ \ \ \ \ \ \ \ nRhs\ =\ MatrixKernelClass::NRHS,}
\DoxyCodeLine{00036\ \ \ \ \ \ \ \ \ \ \ nLhs\ =\ MatrixKernelClass::NLHS,}
\DoxyCodeLine{00037\ \ \ \ \ \ \ \ \ \ \ nPV\ =\ MatrixKernelClass::NPV,}
\DoxyCodeLine{00038\ \ \ \ \ \ \ \ \ \ \ nVals\ =\ NVALS\};}
\DoxyCodeLine{00039\ \ \ \ \ \textcolor{keyword}{typedef}\ \mbox{\hyperlink{struct_f_cheb_roots}{FChebRoots<FReal,\ ORDER>}}\ \ \mbox{\hyperlink{struct_f_cheb_roots}{BasisType}};}
\DoxyCodeLine{00040\ \ \ \ \ \textcolor{keyword}{typedef}\ \mbox{\hyperlink{class_f_cheb_tensor}{FChebTensor<FReal,\ ORDER>}}\ \mbox{\hyperlink{class_f_cheb_tensor}{TensorType}};}
\DoxyCodeLine{00041\ }
\DoxyCodeLine{00042\ \textcolor{keyword}{protected}:\ \textcolor{comment}{//\ PB\ for\ OptiDis}}
\DoxyCodeLine{00043\ }
\DoxyCodeLine{00044\ \ \ \ \ FReal\ T\_of\_roots[ORDER][ORDER];}
\DoxyCodeLine{00045\ \ \ \ \ FReal\ T[ORDER\ *\ (ORDER-\/1)];}
\DoxyCodeLine{00046\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ node\_ids[nnodes][3];}
\DoxyCodeLine{00047\ }
\DoxyCodeLine{00048\ \ \ \ \ \textcolor{comment}{//\ 8\ Non-\/leaf\ (i.e.\ M2M/L2L)\ interpolators}}
\DoxyCodeLine{00049\ \ \ \ \ \textcolor{comment}{//\ x1\ per\ level\ if\ box\ is\ extended}}
\DoxyCodeLine{00050\ \ \ \ \ \textcolor{comment}{//\ only\ 1\ is\ required\ for\ all\ levels\ if\ extension\ is\ 0}}
\DoxyCodeLine{00051\ \ \ \ \ FReal***\ ChildParentInterpolator;}
\DoxyCodeLine{00052\ }
\DoxyCodeLine{00053\ \ \ \ \ \textcolor{comment}{//\ Tree\ height\ (needed\ by\ M2M/L2L\ if\ cell\ width\ is\ extended)}}
\DoxyCodeLine{00054\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ TreeHeight;}
\DoxyCodeLine{00055\ \ \ \ \ \textcolor{comment}{//\ Root\ cell\ width\ (only\ used\ by\ M2M/L2L)}}
\DoxyCodeLine{00056\ \ \ \ \ \textcolor{keyword}{const}\ FReal\ RootCellWidth;}
\DoxyCodeLine{00057\ \ \ \ \ \textcolor{comment}{//\ Cell\ width\ extension\ (only\ used\ by\ M2M/L2L,\ kernel\ handles\ extension\ for\ P2M/L2P)}}
\DoxyCodeLine{00058\ \ \ \ \ \textcolor{keyword}{const}\ FReal\ CellWidthExtension;}
\DoxyCodeLine{00059\ }
\DoxyCodeLine{00060\ }
\DoxyCodeLine{00061\ \ \ \ \ \textcolor{comment}{//\ permutations\ (only\ needed\ in\ the\ tensor\ product\ interpolation\ case)}}
\DoxyCodeLine{00062\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ perm[3][nnodes];}
\DoxyCodeLine{00063\ }
\DoxyCodeLine{00065\ \ \ \ \ \textcolor{comment}{//\ needed\ for\ P2M}}
\DoxyCodeLine{00066\ \ \ \ \ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_f_cheb_interpolator_1_1_i_m_n2_m_n_i}{IMN2MNI}}\ \{}
\DoxyCodeLine{00067\ \ \ \ \ \ \ \ \ \textcolor{keyword}{enum}\ \{size\ =\ ORDER\ *\ (ORDER-\/1)\ *\ (ORDER-\/1)\};}
\DoxyCodeLine{00068\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ imn[size],\ mni[size];}
\DoxyCodeLine{00069\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{struct_f_cheb_interpolator_1_1_i_m_n2_m_n_i}{IMN2MNI}}()\ \{}
\DoxyCodeLine{00070\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ counter\ =\ 0;}
\DoxyCodeLine{00071\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ i=0;\ i<ORDER;\ ++i)\ \{}
\DoxyCodeLine{00072\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ m=0;\ m<ORDER-\/1;\ ++m)\ \{}
\DoxyCodeLine{00073\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ n=0;\ n<ORDER-\/1;\ ++n)\ \{}
\DoxyCodeLine{00074\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ imn[counter]\ =\ n*(ORDER-\/1)*ORDER\ +\ m*ORDER\ +\ i;}
\DoxyCodeLine{00075\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ mni[counter]\ =\ i*(ORDER-\/1)*(ORDER-\/1)\ +\ n*(ORDER-\/1)\ +\ m;}
\DoxyCodeLine{00076\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ counter++;}
\DoxyCodeLine{00077\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00078\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00079\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00080\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00081\ \ \ \ \ \}\ perm0;}
\DoxyCodeLine{00082\ }
\DoxyCodeLine{00083\ \ \ \ \ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_f_cheb_interpolator_1_1_j_n_i2_n_i_j}{JNI2NIJ}}\ \{}
\DoxyCodeLine{00084\ \ \ \ \ \ \ \ \ \textcolor{keyword}{enum}\ \{size\ =\ ORDER\ *\ ORDER\ *\ (ORDER-\/1)\};}
\DoxyCodeLine{00085\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ jni[size],\ nij[size];}
\DoxyCodeLine{00086\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{struct_f_cheb_interpolator_1_1_j_n_i2_n_i_j}{JNI2NIJ}}()\ \{}
\DoxyCodeLine{00087\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ counter\ =\ 0;}
\DoxyCodeLine{00088\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ i=0;\ i<ORDER;\ ++i)\ \{}
\DoxyCodeLine{00089\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ j=0;\ j<ORDER;\ ++j)\ \{}
\DoxyCodeLine{00090\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ n=0;\ n<ORDER-\/1;\ ++n)\ \{}
\DoxyCodeLine{00091\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ jni[counter]\ =\ i*(ORDER-\/1)*ORDER\ +\ n*ORDER\ +\ j;}
\DoxyCodeLine{00092\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ nij[counter]\ =\ j*ORDER*(ORDER-\/1)\ +\ i*(ORDER-\/1)\ +\ n;}
\DoxyCodeLine{00093\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ counter++;}
\DoxyCodeLine{00094\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00095\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00096\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00097\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00098\ \ \ \ \ \}\ perm1;}
\DoxyCodeLine{00099\ }
\DoxyCodeLine{00100\ \ \ \ \ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_f_cheb_interpolator_1_1_k_i_j2_i_j_k}{KIJ2IJK}}\ \{}
\DoxyCodeLine{00101\ \ \ \ \ \ \ \ \ \textcolor{keyword}{enum}\ \{size\ =\ ORDER\ *\ ORDER\ *\ ORDER\};}
\DoxyCodeLine{00102\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ kij[size],\ ijk[size];}
\DoxyCodeLine{00103\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{struct_f_cheb_interpolator_1_1_k_i_j2_i_j_k}{KIJ2IJK}}()\ \{}
\DoxyCodeLine{00104\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ counter\ =\ 0;}
\DoxyCodeLine{00105\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ i=0;\ i<ORDER;\ ++i)\ \{}
\DoxyCodeLine{00106\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ j=0;\ j<ORDER;\ ++j)\ \{}
\DoxyCodeLine{00107\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ k=0;\ k<ORDER;\ ++k)\ \{}
\DoxyCodeLine{00108\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ kij[counter]\ =\ j*ORDER*ORDER\ +\ i*ORDER\ +\ k;}
\DoxyCodeLine{00109\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ijk[counter]\ =\ k*ORDER*ORDER\ +\ j*ORDER\ +\ i;}
\DoxyCodeLine{00110\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ counter++;}
\DoxyCodeLine{00111\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00112\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00113\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00114\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00115\ \ \ \ \ \}\ perm2;}
\DoxyCodeLine{00117\ }
\DoxyCodeLine{00119\ \ \ \ \ \textcolor{comment}{//\ needed\ for\ L2P}}
\DoxyCodeLine{00120\ \ \ \ \ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_f_cheb_interpolator_1_1_i_j_k2_j_k_i}{IJK2JKI}}\ \{}
\DoxyCodeLine{00121\ \ \ \ \ \ \ \ \ \textcolor{keyword}{enum}\ \{size\ =\ ORDER\ *\ ORDER\ *\ ORDER\};}
\DoxyCodeLine{00122\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ ijk[size],\ jki[size];}
\DoxyCodeLine{00123\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{struct_f_cheb_interpolator_1_1_i_j_k2_j_k_i}{IJK2JKI}}()\ \{}
\DoxyCodeLine{00124\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ counter\ =\ 0;}
\DoxyCodeLine{00125\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ i=0;\ i<ORDER;\ ++i)\ \{}
\DoxyCodeLine{00126\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ j=0;\ j<ORDER;\ ++j)\ \{}
\DoxyCodeLine{00127\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ k=0;\ k<ORDER;\ ++k)\ \{}
\DoxyCodeLine{00128\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ijk[counter]\ =\ k*ORDER*ORDER\ +\ j*ORDER\ +\ i;}
\DoxyCodeLine{00129\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ jki[counter]\ =\ i*ORDER*ORDER\ +\ k*ORDER\ +\ j;}
\DoxyCodeLine{00130\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ counter++;}
\DoxyCodeLine{00131\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00132\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00133\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00134\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00135\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{void}\ permute(\textcolor{keyword}{const}\ FReal\ *\textcolor{keyword}{const}\ IN,\ FReal\ *\textcolor{keyword}{const}\ OUT)\textcolor{keyword}{\ const}}
\DoxyCodeLine{00136\ \textcolor{keyword}{\ \ \ \ \ \ \ \ }\{\ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ i=0;\ i<size;\ ++i)\ OUT[jki[i]]\ =\ IN[ijk[i]];\ \}}
\DoxyCodeLine{00137\ \ \ \ \ \}\ perm3;}
\DoxyCodeLine{00138\ }
\DoxyCodeLine{00139\ \ \ \ \ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_f_cheb_interpolator_1_1_i_j_k2_k_i_j}{IJK2KIJ}}\ \{}
\DoxyCodeLine{00140\ \ \ \ \ \ \ \ \ \textcolor{keyword}{enum}\ \{size\ =\ ORDER\ *\ ORDER\ *\ ORDER\};}
\DoxyCodeLine{00141\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ ijk[size],\ kij[size];}
\DoxyCodeLine{00142\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{struct_f_cheb_interpolator_1_1_i_j_k2_k_i_j}{IJK2KIJ}}()\ \{}
\DoxyCodeLine{00143\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ counter\ =\ 0;}
\DoxyCodeLine{00144\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ i=0;\ i<ORDER;\ ++i)\ \{}
\DoxyCodeLine{00145\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ j=0;\ j<ORDER;\ ++j)\ \{}
\DoxyCodeLine{00146\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ k=0;\ k<ORDER;\ ++k)\ \{}
\DoxyCodeLine{00147\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ijk[counter]\ =\ k*ORDER*ORDER\ +\ j*ORDER\ +\ i;}
\DoxyCodeLine{00148\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ kij[counter]\ =\ j*ORDER*ORDER\ +\ i*ORDER\ +\ k;}
\DoxyCodeLine{00149\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ counter++;}
\DoxyCodeLine{00150\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00151\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00152\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00153\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00154\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{void}\ permute(\textcolor{keyword}{const}\ FReal\ *\textcolor{keyword}{const}\ IN,\ FReal\ *\textcolor{keyword}{const}\ OUT)\textcolor{keyword}{\ const}}
\DoxyCodeLine{00155\ \textcolor{keyword}{\ \ \ \ \ \ \ \ }\{\ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ i=0;\ i<size;\ ++i)\ OUT[kij[i]]\ =\ IN[ijk[i]];\ \}}
\DoxyCodeLine{00156\ \ \ \ \ \}\ perm4;}
\DoxyCodeLine{00157\ }
\DoxyCodeLine{00158\ \ \ \ \ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_f_cheb_interpolator_1_1_l_j_k2_j_k_l}{LJK2JKL}}\ \{}
\DoxyCodeLine{00159\ \ \ \ \ \ \ \ \ \textcolor{keyword}{enum}\ \{size\ =\ (ORDER-\/1)\ *\ ORDER\ *\ ORDER\};}
\DoxyCodeLine{00160\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ ljk[size],\ jkl[size];}
\DoxyCodeLine{00161\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{struct_f_cheb_interpolator_1_1_l_j_k2_j_k_l}{LJK2JKL}}()\ \{}
\DoxyCodeLine{00162\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ counter\ =\ 0;}
\DoxyCodeLine{00163\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ l=0;\ l<ORDER-\/1;\ ++l)\ \{}
\DoxyCodeLine{00164\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ j=0;\ j<ORDER;\ ++j)\ \{}
\DoxyCodeLine{00165\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ k=0;\ k<ORDER;\ ++k)\ \{}
\DoxyCodeLine{00166\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ljk[counter]\ =\ k*ORDER*(ORDER-\/1)\ +\ j*(ORDER-\/1)\ +\ l;}
\DoxyCodeLine{00167\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ jkl[counter]\ =\ l*ORDER*ORDER\ +\ k*ORDER\ +\ j;}
\DoxyCodeLine{00168\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ counter++;}
\DoxyCodeLine{00169\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00170\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00171\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00172\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00173\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{void}\ permute(\textcolor{keyword}{const}\ FReal\ *\textcolor{keyword}{const}\ IN,\ FReal\ *\textcolor{keyword}{const}\ OUT)\textcolor{keyword}{\ const}}
\DoxyCodeLine{00174\ \textcolor{keyword}{\ \ \ \ \ \ \ \ }\{\ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ i=0;\ i<size;\ ++i)\ OUT[jkl[i]]\ =\ IN[ljk[i]];\ \}}
\DoxyCodeLine{00175\ \ \ \ \ \}\ perm5;}
\DoxyCodeLine{00176\ }
\DoxyCodeLine{00177\ \ \ \ \ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_f_cheb_interpolator_1_1_l_j_k2_k_l_j}{LJK2KLJ}}\ \{}
\DoxyCodeLine{00178\ \ \ \ \ \ \ \ \ \textcolor{keyword}{enum}\ \{size\ =\ (ORDER-\/1)\ *\ ORDER\ *\ ORDER\};}
\DoxyCodeLine{00179\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ ljk[size],\ klj[size];}
\DoxyCodeLine{00180\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{struct_f_cheb_interpolator_1_1_l_j_k2_k_l_j}{LJK2KLJ}}()\ \{}
\DoxyCodeLine{00181\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ counter\ =\ 0;}
\DoxyCodeLine{00182\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ l=0;\ l<ORDER-\/1;\ ++l)\ \{}
\DoxyCodeLine{00183\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ j=0;\ j<ORDER;\ ++j)\ \{}
\DoxyCodeLine{00184\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ k=0;\ k<ORDER;\ ++k)\ \{}
\DoxyCodeLine{00185\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ljk[counter]\ =\ k*ORDER*(ORDER-\/1)\ +\ j*(ORDER-\/1)\ +\ l;}
\DoxyCodeLine{00186\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ klj[counter]\ =\ j*(ORDER-\/1)*ORDER\ +\ l*ORDER\ +\ k;}
\DoxyCodeLine{00187\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ counter++;}
\DoxyCodeLine{00188\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00189\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00190\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00191\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00192\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{void}\ permute(\textcolor{keyword}{const}\ FReal\ *\textcolor{keyword}{const}\ IN,\ FReal\ *\textcolor{keyword}{const}\ OUT)\textcolor{keyword}{\ const}}
\DoxyCodeLine{00193\ \textcolor{keyword}{\ \ \ \ \ \ \ \ }\{\ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ i=0;\ i<size;\ ++i)\ OUT[klj[i]]\ =\ IN[ljk[i]];\ \}}
\DoxyCodeLine{00194\ \ \ \ \ \}\ perm6;}
\DoxyCodeLine{00195\ }
\DoxyCodeLine{00196\ \ \ \ \ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_f_cheb_interpolator_1_1_m_k_i2_k_i_m}{MKI2KIM}}\ \{}
\DoxyCodeLine{00197\ \ \ \ \ \ \ \ \ \textcolor{keyword}{enum}\ \{size\ =\ (ORDER-\/1)\ *\ ORDER\ *\ ORDER\};}
\DoxyCodeLine{00198\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ mki[size],\ kim[size];}
\DoxyCodeLine{00199\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{struct_f_cheb_interpolator_1_1_m_k_i2_k_i_m}{MKI2KIM}}()\ \{}
\DoxyCodeLine{00200\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ counter\ =\ 0;}
\DoxyCodeLine{00201\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ m=0;\ m<ORDER-\/1;\ ++m)\ \{}
\DoxyCodeLine{00202\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ k=0;\ k<ORDER;\ ++k)\ \{}
\DoxyCodeLine{00203\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ i=0;\ i<ORDER;\ ++i)\ \{}
\DoxyCodeLine{00204\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ mki[counter]\ =\ i*ORDER*(ORDER-\/1)\ +\ k*(ORDER-\/1)\ +\ m;}
\DoxyCodeLine{00205\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ kim[counter]\ =\ m*ORDER*ORDER\ +\ i*ORDER\ +\ k;}
\DoxyCodeLine{00206\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ counter++;}
\DoxyCodeLine{00207\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00208\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00209\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00210\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00211\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{void}\ permute(\textcolor{keyword}{const}\ FReal\ *\textcolor{keyword}{const}\ IN,\ FReal\ *\textcolor{keyword}{const}\ OUT)\textcolor{keyword}{\ const}}
\DoxyCodeLine{00212\ \textcolor{keyword}{\ \ \ \ \ \ \ \ }\{\ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ i=0;\ i<size;\ ++i)\ OUT[kim[i]]\ =\ IN[mki[i]];\ \}}
\DoxyCodeLine{00213\ \ \ \ \ \}\ perm7;}
\DoxyCodeLine{00214\ }
\DoxyCodeLine{00215\ \ \ \ \ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_f_cheb_interpolator_1_1_m_k_l2_k_l_m}{MKL2KLM}}\ \{}
\DoxyCodeLine{00216\ \ \ \ \ \ \ \ \ \textcolor{keyword}{enum}\ \{size\ =\ (ORDER-\/1)\ *\ ORDER\ *\ (ORDER-\/1)\};}
\DoxyCodeLine{00217\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ mkl[size],\ klm[size];}
\DoxyCodeLine{00218\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{struct_f_cheb_interpolator_1_1_m_k_l2_k_l_m}{MKL2KLM}}()\ \{}
\DoxyCodeLine{00219\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ counter\ =\ 0;}
\DoxyCodeLine{00220\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ m=0;\ m<ORDER-\/1;\ ++m)\ \{}
\DoxyCodeLine{00221\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ k=0;\ k<ORDER;\ ++k)\ \{}
\DoxyCodeLine{00222\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ l=0;\ l<ORDER-\/1;\ ++l)\ \{}
\DoxyCodeLine{00223\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ mkl[counter]\ =\ l*ORDER*(ORDER-\/1)\ +\ k*(ORDER-\/1)\ +\ m;}
\DoxyCodeLine{00224\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ klm[counter]\ =\ m*(ORDER-\/1)*ORDER\ +\ l*ORDER\ +\ k;}
\DoxyCodeLine{00225\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ counter++;}
\DoxyCodeLine{00226\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00227\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00228\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00229\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00230\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{void}\ permute(\textcolor{keyword}{const}\ FReal\ *\textcolor{keyword}{const}\ IN,\ FReal\ *\textcolor{keyword}{const}\ OUT)\textcolor{keyword}{\ const}}
\DoxyCodeLine{00231\ \textcolor{keyword}{\ \ \ \ \ \ \ \ }\{\ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ i=0;\ i<size;\ ++i)\ OUT[klm[i]]\ =\ IN[mkl[i]];\ \}}
\DoxyCodeLine{00232\ \ \ \ \ \}\ perm8;}
\DoxyCodeLine{00233\ }
\DoxyCodeLine{00234\ \ \ \ \ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_f_cheb_interpolator_1_1_n_l_m2_l_m_n}{NLM2LMN}}\ \{}
\DoxyCodeLine{00235\ \ \ \ \ \ \ \ \ \textcolor{keyword}{enum}\ \{size\ =\ (ORDER-\/1)\ *\ (ORDER-\/1)\ *\ (ORDER-\/1)\};}
\DoxyCodeLine{00236\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ nlm[size],\ lmn[size];}
\DoxyCodeLine{00237\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{struct_f_cheb_interpolator_1_1_n_l_m2_l_m_n}{NLM2LMN}}()\ \{}
\DoxyCodeLine{00238\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ counter\ =\ 0;}
\DoxyCodeLine{00239\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ n=0;\ n<ORDER-\/1;\ ++n)\ \{}
\DoxyCodeLine{00240\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ l=0;\ l<ORDER-\/1;\ ++l)\ \{}
\DoxyCodeLine{00241\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ m=0;\ m<ORDER-\/1;\ ++m)\ \{}
\DoxyCodeLine{00242\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ nlm[counter]\ =\ m*(ORDER-\/1)*(ORDER-\/1)\ +\ l*(ORDER-\/1)\ +\ n;}
\DoxyCodeLine{00243\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ lmn[counter]\ =\ n*(ORDER-\/1)*(ORDER-\/1)\ +\ m*(ORDER-\/1)\ +\ l;}
\DoxyCodeLine{00244\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ counter++;}
\DoxyCodeLine{00245\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00246\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00247\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00248\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00249\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{void}\ permute(\textcolor{keyword}{const}\ FReal\ *\textcolor{keyword}{const}\ IN,\ FReal\ *\textcolor{keyword}{const}\ OUT)\textcolor{keyword}{\ const}}
\DoxyCodeLine{00250\ \textcolor{keyword}{\ \ \ \ \ \ \ \ }\{\ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ i=0;\ i<size;\ ++i)\ OUT[lmn[i]]\ =\ IN[nlm[i]];\ \}}
\DoxyCodeLine{00251\ \ \ \ \ \}\ perm9;}
\DoxyCodeLine{00252\ }
\DoxyCodeLine{00254\ }
\DoxyCodeLine{00255\ }
\DoxyCodeLine{00256\ }
\DoxyCodeLine{00264\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_f_cheb_interpolator_abf2f611f9d0b350969c6145003570896}{initM2MandL2L}}(\textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ TreeLevel,\ \textcolor{keyword}{const}\ FReal\ ParentWidth)}
\DoxyCodeLine{00265\ \ \ \ \ \{}
\DoxyCodeLine{00266\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_f_point}{FPoint<FReal>}}\ ChildRoots[nnodes];}
\DoxyCodeLine{00267\ }
\DoxyCodeLine{00268\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Ratio\ of\ extended\ cell\ widths\ (definition:\ child\ ext\ /\ parent\ ext)}}
\DoxyCodeLine{00269\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ FReal\ ExtendedCellRatio\ =}
\DoxyCodeLine{00270\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ FReal(FReal(ParentWidth)/FReal(2.)\ +\ CellWidthExtension)\ /\ FReal(ParentWidth\ +\ CellWidthExtension);}
\DoxyCodeLine{00271\ }
\DoxyCodeLine{00272\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Child\ cell\ center\ and\ width}}
\DoxyCodeLine{00273\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_f_point}{FPoint<FReal>}}\ ChildCenter;}
\DoxyCodeLine{00274\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ FReal\ ChildWidth(2.*ExtendedCellRatio);}
\DoxyCodeLine{00275\ }
\DoxyCodeLine{00276\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ loop:\ child\ cells}}
\DoxyCodeLine{00277\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ child=0;\ child<8;\ ++child)\ \{}
\DoxyCodeLine{00278\ }
\DoxyCodeLine{00279\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ allocate\ memory}}
\DoxyCodeLine{00280\ \ \ \ \ \ \ \ \ \ \ \ \ ChildParentInterpolator[TreeLevel][child]\ =\ \textcolor{keyword}{new}\ FReal\ [nnodes\ *\ nnodes];}
\DoxyCodeLine{00281\ }
\DoxyCodeLine{00282\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ set\ child\ info}}
\DoxyCodeLine{00283\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_f_interp_tensor_a3e87e6a9c05e36db6e7e902d81ff1e66}{FChebTensor<FReal,\ ORDER>::setRelativeChildCenter}}(child,\ ChildCenter,\ ExtendedCellRatio);}
\DoxyCodeLine{00284\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_f_interp_tensor_ac8107c468326e9c786873c23fe2e8766}{FChebTensor<FReal,\ ORDER>::setRoots}}(ChildCenter,\ ChildWidth,\ ChildRoots);}
\DoxyCodeLine{00285\ }
\DoxyCodeLine{00286\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ assemble\ child\ -\/\ parent\ -\/\ interpolator}}
\DoxyCodeLine{00287\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_f_cheb_interpolator_a147b0202ce6c3c70765baa391e7825f4}{assembleInterpolator}}(nnodes,\ ChildRoots,\ ChildParentInterpolator[TreeLevel][child]);}
\DoxyCodeLine{00288\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00289\ \ \ \ \ \}}
\DoxyCodeLine{00290\ }
\DoxyCodeLine{00291\ }
\DoxyCodeLine{00300\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_f_cheb_interpolator_a0ed6e8c71de65ed81e36f607e3555d52}{initTensorM2MandL2L}}(\textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ TreeLevel,\ \textcolor{keyword}{const}\ FReal\ ParentWidth)}
\DoxyCodeLine{00301\ \ \ \ \ \{}
\DoxyCodeLine{00302\ \ \ \ \ \ \ \ \ FReal\ ChildCoords[3][ORDER];}
\DoxyCodeLine{00303\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_f_point}{FPoint<FReal>}}\ ChildCenter;}
\DoxyCodeLine{00304\ }
\DoxyCodeLine{00305\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Ratio\ of\ extended\ cell\ widths\ (definition:\ child\ ext\ /\ parent\ ext)}}
\DoxyCodeLine{00306\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ FReal\ ExtendedCellRatio\ =}
\DoxyCodeLine{00307\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ FReal(FReal(ParentWidth)/FReal(2.)\ +\ CellWidthExtension)\ /\ FReal(ParentWidth\ +\ CellWidthExtension);}
\DoxyCodeLine{00308\ }
\DoxyCodeLine{00309\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Child\ cell\ width}}
\DoxyCodeLine{00310\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ FReal\ ChildWidth(2.*ExtendedCellRatio);}
\DoxyCodeLine{00311\ }
\DoxyCodeLine{00312\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ loop:\ child\ cells}}
\DoxyCodeLine{00313\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ child=0;\ child<8;\ ++child)\ \{}
\DoxyCodeLine{00314\ }
\DoxyCodeLine{00315\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ set\ child\ info}}
\DoxyCodeLine{00316\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_f_interp_tensor_a3e87e6a9c05e36db6e7e902d81ff1e66}{FChebTensor<FReal,\ ORDER>::setRelativeChildCenter}}(child,\ ChildCenter,\ ExtendedCellRatio);}
\DoxyCodeLine{00317\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_f_interp_tensor_abc18f0f754049c342b5f808990ba95d0}{FChebTensor<FReal,\ ORDER>::setPolynomialsRoots}}(ChildCenter,\ ChildWidth,\ ChildCoords);}
\DoxyCodeLine{00318\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ allocate\ memory}}
\DoxyCodeLine{00319\ \ \ \ \ \ \ \ \ \ \ \ \ ChildParentInterpolator[TreeLevel][child]\ =\ \textcolor{keyword}{new}\ FReal\ [3\ *\ ORDER*ORDER];}
\DoxyCodeLine{00320\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_f_cheb_interpolator_a147b0202ce6c3c70765baa391e7825f4}{assembleInterpolator}}(ORDER,\ ChildCoords[0],\ ChildParentInterpolator[TreeLevel][child]);}
\DoxyCodeLine{00321\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_f_cheb_interpolator_a147b0202ce6c3c70765baa391e7825f4}{assembleInterpolator}}(ORDER,\ ChildCoords[1],\ ChildParentInterpolator[TreeLevel][child]\ +\ 1\ *\ ORDER*ORDER);}
\DoxyCodeLine{00322\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_f_cheb_interpolator_a147b0202ce6c3c70765baa391e7825f4}{assembleInterpolator}}(ORDER,\ ChildCoords[2],\ ChildParentInterpolator[TreeLevel][child]\ +\ 2\ *\ ORDER*ORDER);}
\DoxyCodeLine{00323\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00324\ }
\DoxyCodeLine{00325\ }
\DoxyCodeLine{00326\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ init\ permutations}}
\DoxyCodeLine{00327\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ i=0;\ i<ORDER;\ ++i)\ \{}
\DoxyCodeLine{00328\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ j=0;\ j<ORDER;\ ++j)\ \{}
\DoxyCodeLine{00329\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ k=0;\ k<ORDER;\ ++k)\ \{}
\DoxyCodeLine{00330\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ index\ =\ k*ORDER*ORDER\ +\ j*ORDER\ +\ i;}
\DoxyCodeLine{00331\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ perm[0][index]\ =\ k*ORDER*ORDER\ +\ j*ORDER\ +\ i;}
\DoxyCodeLine{00332\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ perm[1][index]\ =\ i*ORDER*ORDER\ +\ k*ORDER\ +\ j;}
\DoxyCodeLine{00333\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ perm[2][index]\ =\ j*ORDER*ORDER\ +\ i*ORDER\ +\ k;}
\DoxyCodeLine{00334\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00335\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00336\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00337\ }
\DoxyCodeLine{00338\ \ \ \ \ \}}
\DoxyCodeLine{00339\ }
\DoxyCodeLine{00340\ }
\DoxyCodeLine{00341\ }
\DoxyCodeLine{00342\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00352\ \ \ \ \ \textcolor{keyword}{explicit}\ \mbox{\hyperlink{class_f_cheb_interpolator_a37f3c5b7163c5465202fe1529f7cc7f8}{FChebInterpolator}}(\textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ inTreeHeight=3,}
\DoxyCodeLine{00353\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ FReal\ inRootCellWidth=FReal(1.),}
\DoxyCodeLine{00354\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ FReal\ inCellWidthExtension=FReal(0.))}
\DoxyCodeLine{00355\ \ \ \ \ \ \ \ \ :\ TreeHeight(inTreeHeight),}
\DoxyCodeLine{00356\ \ \ \ \ \ \ \ \ \ \ RootCellWidth(inRootCellWidth),}
\DoxyCodeLine{00357\ \ \ \ \ \ \ \ \ \ \ CellWidthExtension(inCellWidthExtension)}
\DoxyCodeLine{00358\ \ \ \ \ \{}
\DoxyCodeLine{00359\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ initialize\ chebyshev\ polynomials\ of\ root\ nodes:\ T\_o(x\_j)}}
\DoxyCodeLine{00360\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ o=1;\ o<ORDER;\ ++o)}
\DoxyCodeLine{00361\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ j=0;\ j<ORDER;\ ++j)}
\DoxyCodeLine{00362\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ T\_of\_roots[o][j]\ =\ FReal(\mbox{\hyperlink{struct_f_cheb_roots_a955a52eca33b000cbd3d6feb79247087}{BasisType::T}}(o,\ FReal(\mbox{\hyperlink{struct_f_cheb_roots_a1b3a28b4b88ad8fbe17b0e0c6ba44e29}{BasisType::roots}}[j])));}
\DoxyCodeLine{00363\ }
\DoxyCodeLine{00364\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ initialize\ chebyshev\ polynomials\ of\ root\ nodes:\ T\_o(x\_j)}}
\DoxyCodeLine{00365\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ o=1;\ o<ORDER;\ ++o)}
\DoxyCodeLine{00366\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ j=0;\ j<ORDER;\ ++j)}
\DoxyCodeLine{00367\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ T[(o-\/1)*ORDER\ +\ j]\ =\ FReal(\mbox{\hyperlink{struct_f_cheb_roots_a955a52eca33b000cbd3d6feb79247087}{BasisType::T}}(o,\ FReal(\mbox{\hyperlink{struct_f_cheb_roots_a1b3a28b4b88ad8fbe17b0e0c6ba44e29}{BasisType::roots}}[j])));}
\DoxyCodeLine{00368\ }
\DoxyCodeLine{00369\ }
\DoxyCodeLine{00370\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ initialize\ root\ node\ ids}}
\DoxyCodeLine{00371\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_f_interp_tensor_aeecba74045a1cd16382c87ab3acdb20a}{TensorType::setNodeIds}}(node\_ids);}
\DoxyCodeLine{00372\ }
\DoxyCodeLine{00373\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ initialize\ interpolation\ operator\ for\ M2M/L2L\ (non\ leaf\ operations)}}
\DoxyCodeLine{00374\ }
\DoxyCodeLine{00375\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ allocate\ 8\ arrays\ per\ level}}
\DoxyCodeLine{00376\ \ \ \ \ \ \ \ \ ChildParentInterpolator\ =\ \textcolor{keyword}{new}\ FReal**[TreeHeight];}
\DoxyCodeLine{00377\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ l\ =\ 0;\ l\ <\ TreeHeight;\ ++l)\{}
\DoxyCodeLine{00378\ \ \ \ \ \ \ \ \ \ \ \ \ ChildParentInterpolator[l]\ =\ \textcolor{keyword}{new}\ FReal*[8];}
\DoxyCodeLine{00379\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ c=0;\ c<8;\ ++c)}
\DoxyCodeLine{00380\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ChildParentInterpolator[l][c]=\textcolor{keyword}{nullptr};}
\DoxyCodeLine{00381\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00382\ }
\DoxyCodeLine{00383\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Set\ number\ of\ non-\/leaf\ ios\ that\ actually\ need\ to\ be\ computed}}
\DoxyCodeLine{00384\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ reducedTreeHeight;\ \textcolor{comment}{//\ =\ 2\ +\ nb\ of\ computed\ nl\ ios}}
\DoxyCodeLine{00385\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(CellWidthExtension==0.\ \&\&\ TreeHeight\ !=\ 2)\ \textcolor{comment}{//\ if\ no\ cell\ extension,\ then\ ...}}
\DoxyCodeLine{00386\ \ \ \ \ \ \ \ \ \ \ \ \ reducedTreeHeight\ =\ 3;\ \textcolor{comment}{//\ cmp\ only\ 1\ non-\/leaf\ io}}
\DoxyCodeLine{00387\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00388\ \ \ \ \ \ \ \ \ \ \ \ \ reducedTreeHeight\ =\ TreeHeight;\ \textcolor{comment}{//\ cmp\ 1\ non-\/leaf\ io\ per\ level}}
\DoxyCodeLine{00389\ }
\DoxyCodeLine{00390\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Init\ non-\/leaf\ interpolators}}
\DoxyCodeLine{00391\ \ \ \ \ \ \ \ \ FReal\ CellWidth\ =\ RootCellWidth\ /\ FReal(2.);\ \textcolor{comment}{//\ at\ level\ 1}}
\DoxyCodeLine{00392\ \ \ \ \ \ \ \ \ CellWidth\ /=\ FReal(2.);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ at\ level\ 2}}
\DoxyCodeLine{00393\ }
\DoxyCodeLine{00394\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ l=2;\ l<reducedTreeHeight;\ ++l)\ \{}
\DoxyCodeLine{00395\ }
\DoxyCodeLine{00396\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//this\ -\/>\ initM2MandL2L(l,CellWidth);\ \ \ \ \ //\ non\ tensor-\/product\ interpolation}}
\DoxyCodeLine{00397\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{this}\ -\/>\ \mbox{\hyperlink{class_f_cheb_interpolator_a0ed6e8c71de65ed81e36f607e3555d52}{initTensorM2MandL2L}}(l,CellWidth);\ \textcolor{comment}{//\ tensor-\/product\ interpolation}}
\DoxyCodeLine{00398\ }
\DoxyCodeLine{00399\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ update\ cell\ width}}
\DoxyCodeLine{00400\ \ \ \ \ \ \ \ \ \ \ \ \ CellWidth\ /=\ FReal(2.);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ at\ level\ l+1}}
\DoxyCodeLine{00401\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00402\ \ \ \ \ \}}
\DoxyCodeLine{00403\ }
\DoxyCodeLine{00404\ }
\DoxyCodeLine{00408\ \ \ \ \ \mbox{\hyperlink{class_f_cheb_interpolator_a64553d580d0c6b32ccf8ece1a2765ed8}{\string~FChebInterpolator}}()}
\DoxyCodeLine{00409\ \ \ \ \ \{}
\DoxyCodeLine{00410\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ l=0;\ l<static\_cast<unsigned\ int>(TreeHeight);\ ++l)\{}
\DoxyCodeLine{00411\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ child=0;\ child<8;\ ++child)\{}
\DoxyCodeLine{00412\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(ChildParentInterpolator[l][child]\ !=\ \textcolor{keyword}{nullptr})\{}
\DoxyCodeLine{00413\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{delete}\ []\ ChildParentInterpolator[l][child];}
\DoxyCodeLine{00414\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00415\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00416\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{delete}[]\ ChildParentInterpolator[l];}
\DoxyCodeLine{00417\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00418\ \ \ \ \ \ \ \ \ \textcolor{keyword}{delete}[]\ ChildParentInterpolator;}
\DoxyCodeLine{00419\ \ \ \ \ \}}
\DoxyCodeLine{00420\ }
\DoxyCodeLine{00421\ }
\DoxyCodeLine{00431\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_f_cheb_interpolator_a147b0202ce6c3c70765baa391e7825f4}{assembleInterpolator}}(\textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ NumberOfLocalPoints,}
\DoxyCodeLine{00432\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_f_point}{FPoint<FReal>}}\ *\textcolor{keyword}{const}\ LocalPoints,}
\DoxyCodeLine{00433\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ FReal\ *\textcolor{keyword}{const}\ Interpolator)\textcolor{keyword}{\ const}}
\DoxyCodeLine{00434\ \textcolor{keyword}{\ \ \ \ }\{}
\DoxyCodeLine{00435\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ values\ of\ chebyshev\ polynomials\ of\ source\ particle:\ T\_o(x\_i)}}
\DoxyCodeLine{00436\ \ \ \ \ \ \ \ \ FReal\ T\_of\_x[ORDER][3];}
\DoxyCodeLine{00437\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ loop:\ local\ points\ (mapped\ in\ [-\/1,1])}}
\DoxyCodeLine{00438\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ m=0;\ m<NumberOfLocalPoints;\ ++m)\ \{}
\DoxyCodeLine{00439\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ evaluate\ chebyshev\ polynomials\ at\ local\ points}}
\DoxyCodeLine{00440\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ o=1;\ o<ORDER;\ ++o)\ \{}
\DoxyCodeLine{00441\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ T\_of\_x[o][0]\ =\ \mbox{\hyperlink{struct_f_cheb_roots_a955a52eca33b000cbd3d6feb79247087}{BasisType::T}}(o,\ LocalPoints[m].getX());}
\DoxyCodeLine{00442\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ T\_of\_x[o][1]\ =\ \mbox{\hyperlink{struct_f_cheb_roots_a955a52eca33b000cbd3d6feb79247087}{BasisType::T}}(o,\ LocalPoints[m].getY());}
\DoxyCodeLine{00443\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ T\_of\_x[o][2]\ =\ \mbox{\hyperlink{struct_f_cheb_roots_a955a52eca33b000cbd3d6feb79247087}{BasisType::T}}(o,\ LocalPoints[m].getZ());}
\DoxyCodeLine{00444\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00445\ }
\DoxyCodeLine{00446\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ assemble\ interpolator}}
\DoxyCodeLine{00447\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ n=0;\ n<nnodes;\ ++n)\ \{}
\DoxyCodeLine{00448\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Interpolator[n*nnodes\ +\ m]\ =\ FReal(1.);}}
\DoxyCodeLine{00449\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Interpolator[n*NumberOfLocalPoints\ +\ m]\ =\ FReal(1.);}
\DoxyCodeLine{00450\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ d=0;\ d<3;\ ++d)\ \{}
\DoxyCodeLine{00451\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ j\ =\ node\_ids[n][d];}
\DoxyCodeLine{00452\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ FReal\ S\_d\ =\ FReal(1.)\ /\ ORDER;}
\DoxyCodeLine{00453\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ o=1;\ o<ORDER;\ ++o)}
\DoxyCodeLine{00454\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ S\_d\ +=\ FReal(2.)\ /\ ORDER\ *\ T\_of\_x[o][d]\ *\ T\_of\_roots[o][j];}
\DoxyCodeLine{00455\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Interpolator[n*nnodes\ +\ m]\ *=\ S\_d;}}
\DoxyCodeLine{00456\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Interpolator[n*NumberOfLocalPoints\ +\ m]\ *=\ S\_d;}
\DoxyCodeLine{00457\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00458\ }
\DoxyCodeLine{00459\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00460\ }
\DoxyCodeLine{00461\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00462\ }
\DoxyCodeLine{00463\ \ \ \ \ \}}
\DoxyCodeLine{00464\ }
\DoxyCodeLine{00465\ }
\DoxyCodeLine{00466\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_f_cheb_interpolator_a147b0202ce6c3c70765baa391e7825f4}{assembleInterpolator}}(\textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ M,\ \textcolor{keyword}{const}\ FReal\ *\textcolor{keyword}{const}\ x,\ FReal\ *\textcolor{keyword}{const}\ S)\textcolor{keyword}{\ const}}
\DoxyCodeLine{00467\ \textcolor{keyword}{\ \ \ \ }\{}
\DoxyCodeLine{00468\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ values\ of\ chebyshev\ polynomials\ of\ source\ particle:\ T\_o(x\_i)}}
\DoxyCodeLine{00469\ \ \ \ \ \ \ \ \ FReal\ T\_of\_x[ORDER];}
\DoxyCodeLine{00470\ }
\DoxyCodeLine{00471\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ loop:\ local\ points\ (mapped\ in\ [-\/1,1])}}
\DoxyCodeLine{00472\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ m=0;\ m<M;\ ++m)\ \{}
\DoxyCodeLine{00473\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ evaluate\ chebyshev\ polynomials\ at\ local\ points}}
\DoxyCodeLine{00474\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ o=1;\ o<ORDER;\ ++o)}
\DoxyCodeLine{00475\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ T\_of\_x[o]\ =\ \mbox{\hyperlink{struct_f_cheb_roots_a955a52eca33b000cbd3d6feb79247087}{BasisType::T}}(o,\ x[m]);}
\DoxyCodeLine{00476\ }
\DoxyCodeLine{00477\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ n=0;\ n<ORDER;\ ++n)\ \{}
\DoxyCodeLine{00478\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ S[n*M\ +\ m]\ =\ FReal(1.)\ /\ ORDER;}
\DoxyCodeLine{00479\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ o=1;\ o<ORDER;\ ++o)}
\DoxyCodeLine{00480\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ S[n*M\ +\ m]\ +=\ FReal(2.)\ /\ ORDER\ *\ T\_of\_x[o]\ *\ T\_of\_roots[o][n];}
\DoxyCodeLine{00481\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00482\ }
\DoxyCodeLine{00483\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00484\ }
\DoxyCodeLine{00485\ \ \ \ \ \}}
\DoxyCodeLine{00486\ }
\DoxyCodeLine{00487\ }
\DoxyCodeLine{00488\ }
\DoxyCodeLine{00489\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ *\ getPermutationsM2ML2L(\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ i)\textcolor{keyword}{\ const}}
\DoxyCodeLine{00490\ \textcolor{keyword}{\ \ \ \ }\{\ \textcolor{keywordflow}{return}\ perm[i];\ \}}
\DoxyCodeLine{00491\ }
\DoxyCodeLine{00492\ }
\DoxyCodeLine{00493\ }
\DoxyCodeLine{00494\ }
\DoxyCodeLine{00495\ }
\DoxyCodeLine{00496\ }
\DoxyCodeLine{00501\ \ \ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{class}\ ContainerClass>}
\DoxyCodeLine{00502\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_f_cheb_interpolator_ae4c31b108e19215b2c4b70f217aeee3f}{applyP2M}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{class_f_point}{FPoint<FReal>}}\&\ center,}
\DoxyCodeLine{00503\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ FReal\ width,}
\DoxyCodeLine{00504\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ FReal\ *\textcolor{keyword}{const}\ multipoleExpansion,}
\DoxyCodeLine{00505\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ ContainerClass\ *\textcolor{keyword}{const}\ sourceParticles)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00506\ }
\DoxyCodeLine{00507\ }
\DoxyCodeLine{00508\ }
\DoxyCodeLine{00512\ \ \ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{class}\ ContainerClass>}
\DoxyCodeLine{00513\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_f_cheb_interpolator_adcf3f59d0d46a5fdc56a246b27432dfa}{applyL2P}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{class_f_point}{FPoint<FReal>}}\&\ center,}
\DoxyCodeLine{00514\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ FReal\ width,}
\DoxyCodeLine{00515\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ FReal\ *\textcolor{keyword}{const}\ localExpansion,}
\DoxyCodeLine{00516\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ContainerClass\ *\textcolor{keyword}{const}\ localParticles)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00517\ }
\DoxyCodeLine{00518\ }
\DoxyCodeLine{00522\ \ \ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{class}\ ContainerClass>}
\DoxyCodeLine{00523\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_f_cheb_interpolator_a1eba40f12be2f8f60a747ae947d2642f}{applyL2PGradient}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{class_f_point}{FPoint<FReal>}}\&\ center,}
\DoxyCodeLine{00524\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ FReal\ width,}
\DoxyCodeLine{00525\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ FReal\ *\textcolor{keyword}{const}\ localExpansion,}
\DoxyCodeLine{00526\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ContainerClass\ *\textcolor{keyword}{const}\ localParticles)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00527\ }
\DoxyCodeLine{00532\ \ \ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{class}\ ContainerClass>}
\DoxyCodeLine{00533\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_f_cheb_interpolator_a21ca0aabd7b14d6a53cf97a12070cab8}{applyL2PTotal}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{class_f_point}{FPoint<FReal>}}\&\ center,}
\DoxyCodeLine{00534\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ FReal\ width,}
\DoxyCodeLine{00535\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ FReal\ *\textcolor{keyword}{const}\ localExpansion,}
\DoxyCodeLine{00536\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ContainerClass\ *\textcolor{keyword}{const}\ localParticles)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00537\ }
\DoxyCodeLine{00538\ }
\DoxyCodeLine{00539\ \ \ \ \ \textcolor{comment}{/*}}
\DoxyCodeLine{00540\ \textcolor{comment}{\ \ \ \ void\ applyM2M(const\ unsigned\ int\ ChildIndex,}}
\DoxyCodeLine{00541\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ const\ FReal\ *const\ ChildExpansion,}}
\DoxyCodeLine{00542\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ FReal\ *const\ ParentExpansion)\ const}}
\DoxyCodeLine{00543\ \textcolor{comment}{\ \ \ \ \{}}
\DoxyCodeLine{00544\ \textcolor{comment}{\ \ \ \ \ \ \ \ FBlas::gemtva(nnodes,\ nnodes,\ FReal(1.),}}
\DoxyCodeLine{00545\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ChildParentInterpolator[ChildIndex],}}
\DoxyCodeLine{00546\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ const\_cast<FReal*>(ChildExpansion),\ ParentExpansion);}}
\DoxyCodeLine{00547\ \textcolor{comment}{\ \ \ \ \}}}
\DoxyCodeLine{00548\ \textcolor{comment}{}}
\DoxyCodeLine{00549\ \textcolor{comment}{\ \ \ \ void\ applyL2L(const\ unsigned\ int\ ChildIndex,}}
\DoxyCodeLine{00550\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ const\ FReal\ *const\ ParentExpansion,}}
\DoxyCodeLine{00551\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ FReal\ *const\ ChildExpansion)\ const}}
\DoxyCodeLine{00552\ \textcolor{comment}{\ \ \ \ \{}}
\DoxyCodeLine{00553\ \textcolor{comment}{\ \ \ \ \ \ \ \ FBlas::gemva(nnodes,\ nnodes,\ FReal(1.),}}
\DoxyCodeLine{00554\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ChildParentInterpolator[ChildIndex],}}
\DoxyCodeLine{00555\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ const\_cast<FReal*>(ParentExpansion),\ ChildExpansion);}}
\DoxyCodeLine{00556\ \textcolor{comment}{\ \ \ \ \}}}
\DoxyCodeLine{00557\ \textcolor{comment}{\ \ \ \ */}}
\DoxyCodeLine{00558\ }
\DoxyCodeLine{00559\ }
\DoxyCodeLine{00560\ \ \ \ \ \textcolor{keywordtype}{void}\ applyM2M(\textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ ChildIndex,}
\DoxyCodeLine{00561\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ FReal\ *\textcolor{keyword}{const}\ ChildExpansion,}
\DoxyCodeLine{00562\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ FReal\ *\textcolor{keyword}{const}\ ParentExpansion,}
\DoxyCodeLine{00563\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ TreeLevel\ =\ 2)\textcolor{keyword}{\ const}}
\DoxyCodeLine{00564\ \textcolor{keyword}{\ \ \ \ }\{}
\DoxyCodeLine{00565\ \ \ \ \ \ \ \ \ FReal\ Exp[nnodes],\ PermExp[nnodes];}
\DoxyCodeLine{00566\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ ORDER*ORDER*ORDER\ *\ (2*ORDER-\/1)}}
\DoxyCodeLine{00567\ \ \ \ \ \ \ \ \ FBlas::gemtm(ORDER,\ ORDER,\ ORDER*ORDER,\ FReal(1.),}
\DoxyCodeLine{00568\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ChildParentInterpolator[TreeLevel][ChildIndex],\ ORDER,}
\DoxyCodeLine{00569\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const\_cast<}FReal*\textcolor{keyword}{>}(ChildExpansion),\ ORDER,\ PermExp,\ ORDER);}
\DoxyCodeLine{00570\ }
\DoxyCodeLine{00571\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ n=0;\ n<nnodes;\ ++n)\ \ \ Exp[n]\ =\ PermExp[perm[1][n]];}
\DoxyCodeLine{00572\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ ORDER*ORDER*ORDER\ *\ (2*ORDER-\/1)}}
\DoxyCodeLine{00573\ \ \ \ \ \ \ \ \ FBlas::gemtm(ORDER,\ ORDER,\ ORDER*ORDER,\ FReal(1.),}
\DoxyCodeLine{00574\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ChildParentInterpolator[TreeLevel][ChildIndex]\ +\ 2\ *\ ORDER*ORDER,\ ORDER,}
\DoxyCodeLine{00575\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Exp,\ ORDER,\ PermExp,\ ORDER);}
\DoxyCodeLine{00576\ }
\DoxyCodeLine{00577\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ n=0;\ n<nnodes;\ ++n)\ \ \ Exp[perm[1][n]]\ =\ PermExp[perm[2][n]];}
\DoxyCodeLine{00578\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ ORDER*ORDER*ORDER\ *\ (2*ORDER-\/1)}}
\DoxyCodeLine{00579\ \ \ \ \ \ \ \ \ FBlas::gemtm(ORDER,\ ORDER,\ ORDER*ORDER,\ FReal(1.),}
\DoxyCodeLine{00580\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ChildParentInterpolator[TreeLevel][ChildIndex]\ +\ 1\ *\ ORDER*ORDER,\ ORDER,}
\DoxyCodeLine{00581\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Exp,\ ORDER,\ PermExp,\ ORDER);}
\DoxyCodeLine{00582\ }
\DoxyCodeLine{00583\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ n=0;\ n<nnodes;\ ++n)\ \ \ ParentExpansion[perm[2][n]]\ +=\ PermExp[n];}
\DoxyCodeLine{00584\ \ \ \ \ \}}
\DoxyCodeLine{00585\ }
\DoxyCodeLine{00586\ }
\DoxyCodeLine{00587\ \ \ \ \ \textcolor{keywordtype}{void}\ applyL2L(\textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ ChildIndex,}
\DoxyCodeLine{00588\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ FReal\ *\textcolor{keyword}{const}\ ParentExpansion,}
\DoxyCodeLine{00589\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ FReal\ *\textcolor{keyword}{const}\ ChildExpansion,}
\DoxyCodeLine{00590\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ TreeLevel\ =\ 2)\textcolor{keyword}{\ const}}
\DoxyCodeLine{00591\ \textcolor{keyword}{\ \ \ \ }\{}
\DoxyCodeLine{00592\ \ \ \ \ \ \ \ \ FReal\ Exp[nnodes],\ PermExp[nnodes];}
\DoxyCodeLine{00593\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ ORDER*ORDER*ORDER\ *\ (2*ORDER-\/1)}}
\DoxyCodeLine{00594\ \ \ \ \ \ \ \ \ FBlas::gemm(ORDER,\ ORDER,\ ORDER*ORDER,\ FReal(1.),}
\DoxyCodeLine{00595\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ChildParentInterpolator[TreeLevel][ChildIndex],\ ORDER,}
\DoxyCodeLine{00596\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const\_cast<}FReal*\textcolor{keyword}{>}(ParentExpansion),\ ORDER,\ PermExp,\ ORDER);}
\DoxyCodeLine{00597\ }
\DoxyCodeLine{00598\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ n=0;\ n<nnodes;\ ++n)\ \ \ Exp[n]\ =\ PermExp[perm[1][n]];}
\DoxyCodeLine{00599\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ ORDER*ORDER*ORDER\ *\ (2*ORDER-\/1)}}
\DoxyCodeLine{00600\ \ \ \ \ \ \ \ \ FBlas::gemm(ORDER,\ ORDER,\ ORDER*ORDER,\ FReal(1.),}
\DoxyCodeLine{00601\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ChildParentInterpolator[TreeLevel][ChildIndex]\ +\ 2\ *\ ORDER*ORDER,\ ORDER,}
\DoxyCodeLine{00602\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Exp,\ ORDER,\ PermExp,\ ORDER);}
\DoxyCodeLine{00603\ }
\DoxyCodeLine{00604\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ n=0;\ n<nnodes;\ ++n)\ \ \ Exp[perm[1][n]]\ =\ PermExp[perm[2][n]];}
\DoxyCodeLine{00605\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ ORDER*ORDER*ORDER\ *\ (2*ORDER-\/1)}}
\DoxyCodeLine{00606\ \ \ \ \ \ \ \ \ FBlas::gemm(ORDER,\ ORDER,\ ORDER*ORDER,\ FReal(1.),}
\DoxyCodeLine{00607\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ChildParentInterpolator[TreeLevel][ChildIndex]\ +\ 1\ *\ ORDER*ORDER,\ ORDER,}
\DoxyCodeLine{00608\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Exp,\ ORDER,\ PermExp,\ ORDER);}
\DoxyCodeLine{00609\ }
\DoxyCodeLine{00610\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ n=0;\ n<nnodes;\ ++n)\ \ \ ChildExpansion[perm[2][n]]\ +=\ PermExp[n];}
\DoxyCodeLine{00611\ \ \ \ \ \}}
\DoxyCodeLine{00612\ \ \ \ \ \textcolor{comment}{//\ total\ flops\ count:\ 3\ *\ ORDER*ORDER*ORDER\ *\ (2*ORDER-\/1)}}
\DoxyCodeLine{00613\ \};}
\DoxyCodeLine{00614\ }
\DoxyCodeLine{00615\ }
\DoxyCodeLine{00616\ }
\DoxyCodeLine{00617\ }
\DoxyCodeLine{00618\ }
\DoxyCodeLine{00619\ }
\DoxyCodeLine{00620\ }
\DoxyCodeLine{00625\ \textcolor{keyword}{template}\ <\textcolor{keyword}{class}\ FReal,\ \textcolor{keywordtype}{int}\ ORDER,\ \textcolor{keyword}{class}\ MatrixKernelClass,\ \textcolor{keywordtype}{int}\ NVALS>}
\DoxyCodeLine{00626\ \textcolor{keyword}{template}\ <\textcolor{keyword}{class}\ ContainerClass>}
\DoxyCodeLine{00627\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_f_cheb_interpolator_ae4c31b108e19215b2c4b70f217aeee3f}{FChebInterpolator<FReal,\ ORDER,MatrixKernelClass,NVALS>::applyP2M}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{class_f_point}{FPoint<FReal>}}\&\ center,}
\DoxyCodeLine{00628\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ FReal\ width,}
\DoxyCodeLine{00629\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ FReal\ *\textcolor{keyword}{const}\ multipoleExpansion,}
\DoxyCodeLine{00630\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ ContainerClass\ *\textcolor{keyword}{const}\ inParticles)\textcolor{keyword}{\ const}}
\DoxyCodeLine{00631\ \textcolor{keyword}{}\{}
\DoxyCodeLine{00632\ }
\DoxyCodeLine{00633\ \ \ \ \ \textcolor{comment}{//\ allocate\ stuff}}
\DoxyCodeLine{00634\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classmap__glob__loc}{map\_glob\_loc<FReal>}}\ map(center,\ width);}
\DoxyCodeLine{00635\ \ \ \ \ \mbox{\hyperlink{class_f_point}{FPoint<FReal>}}\ localPosition;}
\DoxyCodeLine{00636\ }
\DoxyCodeLine{00637\ \ \ \ \ \textcolor{comment}{//\ number\ of\ multipole\ expansions}}
\DoxyCodeLine{00638\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ nMul\ =\ nVals*nRhs;}
\DoxyCodeLine{00639\ }
\DoxyCodeLine{00640\ \ \ \ \ \textcolor{comment}{//\ Init\ W}}
\DoxyCodeLine{00641\ \ \ \ \ FReal\ W1[nMul];}
\DoxyCodeLine{00642\ \ \ \ \ FReal\ W2[nMul][3][\ ORDER-\/1];}
\DoxyCodeLine{00643\ \ \ \ \ FReal\ W4[nMul][3][(ORDER-\/1)*(ORDER-\/1)];}
\DoxyCodeLine{00644\ \ \ \ \ FReal\ W8[nMul][\ \ \ (ORDER-\/1)*(ORDER-\/1)*(ORDER-\/1)];}
\DoxyCodeLine{00645\ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ idxMul\ =\ 0\ ;\ idxMul\ <\ nMul\ ;\ ++idxMul)\{}
\DoxyCodeLine{00646\ \ \ \ \ \ \ \ \ W1[idxMul]\ =\ FReal(0.);}
\DoxyCodeLine{00647\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ i=0;\ i<(ORDER-\/1);\ ++i)\ W2[idxMul][0][i]\ =\ W2[idxMul][1][i]\ =\ W2[idxMul][2][i]\ =\ FReal(0.);}
\DoxyCodeLine{00648\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ i=0;\ i<(ORDER-\/1)*(ORDER-\/1);\ ++i)\ \ \ W4[idxMul][0][i]\ =\ W4[idxMul][1][i]\ =\ W4[idxMul][2][i]\ =\ FReal(0.);}
\DoxyCodeLine{00649\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ i=0;\ i<(ORDER-\/1)*(ORDER-\/1)*(ORDER-\/1);\ ++i)\ W8[idxMul][i]\ =\ FReal(0.);}
\DoxyCodeLine{00650\ \ \ \ \ \}}
\DoxyCodeLine{00651\ }
\DoxyCodeLine{00652\ }
\DoxyCodeLine{00653\ \ \ \ \ \textcolor{comment}{//\ loop\ over\ source\ particles}}
\DoxyCodeLine{00654\ \ \ \ \ \textcolor{keyword}{const}\ FReal*\textcolor{keyword}{const}\ positionsX\ =\ inParticles-\/>getPositions()[0];}
\DoxyCodeLine{00655\ \ \ \ \ \textcolor{keyword}{const}\ FReal*\textcolor{keyword}{const}\ positionsY\ =\ inParticles-\/>getPositions()[1];}
\DoxyCodeLine{00656\ \ \ \ \ \textcolor{keyword}{const}\ FReal*\textcolor{keyword}{const}\ positionsZ\ =\ inParticles-\/>getPositions()[2];}
\DoxyCodeLine{00657\ }
\DoxyCodeLine{00658\ \ \ \ \ \textcolor{keywordflow}{for}(FSize\ idxPart\ =\ 0\ ;\ idxPart\ <\ inParticles-\/>getNbParticles()\ ;\ ++idxPart)\{}
\DoxyCodeLine{00659\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ map\ global\ position\ to\ [-\/1,1]}}
\DoxyCodeLine{00660\ \ \ \ \ \ \ \ \ map(\mbox{\hyperlink{class_f_point}{FPoint<FReal>}}(positionsX[idxPart],positionsY[idxPart],positionsZ[idxPart]),\ localPosition);\ \textcolor{comment}{//\ 15\ flops}}
\DoxyCodeLine{00661\ }
\DoxyCodeLine{00662\ \ \ \ \ \ \ \ \ FReal\ T\_of\_x[3][ORDER];}
\DoxyCodeLine{00663\ \ \ \ \ \ \ \ \ T\_of\_x[0][0]\ =\ FReal(1.);\ T\_of\_x[0][1]\ =\ localPosition.\mbox{\hyperlink{class_f_point_a58d3859160347552d6a4a94fbdf883c3}{getX}}();}
\DoxyCodeLine{00664\ \ \ \ \ \ \ \ \ T\_of\_x[1][0]\ =\ FReal(1.);\ T\_of\_x[1][1]\ =\ localPosition.\mbox{\hyperlink{class_f_point_ae4383512b9b8d216775b3fb92325cfc9}{getY}}();}
\DoxyCodeLine{00665\ \ \ \ \ \ \ \ \ T\_of\_x[2][0]\ =\ FReal(1.);\ T\_of\_x[2][1]\ =\ localPosition.\mbox{\hyperlink{class_f_point_a02208d4db50cbafe597adcbfb152b536}{getZ}}();}
\DoxyCodeLine{00666\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ FReal\ x2\ =\ FReal(2.)\ *\ T\_of\_x[0][1];\ \textcolor{comment}{//\ 1\ flop}}
\DoxyCodeLine{00667\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ FReal\ y2\ =\ FReal(2.)\ *\ T\_of\_x[1][1];\ \textcolor{comment}{//\ 1\ flop}}
\DoxyCodeLine{00668\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ FReal\ z2\ =\ FReal(2.)\ *\ T\_of\_x[2][1];\ \textcolor{comment}{//\ 1\ flop}}
\DoxyCodeLine{00669\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ j=2;\ j<ORDER;\ ++j)\ \{}
\DoxyCodeLine{00670\ \ \ \ \ \ \ \ \ \ \ \ \ T\_of\_x[0][j]\ =\ x2\ *\ T\_of\_x[0][j-\/1]\ -\/\ T\_of\_x[0][j-\/2];\ \textcolor{comment}{//\ 2\ flops}}
\DoxyCodeLine{00671\ \ \ \ \ \ \ \ \ \ \ \ \ T\_of\_x[1][j]\ =\ y2\ *\ T\_of\_x[1][j-\/1]\ -\/\ T\_of\_x[1][j-\/2];\ \textcolor{comment}{//\ 2\ flops}}
\DoxyCodeLine{00672\ \ \ \ \ \ \ \ \ \ \ \ \ T\_of\_x[2][j]\ =\ z2\ *\ T\_of\_x[2][j-\/1]\ -\/\ T\_of\_x[2][j-\/2];\ \textcolor{comment}{//\ 2\ flops}}
\DoxyCodeLine{00673\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00674\ }
\DoxyCodeLine{00675\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ idxVals\ =\ 0\ ;\ idxVals\ <\ nVals\ ;\ ++idxVals)\{}
\DoxyCodeLine{00676\ }
\DoxyCodeLine{00677\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ idxRhs\ =\ 0\ ;\ idxRhs\ <\ nRhs\ ;\ ++idxRhs)\{}
\DoxyCodeLine{00678\ }
\DoxyCodeLine{00679\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ idxMul\ =\ idxRhs*nVals+idxVals;}
\DoxyCodeLine{00680\ }
\DoxyCodeLine{00681\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ FReal*\textcolor{keyword}{const}\ physicalValues\ =\ inParticles-\/>getPhysicalValues(idxVals,idxRhs);}
\DoxyCodeLine{00682\ }
\DoxyCodeLine{00683\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ FReal\ weight\ =\ physicalValues[idxPart];}
\DoxyCodeLine{00684\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ W1[idxMul]\ +=\ weight;\ \textcolor{comment}{//\ 1\ flop}}
\DoxyCodeLine{00685\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ i=1;\ i<ORDER;\ ++i)\ \{}
\DoxyCodeLine{00686\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ FReal\ wx\ =\ weight\ *\ T\_of\_x[0][i];\ \textcolor{comment}{//\ 1\ flop}}
\DoxyCodeLine{00687\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ FReal\ wy\ =\ weight\ *\ T\_of\_x[1][i];\ \textcolor{comment}{//\ 1\ flop}}
\DoxyCodeLine{00688\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ FReal\ wz\ =\ weight\ *\ T\_of\_x[2][i];\ \textcolor{comment}{//\ 1\ flop}}
\DoxyCodeLine{00689\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ W2[idxMul][0][i-\/1]\ +=\ wx;\ \textcolor{comment}{//\ 1\ flop}}
\DoxyCodeLine{00690\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ W2[idxMul][1][i-\/1]\ +=\ wy;\ \textcolor{comment}{//\ 1\ flop}}
\DoxyCodeLine{00691\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ W2[idxMul][2][i-\/1]\ +=\ wz;\ \textcolor{comment}{//\ 1\ flop}}
\DoxyCodeLine{00692\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ j=1;\ j<ORDER;\ ++j)\ \{}
\DoxyCodeLine{00693\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ FReal\ wxy\ =\ wx\ *\ T\_of\_x[1][j];\ \textcolor{comment}{//\ 1\ flop}}
\DoxyCodeLine{00694\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ FReal\ wxz\ =\ wx\ *\ T\_of\_x[2][j];\ \textcolor{comment}{//\ 1\ flop}}
\DoxyCodeLine{00695\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ FReal\ wyz\ =\ wy\ *\ T\_of\_x[2][j];\ \textcolor{comment}{//\ 1\ flop}}
\DoxyCodeLine{00696\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ W4[idxMul][0][(j-\/1)*(ORDER-\/1)\ +\ (i-\/1)]\ +=\ wxy;\ \textcolor{comment}{//\ 1\ flop}}
\DoxyCodeLine{00697\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ W4[idxMul][1][(j-\/1)*(ORDER-\/1)\ +\ (i-\/1)]\ +=\ wxz;\ \textcolor{comment}{//\ 1\ flop}}
\DoxyCodeLine{00698\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ W4[idxMul][2][(j-\/1)*(ORDER-\/1)\ +\ (i-\/1)]\ +=\ wyz;\ \textcolor{comment}{//\ 1\ flop}}
\DoxyCodeLine{00699\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ k=1;\ k<ORDER;\ ++k)\ \{}
\DoxyCodeLine{00700\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ FReal\ wxyz\ =\ wxy\ *\ T\_of\_x[2][k];\ \textcolor{comment}{//\ 1\ flop}}
\DoxyCodeLine{00701\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ W8[idxMul][(k-\/1)*(ORDER-\/1)*(ORDER-\/1)\ +\ (j-\/1)*(ORDER-\/1)\ +\ (i-\/1)]\ +=\ wxyz;\ \textcolor{comment}{//\ 1\ flop}}
\DoxyCodeLine{00702\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}\ \textcolor{comment}{//\ flops:\ (ORDER-\/1)\ *\ 2}}
\DoxyCodeLine{00703\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}\ \textcolor{comment}{//\ flops:\ (ORDER-\/1)\ *\ (6\ +\ (ORDER-\/1)\ *\ 2)}}
\DoxyCodeLine{00704\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}\ \textcolor{comment}{//\ flops:\ (ORDER-\/1)\ *\ (6\ +\ (ORDER-\/1)\ *\ (6\ +\ (ORDER-\/1)\ *\ 2))}}
\DoxyCodeLine{00705\ \ \ \ \ \ \ \ \ \ \ \ \ \}\ \textcolor{comment}{//\ flops:\ ...\ *\ NRHS}}
\DoxyCodeLine{00706\ \ \ \ \ \ \ \ \ \}\ \textcolor{comment}{//\ flops:\ ...\ *\ NVALS}}
\DoxyCodeLine{00707\ \ \ \ \ \}\ \textcolor{comment}{//\ flops:\ N\ *\ (18\ +\ (ORDER-\/2)\ *\ 6\ +\ (ORDER-\/1)\ *\ (6\ +\ (ORDER-\/1)\ *\ (6\ +\ (ORDER-\/1)\ *\ 2)))}}
\DoxyCodeLine{00708\ }
\DoxyCodeLine{00710\ }
\DoxyCodeLine{00711\ }
\DoxyCodeLine{00712\ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ idxMul\ =\ 0\ ;\ idxMul\ <\ nMul\ ;\ ++idxMul)\{}
\DoxyCodeLine{00713\ }
\DoxyCodeLine{00714\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ loop\ over\ interpolation\ points}}
\DoxyCodeLine{00715\ \ \ \ \ \ \ \ \ FReal\ F2[3][ORDER];}
\DoxyCodeLine{00716\ \ \ \ \ \ \ \ \ FReal\ F4[3][ORDER*ORDER];}
\DoxyCodeLine{00717\ \ \ \ \ \ \ \ \ FReal\ F8[\ \ \ ORDER*ORDER*ORDER];}
\DoxyCodeLine{00718\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00719\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ compute\ W2:\ 3\ *\ ORDER*(2*(ORDER-\/1)-\/1)\ flops}}
\DoxyCodeLine{00720\ \ \ \ \ \ \ \ \ \ \ \ \ FBlas::gemv(ORDER,\ ORDER-\/1,\ FReal(1.),\ \textcolor{keyword}{const\_cast<}FReal*\textcolor{keyword}{>}(T),\ W2[idxMul][0],\ F2[0]);}
\DoxyCodeLine{00721\ \ \ \ \ \ \ \ \ \ \ \ \ FBlas::gemv(ORDER,\ ORDER-\/1,\ FReal(1.),\ \textcolor{keyword}{const\_cast<}FReal*\textcolor{keyword}{>}(T),\ W2[idxMul][1],\ F2[1]);}
\DoxyCodeLine{00722\ \ \ \ \ \ \ \ \ \ \ \ \ FBlas::gemv(ORDER,\ ORDER-\/1,\ FReal(1.),\ \textcolor{keyword}{const\_cast<}FReal*\textcolor{keyword}{>}(T),\ W2[idxMul][2],\ F2[2]);}
\DoxyCodeLine{00723\ }
\DoxyCodeLine{00724\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ compute\ W4:\ 3\ *\ [ORDER*(ORDER-\/1)*(2*(ORDER-\/1)-\/1)\ +\ ORDER*ORDER*(2*(ORDER-\/1)-\/1)]}}
\DoxyCodeLine{00725\ \ \ \ \ \ \ \ \ \ \ \ \ FReal\ C[ORDER\ *\ (ORDER-\/1)];}
\DoxyCodeLine{00726\ \ \ \ \ \ \ \ \ \ \ \ \ FBlas::gemmt(ORDER,\ ORDER-\/1,\ ORDER-\/1,\ FReal(1.),\ \textcolor{keyword}{const\_cast<}FReal*\textcolor{keyword}{>}(T),\ ORDER,\ W4[idxMul][0],\ ORDER-\/1,\ C,\ \ \ \ \ ORDER);}
\DoxyCodeLine{00727\ \ \ \ \ \ \ \ \ \ \ \ \ FBlas::gemmt(ORDER,\ ORDER-\/1,\ ORDER,\ \ \ FReal(1.),\ \textcolor{keyword}{const\_cast<}FReal*\textcolor{keyword}{>}(T),\ ORDER,\ C,\ \ \ \ \ ORDER,\ \ \ F4[0],\ ORDER);}
\DoxyCodeLine{00728\ \ \ \ \ \ \ \ \ \ \ \ \ FBlas::gemmt(ORDER,\ ORDER-\/1,\ ORDER-\/1,\ FReal(1.),\ \textcolor{keyword}{const\_cast<}FReal*\textcolor{keyword}{>}(T),\ ORDER,\ W4[idxMul][1],\ ORDER-\/1,\ C,\ \ \ \ \ ORDER);}
\DoxyCodeLine{00729\ \ \ \ \ \ \ \ \ \ \ \ \ FBlas::gemmt(ORDER,\ ORDER-\/1,\ ORDER,\ \ \ FReal(1.),\ \textcolor{keyword}{const\_cast<}FReal*\textcolor{keyword}{>}(T),\ ORDER,\ C,\ \ \ \ \ ORDER,\ \ \ F4[1],\ ORDER);}
\DoxyCodeLine{00730\ \ \ \ \ \ \ \ \ \ \ \ \ FBlas::gemmt(ORDER,\ ORDER-\/1,\ ORDER-\/1,\ FReal(1.),\ \textcolor{keyword}{const\_cast<}FReal*\textcolor{keyword}{>}(T),\ ORDER,\ W4[idxMul][2],\ ORDER-\/1,\ C,\ \ \ \ \ ORDER);}
\DoxyCodeLine{00731\ \ \ \ \ \ \ \ \ \ \ \ \ FBlas::gemmt(ORDER,\ ORDER-\/1,\ ORDER,\ \ \ FReal(1.),\ \textcolor{keyword}{const\_cast<}FReal*\textcolor{keyword}{>}(T),\ ORDER,\ C,\ \ \ \ \ ORDER,\ \ \ F4[2],\ ORDER);}
\DoxyCodeLine{00732\ }
\DoxyCodeLine{00733\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ compute\ W8:\ 3\ *\ (2*(ORDER-\/1)-\/1)\ *\ [ORDER*(ORDER-\/1)*(ORDER-\/1)\ +\ ORDER*ORDER*(ORDER-\/1)\ +\ ORDER*ORDER*ORDER]}}
\DoxyCodeLine{00734\ \ \ \ \ \ \ \ \ \ \ \ \ FReal\ D[ORDER\ *\ (ORDER-\/1)\ *\ (ORDER-\/1)];}
\DoxyCodeLine{00735\ \ \ \ \ \ \ \ \ \ \ \ \ FBlas::gemm(ORDER,\ ORDER-\/1,\ (ORDER-\/1)*(ORDER-\/1),\ FReal(1.),\ \textcolor{keyword}{const\_cast<}FReal*\textcolor{keyword}{>}(T),\ ORDER,\ W8[idxMul],\ ORDER-\/1,\ D,\ ORDER);}
\DoxyCodeLine{00736\ \ \ \ \ \ \ \ \ \ \ \ \ FReal\ E[(ORDER-\/1)\ *\ (ORDER-\/1)\ *\ ORDER];}
\DoxyCodeLine{00737\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ s=0;\ s<perm0.size;\ ++s)\ \ \ E[perm0.mni[s]]\ =\ D[perm0.imn[s]];}
\DoxyCodeLine{00738\ \ \ \ \ \ \ \ \ \ \ \ \ FReal\ F[ORDER\ *\ (ORDER-\/1)\ *\ ORDER];}
\DoxyCodeLine{00739\ \ \ \ \ \ \ \ \ \ \ \ \ FBlas::gemm(ORDER,\ ORDER-\/1,\ ORDER*(ORDER-\/1),\ FReal(1.),\ \textcolor{keyword}{const\_cast<}FReal*\textcolor{keyword}{>}(T),\ ORDER,\ E,\ ORDER-\/1,\ F,\ ORDER);}
\DoxyCodeLine{00740\ \ \ \ \ \ \ \ \ \ \ \ \ FReal\ G[(ORDER-\/1)\ *\ ORDER\ *\ ORDER];}
\DoxyCodeLine{00741\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ s=0;\ s<perm1.size;\ ++s)\ \ \ G[perm1.nij[s]]\ =\ F[perm1.jni[s]];}
\DoxyCodeLine{00742\ \ \ \ \ \ \ \ \ \ \ \ \ FReal\ H[ORDER\ *\ ORDER\ *\ ORDER];}
\DoxyCodeLine{00743\ \ \ \ \ \ \ \ \ \ \ \ \ FBlas::gemm(ORDER,\ ORDER-\/1,\ ORDER*ORDER,\ FReal(1.),\ \textcolor{keyword}{const\_cast<}FReal*\textcolor{keyword}{>}(T),\ ORDER,\ G,\ ORDER-\/1,\ H,\ ORDER);}
\DoxyCodeLine{00744\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ s=0;\ s<perm2.size;\ ++s)\ \ \ F8[perm2.ijk[s]]\ =\ H[perm2.kij[s]];}
\DoxyCodeLine{00745\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00746\ }
\DoxyCodeLine{00747\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ assemble\ multipole\ expansions}}
\DoxyCodeLine{00748\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ i=0;\ i<ORDER;\ ++i)\ \{}
\DoxyCodeLine{00749\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ j=0;\ j<ORDER;\ ++j)\ \{}
\DoxyCodeLine{00750\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ k=0;\ k<ORDER;\ ++k)\ \{}
\DoxyCodeLine{00751\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ idx\ =\ k*ORDER*ORDER\ +\ j*ORDER\ +\ i;}
\DoxyCodeLine{00752\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ multipoleExpansion[2*idxMul*nnodes\ +\ idx]\ +=\ (W1[idxMul]\ +}
\DoxyCodeLine{00753\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ FReal(2.)\ *\ (F2[0][i]\ +\ F2[1][j]\ +\ F2[2][k])\ +}
\DoxyCodeLine{00754\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ FReal(4.)\ *\ (F4[0][j*ORDER+i]\ +\ F4[1][k*ORDER+i]\ +\ F4[2][k*ORDER+j])\ +}
\DoxyCodeLine{00755\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ FReal(8.)\ *\ \ F8[idx])\ /\ nnodes;\ \textcolor{comment}{//\ 11\ *\ ORDER*ORDER*ORDER\ flops}}
\DoxyCodeLine{00756\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00757\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00758\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00759\ }
\DoxyCodeLine{00760\ \ \ \ \ \}\ \textcolor{comment}{//\ NVALS*NRHS}}
\DoxyCodeLine{00761\ }
\DoxyCodeLine{00762\ \}}
\DoxyCodeLine{00763\ }
\DoxyCodeLine{00764\ }
\DoxyCodeLine{00766\ \textcolor{comment}{//\ *\ Particle\ to\ moment:\ application\ of\ \(\backslash\)f\$S\_\(\backslash\)ell(y,\(\backslash\)bar\ y\_n)\(\backslash\)f\$}}
\DoxyCodeLine{00767\ \textcolor{comment}{//\ *\ (anterpolation,\ it\ is\ the\ transposed\ interpolation)}}
\DoxyCodeLine{00768\ \textcolor{comment}{//\ */}}
\DoxyCodeLine{00769\ \textcolor{comment}{//template\ <int\ ORDER>}}
\DoxyCodeLine{00770\ \textcolor{comment}{//template\ <class\ ContainerClass>}}
\DoxyCodeLine{00771\ \textcolor{comment}{//inline\ void\ FChebInterpolator<FReal,ORDER>::applyP2M(const\ FPoint<FReal>\&\ center,}}
\DoxyCodeLine{00772\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ const\ FReal\ width,}}
\DoxyCodeLine{00773\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ FReal\ *const\ multipoleExpansion,}}
\DoxyCodeLine{00774\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ const\ ContainerClass\ *const\ sourceParticles)\ const}}
\DoxyCodeLine{00775\ \textcolor{comment}{//\{}}
\DoxyCodeLine{00776\ \textcolor{comment}{//\ \ //\ set\ all\ multipole\ expansions\ to\ zero}}
\DoxyCodeLine{00777\ \textcolor{comment}{//\ \ FBlas::setzero(nnodes,\ multipoleExpansion);}}
\DoxyCodeLine{00778\ \textcolor{comment}{//}}
\DoxyCodeLine{00779\ \textcolor{comment}{//\ \ //\ allocate\ stuff}}
\DoxyCodeLine{00780\ \textcolor{comment}{//\ \ const\ map\_glob\_loc\ map(center,\ width);}}
\DoxyCodeLine{00781\ \textcolor{comment}{//\ \ FPoint<FReal>\ localPosition;}}
\DoxyCodeLine{00782\ \textcolor{comment}{//\ \ FReal\ T\_of\_x[ORDER][3];}}
\DoxyCodeLine{00783\ \textcolor{comment}{//\ \ FReal\ S[3],\ c1;}}
\DoxyCodeLine{00784\ \textcolor{comment}{//\ \ //}}
\DoxyCodeLine{00785\ \textcolor{comment}{//\ \ FReal\ xpx,ypy,zpz\ ;}}
\DoxyCodeLine{00786\ \textcolor{comment}{//\ \ c1\ =\ FReal(8.)\ /\ nnodes\ ;\ //\ 1\ flop}}
\DoxyCodeLine{00787\ \textcolor{comment}{//\ \ //\ loop\ over\ source\ particles}}
\DoxyCodeLine{00788\ \textcolor{comment}{//\ \ typename\ ContainerClass::ConstBasicIterator\ iter(*sourceParticles);}}
\DoxyCodeLine{00789\ \textcolor{comment}{//\ \ while(iter.hasNotFinished())\{}}
\DoxyCodeLine{00790\ \textcolor{comment}{//}}
\DoxyCodeLine{00791\ \textcolor{comment}{//\ \ \ \ \ \ //\ map\ global\ position\ to\ [-\/1,1]}}
\DoxyCodeLine{00792\ \textcolor{comment}{//\ \ \ \ \ \ map(iter.data().getPosition(),\ localPosition);\ //\ 15\ flops}}
\DoxyCodeLine{00793\ \textcolor{comment}{//}}
\DoxyCodeLine{00794\ \textcolor{comment}{//\ \ \ \ \ \ //\ evaluate\ chebyshev\ polynomials\ of\ source\ particle:\ T\_o(x\_i)}}
\DoxyCodeLine{00795\ \textcolor{comment}{//\ \ \ \ \ \ T\_of\_x[0][0]\ =\ FReal(1.);\ \ \ T\_of\_x[1][0]\ =\ localPosition.getX();}}
\DoxyCodeLine{00796\ \textcolor{comment}{//\ \ \ \ \ \ T\_of\_x[0][1]\ =\ FReal(1.);\ \ \ T\_of\_x[1][1]\ =\ localPosition.getY();}}
\DoxyCodeLine{00797\ \textcolor{comment}{//\ \ \ \ \ \ T\_of\_x[0][2]\ =\ FReal(1.);\ \ \ T\_of\_x[1][2]\ =\ localPosition.getZ();}}
\DoxyCodeLine{00798\ \textcolor{comment}{//\ \ \ \ \ \ xpx\ =\ FReal(2.)\ *\ localPosition.getX()\ ;\ //\ 1\ flop}}
\DoxyCodeLine{00799\ \textcolor{comment}{//\ \ \ \ \ \ ypy\ =\ FReal(2.)\ *\ localPosition.getY()\ ;\ //\ 1\ flop}}
\DoxyCodeLine{00800\ \textcolor{comment}{//\ \ \ \ \ \ zpz\ =\ FReal(2.)\ *\ localPosition.getZ()\ ;\ //\ 1\ flop}}
\DoxyCodeLine{00801\ \textcolor{comment}{//}}
\DoxyCodeLine{00802\ \textcolor{comment}{//\ \ \ \ \ \ for\ (unsigned\ int\ o=2;\ o<ORDER;\ ++o)\ \{}}
\DoxyCodeLine{00803\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ T\_of\_x[o][0]\ =\ xpx\ *\ T\_of\_x[o-\/1][0]\ -\/\ T\_of\_x[o-\/2][0];\ //\ 2\ flops}}
\DoxyCodeLine{00804\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ T\_of\_x[o][1]\ =\ ypy\ *\ T\_of\_x[o-\/1][1]\ -\/\ T\_of\_x[o-\/2][1];\ \ \ //\ 2\ flops}}
\DoxyCodeLine{00805\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ T\_of\_x[o][2]\ =\ zpz\ *\ T\_of\_x[o-\/1][2]\ -\/\ T\_of\_x[o-\/2][2];\ //\ 2\ flops}}
\DoxyCodeLine{00806\ \textcolor{comment}{//\ \ \ \ \ \ \}\ //\ flops:\ (ORDER-\/1)\ *\ 6}}
\DoxyCodeLine{00807\ \textcolor{comment}{//}}
\DoxyCodeLine{00808\ \textcolor{comment}{//\ \ \ \ \ \ //\ anterpolate}}
\DoxyCodeLine{00809\ \textcolor{comment}{//\ \ \ \ \ \ const\ FReal\ sourceValue\ =\ iter.data().getPhysicalValue();}}
\DoxyCodeLine{00810\ \textcolor{comment}{//\ \ \ \ \ \ for\ (unsigned\ int\ n=0;\ n<nnodes;\ ++n)\ \{}}
\DoxyCodeLine{00811\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ const\ unsigned\ int\ j[3]\ =\ \{node\_ids[n][0],\ node\_ids[n][1],\ node\_ids[n][2]\};}}
\DoxyCodeLine{00812\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ S[0]\ =\ FReal(0.5)\ +\ T\_of\_x[1][0]\ *\ T\_of\_roots[1][j[0]];\ //\ 2\ flops}}
\DoxyCodeLine{00813\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ S[1]\ =\ FReal(0.5)\ +\ T\_of\_x[1][1]\ *\ T\_of\_roots[1][j[1]];\ //\ 2\ flops}}
\DoxyCodeLine{00814\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ S[2]\ =\ FReal(0.5)\ +\ T\_of\_x[1][2]\ *\ T\_of\_roots[1][j[2]];\ //\ 2\ flops}}
\DoxyCodeLine{00815\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ for\ (unsigned\ int\ o=2;\ o<ORDER;\ ++o)\ \{}}
\DoxyCodeLine{00816\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ S[0]\ +=\ T\_of\_x[o][0]\ *\ T\_of\_roots[o][j[0]];\ //\ 2\ flops}}
\DoxyCodeLine{00817\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ S[1]\ +=\ T\_of\_x[o][1]\ *\ T\_of\_roots[o][j[1]];\ //\ 2\ flops}}
\DoxyCodeLine{00818\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ S[2]\ +=\ T\_of\_x[o][2]\ *\ T\_of\_roots[o][j[2]];\ //\ 2\ flops}}
\DoxyCodeLine{00819\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \}\ //\ flops:\ (ORDER-\/2)\ *\ 6}}
\DoxyCodeLine{00820\ \textcolor{comment}{//}}
\DoxyCodeLine{00821\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ //\ gather\ contributions}}
\DoxyCodeLine{00822\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ multipoleExpansion[n]\ \ \ +=\ c1\ *\ S[0]\ *\ S[1]\ *\ S[2]\ *\ \ \ \ sourceValue;\ //\ 4\ flops}}
\DoxyCodeLine{00823\ \textcolor{comment}{//\ \ \ \ \ \ \}\ //\ flops:\ ORDER*ORDER*ORDER\ *\ (10\ +\ (ORDER-\/2)\ *\ 6)}}
\DoxyCodeLine{00824\ \textcolor{comment}{//}}
\DoxyCodeLine{00825\ \textcolor{comment}{//\ \ \ \ \ \ //\ increment\ source\ iterator}}
\DoxyCodeLine{00826\ \textcolor{comment}{//\ \ \ \ \ \ iter.gotoNext();}}
\DoxyCodeLine{00827\ \textcolor{comment}{//\ \ \}\ //\ flops:\ M\ *\ (18\ +\ (ORDER-\/1)\ *\ 6\ +\ ORDER*ORDER*ORDER\ *\ (10\ +\ (ORDER-\/2)\ *\ 6))}}
\DoxyCodeLine{00828\ \textcolor{comment}{//\}}}
\DoxyCodeLine{00829\ }
\DoxyCodeLine{00830\ }
\DoxyCodeLine{00831\ }
\DoxyCodeLine{00835\ \textcolor{keyword}{template}\ <\textcolor{keyword}{class}\ FReal,\textcolor{keywordtype}{int}\ ORDER,\ \textcolor{keyword}{class}\ MatrixKernelClass,\ \textcolor{keywordtype}{int}\ NVALS>}
\DoxyCodeLine{00836\ \textcolor{keyword}{template}\ <\textcolor{keyword}{class}\ ContainerClass>}
\DoxyCodeLine{00837\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_f_cheb_interpolator_adcf3f59d0d46a5fdc56a246b27432dfa}{FChebInterpolator<FReal,\ ORDER,MatrixKernelClass,NVALS>::applyL2P}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{class_f_point}{FPoint<FReal>}}\&\ center,}
\DoxyCodeLine{00838\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ FReal\ width,}
\DoxyCodeLine{00839\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ FReal\ *\textcolor{keyword}{const}\ localExpansion,}
\DoxyCodeLine{00840\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ContainerClass\ *\textcolor{keyword}{const}\ inParticles)\textcolor{keyword}{\ const}}
\DoxyCodeLine{00841\ \textcolor{keyword}{}\{}
\DoxyCodeLine{00842\ }
\DoxyCodeLine{00843\ \ \ \ \ \textcolor{comment}{//\ number\ of\ local\ expansions}}
\DoxyCodeLine{00844\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ nLoc\ =\ nVals*nLhs;}
\DoxyCodeLine{00845\ }
\DoxyCodeLine{00846\ \ \ \ \ FReal\ f1[nLoc];}
\DoxyCodeLine{00847\ \ \ \ \ FReal\ W2[nLoc][3][\ ORDER-\/1];}
\DoxyCodeLine{00848\ \ \ \ \ FReal\ W4[nLoc][3][(ORDER-\/1)*(ORDER-\/1)];}
\DoxyCodeLine{00849\ \ \ \ \ FReal\ W8[nLoc][\ \ \ (ORDER-\/1)*(ORDER-\/1)*(ORDER-\/1)];}
\DoxyCodeLine{00850\ \ \ \ \ \{}
\DoxyCodeLine{00851\ }
\DoxyCodeLine{00852\ }
\DoxyCodeLine{00853\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ idxLoc\ =\ 0\ ;\ idxLoc\ <\ nLoc\ ;\ ++idxLoc)\{}
\DoxyCodeLine{00854\ }
\DoxyCodeLine{00855\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ sum\ over\ interpolation\ points}}
\DoxyCodeLine{00856\ \ \ \ \ \ \ \ \ \ \ \ \ f1[idxLoc]\ =\ FReal(0.);}
\DoxyCodeLine{00857\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ i=0;\ i<ORDER-\/1;\ ++i)\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ W2[idxLoc][0][i]\ =\ W2[idxLoc][1][i]\ =\ W2[idxLoc][2][i]\ =\ FReal(0.);}
\DoxyCodeLine{00858\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ i=0;\ i<(ORDER-\/1)*(ORDER-\/1);\ ++i)\ \ \ \ \ \ \ \ W4[idxLoc][0][i]\ =\ W4[idxLoc][1][i]\ =\ W4[idxLoc][2][i]\ =\ FReal(0.);}
\DoxyCodeLine{00859\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ i=0;\ i<(ORDER-\/1)*(ORDER-\/1)*(ORDER-\/1);\ ++i)\ W8[idxLoc][i]\ =\ FReal(0.);}
\DoxyCodeLine{00860\ }
\DoxyCodeLine{00861\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ idx=0;\ idx<nnodes;\ ++idx)\ \{}
\DoxyCodeLine{00862\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ i\ =\ node\_ids[idx][0];}
\DoxyCodeLine{00863\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ j\ =\ node\_ids[idx][1];}
\DoxyCodeLine{00864\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ k\ =\ node\_ids[idx][2];}
\DoxyCodeLine{00865\ }
\DoxyCodeLine{00866\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ f1[idxLoc]\ +=\ localExpansion[2*idxLoc*nnodes\ +\ idx];\ \textcolor{comment}{//\ 1\ flop}}
\DoxyCodeLine{00867\ }
\DoxyCodeLine{00868\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ l=0;\ l<ORDER-\/1;\ ++l)\ \{}
\DoxyCodeLine{00869\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ FReal\ wx\ =\ T[l*ORDER+i]\ *\ localExpansion[2*idxLoc*nnodes\ +\ idx];\ \textcolor{comment}{//\ 1\ flops}}
\DoxyCodeLine{00870\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ FReal\ wy\ =\ T[l*ORDER+j]\ *\ localExpansion[2*idxLoc*nnodes\ +\ idx];\ \textcolor{comment}{//\ 1\ flops}}
\DoxyCodeLine{00871\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ FReal\ wz\ =\ T[l*ORDER+k]\ *\ localExpansion[2*idxLoc*nnodes\ +\ idx];\ \textcolor{comment}{//\ 1\ flops}}
\DoxyCodeLine{00872\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ W2[idxLoc][0][l]\ +=\ wx;\ \textcolor{comment}{//\ 1\ flops}}
\DoxyCodeLine{00873\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ W2[idxLoc][1][l]\ +=\ wy;\ \textcolor{comment}{//\ 1\ flops}}
\DoxyCodeLine{00874\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ W2[idxLoc][2][l]\ +=\ wz;\ \textcolor{comment}{//\ 1\ flops}}
\DoxyCodeLine{00875\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ m=0;\ m<ORDER-\/1;\ ++m)\ \{}
\DoxyCodeLine{00876\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ FReal\ wxy\ =\ wx\ *\ T[m*ORDER\ +\ j];\ \textcolor{comment}{//\ 1\ flops}}
\DoxyCodeLine{00877\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ FReal\ wxz\ =\ wx\ *\ T[m*ORDER\ +\ k];\ \textcolor{comment}{//\ 1\ flops}}
\DoxyCodeLine{00878\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ FReal\ wyz\ =\ wy\ *\ T[m*ORDER\ +\ k];\ \textcolor{comment}{//\ 1\ flops}}
\DoxyCodeLine{00879\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ W4[idxLoc][0][m*(ORDER-\/1)+l]\ +=\ wxy;\ \textcolor{comment}{//\ 1\ flops}}
\DoxyCodeLine{00880\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ W4[idxLoc][1][m*(ORDER-\/1)+l]\ +=\ wxz;\ \textcolor{comment}{//\ 1\ flops}}
\DoxyCodeLine{00881\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ W4[idxLoc][2][m*(ORDER-\/1)+l]\ +=\ wyz;\ \textcolor{comment}{//\ 1\ flops}}
\DoxyCodeLine{00882\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ n=0;\ n<ORDER-\/1;\ ++n)\ \{}
\DoxyCodeLine{00883\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ FReal\ wxyz\ =\ wxy\ *\ T[n*ORDER\ +\ k];\ \textcolor{comment}{//\ 1\ flops}}
\DoxyCodeLine{00884\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ W8[idxLoc][n*(ORDER-\/1)*(ORDER-\/1)\ +\ m*(ORDER-\/1)\ +\ l]\ +=\ wxyz;\ \textcolor{comment}{//\ 1\ flops}}
\DoxyCodeLine{00885\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}\ \textcolor{comment}{//\ (ORDER-\/1)\ *\ 2\ flops}}
\DoxyCodeLine{00886\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}\ \textcolor{comment}{//\ (ORDER-\/1)\ *\ (6\ +\ (ORDER-\/1)*2)\ flops}}
\DoxyCodeLine{00887\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}\ \textcolor{comment}{//\ (ORDER-\/1)\ *\ (6\ +\ (ORDER-\/1)\ *\ (6\ +\ (ORDER-\/1)*2))\ flops}}
\DoxyCodeLine{00888\ \ \ \ \ \ \ \ \ \ \ \ \ \}\ \textcolor{comment}{//\ ORDER*ORDER*ORDER\ *\ (1\ +\ (ORDER-\/1)\ *\ (6\ +\ (ORDER-\/1)\ *\ (6\ +\ (ORDER-\/1)*2)))\ flops}}
\DoxyCodeLine{00889\ \ \ \ \ \ \ \ \ \}\ \textcolor{comment}{//\ NLOC}}
\DoxyCodeLine{00890\ \ \ \ \ \}}
\DoxyCodeLine{00891\ }
\DoxyCodeLine{00892\ }
\DoxyCodeLine{00893\ \ \ \ \ \textcolor{comment}{//\ loop\ over\ particles}}
\DoxyCodeLine{00894\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classmap__glob__loc}{map\_glob\_loc<FReal>}}\ map(center,\ width);}
\DoxyCodeLine{00895\ \ \ \ \ \mbox{\hyperlink{class_f_point}{FPoint<FReal>}}\ localPosition;}
\DoxyCodeLine{00896\ }
\DoxyCodeLine{00897\ \ \ \ \ \textcolor{comment}{//\ get\ particles\ position}}
\DoxyCodeLine{00898\ \ \ \ \ \textcolor{keyword}{const}\ FReal*\textcolor{keyword}{const}\ positionsX\ =\ inParticles-\/>getPositions()[0];}
\DoxyCodeLine{00899\ \ \ \ \ \textcolor{keyword}{const}\ FReal*\textcolor{keyword}{const}\ positionsY\ =\ inParticles-\/>getPositions()[1];}
\DoxyCodeLine{00900\ \ \ \ \ \textcolor{keyword}{const}\ FReal*\textcolor{keyword}{const}\ positionsZ\ =\ inParticles-\/>getPositions()[2];}
\DoxyCodeLine{00901\ }
\DoxyCodeLine{00902\ \ \ \ \ \textcolor{keywordflow}{for}(FSize\ idxPart\ =\ 0\ ;\ idxPart\ <\ inParticles-\/>getNbParticles()\ ;\ ++\ idxPart)\{}
\DoxyCodeLine{00903\ }
\DoxyCodeLine{00904\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ map\ global\ position\ to\ [-\/1,1]}}
\DoxyCodeLine{00905\ \ \ \ \ \ \ \ \ map(\mbox{\hyperlink{class_f_point}{FPoint<FReal>}}(positionsX[idxPart],positionsY[idxPart],positionsZ[idxPart]),\ localPosition);\ \textcolor{comment}{//\ 15\ flops}}
\DoxyCodeLine{00906\ }
\DoxyCodeLine{00907\ \ \ \ \ \ \ \ \ FReal\ T\_of\_x[3][ORDER];}
\DoxyCodeLine{00908\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00909\ \ \ \ \ \ \ \ \ \ \ \ \ T\_of\_x[0][0]\ =\ FReal(1.);\ T\_of\_x[0][1]\ =\ localPosition.\mbox{\hyperlink{class_f_point_a58d3859160347552d6a4a94fbdf883c3}{getX}}();}
\DoxyCodeLine{00910\ \ \ \ \ \ \ \ \ \ \ \ \ T\_of\_x[1][0]\ =\ FReal(1.);\ T\_of\_x[1][1]\ =\ localPosition.\mbox{\hyperlink{class_f_point_ae4383512b9b8d216775b3fb92325cfc9}{getY}}();}
\DoxyCodeLine{00911\ \ \ \ \ \ \ \ \ \ \ \ \ T\_of\_x[2][0]\ =\ FReal(1.);\ T\_of\_x[2][1]\ =\ localPosition.\mbox{\hyperlink{class_f_point_a02208d4db50cbafe597adcbfb152b536}{getZ}}();}
\DoxyCodeLine{00912\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ FReal\ x2\ =\ FReal(2.)\ *\ T\_of\_x[0][1];\ \textcolor{comment}{//\ 1\ flop}}
\DoxyCodeLine{00913\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ FReal\ y2\ =\ FReal(2.)\ *\ T\_of\_x[1][1];\ \textcolor{comment}{//\ 1\ flop}}
\DoxyCodeLine{00914\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ FReal\ z2\ =\ FReal(2.)\ *\ T\_of\_x[2][1];\ \textcolor{comment}{//\ 1\ flop}}
\DoxyCodeLine{00915\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ j=2;\ j<ORDER;\ ++j)\ \{}
\DoxyCodeLine{00916\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ T\_of\_x[0][j]\ =\ x2\ *\ T\_of\_x[0][j-\/1]\ -\/\ T\_of\_x[0][j-\/2];\ \textcolor{comment}{//\ 2\ flops}}
\DoxyCodeLine{00917\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ T\_of\_x[1][j]\ =\ y2\ *\ T\_of\_x[1][j-\/1]\ -\/\ T\_of\_x[1][j-\/2];\ \textcolor{comment}{//\ 2\ flops}}
\DoxyCodeLine{00918\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ T\_of\_x[2][j]\ =\ z2\ *\ T\_of\_x[2][j-\/1]\ -\/\ T\_of\_x[2][j-\/2];\ \textcolor{comment}{//\ 2\ flops}}
\DoxyCodeLine{00919\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00920\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00921\ }
\DoxyCodeLine{00922\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ loop\ over\ multipole\ expansions}}
\DoxyCodeLine{00923\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ idxVals\ =\ 0\ ;\ idxVals\ <\ nVals\ ;\ ++idxVals)\{}
\DoxyCodeLine{00924\ }
\DoxyCodeLine{00925\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ idxLhs\ =\ 0\ ;\ idxLhs\ <\ nLhs\ ;\ ++idxLhs)\{}
\DoxyCodeLine{00926\ }
\DoxyCodeLine{00927\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ idxLoc\ =\ idxLhs*nVals+idxVals;}
\DoxyCodeLine{00928\ }
\DoxyCodeLine{00929\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ distribution\ over\ potential\ components:}}
\DoxyCodeLine{00930\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ We\ sum\ the\ multidim\ contribution\ of\ PhysValue}}
\DoxyCodeLine{00931\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ This\ was\ originally\ done\ at\ M2L\ step\ but\ moved\ here}}
\DoxyCodeLine{00932\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ because\ their\ storage\ is\ required\ by\ the\ force\ computation.}}
\DoxyCodeLine{00933\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ In\ fact\ :\ f\_\{ik\}(x)=w\_j(x)\ \(\backslash\)nabla\_\{x\_i\}\ K\_\{ij\}(x,y)w\_j(y))}}
\DoxyCodeLine{00934\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ idxPot\ =\ idxLhs\ /\ nPV;}
\DoxyCodeLine{00935\ }
\DoxyCodeLine{00936\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ FReal*\textcolor{keyword}{const}\ potentials\ =\ inParticles-\/>getPotentials(idxVals,idxPot);}
\DoxyCodeLine{00937\ }
\DoxyCodeLine{00938\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ interpolate\ and\ increment\ target\ value}}
\DoxyCodeLine{00939\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ FReal\ targetValue\ =\ potentials[idxPart];}
\DoxyCodeLine{00940\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00941\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ FReal\ f2,\ f4,\ f8;}
\DoxyCodeLine{00942\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00943\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ f2\ =\ f4\ =\ f8\ =\ FReal(0.);}
\DoxyCodeLine{00944\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ l=1;\ l<ORDER;\ ++l)\ \{}
\DoxyCodeLine{00945\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ f2\ +=}
\DoxyCodeLine{00946\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ T\_of\_x[0][l]\ *\ W2[idxLoc][0][l-\/1]\ +}
\DoxyCodeLine{00947\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ T\_of\_x[1][l]\ *\ W2[idxLoc][1][l-\/1]\ +}
\DoxyCodeLine{00948\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ T\_of\_x[2][l]\ *\ W2[idxLoc][2][l-\/1];\ \textcolor{comment}{//\ 6\ flops}}
\DoxyCodeLine{00949\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ m=1;\ m<ORDER;\ ++m)\ \{}
\DoxyCodeLine{00950\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ f4\ +=}
\DoxyCodeLine{00951\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ T\_of\_x[0][l]\ *\ T\_of\_x[1][m]\ *\ W4[idxLoc][0][(m-\/1)*(ORDER-\/1)+(l-\/1)]\ +}
\DoxyCodeLine{00952\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ T\_of\_x[0][l]\ *\ T\_of\_x[2][m]\ *\ W4[idxLoc][1][(m-\/1)*(ORDER-\/1)+(l-\/1)]\ +}
\DoxyCodeLine{00953\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ T\_of\_x[1][l]\ *\ T\_of\_x[2][m]\ *\ W4[idxLoc][2][(m-\/1)*(ORDER-\/1)+(l-\/1)];\ \textcolor{comment}{//\ 9\ flops}}
\DoxyCodeLine{00954\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ n=1;\ n<ORDER;\ ++n)\ \{}
\DoxyCodeLine{00955\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ f8\ +=}
\DoxyCodeLine{00956\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ T\_of\_x[0][l]\ *\ T\_of\_x[1][m]\ *\ T\_of\_x[2][n]\ *}
\DoxyCodeLine{00957\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ W8[idxLoc][(n-\/1)*(ORDER-\/1)*(ORDER-\/1)\ +\ (m-\/1)*(ORDER-\/1)\ +\ (l-\/1)];}
\DoxyCodeLine{00958\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}\ \textcolor{comment}{//\ ORDER\ *\ 4\ flops}}
\DoxyCodeLine{00959\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}\ \textcolor{comment}{//\ ORDER\ *\ (9\ +\ ORDER\ *\ 4)\ flops}}
\DoxyCodeLine{00960\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}\ \textcolor{comment}{//\ ORDER\ *\ (ORDER\ *\ (9\ +\ ORDER\ *\ 4))\ flops}}
\DoxyCodeLine{00961\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00962\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ targetValue\ =\ (f1[idxLoc]\ +\ FReal(2.)*f2\ +\ FReal(4.)*f4\ +\ FReal(8.)*f8)\ /\ nnodes;\ \textcolor{comment}{//\ 7\ flops}}
\DoxyCodeLine{00963\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}\ \textcolor{comment}{//\ 7\ +\ ORDER\ *\ (ORDER\ *\ (9\ +\ ORDER\ *\ 4))\ flops}}
\DoxyCodeLine{00964\ }
\DoxyCodeLine{00965\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ set\ potential}}
\DoxyCodeLine{00966\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ potentials[idxPart]\ +=\ (targetValue);}
\DoxyCodeLine{00967\ \ \ \ \ \ \ \ \ \ \ \ \ \}\ \textcolor{comment}{//\ NLHS}}
\DoxyCodeLine{00968\ }
\DoxyCodeLine{00969\ \ \ \ \ \ \ \ \ \}\textcolor{comment}{//\ NVALS}}
\DoxyCodeLine{00970\ }
\DoxyCodeLine{00971\ }
\DoxyCodeLine{00972\ \ \ \ \ \}\ \textcolor{comment}{//\ N\ *\ (7\ +\ ORDER\ *\ (ORDER\ *\ (9\ +\ ORDER\ *\ 4)))\ flops}}
\DoxyCodeLine{00973\ }
\DoxyCodeLine{00974\ \}}
\DoxyCodeLine{00975\ }
\DoxyCodeLine{00976\ }
\DoxyCodeLine{00977\ \textcolor{comment}{//\ \ FReal\ F2[3][ORDER-\/1];}}
\DoxyCodeLine{00978\ \textcolor{comment}{//\ \ FBlas::gemtv(ORDER,\ ORDER-\/1,\ FReal(1.),\ const\_cast<FReal*>(T),\ const\_cast<FReal*>(localExpansion),\ F2[0]);}}
\DoxyCodeLine{00979\ \textcolor{comment}{//\ \ for\ (unsigned\ int\ i=1;\ i<ORDER*ORDER;\ ++i)}}
\DoxyCodeLine{00980\ \textcolor{comment}{//\ \ \ \ \ \ FBlas::gemtva(ORDER,\ ORDER-\/1,\ FReal(1.),\ const\_cast<FReal*>(T),}}
\DoxyCodeLine{00981\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ const\_cast<FReal*>(localExpansion)\ +\ ORDER*i,\ F2[0]);}}
\DoxyCodeLine{00982\ \textcolor{comment}{//\ \ for\ (unsigned\ int\ i=0;\ i<ORDER-\/1;\ ++i)}}
\DoxyCodeLine{00983\ \textcolor{comment}{//\ \ \ \ \ \ std::cout\ <<\ W2[0][i]\ <<\ "{}\(\backslash\)t"{}\ <<\ F2[0][i]\ <<\ std::endl;}}
\DoxyCodeLine{00984\ }
\DoxyCodeLine{00985\ \textcolor{comment}{//\ \ FReal\ F2[(ORDER-\/1)\ *\ ORDER*ORDER];}}
\DoxyCodeLine{00986\ \textcolor{comment}{//\ \ FBlas::gemtm(ORDER,\ ORDER-\/1,\ ORDER*ORDER,\ FReal(1.),\ const\_cast<FReal*>(T),\ ORDER,}}
\DoxyCodeLine{00987\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ const\_cast<FReal*>(localExpansion),\ ORDER,\ F2,\ ORDER-\/1);}}
\DoxyCodeLine{00988\ \textcolor{comment}{//\ \ FReal\ F[ORDER-\/1];\ FBlas::setzero(ORDER-\/1,\ F);}}
\DoxyCodeLine{00989\ \textcolor{comment}{//\ \ for\ (unsigned\ int\ i=0;\ i<ORDER-\/1;\ ++i)}}
\DoxyCodeLine{00990\ \textcolor{comment}{//\ \ \ \ \ \ for\ (unsigned\ int\ j=0;\ j<ORDER*ORDER;\ ++j)\ F[i]\ +=\ F2[j*(ORDER-\/1)\ +\ i];}}
\DoxyCodeLine{00991\ \textcolor{comment}{//\ \ for\ (unsigned\ int\ i=0;\ i<ORDER-\/1;\ ++i)}}
\DoxyCodeLine{00992\ \textcolor{comment}{//\ \ \ \ \ \ std::cout\ <<\ W2[0][i]\ <<\ "{}\(\backslash\)t"{}\ <<\ F[i]\ <<\ std::endl;}}
\DoxyCodeLine{00993\ }
\DoxyCodeLine{00994\ }
\DoxyCodeLine{00996\ \textcolor{comment}{//\ *\ Local\ to\ particle\ operation:\ application\ of\ \(\backslash\)f\$S\_\(\backslash\)ell(x,\(\backslash\)bar\ x\_m)\(\backslash\)f\$\ (interpolation)}}
\DoxyCodeLine{00997\ \textcolor{comment}{//\ */}}
\DoxyCodeLine{00998\ \textcolor{comment}{//template\ <int\ ORDER>}}
\DoxyCodeLine{00999\ \textcolor{comment}{//template\ <class\ ContainerClass>}}
\DoxyCodeLine{01000\ \textcolor{comment}{//inline\ void\ FChebInterpolator<FReal,ORDER>::applyL2P(const\ FPoint<FReal>\&\ center,}}
\DoxyCodeLine{01001\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ const\ FReal\ width,}}
\DoxyCodeLine{01002\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ const\ FReal\ *const\ localExpansion,}}
\DoxyCodeLine{01003\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ContainerClass\ *const\ localParticles)\ const}}
\DoxyCodeLine{01004\ \textcolor{comment}{//\{}}
\DoxyCodeLine{01005\ \textcolor{comment}{//\ \ //\ allocate\ stuff}}
\DoxyCodeLine{01006\ \textcolor{comment}{//\ \ const\ map\_glob\_loc\ map(center,\ width);}}
\DoxyCodeLine{01007\ \textcolor{comment}{//\ \ FPoint<FReal>\ localPosition;}}
\DoxyCodeLine{01008\ \textcolor{comment}{//\ \ FReal\ T\_of\_x[ORDER][3];}}
\DoxyCodeLine{01009\ \textcolor{comment}{//\ \ FReal\ xpx,ypy,zpz\ ;}}
\DoxyCodeLine{01010\ \textcolor{comment}{//\ \ FReal\ S[3],c1;}}
\DoxyCodeLine{01011\ \textcolor{comment}{//\ \ //}}
\DoxyCodeLine{01012\ \textcolor{comment}{//\ \ c1\ =\ FReal(8.)\ /\ nnodes\ ;}}
\DoxyCodeLine{01013\ \textcolor{comment}{//\ \ typename\ ContainerClass::BasicIterator\ iter(*localParticles);}}
\DoxyCodeLine{01014\ \textcolor{comment}{//\ \ while(iter.hasNotFinished())\{}}
\DoxyCodeLine{01015\ \textcolor{comment}{//}}
\DoxyCodeLine{01016\ \textcolor{comment}{//\ \ \ \ \ \ //\ map\ global\ position\ to\ [-\/1,1]}}
\DoxyCodeLine{01017\ \textcolor{comment}{//\ \ \ \ \ \ map(iter.data().getPosition(),\ localPosition);\ //\ 15\ flops}}
\DoxyCodeLine{01018\ \textcolor{comment}{//}}
\DoxyCodeLine{01019\ \textcolor{comment}{//\ \ \ \ \ \ //\ evaluate\ chebyshev\ polynomials\ of\ source\ particle:\ T\_o(x\_i)}}
\DoxyCodeLine{01020\ \textcolor{comment}{//\ \ \ \ \ \ T\_of\_x[0][0]\ =\ FReal(1.);\ \ \ T\_of\_x[1][0]\ =\ localPosition.getX();}}
\DoxyCodeLine{01021\ \textcolor{comment}{//\ \ \ \ \ \ T\_of\_x[0][1]\ =\ FReal(1.);\ \ \ T\_of\_x[1][1]\ =\ localPosition.getY();}}
\DoxyCodeLine{01022\ \textcolor{comment}{//\ \ \ \ \ \ T\_of\_x[0][2]\ =\ FReal(1.);\ \ \ T\_of\_x[1][2]\ =\ localPosition.getZ();}}
\DoxyCodeLine{01023\ \textcolor{comment}{//\ \ \ \ \ \ xpx\ =\ FReal(2.)\ *\ localPosition.getX()\ ;\ //\ 1\ flop}}
\DoxyCodeLine{01024\ \textcolor{comment}{//\ \ \ \ \ \ ypy\ =\ FReal(2.)\ *\ localPosition.getY()\ ;\ //\ 1\ flop}}
\DoxyCodeLine{01025\ \textcolor{comment}{//\ \ \ \ \ \ zpz\ =\ FReal(2.)\ *\ localPosition.getZ()\ ;\ //\ 1\ flop}}
\DoxyCodeLine{01026\ \textcolor{comment}{//\ \ \ \ \ \ for\ (unsigned\ int\ o=2;\ o<ORDER;\ ++o)\ \{}}
\DoxyCodeLine{01027\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ T\_of\_x[o][0]\ =\ xpx\ *\ T\_of\_x[o-\/1][0]\ -\/\ T\_of\_x[o-\/2][0];\ //\ 2\ flop}}
\DoxyCodeLine{01028\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ T\_of\_x[o][1]\ =\ ypy\ *\ T\_of\_x[o-\/1][1]\ -\/\ T\_of\_x[o-\/2][1];\ //\ 2\ flop}}
\DoxyCodeLine{01029\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ T\_of\_x[o][2]\ =\ zpz\ *\ T\_of\_x[o-\/1][2]\ -\/\ T\_of\_x[o-\/2][2];\ //\ 2\ flop}}
\DoxyCodeLine{01030\ \textcolor{comment}{//\ \ \ \ \ \ \}\ //\ (ORDER-\/2)\ *\ 6\ flops}}
\DoxyCodeLine{01031\ \textcolor{comment}{//}}
\DoxyCodeLine{01032\ \textcolor{comment}{//\ \ \ \ \ \ //\ interpolate\ and\ increment\ target\ value}}
\DoxyCodeLine{01033\ \textcolor{comment}{//\ \ \ \ \ \ FReal\ targetValue\ =\ iter.data().getPotential();}}
\DoxyCodeLine{01034\ \textcolor{comment}{//\ \ \ \ \ \ for\ (unsigned\ int\ n=0;\ n<nnodes;\ ++n)\ \{}}
\DoxyCodeLine{01035\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ const\ unsigned\ int\ j[3]\ =\ \{node\_ids[n][0],\ node\_ids[n][1],\ node\_ids[n][2]\};}}
\DoxyCodeLine{01036\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ S[0]\ =\ T\_of\_x[1][0]\ *\ T\_of\_roots[1][j[0]];\ //\ 1\ flops}}
\DoxyCodeLine{01037\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ S[1]\ =\ T\_of\_x[1][1]\ *\ T\_of\_roots[1][j[1]];\ //\ 1\ flops}}
\DoxyCodeLine{01038\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ S[2]\ =\ T\_of\_x[1][2]\ *\ T\_of\_roots[1][j[2]];\ //\ 1\ flops}}
\DoxyCodeLine{01039\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ for\ (unsigned\ int\ o=2;\ o<ORDER;\ ++o)\ \{}}
\DoxyCodeLine{01040\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ S[0]\ +=\ T\_of\_x[o][0]\ *\ T\_of\_roots[o][j[0]];\ //\ 2\ flops}}
\DoxyCodeLine{01041\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ S[1]\ +=\ T\_of\_x[o][1]\ *\ T\_of\_roots[o][j[1]];\ //\ 2\ flops}}
\DoxyCodeLine{01042\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ S[2]\ +=\ T\_of\_x[o][2]\ *\ T\_of\_roots[o][j[2]];\ //\ 2\ flops}}
\DoxyCodeLine{01043\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \}\ //\ (ORDER-\/2)\ *\ 6\ flops}}
\DoxyCodeLine{01044\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ //\ gather\ contributions}}
\DoxyCodeLine{01045\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ S[0]\ +=\ FReal(0.5);\ //\ 1\ flops}}
\DoxyCodeLine{01046\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ S[1]\ +=\ FReal(0.5);\ //\ 1\ flops}}
\DoxyCodeLine{01047\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ S[2]\ +=\ FReal(0.5);\ //\ 1\ flops}}
\DoxyCodeLine{01048\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ targetValue\ +=\ S[0]\ *\ S[1]\ *\ S[2]\ *\ localExpansion[n];\ //\ 4\ flops}}
\DoxyCodeLine{01049\ \textcolor{comment}{//\ \ \ \ \ \ \}\ //\ ORDER*ORDER*ORDER\ *\ (10\ +\ (ORDER-\/2)\ *\ 6)\ flops}}
\DoxyCodeLine{01050\ \textcolor{comment}{//\ \ \ \ \ \ //\ scale}}
\DoxyCodeLine{01051\ \textcolor{comment}{//\ \ \ \ \ \ targetValue\ *=\ c1;\ //\ 1\ flops}}
\DoxyCodeLine{01052\ \textcolor{comment}{//}}
\DoxyCodeLine{01053\ \textcolor{comment}{//\ \ \ \ \ \ //\ set\ potential}}
\DoxyCodeLine{01054\ \textcolor{comment}{//\ \ \ \ \ \ iter.data().setPotential(targetValue);}}
\DoxyCodeLine{01055\ \textcolor{comment}{//}}
\DoxyCodeLine{01056\ \textcolor{comment}{//\ \ \ \ \ \ //\ increment\ target\ iterator}}
\DoxyCodeLine{01057\ \textcolor{comment}{//\ \ \ \ \ \ iter.gotoNext();}}
\DoxyCodeLine{01058\ \textcolor{comment}{//\ \ \}\ //\ N\ *\ ORDER*ORDER*ORDER\ *\ (10\ +\ (ORDER-\/2)\ *\ 6)\ flops}}
\DoxyCodeLine{01059\ \textcolor{comment}{//\}}}
\DoxyCodeLine{01060\ }
\DoxyCodeLine{01061\ }
\DoxyCodeLine{01062\ }
\DoxyCodeLine{01063\ }
\DoxyCodeLine{01064\ }
\DoxyCodeLine{01065\ }
\DoxyCodeLine{01069\ \textcolor{keyword}{template}\ <\textcolor{keyword}{class}\ FReal,\textcolor{keywordtype}{int}\ ORDER,\ \textcolor{keyword}{class}\ MatrixKernelClass,\ \textcolor{keywordtype}{int}\ NVALS>}
\DoxyCodeLine{01070\ \textcolor{keyword}{template}\ <\textcolor{keyword}{class}\ ContainerClass>}
\DoxyCodeLine{01071\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_f_cheb_interpolator_a1eba40f12be2f8f60a747ae947d2642f}{FChebInterpolator<FReal,\ ORDER,MatrixKernelClass,NVALS>::applyL2PGradient}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{class_f_point}{FPoint<FReal>}}\&\ center,}
\DoxyCodeLine{01072\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ FReal\ width,}
\DoxyCodeLine{01073\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ FReal\ *\textcolor{keyword}{const}\ localExpansion,}
\DoxyCodeLine{01074\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ContainerClass\ *\textcolor{keyword}{const}\ inParticles)\textcolor{keyword}{\ const}}
\DoxyCodeLine{01075\ \textcolor{keyword}{}\{}
\DoxyCodeLine{01077\ \ \ \ \ \textcolor{comment}{//\ TENSOR-\/PRODUCT\ INTERPOLUTION\ NOT\ IMPLEMENTED\ YET\ HERE!!!\ ////////}}
\DoxyCodeLine{01079\ }
\DoxyCodeLine{01080\ \ \ \ \ \textcolor{comment}{//\ number\ of\ local\ expansions}}
\DoxyCodeLine{01081\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ nLoc\ =\ nVals*nLhs;}
\DoxyCodeLine{01082\ }
\DoxyCodeLine{01083\ \ \ \ \ \textcolor{comment}{//\ setup\ local\ to\ global\ mapping}}
\DoxyCodeLine{01084\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classmap__glob__loc}{map\_glob\_loc<FReal>}}\ map(center,\ width);}
\DoxyCodeLine{01085\ \ \ \ \ \mbox{\hyperlink{class_f_point}{FPoint<FReal>}}\ Jacobian;}
\DoxyCodeLine{01086\ \ \ \ \ map.computeJacobian(Jacobian);}
\DoxyCodeLine{01087\ \ \ \ \ \textcolor{keyword}{const}\ FReal\ jacobian[3]\ =\ \{Jacobian.\mbox{\hyperlink{class_f_point_a58d3859160347552d6a4a94fbdf883c3}{getX}}(),\ Jacobian.\mbox{\hyperlink{class_f_point_ae4383512b9b8d216775b3fb92325cfc9}{getY}}(),\ Jacobian.\mbox{\hyperlink{class_f_point_a02208d4db50cbafe597adcbfb152b536}{getZ}}()\};}
\DoxyCodeLine{01088\ \ \ \ \ \mbox{\hyperlink{class_f_point}{FPoint<FReal>}}\ localPosition;}
\DoxyCodeLine{01089\ \ \ \ \ FReal\ T\_of\_x[ORDER][3];}
\DoxyCodeLine{01090\ \ \ \ \ FReal\ U\_of\_x[ORDER][3];}
\DoxyCodeLine{01091\ \ \ \ \ FReal\ P[3];}
\DoxyCodeLine{01092\ }
\DoxyCodeLine{01093\ \ \ \ \ \textcolor{keyword}{const}\ FReal*\textcolor{keyword}{const}\ positionsX\ =\ inParticles-\/>getPositions()[0];}
\DoxyCodeLine{01094\ \ \ \ \ \textcolor{keyword}{const}\ FReal*\textcolor{keyword}{const}\ positionsY\ =\ inParticles-\/>getPositions()[1];}
\DoxyCodeLine{01095\ \ \ \ \ \textcolor{keyword}{const}\ FReal*\textcolor{keyword}{const}\ positionsZ\ =\ inParticles-\/>getPositions()[2];}
\DoxyCodeLine{01096\ }
\DoxyCodeLine{01097\ \ \ \ \ \textcolor{keywordflow}{for}(FSize\ idxPart\ =\ 0\ ;\ idxPart\ <\ inParticles-\/>getNbParticles()\ ;\ ++\ idxPart)\{}
\DoxyCodeLine{01098\ }
\DoxyCodeLine{01099\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ map\ global\ position\ to\ [-\/1,1]}}
\DoxyCodeLine{01100\ \ \ \ \ \ \ \ \ map(\mbox{\hyperlink{class_f_point}{FPoint<FReal>}}(positionsX[idxPart],positionsY[idxPart],positionsZ[idxPart]),\ localPosition);}
\DoxyCodeLine{01101\ }
\DoxyCodeLine{01102\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ evaluate\ chebyshev\ polynomials\ of\ source\ particle}}
\DoxyCodeLine{01103\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ T\_0(x\_i)\ and\ T\_1(x\_i)}}
\DoxyCodeLine{01104\ \ \ \ \ \ \ \ \ T\_of\_x[0][0]\ =\ FReal(1.);\ \ \ T\_of\_x[1][0]\ =\ localPosition.\mbox{\hyperlink{class_f_point_a58d3859160347552d6a4a94fbdf883c3}{getX}}();}
\DoxyCodeLine{01105\ \ \ \ \ \ \ \ \ T\_of\_x[0][1]\ =\ FReal(1.);\ \ \ T\_of\_x[1][1]\ =\ localPosition.\mbox{\hyperlink{class_f_point_ae4383512b9b8d216775b3fb92325cfc9}{getY}}();}
\DoxyCodeLine{01106\ \ \ \ \ \ \ \ \ T\_of\_x[0][2]\ =\ FReal(1.);\ \ \ T\_of\_x[1][2]\ =\ localPosition.\mbox{\hyperlink{class_f_point_a02208d4db50cbafe597adcbfb152b536}{getZ}}();}
\DoxyCodeLine{01107\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ U\_0(x\_i)\ and\ U\_1(x\_i)}}
\DoxyCodeLine{01108\ \ \ \ \ \ \ \ \ U\_of\_x[0][0]\ =\ FReal(1.);\ \ \ U\_of\_x[1][0]\ =\ localPosition.\mbox{\hyperlink{class_f_point_a58d3859160347552d6a4a94fbdf883c3}{getX}}()\ *\ FReal(2.);}
\DoxyCodeLine{01109\ \ \ \ \ \ \ \ \ U\_of\_x[0][1]\ =\ FReal(1.);\ \ \ U\_of\_x[1][1]\ =\ localPosition.\mbox{\hyperlink{class_f_point_ae4383512b9b8d216775b3fb92325cfc9}{getY}}()\ *\ FReal(2.);}
\DoxyCodeLine{01110\ \ \ \ \ \ \ \ \ U\_of\_x[0][2]\ =\ FReal(1.);\ \ \ U\_of\_x[1][2]\ =\ localPosition.\mbox{\hyperlink{class_f_point_a02208d4db50cbafe597adcbfb152b536}{getZ}}()\ *\ FReal(2.);}
\DoxyCodeLine{01111\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ o=2;\ o<ORDER;\ ++o)\ \{}
\DoxyCodeLine{01112\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ T\_o(x\_i)}}
\DoxyCodeLine{01113\ \ \ \ \ \ \ \ \ \ \ \ \ T\_of\_x[o][0]\ =\ FReal(2.)*localPosition.\mbox{\hyperlink{class_f_point_a58d3859160347552d6a4a94fbdf883c3}{getX}}()*T\_of\_x[o-\/1][0]\ -\/\ T\_of\_x[o-\/2][0];}
\DoxyCodeLine{01114\ \ \ \ \ \ \ \ \ \ \ \ \ T\_of\_x[o][1]\ =\ FReal(2.)*localPosition.\mbox{\hyperlink{class_f_point_ae4383512b9b8d216775b3fb92325cfc9}{getY}}()*T\_of\_x[o-\/1][1]\ -\/\ T\_of\_x[o-\/2][1];}
\DoxyCodeLine{01115\ \ \ \ \ \ \ \ \ \ \ \ \ T\_of\_x[o][2]\ =\ FReal(2.)*localPosition.\mbox{\hyperlink{class_f_point_a02208d4db50cbafe597adcbfb152b536}{getZ}}()*T\_of\_x[o-\/1][2]\ -\/\ T\_of\_x[o-\/2][2];}
\DoxyCodeLine{01116\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ U\_o(x\_i)}}
\DoxyCodeLine{01117\ \ \ \ \ \ \ \ \ \ \ \ \ U\_of\_x[o][0]\ =\ FReal(2.)*localPosition.\mbox{\hyperlink{class_f_point_a58d3859160347552d6a4a94fbdf883c3}{getX}}()*U\_of\_x[o-\/1][0]\ -\/\ U\_of\_x[o-\/2][0];}
\DoxyCodeLine{01118\ \ \ \ \ \ \ \ \ \ \ \ \ U\_of\_x[o][1]\ =\ FReal(2.)*localPosition.\mbox{\hyperlink{class_f_point_ae4383512b9b8d216775b3fb92325cfc9}{getY}}()*U\_of\_x[o-\/1][1]\ -\/\ U\_of\_x[o-\/2][1];}
\DoxyCodeLine{01119\ \ \ \ \ \ \ \ \ \ \ \ \ U\_of\_x[o][2]\ =\ FReal(2.)*localPosition.\mbox{\hyperlink{class_f_point_a02208d4db50cbafe597adcbfb152b536}{getZ}}()*U\_of\_x[o-\/1][2]\ -\/\ U\_of\_x[o-\/2][2];}
\DoxyCodeLine{01120\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01121\ }
\DoxyCodeLine{01122\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ scale,\ because\ dT\_o/dx\ =\ oU\_\{o-\/1\}}}
\DoxyCodeLine{01123\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ o=2;\ o<ORDER;\ ++o)\ \{}
\DoxyCodeLine{01124\ \ \ \ \ \ \ \ \ \ \ \ \ U\_of\_x[o-\/1][0]\ *=\ FReal(o);}
\DoxyCodeLine{01125\ \ \ \ \ \ \ \ \ \ \ \ \ U\_of\_x[o-\/1][1]\ *=\ FReal(o);}
\DoxyCodeLine{01126\ \ \ \ \ \ \ \ \ \ \ \ \ U\_of\_x[o-\/1][2]\ *=\ FReal(o);}
\DoxyCodeLine{01127\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01128\ }
\DoxyCodeLine{01129\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ apply\ P\ and\ increment\ forces}}
\DoxyCodeLine{01130\ \ \ \ \ \ \ \ \ FReal\ forces[nLoc][3];}
\DoxyCodeLine{01131\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ idxLoc\ =\ 0\ ;\ idxLoc\ <\ nLoc\ ;\ ++idxLoc)}
\DoxyCodeLine{01132\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ i=0;\ i<3;\ ++i)}
\DoxyCodeLine{01133\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ forces[idxLoc][i]\ =\ FReal(0.);}
\DoxyCodeLine{01134\ }
\DoxyCodeLine{01135\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ n=0;\ n<nnodes;\ ++n)\ \{}
\DoxyCodeLine{01136\ }
\DoxyCodeLine{01137\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ tensor\ indices\ of\ chebyshev\ nodes}}
\DoxyCodeLine{01138\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ j[3]\ =\ \{node\_ids[n][0],\ node\_ids[n][1],\ node\_ids[n][2]\};}
\DoxyCodeLine{01139\ }
\DoxyCodeLine{01140\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ f0\ component\ //////////////////////////////////////}}
\DoxyCodeLine{01141\ \ \ \ \ \ \ \ \ \ \ \ \ P[0]\ =\ U\_of\_x[0][0]\ *\ T\_of\_roots[1][j[0]];}
\DoxyCodeLine{01142\ \ \ \ \ \ \ \ \ \ \ \ \ P[1]\ =\ T\_of\_x[1][1]\ *\ T\_of\_roots[1][j[1]];}
\DoxyCodeLine{01143\ \ \ \ \ \ \ \ \ \ \ \ \ P[2]\ =\ T\_of\_x[1][2]\ *\ T\_of\_roots[1][j[2]];}
\DoxyCodeLine{01144\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ o=2;\ o<ORDER;\ ++o)\ \{}
\DoxyCodeLine{01145\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ P[0]\ +=\ U\_of\_x[o-\/1][0]\ *\ T\_of\_roots[o][j[0]];}
\DoxyCodeLine{01146\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ P[1]\ +=\ T\_of\_x[o\ \ ][1]\ *\ T\_of\_roots[o][j[1]];}
\DoxyCodeLine{01147\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ P[2]\ +=\ T\_of\_x[o\ \ ][2]\ *\ T\_of\_roots[o][j[2]];}
\DoxyCodeLine{01148\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01149\ \ \ \ \ \ \ \ \ \ \ \ \ P[0]\ *=\ FReal(2.);}
\DoxyCodeLine{01150\ \ \ \ \ \ \ \ \ \ \ \ \ P[1]\ *=\ FReal(2.);\ P[1]\ +=\ FReal(1.);}
\DoxyCodeLine{01151\ \ \ \ \ \ \ \ \ \ \ \ \ P[2]\ *=\ FReal(2.);\ P[2]\ +=\ FReal(1.);}
\DoxyCodeLine{01152\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ idxLoc\ =\ 0\ ;\ idxLoc\ <\ nLoc\ ;\ ++idxLoc)}
\DoxyCodeLine{01153\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ forces[idxLoc][0]\ \ \ +=\ P[0]\ *\ P[1]\ *\ P[2]\ *\ localExpansion[2*idxLoc*nnodes\ +\ n];}
\DoxyCodeLine{01154\ }
\DoxyCodeLine{01155\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ f1\ component\ //////////////////////////////////////}}
\DoxyCodeLine{01156\ \ \ \ \ \ \ \ \ \ \ \ \ P[0]\ =\ T\_of\_x[1][0]\ *\ T\_of\_roots[1][j[0]];}
\DoxyCodeLine{01157\ \ \ \ \ \ \ \ \ \ \ \ \ P[1]\ =\ U\_of\_x[0][1]\ *\ T\_of\_roots[1][j[1]];}
\DoxyCodeLine{01158\ \ \ \ \ \ \ \ \ \ \ \ \ P[2]\ =\ T\_of\_x[1][2]\ *\ T\_of\_roots[1][j[2]];}
\DoxyCodeLine{01159\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ o=2;\ o<ORDER;\ ++o)\ \{}
\DoxyCodeLine{01160\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ P[0]\ +=\ T\_of\_x[o\ \ ][0]\ *\ T\_of\_roots[o][j[0]];}
\DoxyCodeLine{01161\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ P[1]\ +=\ U\_of\_x[o-\/1][1]\ *\ T\_of\_roots[o][j[1]];}
\DoxyCodeLine{01162\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ P[2]\ +=\ T\_of\_x[o\ \ ][2]\ *\ T\_of\_roots[o][j[2]];}
\DoxyCodeLine{01163\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01164\ \ \ \ \ \ \ \ \ \ \ \ \ P[0]\ *=\ FReal(2.);\ P[0]\ +=\ FReal(1.);}
\DoxyCodeLine{01165\ \ \ \ \ \ \ \ \ \ \ \ \ P[1]\ *=\ FReal(2.);}
\DoxyCodeLine{01166\ \ \ \ \ \ \ \ \ \ \ \ \ P[2]\ *=\ FReal(2.);\ P[2]\ +=\ FReal(1.);}
\DoxyCodeLine{01167\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ idxLoc\ =\ 0\ ;\ idxLoc\ <\ nLoc\ ;\ ++idxLoc)}
\DoxyCodeLine{01168\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ forces[idxLoc][1]\ \ \ +=\ P[0]\ *\ P[1]\ *\ P[2]\ *\ localExpansion[2*idxLoc*nnodes\ +\ n];}
\DoxyCodeLine{01169\ }
\DoxyCodeLine{01170\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ f2\ component\ //////////////////////////////////////}}
\DoxyCodeLine{01171\ \ \ \ \ \ \ \ \ \ \ \ \ P[0]\ =\ T\_of\_x[1][0]\ *\ T\_of\_roots[1][j[0]];}
\DoxyCodeLine{01172\ \ \ \ \ \ \ \ \ \ \ \ \ P[1]\ =\ T\_of\_x[1][1]\ *\ T\_of\_roots[1][j[1]];}
\DoxyCodeLine{01173\ \ \ \ \ \ \ \ \ \ \ \ \ P[2]\ =\ U\_of\_x[0][2]\ *\ T\_of\_roots[1][j[2]];}
\DoxyCodeLine{01174\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ o=2;\ o<ORDER;\ ++o)\ \{}
\DoxyCodeLine{01175\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ P[0]\ +=\ T\_of\_x[o\ \ ][0]\ *\ T\_of\_roots[o][j[0]];}
\DoxyCodeLine{01176\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ P[1]\ +=\ T\_of\_x[o\ \ ][1]\ *\ T\_of\_roots[o][j[1]];}
\DoxyCodeLine{01177\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ P[2]\ +=\ U\_of\_x[o-\/1][2]\ *\ T\_of\_roots[o][j[2]];}
\DoxyCodeLine{01178\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01179\ \ \ \ \ \ \ \ \ \ \ \ \ P[0]\ *=\ FReal(2.);\ P[0]\ +=\ FReal(1.);}
\DoxyCodeLine{01180\ \ \ \ \ \ \ \ \ \ \ \ \ P[1]\ *=\ FReal(2.);\ P[1]\ +=\ FReal(1.);}
\DoxyCodeLine{01181\ \ \ \ \ \ \ \ \ \ \ \ \ P[2]\ *=\ FReal(2.);}
\DoxyCodeLine{01182\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ idxLoc\ =\ 0\ ;\ idxLoc\ <\ nLoc\ ;\ ++idxLoc)}
\DoxyCodeLine{01183\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ forces[idxLoc][2]\ \ \ +=\ P[0]\ *\ P[1]\ *\ P[2]\ *\ localExpansion[2*idxLoc*nnodes\ +\ n];}
\DoxyCodeLine{01184\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01185\ }
\DoxyCodeLine{01186\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ idxLhs\ =\ 0\ ;\ idxLhs\ <\ nLhs\ ;\ ++idxLhs)\{}
\DoxyCodeLine{01187\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ idxPot\ =\ idxLhs\ /\ nPV;}
\DoxyCodeLine{01188\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ idxPV\ \ =\ idxLhs\ \%\ nPV;}
\DoxyCodeLine{01189\ }
\DoxyCodeLine{01190\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ idxVals\ =\ 0\ ;\ idxVals\ <\ nVals\ ;\ ++idxVals)\{}
\DoxyCodeLine{01191\ }
\DoxyCodeLine{01192\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ idxLoc\ =\ idxLhs*nVals+idxVals;}
\DoxyCodeLine{01193\ }
\DoxyCodeLine{01194\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ scale\ forces}}
\DoxyCodeLine{01195\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ forces[idxLoc][0]\ *=\ jacobian[0]\ /\ nnodes;}
\DoxyCodeLine{01196\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ forces[idxLoc][1]\ *=\ jacobian[1]\ /\ nnodes;}
\DoxyCodeLine{01197\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ forces[idxLoc][2]\ *=\ jacobian[2]\ /\ nnodes;}
\DoxyCodeLine{01198\ }
\DoxyCodeLine{01199\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ get\ pointers\ to\ PhysValues\ and\ force\ components}}
\DoxyCodeLine{01200\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ FReal*\textcolor{keyword}{const}\ physicalValues\ =\ inParticles-\/>getPhysicalValues(idxVals,idxPV);}
\DoxyCodeLine{01201\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ FReal*\textcolor{keyword}{const}\ forcesX\ =\ inParticles-\/>getForcesX(idxVals,idxPot);}
\DoxyCodeLine{01202\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ FReal*\textcolor{keyword}{const}\ forcesY\ =\ inParticles-\/>getForcesY(idxVals,idxPot);}
\DoxyCodeLine{01203\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ FReal*\textcolor{keyword}{const}\ forcesZ\ =\ inParticles-\/>getForcesZ(idxVals,idxPot);}
\DoxyCodeLine{01204\ }
\DoxyCodeLine{01205\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ set\ computed\ forces}}
\DoxyCodeLine{01206\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ forcesX[idxPart]\ +=\ forces[idxLoc][0]\ *\ physicalValues[idxPart];}
\DoxyCodeLine{01207\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ forcesY[idxPart]\ +=\ forces[idxLoc][1]\ *\ physicalValues[idxPart];}
\DoxyCodeLine{01208\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ forcesZ[idxPart]\ +=\ forces[idxLoc][2]\ *\ physicalValues[idxPart];}
\DoxyCodeLine{01209\ }
\DoxyCodeLine{01210\ \ \ \ \ \ \ \ \ \ \ \ \ \}\ \textcolor{comment}{//\ NVALS}}
\DoxyCodeLine{01211\ \ \ \ \ \ \ \ \ \}\ \textcolor{comment}{//\ NLHS}}
\DoxyCodeLine{01212\ \ \ \ \ \}\ \textcolor{comment}{//\ N}}
\DoxyCodeLine{01213\ \}}
\DoxyCodeLine{01214\ }
\DoxyCodeLine{01215\ }
\DoxyCodeLine{01220\ \textcolor{keyword}{template}\ <\textcolor{keyword}{class}\ FReal,\textcolor{keywordtype}{int}\ ORDER,\ \textcolor{keyword}{class}\ MatrixKernelClass,\ \textcolor{keywordtype}{int}\ NVALS>}
\DoxyCodeLine{01221\ \textcolor{keyword}{template}\ <\textcolor{keyword}{class}\ ContainerClass>}
\DoxyCodeLine{01222\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_f_cheb_interpolator_a21ca0aabd7b14d6a53cf97a12070cab8}{FChebInterpolator<FReal,\ ORDER,MatrixKernelClass,NVALS>::applyL2PTotal}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{class_f_point}{FPoint<FReal>}}\&\ center,}
\DoxyCodeLine{01223\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ FReal\ width,}
\DoxyCodeLine{01224\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ FReal\ *\textcolor{keyword}{const}\ localExpansion,}
\DoxyCodeLine{01225\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ContainerClass\ *\textcolor{keyword}{const}\ inParticles)\textcolor{keyword}{\ const}}
\DoxyCodeLine{01226\ \textcolor{keyword}{}\{}
\DoxyCodeLine{01227\ }
\DoxyCodeLine{01228\ \ \ \ \ \textcolor{comment}{//\ number\ of\ local\ expansions}}
\DoxyCodeLine{01229\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ nLoc\ =\ nVals*nLhs;}
\DoxyCodeLine{01230\ }
\DoxyCodeLine{01231\ \ \ \ \ FReal\ f1[nLoc];}
\DoxyCodeLine{01232\ \ \ \ \ FReal\ W2[nLoc][3][\ ORDER-\/1];}
\DoxyCodeLine{01233\ \ \ \ \ FReal\ W4[nLoc][3][(ORDER-\/1)*(ORDER-\/1)];}
\DoxyCodeLine{01234\ \ \ \ \ FReal\ W8[nLoc][\ \ \ (ORDER-\/1)*(ORDER-\/1)*(ORDER-\/1)];}
\DoxyCodeLine{01235\ }
\DoxyCodeLine{01236\ \ \ \ \ \{}
\DoxyCodeLine{01237\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ for\ W2}}
\DoxyCodeLine{01238\ \ \ \ \ \ \ \ \ FReal\ lE[nnodes];}
\DoxyCodeLine{01239\ \ \ \ \ \ \ \ \ FReal\ F2[(ORDER-\/1)\ *\ ORDER*ORDER];}
\DoxyCodeLine{01240\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ for\ W4}}
\DoxyCodeLine{01241\ \ \ \ \ \ \ \ \ FReal\ F4[ORDER\ *\ ORDER*(ORDER-\/1)];}
\DoxyCodeLine{01242\ \ \ \ \ \ \ \ \ FReal\ G4[(ORDER-\/1)\ *\ ORDER*(ORDER-\/1)];}
\DoxyCodeLine{01243\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ for\ W8}}
\DoxyCodeLine{01244\ \ \ \ \ \ \ \ \ FReal\ G8[ORDER\ *\ (ORDER-\/1)*(ORDER-\/1)];}
\DoxyCodeLine{01245\ }
\DoxyCodeLine{01246\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ sum\ local\ expansions}}
\DoxyCodeLine{01247\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ idxLoc\ =\ 0\ ;\ idxLoc\ <\ nLoc\ ;\ ++idxLoc)\{}
\DoxyCodeLine{01248\ }
\DoxyCodeLine{01249\ \ \ \ \ \ \ \ \ \ \ \ \ f1[idxLoc]\ =\ FReal(0.);}
\DoxyCodeLine{01250\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ idx=0;\ idx<nnodes;\ ++idx)\ f1[idxLoc]\ +=\ localExpansion[2*idxLoc*nnodes\ +\ idx];\ \textcolor{comment}{//\ 1\ flop}}
\DoxyCodeLine{01251\ }
\DoxyCodeLine{01253\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ IMPORTANT:\ NOT\ CHANGE\ ORDER\ OF\ COMPUTATIONS!!!\ ////////////////}}
\DoxyCodeLine{01255\ }
\DoxyCodeLine{01256\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ W2[0]\ /////////////////\ (ORDER-\/1)*ORDER*ORDER\ *\ 2*ORDER}}
\DoxyCodeLine{01257\ \ \ \ \ \ \ \ \ \ \ \ \ FBlas::gemtm(ORDER,\ ORDER-\/1,\ ORDER*ORDER,\ FReal(1.),\ \textcolor{keyword}{const\_cast<}FReal*\textcolor{keyword}{>}(T),\ ORDER,}
\DoxyCodeLine{01258\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const\_cast<}FReal*\textcolor{keyword}{>}(localExpansion)\ +\ 2*idxLoc*nnodes,\ ORDER,\ F2,\ ORDER-\/1);}
\DoxyCodeLine{01259\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ l=0;\ l<ORDER-\/1;\ ++l)\ \{\ W2[idxLoc][0][l]\ =\ F2[l];}
\DoxyCodeLine{01260\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ j=1;\ j<ORDER*ORDER;\ ++j)\ W2[idxLoc][0][l]\ +=\ F2[j*(ORDER-\/1)\ +\ l];\ \}}
\DoxyCodeLine{01261\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ W4[0]\ /////////////////\ ORDER*(ORDER-\/1)*(ORDER-\/1)\ +\ 2*ORDER}}
\DoxyCodeLine{01262\ \ \ \ \ \ \ \ \ \ \ \ \ perm5.permute(F2,\ F4);}
\DoxyCodeLine{01263\ \ \ \ \ \ \ \ \ \ \ \ \ FBlas::gemtm(ORDER,\ ORDER-\/1,\ ORDER*(ORDER-\/1),\ FReal(1.),\ \textcolor{keyword}{const\_cast<}FReal*\textcolor{keyword}{>}(T),\ ORDER,\ F4,\ ORDER,\ G4,\ ORDER-\/1);}
\DoxyCodeLine{01264\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ l=0;\ l<ORDER-\/1;\ ++l)}
\DoxyCodeLine{01265\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ m=0;\ m<ORDER-\/1;\ ++m)\ \{\ W4[idxLoc][0][m*(ORDER-\/1)+l]\ =\ G4[l*ORDER*(ORDER-\/1)\ +\ m];}
\DoxyCodeLine{01266\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ k=1;\ k<ORDER;\ ++k)\ W4[idxLoc][0][m*(ORDER-\/1)+l]\ +=\ G4[l*ORDER*(ORDER-\/1)\ +\ k*(ORDER-\/1)\ +\ m];\ \ \ \}}
\DoxyCodeLine{01267\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ W8\ ////////////////////\ (ORDER-\/1)*(ORDER-\/1)*(ORDER-\/1)\ *\ (2*ORDER-\/1)}}
\DoxyCodeLine{01268\ \ \ \ \ \ \ \ \ \ \ \ \ perm8.permute(G4,\ G8);}
\DoxyCodeLine{01269\ \ \ \ \ \ \ \ \ \ \ \ \ FReal\ F8[(ORDER-\/1)*(ORDER-\/1)*(ORDER-\/1)];}
\DoxyCodeLine{01270\ \ \ \ \ \ \ \ \ \ \ \ \ FBlas::gemtm(ORDER,\ ORDER-\/1,\ (ORDER-\/1)*(ORDER-\/1),\ FReal(1.),\ \textcolor{keyword}{const\_cast<}FReal*\textcolor{keyword}{>}(T),\ ORDER,\ G8,\ ORDER,\ F8,\ ORDER-\/1);}
\DoxyCodeLine{01271\ \ \ \ \ \ \ \ \ \ \ \ \ perm9.permute(F8,\ W8[idxLoc]);}
\DoxyCodeLine{01272\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ W4[1]\ /////////////////\ ORDER*(ORDER-\/1)*(ORDER-\/1)\ +\ 2*ORDER}}
\DoxyCodeLine{01273\ \ \ \ \ \ \ \ \ \ \ \ \ perm6.permute(F2,\ F4);}
\DoxyCodeLine{01274\ \ \ \ \ \ \ \ \ \ \ \ \ FBlas::gemtm(ORDER,\ ORDER-\/1,\ (ORDER-\/1)*ORDER,\ FReal(1.),\ \textcolor{keyword}{const\_cast<}FReal*\textcolor{keyword}{>}(T),\ ORDER,\ F4,\ ORDER,\ G4,\ ORDER-\/1);}
\DoxyCodeLine{01275\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ l=0;\ l<ORDER-\/1;\ ++l)}
\DoxyCodeLine{01276\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ n=0;\ n<ORDER-\/1;\ ++n)\ \{\ W4[idxLoc][1][n*(ORDER-\/1)+l]\ =\ G4[l*(ORDER-\/1)\ +\ n];}
\DoxyCodeLine{01277\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ j=1;\ j<ORDER;\ ++j)\ W4[idxLoc][1][n*(ORDER-\/1)+l]\ +=\ G4[j*(ORDER-\/1)*(ORDER-\/1)\ +\ l*(ORDER-\/1)\ +\ n];\ \ \ \}}
\DoxyCodeLine{01278\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ W2[1]\ /////////////////\ (ORDER-\/1)*ORDER*ORDER\ *\ 2*ORDER}}
\DoxyCodeLine{01279\ \ \ \ \ \ \ \ \ \ \ \ \ perm3.permute(localExpansion\ +\ 2*idxLoc*nnodes,\ lE);}
\DoxyCodeLine{01280\ \ \ \ \ \ \ \ \ \ \ \ \ FBlas::gemtm(ORDER,\ ORDER-\/1,\ ORDER*ORDER,\ FReal(1.),\ \textcolor{keyword}{const\_cast<}FReal*\textcolor{keyword}{>}(T),\ ORDER,\ lE,\ ORDER,\ F2,\ ORDER-\/1);}
\DoxyCodeLine{01281\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ i=0;\ i<ORDER-\/1;\ ++i)\ \{\ W2[idxLoc][1][i]\ =\ F2[i];}
\DoxyCodeLine{01282\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ j=1;\ j<ORDER*ORDER;\ ++j)\ W2[idxLoc][1][i]\ +=\ F2[j*(ORDER-\/1)\ +\ i];\ \}}
\DoxyCodeLine{01283\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ W4[2]\ /////////////////\ ORDER*(ORDER-\/1)*(ORDER-\/1)\ +\ 2*ORDER}}
\DoxyCodeLine{01284\ \ \ \ \ \ \ \ \ \ \ \ \ perm7.permute(F2,\ F4);}
\DoxyCodeLine{01285\ \ \ \ \ \ \ \ \ \ \ \ \ FBlas::gemtm(ORDER,\ ORDER-\/1,\ (ORDER-\/1)*ORDER,\ FReal(1.),\ \textcolor{keyword}{const\_cast<}FReal*\textcolor{keyword}{>}(T),\ ORDER,\ F4,\ ORDER,\ G4,\ ORDER-\/1);}
\DoxyCodeLine{01286\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ m=0;\ m<ORDER-\/1;\ ++m)}
\DoxyCodeLine{01287\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ n=0;\ n<ORDER-\/1;\ ++n)\ \{\ W4[idxLoc][2][n*(ORDER-\/1)+m]\ =\ G4[m*ORDER*(ORDER-\/1)\ +\ n];}
\DoxyCodeLine{01288\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ i=1;\ i<ORDER;\ ++i)\ W4[idxLoc][2][n*(ORDER-\/1)+m]\ +=\ G4[m*ORDER*(ORDER-\/1)\ +\ i*(ORDER-\/1)\ +\ n];\ \ \ \}}
\DoxyCodeLine{01289\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ W2[2]\ /////////////////\ (ORDER-\/1)*ORDER*ORDER\ *\ 2*ORDER}}
\DoxyCodeLine{01290\ \ \ \ \ \ \ \ \ \ \ \ \ perm4.permute(localExpansion\ +\ 2*idxLoc*nnodes,\ lE);}
\DoxyCodeLine{01291\ \ \ \ \ \ \ \ \ \ \ \ \ FBlas::gemtm(ORDER,\ ORDER-\/1,\ ORDER*ORDER,\ FReal(1.),\ \textcolor{keyword}{const\_cast<}FReal*\textcolor{keyword}{>}(T),\ ORDER,\ lE,\ ORDER,\ F2,\ ORDER-\/1);}
\DoxyCodeLine{01292\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ i=0;\ i<ORDER-\/1;\ ++i)\ \{\ W2[idxLoc][2][i]\ =\ F2[i];}
\DoxyCodeLine{01293\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ j=1;\ j<ORDER*ORDER;\ ++j)\ W2[idxLoc][2][i]\ +=\ F2[j*(ORDER-\/1)\ +\ i];\ \}}
\DoxyCodeLine{01294\ }
\DoxyCodeLine{01295\ \ \ \ \ \ \ \ \ \}\textcolor{comment}{//\ NLHS}}
\DoxyCodeLine{01296\ }
\DoxyCodeLine{01297\ \ \ \ \ \}}
\DoxyCodeLine{01298\ }
\DoxyCodeLine{01299\ \ \ \ \ \textcolor{comment}{//\ loop\ over\ particles}}
\DoxyCodeLine{01300\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classmap__glob__loc}{map\_glob\_loc<FReal>}}\ map(center,\ width);}
\DoxyCodeLine{01301\ \ \ \ \ \mbox{\hyperlink{class_f_point}{FPoint<FReal>}}\ Jacobian;}
\DoxyCodeLine{01302\ \ \ \ \ map.computeJacobian(Jacobian);\ \textcolor{comment}{//\ 6\ flops}}
\DoxyCodeLine{01303\ \ \ \ \ \textcolor{keyword}{const}\ FReal\ jacobian[3]\ =\ \{Jacobian.\mbox{\hyperlink{class_f_point_a58d3859160347552d6a4a94fbdf883c3}{getX}}(),\ Jacobian.\mbox{\hyperlink{class_f_point_ae4383512b9b8d216775b3fb92325cfc9}{getY}}(),\ Jacobian.\mbox{\hyperlink{class_f_point_a02208d4db50cbafe597adcbfb152b536}{getZ}}()\};}
\DoxyCodeLine{01304\ \ \ \ \ \mbox{\hyperlink{class_f_point}{FPoint<FReal>}}\ localPosition;}
\DoxyCodeLine{01305\ }
\DoxyCodeLine{01306\ \ \ \ \ \textcolor{keyword}{const}\ FReal*\textcolor{keyword}{const}\ positionsX\ =\ inParticles-\/>getPositions()[0];}
\DoxyCodeLine{01307\ \ \ \ \ \textcolor{keyword}{const}\ FReal*\textcolor{keyword}{const}\ positionsY\ =\ inParticles-\/>getPositions()[1];}
\DoxyCodeLine{01308\ \ \ \ \ \textcolor{keyword}{const}\ FReal*\textcolor{keyword}{const}\ positionsZ\ =\ inParticles-\/>getPositions()[2];}
\DoxyCodeLine{01309\ }
\DoxyCodeLine{01310\ \ \ \ \ \textcolor{keywordflow}{for}(FSize\ idxPart\ =\ 0\ ;\ idxPart\ <\ inParticles-\/>getNbParticles()\ ;\ ++\ idxPart)\{}
\DoxyCodeLine{01311\ }
\DoxyCodeLine{01312\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ map\ global\ position\ to\ [-\/1,1]}}
\DoxyCodeLine{01313\ \ \ \ \ \ \ \ \ map(\mbox{\hyperlink{class_f_point}{FPoint<FReal>}}(positionsX[idxPart],positionsY[idxPart],positionsZ[idxPart]),\ localPosition);\ \textcolor{comment}{//\ 15\ flops}}
\DoxyCodeLine{01314\ }
\DoxyCodeLine{01315\ \ \ \ \ \ \ \ \ FReal\ U\_of\_x[3][ORDER];}
\DoxyCodeLine{01316\ \ \ \ \ \ \ \ \ FReal\ T\_of\_x[3][ORDER];}
\DoxyCodeLine{01317\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01318\ \ \ \ \ \ \ \ \ \ \ \ \ T\_of\_x[0][0]\ =\ FReal(1.);\ T\_of\_x[0][1]\ =\ localPosition.\mbox{\hyperlink{class_f_point_a58d3859160347552d6a4a94fbdf883c3}{getX}}();}
\DoxyCodeLine{01319\ \ \ \ \ \ \ \ \ \ \ \ \ T\_of\_x[1][0]\ =\ FReal(1.);\ T\_of\_x[1][1]\ =\ localPosition.\mbox{\hyperlink{class_f_point_ae4383512b9b8d216775b3fb92325cfc9}{getY}}();}
\DoxyCodeLine{01320\ \ \ \ \ \ \ \ \ \ \ \ \ T\_of\_x[2][0]\ =\ FReal(1.);\ T\_of\_x[2][1]\ =\ localPosition.\mbox{\hyperlink{class_f_point_a02208d4db50cbafe597adcbfb152b536}{getZ}}();}
\DoxyCodeLine{01321\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ FReal\ x2\ =\ FReal(2.)\ *\ T\_of\_x[0][1];\ \textcolor{comment}{//\ 1\ flop}}
\DoxyCodeLine{01322\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ FReal\ y2\ =\ FReal(2.)\ *\ T\_of\_x[1][1];\ \textcolor{comment}{//\ 1\ flop}}
\DoxyCodeLine{01323\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ FReal\ z2\ =\ FReal(2.)\ *\ T\_of\_x[2][1];\ \textcolor{comment}{//\ 1\ flop}}
\DoxyCodeLine{01324\ \ \ \ \ \ \ \ \ \ \ \ \ U\_of\_x[0][0]\ =\ FReal(1.);\ \ \ U\_of\_x[0][1]\ =\ x2;}
\DoxyCodeLine{01325\ \ \ \ \ \ \ \ \ \ \ \ \ U\_of\_x[1][0]\ =\ FReal(1.);\ \ \ U\_of\_x[1][1]\ =\ y2;}
\DoxyCodeLine{01326\ \ \ \ \ \ \ \ \ \ \ \ \ U\_of\_x[2][0]\ =\ FReal(1.);\ \ \ U\_of\_x[2][1]\ =\ z2;}
\DoxyCodeLine{01327\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ j=2;\ j<ORDER;\ ++j)\ \{}
\DoxyCodeLine{01328\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ T\_of\_x[0][j]\ =\ x2\ *\ T\_of\_x[0][j-\/1]\ -\/\ T\_of\_x[0][j-\/2];\ \textcolor{comment}{//\ 2\ flops}}
\DoxyCodeLine{01329\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ T\_of\_x[1][j]\ =\ y2\ *\ T\_of\_x[1][j-\/1]\ -\/\ T\_of\_x[1][j-\/2];\ \textcolor{comment}{//\ 2\ flops}}
\DoxyCodeLine{01330\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ T\_of\_x[2][j]\ =\ z2\ *\ T\_of\_x[2][j-\/1]\ -\/\ T\_of\_x[2][j-\/2];\ \textcolor{comment}{//\ 2\ flops}}
\DoxyCodeLine{01331\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ U\_of\_x[0][j]\ =\ x2\ *\ U\_of\_x[0][j-\/1]\ -\/\ U\_of\_x[0][j-\/2];\ \textcolor{comment}{//\ 2\ flops}}
\DoxyCodeLine{01332\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ U\_of\_x[1][j]\ =\ y2\ *\ U\_of\_x[1][j-\/1]\ -\/\ U\_of\_x[1][j-\/2];\ \textcolor{comment}{//\ 2\ flops}}
\DoxyCodeLine{01333\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ U\_of\_x[2][j]\ =\ z2\ *\ U\_of\_x[2][j-\/1]\ -\/\ U\_of\_x[2][j-\/2];\ \textcolor{comment}{//\ 2\ flops}}
\DoxyCodeLine{01334\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01335\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ scale,\ because\ dT\_j/dx\ =\ jU\_\{j-\/1\}}}
\DoxyCodeLine{01336\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ j=2;\ j<ORDER;\ ++j)\ \{}
\DoxyCodeLine{01337\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ U\_of\_x[0][j-\/1]\ *=\ FReal(j);\ \textcolor{comment}{//\ 1\ flops}}
\DoxyCodeLine{01338\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ U\_of\_x[1][j-\/1]\ *=\ FReal(j);\ \textcolor{comment}{//\ 1\ flops}}
\DoxyCodeLine{01339\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ U\_of\_x[2][j-\/1]\ *=\ FReal(j);\ \textcolor{comment}{//\ 1\ flops}}
\DoxyCodeLine{01340\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01341\ \ \ \ \ \ \ \ \ \}\ \textcolor{comment}{//\ 3\ +\ (ORDER-\/2)*15}}
\DoxyCodeLine{01342\ }
\DoxyCodeLine{01343\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ apply\ P\ and\ increment\ forces}}
\DoxyCodeLine{01344\ \ \ \ \ \ \ \ \ FReal\ potential[nLoc];}
\DoxyCodeLine{01345\ \ \ \ \ \ \ \ \ FReal\ forces[nLoc][3];}
\DoxyCodeLine{01346\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ idxLoc\ =\ 0\ ;\ idxLoc\ <\ nLoc\ ;\ ++idxLoc)\{}
\DoxyCodeLine{01347\ \ \ \ \ \ \ \ \ \ \ \ \ potential[idxLoc]=\ FReal(0.);}
\DoxyCodeLine{01348\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ i=0;\ i<3;\ ++i)}
\DoxyCodeLine{01349\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ forces[idxLoc][i]\ =\ FReal(0.);}
\DoxyCodeLine{01350\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01351\ }
\DoxyCodeLine{01352\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\ \textcolor{keywordtype}{int}\ idxVals\ =\ 0\ ;\ idxVals\ <\ nVals\ ;\ ++idxVals)\{}
\DoxyCodeLine{01353\ }
\DoxyCodeLine{01354\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\ \textcolor{keywordtype}{int}\ idxLhs\ =\ 0\ ;\ idxLhs\ <\ nLhs\ ;\ ++idxLhs)\{}
\DoxyCodeLine{01355\ }
\DoxyCodeLine{01356\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ idxLoc\ =\ idxLhs*nVals+idxVals;}
\DoxyCodeLine{01357\ }
\DoxyCodeLine{01358\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01359\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ FReal\ f2[4],\ f4[4],\ f8[4];}
\DoxyCodeLine{01360\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ i=0;\ i<4;\ ++i)\ f2[i]\ =\ f4[i]\ =\ f8[i]\ =\ FReal(0.);}
\DoxyCodeLine{01361\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01362\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ l=1;\ l<ORDER;\ ++l)\ \{}
\DoxyCodeLine{01363\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ FReal\ w2[3]\ =\ \{W2[idxLoc][0][l-\/1],\ W2[idxLoc][1][l-\/1],\ W2[idxLoc][2][l-\/1]\};}
\DoxyCodeLine{01364\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ f2[0]\ +=\ T\_of\_x[0][l\ \ ]\ *\ w2[0]\ +\ T\_of\_x[1][l]\ *\ w2[1]\ +\ T\_of\_x[2][l]\ *\ w2[2];\ \textcolor{comment}{//\ 6\ flops}}
\DoxyCodeLine{01365\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ f2[1]\ +=\ U\_of\_x[0][l-\/1]\ *\ w2[0];\ \textcolor{comment}{//\ 2\ flops}}
\DoxyCodeLine{01366\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ f2[2]\ +=\ U\_of\_x[1][l-\/1]\ *\ w2[1];\ \textcolor{comment}{//\ 2\ flops}}
\DoxyCodeLine{01367\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ f2[3]\ +=\ U\_of\_x[2][l-\/1]\ *\ w2[2];\ \textcolor{comment}{//\ 2\ flops}}
\DoxyCodeLine{01368\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ m=1;\ m<ORDER;\ ++m)\ \{}
\DoxyCodeLine{01369\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ w4idx\ =\ (m-\/1)*(ORDER-\/1)+(l-\/1);}
\DoxyCodeLine{01370\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ FReal\ w4[3]\ =\ \{W4[idxLoc][0][w4idx],\ W4[idxLoc][1][w4idx],\ W4[idxLoc][2][w4idx]\};}
\DoxyCodeLine{01371\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ f4[0]\ +=}
\DoxyCodeLine{01372\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ T\_of\_x[0][l]\ *\ T\_of\_x[1][m]\ *\ w4[0]\ +}
\DoxyCodeLine{01373\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ T\_of\_x[0][l]\ *\ T\_of\_x[2][m]\ *\ w4[1]\ +}
\DoxyCodeLine{01374\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ T\_of\_x[1][l]\ *\ T\_of\_x[2][m]\ *\ w4[2];\ \textcolor{comment}{//\ 9\ flops}}
\DoxyCodeLine{01375\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ f4[1]\ +=\ U\_of\_x[0][l-\/1]\ *\ T\_of\_x[1][m]\ \ \ *\ w4[0]\ +\ U\_of\_x[0][l-\/1]\ *\ T\_of\_x[2][m]\ \ \ *\ w4[1];\ \textcolor{comment}{//\ 6\ flops}}
\DoxyCodeLine{01376\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ f4[2]\ +=\ T\_of\_x[0][l]\ \ \ *\ U\_of\_x[1][m-\/1]\ *\ w4[0]\ +\ U\_of\_x[1][l-\/1]\ *\ T\_of\_x[2][m]\ \ \ *\ w4[2];\ \textcolor{comment}{//\ 6\ flops}}
\DoxyCodeLine{01377\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ f4[3]\ +=\ T\_of\_x[0][l]\ \ \ *\ U\_of\_x[2][m-\/1]\ *\ w4[1]\ +\ T\_of\_x[1][l]\ \ \ *\ U\_of\_x[2][m-\/1]\ *\ w4[2];\ \textcolor{comment}{//\ 6\ flops}}
\DoxyCodeLine{01378\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ n=1;\ n<ORDER;\ ++n)\ \{}
\DoxyCodeLine{01379\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ FReal\ w8\ =\ W8[idxLoc][(n-\/1)*(ORDER-\/1)*(ORDER-\/1)\ +\ (m-\/1)*(ORDER-\/1)\ +\ (l-\/1)];}
\DoxyCodeLine{01380\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ f8[0]\ +=\ T\_of\_x[0][l]\ \ \ *\ T\_of\_x[1][m]\ \ \ *\ T\_of\_x[2][n]\ \ \ *\ w8;\ \textcolor{comment}{//\ 4\ flops}}
\DoxyCodeLine{01381\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ f8[1]\ +=\ U\_of\_x[0][l-\/1]\ *\ T\_of\_x[1][m]\ \ \ *\ T\_of\_x[2][n]\ \ \ *\ w8;\ \textcolor{comment}{//\ 4\ flops}}
\DoxyCodeLine{01382\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ f8[2]\ +=\ T\_of\_x[0][l]\ \ \ *\ U\_of\_x[1][m-\/1]\ *\ T\_of\_x[2][n]\ \ \ *\ w8;\ \textcolor{comment}{//\ 4\ flops}}
\DoxyCodeLine{01383\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ f8[3]\ +=\ T\_of\_x[0][l]\ \ \ *\ T\_of\_x[1][m]\ \ \ *\ U\_of\_x[2][n-\/1]\ *\ w8;\ \textcolor{comment}{//\ 4\ flops}}
\DoxyCodeLine{01384\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}\ \textcolor{comment}{//\ (ORDER-\/1)\ *\ 16\ flops}}
\DoxyCodeLine{01385\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}\ \textcolor{comment}{//\ (ORDER-\/1)\ *\ (27\ +\ (ORDER-\/1)\ *\ 16)\ flops}}
\DoxyCodeLine{01386\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}\ \textcolor{comment}{//\ (ORDER-\/1)\ *\ ((ORDER-\/1)\ *\ (27\ +\ (ORDER-\/1)\ *\ 16))\ flops}}
\DoxyCodeLine{01387\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01388\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ potential[idxLoc]\ =\ (f1[idxLoc]\ +\ FReal(2.)*f2[0]\ +\ FReal(4.)*f4[0]\ +\ FReal(8.)*f8[0])\ /\ nnodes;\ \textcolor{comment}{//\ 7\ flops}}
\DoxyCodeLine{01389\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ forces[idxLoc][0]\ =\ (\ \ \ \ \ FReal(2.)*f2[1]\ +\ FReal(4.)*f4[1]\ +\ FReal(8.)*f8[1])\ *\ jacobian[0]\ /\ nnodes;\ \textcolor{comment}{//\ 7\ flops}}
\DoxyCodeLine{01390\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ forces[idxLoc][1]\ =\ (\ \ \ \ \ FReal(2.)*f2[2]\ +\ FReal(4.)*f4[2]\ +\ FReal(8.)*f8[2])\ *\ jacobian[1]\ /\ nnodes;\ \textcolor{comment}{//\ 7\ flops}}
\DoxyCodeLine{01391\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ forces[idxLoc][2]\ =\ (\ \ \ \ \ FReal(2.)*f2[3]\ +\ FReal(4.)*f4[3]\ +\ FReal(8.)*f8[3])\ *\ jacobian[2]\ /\ nnodes;\ \textcolor{comment}{//\ 7\ flops}}
\DoxyCodeLine{01392\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}\ \textcolor{comment}{//\ 28\ +\ (ORDER-\/1)\ *\ ((ORDER-\/1)\ *\ (27\ +\ (ORDER-\/1)\ *\ 16))\ flops}}
\DoxyCodeLine{01393\ }
\DoxyCodeLine{01394\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \ \textcolor{keywordtype}{int}\ idxPot\ =\ idxLhs\ /\ nPV;}
\DoxyCodeLine{01395\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \ \textcolor{keywordtype}{int}\ idxPV\ \ =\ idxLhs\ \%\ nPV;}
\DoxyCodeLine{01396\ }
\DoxyCodeLine{01397\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ get\ potentials,\ physValues\ and\ forces\ components}}
\DoxyCodeLine{01398\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ FReal*\textcolor{keyword}{const}\ physicalValues\ =\ inParticles-\/>getPhysicalValues(idxVals,idxPV);}
\DoxyCodeLine{01399\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ FReal*\textcolor{keyword}{const}\ forcesX\ =\ inParticles-\/>getForcesX(idxVals,idxPot);}
\DoxyCodeLine{01400\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ FReal*\textcolor{keyword}{const}\ forcesY\ =\ inParticles-\/>getForcesY(idxVals,idxPot);}
\DoxyCodeLine{01401\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ FReal*\textcolor{keyword}{const}\ forcesZ\ =\ inParticles-\/>getForcesZ(idxVals,idxPot);}
\DoxyCodeLine{01402\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ FReal*\textcolor{keyword}{const}\ potentials\ =\ inParticles-\/>getPotentials(idxVals,idxPot);}
\DoxyCodeLine{01403\ }
\DoxyCodeLine{01404\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ set\ computed\ potential}}
\DoxyCodeLine{01405\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ potentials[idxPart]\ +=\ (potential[idxLoc]);\ \textcolor{comment}{//\ 1\ flop}}
\DoxyCodeLine{01406\ }
\DoxyCodeLine{01407\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ set\ computed\ forces}}
\DoxyCodeLine{01408\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ forcesX[idxPart]\ +=\ forces[idxLoc][0]\ *\ physicalValues[idxPart];}
\DoxyCodeLine{01409\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ forcesY[idxPart]\ +=\ forces[idxLoc][1]\ *\ physicalValues[idxPart];}
\DoxyCodeLine{01410\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ forcesZ[idxPart]\ +=\ forces[idxLoc][2]\ *\ physicalValues[idxPart];\ \textcolor{comment}{//\ 6\ flops}}
\DoxyCodeLine{01411\ }
\DoxyCodeLine{01412\ \ \ \ \ \ \ \ \ \ \ \ \ \}\textcolor{comment}{//\ NLHS}}
\DoxyCodeLine{01413\ }
\DoxyCodeLine{01414\ \ \ \ \ \ \ \ \ \}\ \textcolor{comment}{//\ NVALS}}
\DoxyCodeLine{01415\ }
\DoxyCodeLine{01416\ \ \ \ \ \}\ \textcolor{comment}{//\ N\ *\ (38\ +\ (ORDER-\/2)*15\ +\ (ORDER-\/1)*((ORDER-\/1)\ *\ (27\ +\ (ORDER-\/1)\ *\ 16)))\ +\ 6\ flops}}
\DoxyCodeLine{01417\ \}}
\DoxyCodeLine{01418\ }
\DoxyCodeLine{01419\ }
\DoxyCodeLine{01421\ \textcolor{comment}{//\ *\ Local\ to\ particle\ operation:\ application\ of\ \(\backslash\)f\$S\_\(\backslash\)ell(x,\(\backslash\)bar\ x\_m)\(\backslash\)f\$\ and}}
\DoxyCodeLine{01422\ \textcolor{comment}{//\ *\ \(\backslash\)f\$\(\backslash\)nabla\_x\ S\_\(\backslash\)ell(x,\(\backslash\)bar\ x\_m)\(\backslash\)f\$\ (interpolation)}}
\DoxyCodeLine{01423\ \textcolor{comment}{//\ */}}
\DoxyCodeLine{01424\ \textcolor{comment}{//template\ <int\ ORDER>}}
\DoxyCodeLine{01425\ \textcolor{comment}{//template\ <class\ ContainerClass>}}
\DoxyCodeLine{01426\ \textcolor{comment}{//inline\ void\ FChebInterpolator<FReal,ORDER>::applyL2PTotal(const\ FPoint<FReal>\&\ center,}}
\DoxyCodeLine{01427\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ const\ FReal\ width,}}
\DoxyCodeLine{01428\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ const\ FReal\ *const\ localExpansion,}}
\DoxyCodeLine{01429\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ContainerClass\ *const\ localParticles)\ const}}
\DoxyCodeLine{01430\ \textcolor{comment}{//\{}}
\DoxyCodeLine{01431\ \textcolor{comment}{//\ \ //\ setup\ local\ to\ global\ mapping}}
\DoxyCodeLine{01432\ \textcolor{comment}{//\ \ const\ map\_glob\_loc\ map(center,\ width);}}
\DoxyCodeLine{01433\ \textcolor{comment}{//\ \ FPoint<FReal>\ Jacobian;}}
\DoxyCodeLine{01434\ \textcolor{comment}{//\ \ map.computeJacobian(Jacobian);\ //\ 6\ flops}}
\DoxyCodeLine{01435\ \textcolor{comment}{//\ \ const\ FReal\ jacobian[3]\ =\ \{Jacobian.getX(),\ Jacobian.getY(),\ Jacobian.getZ()\};}}
\DoxyCodeLine{01436\ \textcolor{comment}{//\ \ FPoint<FReal>\ localPosition;}}
\DoxyCodeLine{01437\ \textcolor{comment}{//\ \ FReal\ T\_of\_x[ORDER][3];}}
\DoxyCodeLine{01438\ \textcolor{comment}{//\ \ FReal\ U\_of\_x[ORDER][3];}}
\DoxyCodeLine{01439\ \textcolor{comment}{//\ \ FReal\ P[6];}}
\DoxyCodeLine{01440\ \textcolor{comment}{//\ \ //}}
\DoxyCodeLine{01441\ \textcolor{comment}{//\ \ FReal\ xpx,ypy,zpz\ ;}}
\DoxyCodeLine{01442\ \textcolor{comment}{//\ \ FReal\ c1\ =\ FReal(8.0)\ /\ nnodes;\ //\ 1\ flop}}
\DoxyCodeLine{01443\ \textcolor{comment}{//\ \ //}}
\DoxyCodeLine{01444\ \textcolor{comment}{//\ \ typename\ ContainerClass::BasicIterator\ iter(*localParticles);}}
\DoxyCodeLine{01445\ \textcolor{comment}{//\ \ while(iter.hasNotFinished())\{}}
\DoxyCodeLine{01446\ \textcolor{comment}{//}}
\DoxyCodeLine{01447\ \textcolor{comment}{//\ \ \ \ \ \ //\ map\ global\ position\ to\ [-\/1,1]}}
\DoxyCodeLine{01448\ \textcolor{comment}{//\ \ \ \ \ \ map(iter.data().getPosition(),\ localPosition);\ //\ 15\ flops}}
\DoxyCodeLine{01449\ \textcolor{comment}{//}}
\DoxyCodeLine{01450\ \textcolor{comment}{//\ \ \ \ \ \ //\ evaluate\ chebyshev\ polynomials\ of\ source\ particle}}
\DoxyCodeLine{01451\ \textcolor{comment}{//\ \ \ \ \ \ //\ T\_0(x\_i)\ and\ T\_1(x\_i)}}
\DoxyCodeLine{01452\ \textcolor{comment}{//\ \ \ \ \ \ xpx\ =\ FReal(2.)\ *\ localPosition.getX();\ //\ 1\ flop}}
\DoxyCodeLine{01453\ \textcolor{comment}{//\ \ \ \ \ \ ypy\ =\ FReal(2.)\ *\ localPosition.getY();\ //\ 1\ flop}}
\DoxyCodeLine{01454\ \textcolor{comment}{//\ \ \ \ \ \ zpz\ =\ FReal(2.)\ *\ localPosition.getZ();\ //\ 1\ flop}}
\DoxyCodeLine{01455\ \textcolor{comment}{//\ \ \ \ \ \ //}}
\DoxyCodeLine{01456\ \textcolor{comment}{//\ \ \ \ \ \ T\_of\_x[0][0]\ =\ FReal(1.);\ \ \ T\_of\_x[1][0]\ =\ localPosition.getX();}}
\DoxyCodeLine{01457\ \textcolor{comment}{//\ \ \ \ \ \ T\_of\_x[0][1]\ =\ FReal(1.);\ \ \ T\_of\_x[1][1]\ =\ localPosition.getY();}}
\DoxyCodeLine{01458\ \textcolor{comment}{//\ \ \ \ \ \ T\_of\_x[0][2]\ =\ FReal(1.);\ \ \ T\_of\_x[1][2]\ =\ localPosition.getZ();}}
\DoxyCodeLine{01459\ \textcolor{comment}{//\ \ \ \ \ \ U\_of\_x[0][0]\ =\ FReal(1.);\ \ \ U\_of\_x[1][0]\ =\ xpx;}}
\DoxyCodeLine{01460\ \textcolor{comment}{//\ \ \ \ \ \ U\_of\_x[0][1]\ =\ FReal(1.);\ \ \ U\_of\_x[1][1]\ =\ ypy;}}
\DoxyCodeLine{01461\ \textcolor{comment}{//\ \ \ \ \ \ U\_of\_x[0][2]\ =\ FReal(1.);\ \ \ U\_of\_x[1][2]\ =\ zpz;}}
\DoxyCodeLine{01462\ \textcolor{comment}{//\ \ \ \ \ \ for\ (unsigned\ int\ o=2;\ o<ORDER;\ ++o)\ \{}}
\DoxyCodeLine{01463\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ T\_of\_x[o][0]\ =\ xpx\ *\ T\_of\_x[o-\/1][0]\ -\/\ T\_of\_x[o-\/2][0];\ //\ 2\ flops}}
\DoxyCodeLine{01464\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ T\_of\_x[o][1]\ =\ ypy\ *\ T\_of\_x[o-\/1][1]\ -\/\ T\_of\_x[o-\/2][1];\ //\ 2\ flops}}
\DoxyCodeLine{01465\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ T\_of\_x[o][2]\ =\ zpz\ *\ T\_of\_x[o-\/1][2]\ -\/\ T\_of\_x[o-\/2][2];\ //\ 2\ flops}}
\DoxyCodeLine{01466\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ U\_of\_x[o][0]\ =\ xpx\ *\ U\_of\_x[o-\/1][0]\ -\/\ U\_of\_x[o-\/2][0];\ //\ 2\ flops}}
\DoxyCodeLine{01467\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ U\_of\_x[o][1]\ =\ ypy\ *\ U\_of\_x[o-\/1][1]\ -\/\ U\_of\_x[o-\/2][1];\ //\ 2\ flops}}
\DoxyCodeLine{01468\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ U\_of\_x[o][2]\ =\ zpz\ *\ U\_of\_x[o-\/1][2]\ -\/\ U\_of\_x[o-\/2][2];\ //\ 2\ flops}}
\DoxyCodeLine{01469\ \textcolor{comment}{//\ \ \ \ \ \ \}}}
\DoxyCodeLine{01470\ \textcolor{comment}{//}}
\DoxyCodeLine{01471\ \textcolor{comment}{//\ \ \ \ \ \ //\ scale,\ because\ dT\_o/dx\ =\ oU\_\{o-\/1\}}}
\DoxyCodeLine{01472\ \textcolor{comment}{//\ \ \ \ \ \ for\ (unsigned\ int\ o=2;\ o<ORDER;\ ++o)\ \{}}
\DoxyCodeLine{01473\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ U\_of\_x[o-\/1][0]\ *=\ FReal(o);\ //\ 1\ flops}}
\DoxyCodeLine{01474\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ U\_of\_x[o-\/1][1]\ *=\ FReal(o);\ //\ 1\ flops}}
\DoxyCodeLine{01475\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ U\_of\_x[o-\/1][2]\ *=\ FReal(o);\ //\ 1\ flops}}
\DoxyCodeLine{01476\ \textcolor{comment}{//\ \ \ \ \ \ \}}}
\DoxyCodeLine{01477\ \textcolor{comment}{//}}
\DoxyCodeLine{01478\ \textcolor{comment}{//\ \ \ \ \ \ //\ apply\ P\ and\ increment\ forces}}
\DoxyCodeLine{01479\ \textcolor{comment}{//\ \ \ \ \ \ FReal\ potential\ =\ FReal(0.);}}
\DoxyCodeLine{01480\ \textcolor{comment}{//\ \ \ \ \ \ FReal\ forces[3]\ =\ \{FReal(0.),\ FReal(0.),\ FReal(0.)\};}}
\DoxyCodeLine{01481\ \textcolor{comment}{//\ \ \ \ \ \ //}}
\DoxyCodeLine{01482\ \textcolor{comment}{//\ \ \ \ \ \ //\ Optimization:}}
\DoxyCodeLine{01483\ \textcolor{comment}{//\ \ \ \ \ \ //\ \ \ Here\ we\ compute\ 1/2\ S\ and\ 1/2\ P\ \ rather\ S\ and\ F\ like\ in\ the\ paper}}
\DoxyCodeLine{01484\ \textcolor{comment}{//\ \ \ \ \ \ for\ (unsigned\ int\ n=0;\ n<nnodes;\ ++n)\ \{}}
\DoxyCodeLine{01485\ \textcolor{comment}{//}}
\DoxyCodeLine{01486\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ //\ tensor\ indices\ of\ chebyshev\ nodes}}
\DoxyCodeLine{01487\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ const\ unsigned\ int\ j[3]\ =\ \{node\_ids[n][0],\ node\_ids[n][1],\ node\_ids[n][2]\};}}
\DoxyCodeLine{01488\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ //}}
\DoxyCodeLine{01489\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ P[0]\ =\ FReal(0.5)\ +\ T\_of\_x[1][0]\ *\ T\_of\_roots[1][j[0]];\ //\ 2\ flops}}
\DoxyCodeLine{01490\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ P[1]\ =\ FReal(0.5)\ +\ T\_of\_x[1][1]\ *\ T\_of\_roots[1][j[1]];\ //\ 2\ flops}}
\DoxyCodeLine{01491\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ P[2]\ =\ FReal(0.5)\ +\ T\_of\_x[1][2]\ *\ T\_of\_roots[1][j[2]];\ //\ 2\ flops}}
\DoxyCodeLine{01492\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ P[3]\ =\ U\_of\_x[0][0]\ *\ T\_of\_roots[1][j[0]];\ //\ 1\ flop}}
\DoxyCodeLine{01493\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ P[4]\ =\ U\_of\_x[0][1]\ *\ T\_of\_roots[1][j[1]];\ //\ 1\ flop}}
\DoxyCodeLine{01494\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ P[5]\ =\ U\_of\_x[0][2]\ *\ T\_of\_roots[1][j[2]];\ //\ 1\ flop}}
\DoxyCodeLine{01495\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ for\ (unsigned\ int\ o=2;\ o<ORDER;\ ++o)\ \{}}
\DoxyCodeLine{01496\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ P[0]\ +=\ T\_of\_x[o\ \ ][0]\ *\ T\_of\_roots[o][j[0]];\ //\ 2\ flop}}
\DoxyCodeLine{01497\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ P[1]\ +=\ T\_of\_x[o\ \ ][1]\ *\ T\_of\_roots[o][j[1]];\ //\ 2\ flop}}
\DoxyCodeLine{01498\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ P[2]\ +=\ T\_of\_x[o\ \ ][2]\ *\ T\_of\_roots[o][j[2]];\ //\ 2\ flop}}
\DoxyCodeLine{01499\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ P[3]\ +=\ U\_of\_x[o-\/1][0]\ *\ T\_of\_roots[o][j[0]];\ //\ 2\ flop}}
\DoxyCodeLine{01500\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ P[4]\ +=\ U\_of\_x[o-\/1][1]\ *\ T\_of\_roots[o][j[1]];\ //\ 2\ flop}}
\DoxyCodeLine{01501\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ P[5]\ +=\ U\_of\_x[o-\/1][2]\ *\ T\_of\_roots[o][j[2]];\ //\ 2\ flop}}
\DoxyCodeLine{01502\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}}
\DoxyCodeLine{01503\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ //}}
\DoxyCodeLine{01504\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ potential\ +=\ P[0]\ *\ P[1]\ *\ P[2]\ *\ localExpansion[n];\ //\ 4\ flops}}
\DoxyCodeLine{01505\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ forces[0]\ +=\ P[3]\ *\ P[1]\ *\ P[2]\ *\ localExpansion[n];\ //\ 4\ flops}}
\DoxyCodeLine{01506\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ forces[1]\ +=\ P[0]\ *\ P[4]\ *\ P[2]\ *\ localExpansion[n];\ //\ 4\ flops}}
\DoxyCodeLine{01507\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ forces[2]\ +=\ P[0]\ *\ P[1]\ *\ P[5]\ *\ localExpansion[n];\ //\ 4\ flops}}
\DoxyCodeLine{01508\ \textcolor{comment}{//\ \ \ \ \ \ \}}}
\DoxyCodeLine{01509\ \textcolor{comment}{//\ \ \ \ \ \ //}}
\DoxyCodeLine{01510\ \textcolor{comment}{//\ \ \ \ \ \ potential\ *=\ c1\ ;\ //\ 1\ flop}}
\DoxyCodeLine{01511\ \textcolor{comment}{//\ \ \ \ \ \ forces[0]\ *=\ jacobian[0]\ *c1;\ //\ 2\ flops}}
\DoxyCodeLine{01512\ \textcolor{comment}{//\ \ \ \ \ \ forces[1]\ *=\ jacobian[1]\ *c1;\ //\ 2\ flops}}
\DoxyCodeLine{01513\ \textcolor{comment}{//\ \ \ \ \ \ forces[2]\ *=\ jacobian[2]\ *c1;\ //\ 2\ flops}}
\DoxyCodeLine{01514\ \textcolor{comment}{//\ \ \ \ \ \ //\ set\ computed\ potential}}
\DoxyCodeLine{01515\ \textcolor{comment}{//\ \ \ \ \ \ iter.data().incPotential(potential);\ //\ 1\ flop}}
\DoxyCodeLine{01516\ \textcolor{comment}{//}}
\DoxyCodeLine{01517\ \textcolor{comment}{//\ \ \ \ \ \ //\ set\ computed\ forces}}
\DoxyCodeLine{01518\ \textcolor{comment}{//\ \ \ \ \ \ iter.data().incForces(forces[0]\ *\ iter.data().getPhysicalValue(),}}
\DoxyCodeLine{01519\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ forces[1]\ *\ iter.data().getPhysicalValue(),}}
\DoxyCodeLine{01520\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ forces[2]\ *\ iter.data().getPhysicalValue());\ //\ 6\ flops}}
\DoxyCodeLine{01521\ \textcolor{comment}{//}}
\DoxyCodeLine{01522\ \textcolor{comment}{//\ \ \ \ \ \ //\ increment\ iterator}}
\DoxyCodeLine{01523\ \textcolor{comment}{//\ \ \ \ \ \ iter.gotoNext();}}
\DoxyCodeLine{01524\ \textcolor{comment}{//\ \ \}}}
\DoxyCodeLine{01525\ \textcolor{comment}{//\}}}
\DoxyCodeLine{01526\ }
\DoxyCodeLine{01527\ }
\DoxyCodeLine{01528\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{01529\ }
\DoxyCodeLine{01530\ }
\DoxyCodeLine{01531\ }
\DoxyCodeLine{01532\ }
\DoxyCodeLine{01533\ }
\DoxyCodeLine{01534\ }
\DoxyCodeLine{01535\ }
\DoxyCodeLine{01536\ }
\DoxyCodeLine{01553\ \textcolor{comment}{//}}
\DoxyCodeLine{01563\ }
\DoxyCodeLine{01580\ \textcolor{comment}{//}}
\DoxyCodeLine{01590\ }
\DoxyCodeLine{01607\ \textcolor{comment}{//}}
\DoxyCodeLine{01617\ }
\DoxyCodeLine{01618\ \textcolor{comment}{//FReal\ T\_of\_y[ORDER\ *\ (ORDER-\/1)];}}
\DoxyCodeLine{01619\ \textcolor{comment}{//for\ (unsigned\ int\ o=1;\ o<ORDER;\ ++o)}}
\DoxyCodeLine{01620\ \textcolor{comment}{//\ \ for\ (unsigned\ int\ j=0;\ j<ORDER;\ ++j)}}
\DoxyCodeLine{01621\ \textcolor{comment}{//\ \ \ \ \ \ T\_of\_y[(o-\/1)*ORDER\ +\ j]\ =\ FReal(FChebRoots<FReal,ORDER>::T(o,\ FReal(FChebRoots<FReal,ORDER>::roots[j])));}}
\DoxyCodeLine{01622\ }
\DoxyCodeLine{01623\ \textcolor{comment}{//struct\ SumP2M\ \{}}
\DoxyCodeLine{01624\ \textcolor{comment}{//\ \ unsigned\ int\ f2[3][nnodes],\ f4[3][nnodes];}}
\DoxyCodeLine{01625\ \textcolor{comment}{//\ \ SumP2M()\ \{}}
\DoxyCodeLine{01626\ \textcolor{comment}{//\ \ \ \ \ \ for\ (unsigned\ int\ i=0;\ i<ORDER;\ ++i)\ \{}}
\DoxyCodeLine{01627\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ for\ (unsigned\ int\ j=0;\ j<ORDER;\ ++j)\ \{}}
\DoxyCodeLine{01628\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ for\ (unsigned\ int\ k=0;\ k<ORDER;\ ++k)\ \{}}
\DoxyCodeLine{01629\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ const\ unsigned\ int\ idx\ =\ k*ORDER*ORDER\ +\ j*ORDER\ +\ i;}}
\DoxyCodeLine{01630\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ f2[0][idx]\ =\ i;}}
\DoxyCodeLine{01631\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ f2[1][idx]\ =\ j;}}
\DoxyCodeLine{01632\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ f2[2][idx]\ =\ k;}}
\DoxyCodeLine{01633\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ f4[0][idx]\ =\ j*ORDER+i;}}
\DoxyCodeLine{01634\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ f4[1][idx]\ =\ k*ORDER+i;}}
\DoxyCodeLine{01635\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ f4[2][idx]\ =\ k*ORDER+j;}}
\DoxyCodeLine{01636\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}}
\DoxyCodeLine{01637\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \}}}
\DoxyCodeLine{01638\ \textcolor{comment}{//\ \ \ \ \ \ \}}}
\DoxyCodeLine{01639\ \textcolor{comment}{//\ \ \}}}
\DoxyCodeLine{01640\ \textcolor{comment}{//\}\ idx0;}}
\DoxyCodeLine{01641\ \textcolor{comment}{//}}
\DoxyCodeLine{01642\ \textcolor{comment}{//for\ (unsigned\ int\ i=0;\ i<nnodes;\ ++i)}}
\DoxyCodeLine{01643\ \textcolor{comment}{//\ \ multipoleExpansion[i]\ =\ (W1\ +}}
\DoxyCodeLine{01644\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ FReal(2.)\ *\ (F2[0][idx0.f2[0][i]]\ +\ F2[1][idx0.f2[1][i]]\ +\ F2[2][idx0.f2[2][i]])\ +}}
\DoxyCodeLine{01645\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ FReal(4.)\ *\ (F4[0][idx0.f4[0][i]]\ +\ F4[1][idx0.f4[1][i]]\ +\ F4[2][idx0.f4[2][i]])\ +}}
\DoxyCodeLine{01646\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ FReal(8.)\ *\ \ F8[i])\ /\ nnodes;}}

\end{DoxyCode}
