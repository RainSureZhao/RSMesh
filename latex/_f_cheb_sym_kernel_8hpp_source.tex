\doxysection{FCheb\+Sym\+Kernel.\+hpp}
\hypertarget{_f_cheb_sym_kernel_8hpp_source}{}\label{_f_cheb_sym_kernel_8hpp_source}\index{third\_party/ScalFMM/include/ScalFMM/Kernels/Chebyshev/FChebSymKernel.hpp@{third\_party/ScalFMM/include/ScalFMM/Kernels/Chebyshev/FChebSymKernel.hpp}}

\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{preprocessor}{\#ifndef\ FCHEBSYMKERNEL\_HPP}}
\DoxyCodeLine{00002\ \textcolor{preprocessor}{\#define\ FCHEBSYMKERNEL\_HPP}}
\DoxyCodeLine{00003\ \textcolor{comment}{//\ See\ LICENCE\ file\ at\ project\ root}}
\DoxyCodeLine{00004\ }
\DoxyCodeLine{00005\ \textcolor{preprocessor}{\#include\ "{}../../Utils/FGlobal.hpp"{}}}
\DoxyCodeLine{00006\ }
\DoxyCodeLine{00007\ \textcolor{preprocessor}{\#include\ "{}../../Utils/FSmartPointer.hpp"{}}}
\DoxyCodeLine{00008\ }
\DoxyCodeLine{00009\ \textcolor{preprocessor}{\#include\ "{}FAbstractChebKernel.hpp"{}}}
\DoxyCodeLine{00010\ \textcolor{preprocessor}{\#include\ "{}FChebInterpolator.hpp"{}}}
\DoxyCodeLine{00011\ \textcolor{preprocessor}{\#include\ "{}FChebSymM2LHandler.hpp"{}}}
\DoxyCodeLine{00012\ }
\DoxyCodeLine{00013\ \textcolor{keyword}{class\ }\mbox{\hyperlink{class_f_tree_coordinate}{FTreeCoordinate}};}
\DoxyCodeLine{00014\ }
\DoxyCodeLine{00015\ }
\DoxyCodeLine{00016\ \textcolor{comment}{//\ for\ verbosity\ only!!!}}
\DoxyCodeLine{00017\ \textcolor{comment}{//\#define\ COUNT\_BLOCKED\_INTERACTIONS}}
\DoxyCodeLine{00018\ }
\DoxyCodeLine{00019\ \textcolor{comment}{//\ if\ timings\ should\ be\ logged}}
\DoxyCodeLine{00020\ \textcolor{comment}{//\#define\ LOG\_TIMINGS}}
\DoxyCodeLine{00021\ }
\DoxyCodeLine{00045\ \textcolor{keyword}{template}\ <\ \textcolor{keyword}{class}\ FReal,\ \textcolor{keyword}{class}\ CellClass,\ \textcolor{keyword}{class}\ ContainerClass,\ \ \ \textcolor{keyword}{class}\ MatrixKernelClass,\ \textcolor{keywordtype}{int}\ ORDER,\ \textcolor{keywordtype}{int}\ NVALS\ =\ 1>}
\DoxyCodeLine{00046\ \textcolor{keyword}{class\ }\mbox{\hyperlink{class_f_cheb_sym_kernel}{FChebSymKernel}}}
\DoxyCodeLine{00047\ \ \ \ \ \ \ \ \ :\ \textcolor{keyword}{public}\ \mbox{\hyperlink{class_f_abstract_cheb_kernel}{FAbstractChebKernel}}<FReal,\ CellClass,\ ContainerClass,\ MatrixKernelClass,\ ORDER,\ NVALS>}
\DoxyCodeLine{00048\ \{}
\DoxyCodeLine{00049\ \ \ \ \ \textcolor{keyword}{typedef}\ \mbox{\hyperlink{class_f_abstract_cheb_kernel}{FAbstractChebKernel<FReal,\ CellClass,\ ContainerClass,\ MatrixKernelClass,\ ORDER,\ NVALS>}}\ \mbox{\hyperlink{class_f_abstract_cheb_kernel}{AbstractBaseClass}};}
\DoxyCodeLine{00050\ \ \ \ \ \textcolor{keyword}{typedef}\ \mbox{\hyperlink{class_symmetry_handler}{SymmetryHandler<FReal,\ ORDER,\ MatrixKernelClass::Type>}}\ \mbox{\hyperlink{class_symmetry_handler}{SymmetryHandlerClass}};}
\DoxyCodeLine{00051\ \ \ \ \ \textcolor{keyword}{enum}\ \{nnodes\ =\ AbstractBaseClass::nnodes\};}
\DoxyCodeLine{00052\ }
\DoxyCodeLine{00054\ \ \ \ \ \textcolor{keyword}{const}\ MatrixKernelClass\ *\textcolor{keyword}{const}\ MatrixKernel;}
\DoxyCodeLine{00055\ }
\DoxyCodeLine{00057\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_f_smart_pointer}{FSmartPointer<SymmetryHandlerClass,FSmartPointerMemory>}}\ SymHandler;}
\DoxyCodeLine{00058\ }
\DoxyCodeLine{00059\ \ \ \ \ \textcolor{comment}{//\ permuted\ local\ and\ multipole\ expansions}}
\DoxyCodeLine{00060\ \ \ \ \ FReal**\ Loc;}
\DoxyCodeLine{00061\ \ \ \ \ FReal**\ Mul;}
\DoxyCodeLine{00062\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}*\ countExp;}
\DoxyCodeLine{00063\ }
\DoxyCodeLine{00064\ }
\DoxyCodeLine{00065\ \ \ \ \ }
\DoxyCodeLine{00069\ \ \ \ \ \textcolor{keywordtype}{void}\ allocateMemoryForPermutedExpansions()}
\DoxyCodeLine{00070\ \ \ \ \ \{}
\DoxyCodeLine{00071\ \ \ \ \ \ \ \ \ assert(Loc==\textcolor{keyword}{nullptr}\ \&\&\ Mul==\textcolor{keyword}{nullptr}\ \&\&\ countExp==\textcolor{keyword}{nullptr});}
\DoxyCodeLine{00072\ \ \ \ \ \ \ \ \ Loc\ =\ \textcolor{keyword}{new}\ FReal*\ [343];}
\DoxyCodeLine{00073\ \ \ \ \ \ \ \ \ Mul\ =\ \textcolor{keyword}{new}\ FReal*\ [343];}
\DoxyCodeLine{00074\ \ \ \ \ \ \ \ \ countExp\ =\ \textcolor{keyword}{new}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ [343];}
\DoxyCodeLine{00075\ }
\DoxyCodeLine{00076\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ set\ all\ 343\ to\ nullptr}}
\DoxyCodeLine{00077\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ idx=0;\ idx<343;\ ++idx)\ \{}
\DoxyCodeLine{00078\ \ \ \ \ \ \ \ \ \ \ \ \ Mul[idx]\ =\ Loc[idx]\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00079\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00080\ }
\DoxyCodeLine{00081\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ init\ only\ 16\ of\ 343\ possible\ translations\ due\ to\ symmetries}}
\DoxyCodeLine{00082\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i=2;\ i<=3;\ ++i)}
\DoxyCodeLine{00083\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j=0;\ j<=i;\ ++j)}
\DoxyCodeLine{00084\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ k=0;\ k<=j;\ ++k)\ \{}
\DoxyCodeLine{00085\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ idx\ =\ (i+3)*7*7\ +\ (j+3)*7\ +\ (k+3);}
\DoxyCodeLine{00086\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ assert(Mul[idx]==\textcolor{keyword}{nullptr}\ ||\ Loc[idx]==\textcolor{keyword}{nullptr});}
\DoxyCodeLine{00087\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Mul[idx]\ =\ \textcolor{keyword}{new}\ FReal\ [24\ *\ nnodes];}
\DoxyCodeLine{00088\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Loc[idx]\ =\ \textcolor{keyword}{new}\ FReal\ [24\ *\ nnodes];}
\DoxyCodeLine{00089\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00090\ \ \ \ \ \}}
\DoxyCodeLine{00091\ \ \ \ \ }
\DoxyCodeLine{00092\ }
\DoxyCodeLine{00093\ \textcolor{preprocessor}{\#ifdef\ LOG\_TIMINGS}}
\DoxyCodeLine{00094\ \ \ \ \ \mbox{\hyperlink{class_f_tic}{FTic}}\ time;}
\DoxyCodeLine{00095\ \ \ \ \ FReal\ t\_m2l\_1,\ t\_m2l\_2,\ t\_m2l\_3;}
\DoxyCodeLine{00096\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00097\ }
\DoxyCodeLine{00098\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00110\ \ \ \ \ \mbox{\hyperlink{class_f_cheb_sym_kernel_a052b0c903b8607a886bafd3a9166f6ec}{FChebSymKernel}}(\textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ inTreeHeight,}
\DoxyCodeLine{00111\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ FReal\ inBoxWidth,}
\DoxyCodeLine{00112\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_f_point}{FPoint<FReal>}}\&\ inBoxCenter,}
\DoxyCodeLine{00113\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ MatrixKernelClass\ *\textcolor{keyword}{const}\ inMatrixKernel,}
\DoxyCodeLine{00114\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ FReal\ Epsilon)}
\DoxyCodeLine{00115\ \ \ \ \ \ \ \ \ :\ \mbox{\hyperlink{class_f_abstract_cheb_kernel}{AbstractBaseClass}}(inTreeHeight,\ inBoxWidth,\ inBoxCenter),}
\DoxyCodeLine{00116\ \ \ \ \ \ \ \ \ \ \ MatrixKernel(inMatrixKernel),}
\DoxyCodeLine{00117\ \ \ \ \ \ \ \ \ \ \ SymHandler(new\ \mbox{\hyperlink{class_symmetry_handler}{SymmetryHandlerClass}}(MatrixKernel,\ Epsilon,\ inBoxWidth,\ inTreeHeight)),}
\DoxyCodeLine{00118\ \ \ \ \ \ \ \ \ \ \ Loc(nullptr),\ Mul(nullptr),\ countExp(nullptr)}
\DoxyCodeLine{00119\ \ \ \ \ \{}
\DoxyCodeLine{00120\ \ \ \ \ \ \ \ \ this-\/>allocateMemoryForPermutedExpansions();}
\DoxyCodeLine{00121\ \textcolor{preprocessor}{\#ifdef\ LOG\_TIMINGS}}
\DoxyCodeLine{00122\ \ \ \ \ \ \ \ \ t\_m2l\_1\ =\ FReal(0.);}
\DoxyCodeLine{00123\ \ \ \ \ \ \ \ \ t\_m2l\_2\ =\ FReal(0.);}
\DoxyCodeLine{00124\ \ \ \ \ \ \ \ \ t\_m2l\_3\ =\ FReal(0.);}
\DoxyCodeLine{00125\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00126\ \ \ \ \ \}}
\DoxyCodeLine{00127\ \ \ \ \ }
\DoxyCodeLine{00136\ \ \ \ \ \mbox{\hyperlink{class_f_cheb_sym_kernel_a1913d85ac4143497636c1d993b716656}{FChebSymKernel}}(\textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ inTreeHeight,}
\DoxyCodeLine{00137\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ FReal\ inBoxWidth,}
\DoxyCodeLine{00138\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_f_point}{FPoint<FReal>}}\&\ inBoxCenter,}
\DoxyCodeLine{00139\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ MatrixKernelClass\ *\textcolor{keyword}{const}\ inMatrixKernel)\ :\mbox{\hyperlink{class_f_cheb_sym_kernel}{FChebSymKernel}}(inTreeHeight,inBoxWidth,\ inBoxCenter,inMatrixKernel,\mbox{\hyperlink{struct_f_math}{FMath}}::pow(10.0,static\_cast<FReal>(-\/ORDER)))}
\DoxyCodeLine{00140\ \ \ \ \ \{\}}
\DoxyCodeLine{00141\ }
\DoxyCodeLine{00142\ \ \ \ \ }
\DoxyCodeLine{00143\ }
\DoxyCodeLine{00145\ \ \ \ \ \mbox{\hyperlink{class_f_cheb_sym_kernel_a86a9a5dbdc5b1fe2a80e3cd2831946bd}{FChebSymKernel}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{class_f_cheb_sym_kernel}{FChebSymKernel}}\&\ other)}
\DoxyCodeLine{00146\ \ \ \ \ \ \ \ \ :\ \mbox{\hyperlink{class_f_abstract_cheb_kernel}{AbstractBaseClass}}(other),}
\DoxyCodeLine{00147\ \ \ \ \ \ \ \ \ \ \ MatrixKernel(other.MatrixKernel),}
\DoxyCodeLine{00148\ \ \ \ \ \ \ \ \ \ \ SymHandler(other.SymHandler),}
\DoxyCodeLine{00149\ \ \ \ \ \ \ \ \ \ \ Loc(nullptr),\ Mul(nullptr),\ countExp(nullptr)}
\DoxyCodeLine{00150\ \ \ \ \ \{}
\DoxyCodeLine{00151\ \ \ \ \ \ \ \ \ this-\/>allocateMemoryForPermutedExpansions();}
\DoxyCodeLine{00152\ \ \ \ \ \}}
\DoxyCodeLine{00153\ }
\DoxyCodeLine{00154\ }
\DoxyCodeLine{00155\ }
\DoxyCodeLine{00157\ \ \ \ \ \mbox{\hyperlink{class_f_cheb_sym_kernel_a49fc8f8d7ab8e1ad4ec1352fcd5581db}{\string~FChebSymKernel}}()}
\DoxyCodeLine{00158\ \ \ \ \ \{}
\DoxyCodeLine{00159\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ t=0;\ t<343;\ ++t)\ \{}
\DoxyCodeLine{00160\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (Loc[t]!=\textcolor{keyword}{nullptr})\ \textcolor{keyword}{delete}\ []\ Loc[t];}
\DoxyCodeLine{00161\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (Mul[t]!=\textcolor{keyword}{nullptr})\ \textcolor{keyword}{delete}\ []\ Mul[t];}
\DoxyCodeLine{00162\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00163\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (Loc!=\textcolor{keyword}{nullptr})\ \ \ \ \ \ \textcolor{keyword}{delete}\ []\ Loc;}
\DoxyCodeLine{00164\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (Mul!=\textcolor{keyword}{nullptr})\ \ \ \ \ \ \textcolor{keyword}{delete}\ []\ Mul;}
\DoxyCodeLine{00165\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (countExp!=\textcolor{keyword}{nullptr})\ \textcolor{keyword}{delete}\ []\ countExp;}
\DoxyCodeLine{00166\ }
\DoxyCodeLine{00167\ \textcolor{preprocessor}{\#ifdef\ LOG\_TIMINGS}}
\DoxyCodeLine{00168\ \ \ \ \ \ \ \ \ std::cout\ <<\ \textcolor{stringliteral}{"{}-\/\ Permutation\ took\ "{}}\ <<\ t\_m2l\_1\ <<\ \textcolor{stringliteral}{"{}s"{}}}
\DoxyCodeLine{00169\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n-\/\ GEMMT\ and\ GEMM\ took\ "{}}\ <<\ t\_m2l\_2\ <<\ \textcolor{stringliteral}{"{}s"{}}}
\DoxyCodeLine{00170\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n-\/\ Unpermutation\ took\ "{}}\ <<\ t\_m2l\_3\ <<\ \textcolor{stringliteral}{"{}s"{}}}
\DoxyCodeLine{00171\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ <<\ std::endl;}
\DoxyCodeLine{00172\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00173\ \ \ \ \ \}}
\DoxyCodeLine{00174\ }
\DoxyCodeLine{00175\ }
\DoxyCodeLine{00176\ \ \ \ \ \textcolor{keyword}{const}\ SymmetryHandlerClass\ *\ getPtrToSymHandler()\textcolor{keyword}{\ const}}
\DoxyCodeLine{00177\ \textcolor{keyword}{\ \ \ \ }\{\ \ \ \textcolor{keywordflow}{return}\ SymHandler.\mbox{\hyperlink{class_f_smart_pointer_a82a013f34ea6809b1d72da35daff374c}{getPtr}}();\ \}}
\DoxyCodeLine{00178\ \ \ \ \ }
\DoxyCodeLine{00179\ }
\DoxyCodeLine{00180\ }
\DoxyCodeLine{00181\ \ \ \ \ \textcolor{keywordtype}{void}\ P2M(CellClass*\ \textcolor{keyword}{const}\ LeafCell,}
\DoxyCodeLine{00182\ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ ContainerClass*\ \textcolor{keyword}{const}\ SourceParticles\textcolor{comment}{/*,\ const\ int\ level\ =\ AbstractBaseClass::TreeHeight*/})\textcolor{keyword}{\ override}}
\DoxyCodeLine{00183\ \textcolor{keyword}{\ \ \ \ }\{}
\DoxyCodeLine{00184\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ apply\ Sy}}
\DoxyCodeLine{00185\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_f_point}{FPoint<FReal>}}\ LeafCellCenter(\mbox{\hyperlink{class_f_abstract_cheb_kernel_af57d7784efc2307a362e8546fbf6e0c2}{AbstractBaseClass::getLeafCellCenter}}(LeafCell-\/>getCoordinate()));}
\DoxyCodeLine{00186\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_f_abstract_cheb_kernel_af955284daad25daea271b4382fb88b05}{AbstractBaseClass::Interpolator}}-\/>applyP2M(LeafCellCenter,\ \mbox{\hyperlink{class_f_abstract_cheb_kernel_a4d5f2c54264bdf5b5339901f129e4049}{AbstractBaseClass::BoxWidthLeaf}},}
\DoxyCodeLine{00187\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ LeafCell-\/>getMultipole(0),\ SourceParticles);}
\DoxyCodeLine{00188\ \ \ \ \ \}}
\DoxyCodeLine{00189\ }
\DoxyCodeLine{00190\ }
\DoxyCodeLine{00191\ }
\DoxyCodeLine{00192\ \ \ \ \ \textcolor{keywordtype}{void}\ M2M(CellClass*\ \textcolor{keyword}{const}\ FRestrict\ ParentCell,}
\DoxyCodeLine{00193\ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ CellClass*\textcolor{keyword}{const}\ FRestrict\ *\textcolor{keyword}{const}\ FRestrict\ ChildCells,}
\DoxyCodeLine{00194\ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ \textcolor{comment}{/*TreeLevel*/})\textcolor{keyword}{\ override}}
\DoxyCodeLine{00195\ \textcolor{keyword}{\ \ \ \ }\{}
\DoxyCodeLine{00196\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ idxRhs\ =\ 0\ ;\ idxRhs\ <\ NVALS\ ;\ ++idxRhs)\{}
\DoxyCodeLine{00197\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Reset\ the\ Parent\ expansion\ to\ zero}}
\DoxyCodeLine{00198\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ \ \ FBlas::scal(nnodes*2,\ FReal(0.),\ ParentCell-\/>getMultipole(idxRhs));}}
\DoxyCodeLine{00199\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ ChildIndex=0;\ ChildIndex\ <\ 8;\ ++ChildIndex)\{}
\DoxyCodeLine{00200\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ apply\ Sy}}
\DoxyCodeLine{00201\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (ChildCells[ChildIndex])\{}
\DoxyCodeLine{00202\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_f_abstract_cheb_kernel_af955284daad25daea271b4382fb88b05}{AbstractBaseClass::Interpolator}}-\/>applyM2M(ChildIndex,\ ChildCells[ChildIndex]-\/>getMultipole(idxRhs),\ ParentCell-\/>getMultipole(idxRhs));}
\DoxyCodeLine{00203\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00204\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00205\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00206\ \ \ \ \ \}}
\DoxyCodeLine{00207\ }
\DoxyCodeLine{00208\ }
\DoxyCodeLine{00209\ }
\DoxyCodeLine{00210\ \ \ \ \ \textcolor{keywordtype}{void}\ M2L(CellClass*\ \textcolor{keyword}{const}\ FRestrict\ TargetCell,\ \textcolor{keyword}{const}\ CellClass*\ SourceCells[],}
\DoxyCodeLine{00211\ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ neighborPositions[],\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ inSize,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ TreeLevel)\textcolor{keyword}{\ \ override\ }\{}
\DoxyCodeLine{00212\ \textcolor{preprocessor}{\#ifdef\ LOG\_TIMINGS}}
\DoxyCodeLine{00213\ \ \ \ \ \ \ \ \ time.\mbox{\hyperlink{class_f_tic_ac0e070e65af128fbe5af711e51033b0a}{tic}}();}
\DoxyCodeLine{00214\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00215\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ idxRhs\ =\ 0\ ;\ idxRhs\ <\ NVALS\ ;\ ++idxRhs)\{}
\DoxyCodeLine{00216\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ permute\ and\ copy\ multipole\ expansion}}
\DoxyCodeLine{00217\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespace_f_mem_utils_a005b2bd1925d50a688606ed5877c5aec}{memset}}(countExp,\ 0,\ \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{int})\ *\ 343);}
\DoxyCodeLine{00218\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ idxExistingNeigh\ =\ 0\ ;\ idxExistingNeigh\ <\ inSize\ ;\ ++idxExistingNeigh)\{}
\DoxyCodeLine{00219\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ idx\ =\ neighborPositions[idxExistingNeigh];}
\DoxyCodeLine{00220\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ pidx\ =\ SymHandler-\/>pindices[idx];}
\DoxyCodeLine{00221\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ count\ =\ (countExp[pidx])++;}
\DoxyCodeLine{00222\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ FReal\ *\textcolor{keyword}{const}\ mul\ =\ Mul[pidx]\ +\ count*nnodes;}
\DoxyCodeLine{00223\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ *\textcolor{keyword}{const}\ pvec\ =\ SymHandler-\/>pvectors[idx];}
\DoxyCodeLine{00224\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ FReal\ *\textcolor{keyword}{const}\ MultiExp\ =\ SourceCells[idxExistingNeigh]-\/>getMultipole(idxRhs);}
\DoxyCodeLine{00225\ }
\DoxyCodeLine{00226\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*}}
\DoxyCodeLine{00227\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ //\ no\ loop\ unrolling}}
\DoxyCodeLine{00228\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ for\ (unsigned\ int\ n=0;\ n<nnodes;\ ++n)}}
\DoxyCodeLine{00229\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ mul[pvec[n]]\ =\ MultiExp[n];}}
\DoxyCodeLine{00230\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ */}}
\DoxyCodeLine{00231\ }
\DoxyCodeLine{00232\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ explicit\ loop\ unrolling}}
\DoxyCodeLine{00233\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ n=0;\ n<nnodes/4\ *\ 4;\ n+=4)\ \{}
\DoxyCodeLine{00234\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ mul[pvec[n\ \ ]]\ =\ MultiExp[n];}
\DoxyCodeLine{00235\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ mul[pvec[n+1]]\ =\ MultiExp[n+1];}
\DoxyCodeLine{00236\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ mul[pvec[n+2]]\ =\ MultiExp[n+2];}
\DoxyCodeLine{00237\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ mul[pvec[n+3]]\ =\ MultiExp[n+3];}
\DoxyCodeLine{00238\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00239\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ n=nnodes/4\ *\ 4;\ n<nnodes;\ ++n)\{}
\DoxyCodeLine{00240\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ mul[pvec[n]]\ =\ MultiExp[n];}
\DoxyCodeLine{00241\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00242\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00243\ }
\DoxyCodeLine{00244\ \textcolor{preprocessor}{\#ifdef\ LOG\_TIMINGS}}
\DoxyCodeLine{00245\ \ \ \ \ \ \ \ \ \ \ \ \ t\_m2l\_1\ +=\ time.\mbox{\hyperlink{class_f_tic_ade3afdb1aa198635ebbc5ee8b7f4f081}{tacAndElapsed}}();}
\DoxyCodeLine{00246\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00247\ }
\DoxyCodeLine{00248\ }
\DoxyCodeLine{00249\ \textcolor{preprocessor}{\#ifdef\ COUNT\_BLOCKED\_INTERACTIONS\ }}
\DoxyCodeLine{00250\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ count\_lidx\ =\ 0;}
\DoxyCodeLine{00251\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ count\_interactions\ =\ 0;}
\DoxyCodeLine{00252\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ idx=0;\ idx<343;\ ++idx)}
\DoxyCodeLine{00253\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ count\_interactions\ +=\ countExp[idx];}
\DoxyCodeLine{00254\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (count\_interactions==189)\ \{}
\DoxyCodeLine{00255\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ idx=0;\ idx<343;\ ++idx)\ \{}
\DoxyCodeLine{00256\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (countExp[idx])}
\DoxyCodeLine{00257\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ std::cout\ <<\ \textcolor{stringliteral}{"{}gidx\ =\ "{}}\ <<\ idx\ <<\ \textcolor{stringliteral}{"{}\ gives\ lidx\ =\ "{}}\ <<\ count\_lidx++\ <<\ \textcolor{stringliteral}{"{}\ and\ has\ "{}}}
\DoxyCodeLine{00258\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ <<\ countExp[idx]\ <<\ \textcolor{stringliteral}{"{}\ interactions"{}}\ <<\ std::endl;}
\DoxyCodeLine{00259\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00260\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ std::cout\ <<\ std::endl;}
\DoxyCodeLine{00261\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00262\ \textcolor{preprocessor}{\#endif\ }}
\DoxyCodeLine{00263\ }
\DoxyCodeLine{00264\ }
\DoxyCodeLine{00265\ \textcolor{preprocessor}{\#ifdef\ LOG\_TIMINGS}}
\DoxyCodeLine{00266\ \ \ \ \ \ \ \ \ \ \ \ \ time.\mbox{\hyperlink{class_f_tic_ac0e070e65af128fbe5af711e51033b0a}{tic}}();}
\DoxyCodeLine{00267\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00268\ }
\DoxyCodeLine{00269\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ multiply\ (mat-\/mat-\/mul)}}
\DoxyCodeLine{00270\ \ \ \ \ \ \ \ \ \ \ \ \ FReal\ Compressed\ [nnodes\ *\ 24];}
\DoxyCodeLine{00271\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ FReal\ scale\ =\ MatrixKernel-\/>getScaleFactor(\mbox{\hyperlink{class_f_abstract_cheb_kernel_ab4ffad9e8de0dfbf65de79e72da2b47a}{AbstractBaseClass::BoxWidth}},\ TreeLevel);}
\DoxyCodeLine{00272\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ pidx=0;\ pidx<343;\ ++pidx)\ \{}
\DoxyCodeLine{00273\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ count\ =\ countExp[pidx];}
\DoxyCodeLine{00274\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (count)\ \{}
\DoxyCodeLine{00275\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ rank\ =\ SymHandler-\/>getLowRank(TreeLevel,\ pidx);}
\DoxyCodeLine{00276\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ rank\ *\ count\ *\ (2*nnodes-\/1)\ flops}}
\DoxyCodeLine{00277\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ FBlas::gemtm(nnodes,\ rank,\ count,\ FReal(1.),}
\DoxyCodeLine{00278\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const\_cast<}FReal*\textcolor{keyword}{>}(SymHandler-\/>getK(TreeLevel,\ pidx))+rank*nnodes,}
\DoxyCodeLine{00279\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ nnodes,\ Mul[pidx],\ nnodes,\ Compressed,\ rank);}
\DoxyCodeLine{00280\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ nnodes\ *count\ *\ (2*rank-\/1)\ flops}}
\DoxyCodeLine{00281\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ FBlas::gemm(\ nnodes,\ rank,\ count,\ scale,}
\DoxyCodeLine{00282\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const\_cast<}FReal*\textcolor{keyword}{>}(SymHandler-\/>getK(TreeLevel,\ pidx)),}
\DoxyCodeLine{00283\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ nnodes,\ Compressed,\ rank,\ Loc[pidx],\ nnodes);}
\DoxyCodeLine{00284\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00285\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00286\ }
\DoxyCodeLine{00287\ \textcolor{preprocessor}{\#ifdef\ LOG\_TIMINGS}}
\DoxyCodeLine{00288\ \ \ \ \ \ \ \ \ \ \ \ \ t\_m2l\_2\ +=\ time.\mbox{\hyperlink{class_f_tic_ade3afdb1aa198635ebbc5ee8b7f4f081}{tacAndElapsed}}();}
\DoxyCodeLine{00289\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00290\ }
\DoxyCodeLine{00291\ \textcolor{preprocessor}{\#ifdef\ LOG\_TIMINGS}}
\DoxyCodeLine{00292\ \ \ \ \ \ \ \ \ \ \ \ \ time.\mbox{\hyperlink{class_f_tic_ac0e070e65af128fbe5af711e51033b0a}{tic}}();}
\DoxyCodeLine{00293\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00294\ }
\DoxyCodeLine{00295\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ permute\ and\ add\ contribution\ to\ local\ expansions}}
\DoxyCodeLine{00296\ \ \ \ \ \ \ \ \ \ \ \ \ FReal\ *\textcolor{keyword}{const}\ LocalExpansion\ =\ TargetCell-\/>getLocal(idxRhs);}
\DoxyCodeLine{00297\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespace_f_mem_utils_a005b2bd1925d50a688606ed5877c5aec}{memset}}(countExp,\ 0,\ \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{int})\ *\ 343);}
\DoxyCodeLine{00298\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ idxExistingNeigh\ =\ 0\ ;\ idxExistingNeigh\ <\ inSize\ ;\ ++idxExistingNeigh)\{}
\DoxyCodeLine{00299\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ idx\ =\ neighborPositions[idxExistingNeigh];}
\DoxyCodeLine{00300\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ pidx\ =\ SymHandler-\/>pindices[idx];}
\DoxyCodeLine{00301\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ count\ =\ (countExp[pidx])++;}
\DoxyCodeLine{00302\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ FReal\ *\textcolor{keyword}{const}\ loc\ =\ Loc[pidx]\ +\ count*nnodes;}
\DoxyCodeLine{00303\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ *\textcolor{keyword}{const}\ pvec\ =\ SymHandler-\/>pvectors[idx];}
\DoxyCodeLine{00304\ }
\DoxyCodeLine{00305\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*}}
\DoxyCodeLine{00306\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ //\ no\ loop\ unrolling}}
\DoxyCodeLine{00307\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ for\ (unsigned\ int\ n=0;\ n<nnodes;\ ++n)}}
\DoxyCodeLine{00308\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ LocalExpansion[n]\ +=\ loc[pvec[n]];}}
\DoxyCodeLine{00309\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ */}}
\DoxyCodeLine{00310\ }
\DoxyCodeLine{00311\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ explicit\ loop\ unrolling}}
\DoxyCodeLine{00312\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ n=0;\ n<nnodes/4\ *\ 4;\ n+=4)\ \{}
\DoxyCodeLine{00313\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ LocalExpansion[n\ \ ]\ +=\ loc[pvec[n\ \ ]];}
\DoxyCodeLine{00314\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ LocalExpansion[n+1]\ +=\ loc[pvec[n+1]];}
\DoxyCodeLine{00315\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ LocalExpansion[n+2]\ +=\ loc[pvec[n+2]];}
\DoxyCodeLine{00316\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ LocalExpansion[n+3]\ +=\ loc[pvec[n+3]];}
\DoxyCodeLine{00317\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00318\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ n=nnodes/4\ *\ 4;\ n<nnodes;\ ++n)}
\DoxyCodeLine{00319\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ LocalExpansion[n]\ +=\ loc[pvec[n]];}
\DoxyCodeLine{00320\ }
\DoxyCodeLine{00321\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00322\ }
\DoxyCodeLine{00323\ \textcolor{preprocessor}{\#ifdef\ LOG\_TIMINGS}}
\DoxyCodeLine{00324\ \ \ \ \ \ \ \ \ \ \ \ \ t\_m2l\_3\ +=\ time.\mbox{\hyperlink{class_f_tic_ade3afdb1aa198635ebbc5ee8b7f4f081}{tacAndElapsed}}();}
\DoxyCodeLine{00325\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00326\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00327\ }
\DoxyCodeLine{00328\ \ \ \ \ \}}
\DoxyCodeLine{00329\ }
\DoxyCodeLine{00330\ }
\DoxyCodeLine{00331\ }
\DoxyCodeLine{00332\ \ \ \ \ \textcolor{comment}{/*}}
\DoxyCodeLine{00333\ \textcolor{comment}{\ \ \ \ void\ M2L(CellClass*\ const\ FRestrict\ TargetCell,\ const\ CellClass*\ SourceCells[],}}
\DoxyCodeLine{00334\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ const\ int\ neighborPositions[],\ const\ int\ inSize,\ const\ int\ TreeLevel)\ \ override\ \{}}
\DoxyCodeLine{00335\ \textcolor{comment}{\ \ \ \ \ \ \ \ //\ permute\ and\ copy\ multipole\ expansion}}
\DoxyCodeLine{00336\ \textcolor{comment}{\ \ \ \ \ \ \ \ memset(countExp,\ 0,\ sizeof(int)\ *\ 343);}}
\DoxyCodeLine{00337\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ for(int\ idxExistingNeigh\ =\ 0\ ;\ idxExistingNeigh\ <\ inSize\ ;\ ++idxExistingNeigh)\{}}
\DoxyCodeLine{00338\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ const\ int\ idx\ =\ neighborPositions[idxExistingNeigh];}}
\DoxyCodeLine{00339\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ const\ unsigned\ int\ pidx\ =\ SymHandler-\/>pindices[idx];}}
\DoxyCodeLine{00340\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ const\ unsigned\ int\ count\ =\ (countExp[pidx])++;}}
\DoxyCodeLine{00341\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ const\ FReal\ *const\ MultiExp\ =\ SourceCells[idxExistingNeigh]-\/>getMultipole();}}
\DoxyCodeLine{00342\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ for\ (unsigned\ int\ n=0;\ n<nnodes;\ ++n)}}
\DoxyCodeLine{00343\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Mul[pidx][count*nnodes\ +\ SymHandler-\/>pvectors[idx][n]]\ =\ MultiExp[n];}}
\DoxyCodeLine{00344\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \}}}
\DoxyCodeLine{00345\ \textcolor{comment}{}}
\DoxyCodeLine{00346\ \textcolor{comment}{\ \ \ \ \ \ \ \ //\ multiply\ (mat-\/mat-\/mul)}}
\DoxyCodeLine{00347\ \textcolor{comment}{\ \ \ \ \ \ \ \ FReal\ Compressed\ [nnodes\ *\ 30];}}
\DoxyCodeLine{00348\ \textcolor{comment}{\ \ \ \ \ \ \ \ const\ FReal\ CellWidth(AbstractBaseClass::BoxWidth\ /\ FReal(FMath::pow(2,\ TreeLevel)));}}
\DoxyCodeLine{00349\ \textcolor{comment}{\ \ \ \ \ \ \ \ const\ FReal\ scale(AbstractBaseClass::MatrixKernel-\/>getScaleFactor(CellWidth));}}
\DoxyCodeLine{00350\ \textcolor{comment}{\ \ \ \ \ \ \ \ for\ (unsigned\ int\ pidx=0;\ pidx<343;\ ++pidx)\ \{}}
\DoxyCodeLine{00351\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ const\ unsigned\ int\ count\ =\ countExp[pidx];}}
\DoxyCodeLine{00352\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ if\ (count)\ \{}}
\DoxyCodeLine{00353\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ const\ unsigned\ int\ rank\ =\ SymHandler-\/>LowRank[pidx];}}
\DoxyCodeLine{00354\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ FBlas::gemtm(nnodes,\ rank,\ count,\ FReal(1.),}}
\DoxyCodeLine{00355\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ SymHandler-\/>K[pidx]+rank*nnodes,\ nnodes,\ Mul[pidx],\ nnodes,\ Compressed,\ rank);}}
\DoxyCodeLine{00356\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ FBlas::gemm(\ nnodes,\ rank,\ count,\ scale,}}
\DoxyCodeLine{00357\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ SymHandler-\/>K[pidx],\ nnodes,\ Compressed,\ rank,\ Loc[pidx],\ nnodes);}}
\DoxyCodeLine{00358\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \}}}
\DoxyCodeLine{00359\ \textcolor{comment}{\ \ \ \ \ \ \ \ \}}}
\DoxyCodeLine{00360\ \textcolor{comment}{}}
\DoxyCodeLine{00361\ \textcolor{comment}{\ \ \ \ \ \ \ \ //\ permute\ and\ add\ contribution\ to\ local\ expansions}}
\DoxyCodeLine{00362\ \textcolor{comment}{\ \ \ \ \ \ \ \ FReal\ *const\ LocalExpansion\ =\ TargetCell-\/>getLocal();}}
\DoxyCodeLine{00363\ \textcolor{comment}{\ \ \ \ \ \ \ \ memset(countExp,\ 0,\ sizeof(int)\ *\ 343);}}
\DoxyCodeLine{00364\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ for(int\ idxExistingNeigh\ =\ 0\ ;\ idxExistingNeigh\ <\ inSize\ ;\ ++idxExistingNeigh)\{}}
\DoxyCodeLine{00365\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ const\ int\ idx\ =\ neighborPositions[idxExistingNeigh];}}
\DoxyCodeLine{00366\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ const\ unsigned\ int\ pidx\ =\ SymHandler-\/>pindices[idx];}}
\DoxyCodeLine{00367\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ const\ unsigned\ int\ count\ =\ (countExp[pidx])++;}}
\DoxyCodeLine{00368\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ for\ (unsigned\ int\ n=0;\ n<nnodes;\ ++n)}}
\DoxyCodeLine{00369\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ LocalExpansion[n]\ +=\ Loc[pidx][count*nnodes\ +\ SymHandler-\/>pvectors[idx][n]];}}
\DoxyCodeLine{00370\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \}}}
\DoxyCodeLine{00371\ \textcolor{comment}{}}
\DoxyCodeLine{00372\ \textcolor{comment}{\ \ \ \ \}}}
\DoxyCodeLine{00373\ \textcolor{comment}{\ \ \ \ */}}
\DoxyCodeLine{00374\ }
\DoxyCodeLine{00375\ \ \ \ \ \textcolor{comment}{/*}}
\DoxyCodeLine{00376\ \textcolor{comment}{\ \ \ \ void\ M2L(CellClass*\ const\ FRestrict\ TargetCell,\ const\ CellClass*\ SourceCells[],}}
\DoxyCodeLine{00377\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ const\ int\ neighborPositions[],\ const\ int\ inSize,\ const\ int\ TreeLevel)\ \ override\ \{}}
\DoxyCodeLine{00378\ \textcolor{comment}{\ \ \ \ \ \ \ \ FReal\ *const\ LocalExpansion\ =\ TargetCell-\/>getLocal();}}
\DoxyCodeLine{00379\ \textcolor{comment}{\ \ \ \ \ \ \ \ const\ FReal\ CellWidth(BoxWidth\ /\ FReal(FMath::pow(2,\ TreeLevel)));}}
\DoxyCodeLine{00380\ \textcolor{comment}{\ \ \ \ \ \ \ \ const\ FReal\ scale(MatrixKernel-\/>getScaleFactor(CellWidth));}}
\DoxyCodeLine{00381\ \textcolor{comment}{}}
\DoxyCodeLine{00382\ \textcolor{comment}{\ \ \ \ \ \ \ \ FReal\ PermLocalExp[nnodes];}}
\DoxyCodeLine{00383\ \textcolor{comment}{\ \ \ \ \ \ \ \ FReal\ PermMultiExp[nnodes];}}
\DoxyCodeLine{00384\ \textcolor{comment}{\ \ \ \ \ \ \ \ FReal\ Compressed[nnodes];}}
\DoxyCodeLine{00385\ \textcolor{comment}{\ \ \ \ \ \ \ \ for\ (int\ i=-\/3;\ i<=3;\ ++i)\ \{}}
\DoxyCodeLine{00386\ \textcolor{comment}{\ \ \ \ \ \ \ \ for\ (int\ j=-\/3;\ j<=3;\ ++j)\ \{}}
\DoxyCodeLine{00387\ \textcolor{comment}{\ \ \ \ \ \ \ \ for\ (int\ k=-\/3;\ k<=3;\ ++k)\ \{}}
\DoxyCodeLine{00388\ \textcolor{comment}{}}
\DoxyCodeLine{00389\ \textcolor{comment}{\ \ \ \ \ \ \ \ const\ unsigned\ int\ idx\ =\ ((i+3)\ *\ 7\ +\ (j+3))\ *\ 7\ +\ (k+3);}}
\DoxyCodeLine{00390\ \textcolor{comment}{}}
\DoxyCodeLine{00391\ \textcolor{comment}{\ \ \ \ \ \ \ \ if\ (SourceCells[idx])\ \{}}
\DoxyCodeLine{00392\ \textcolor{comment}{\ \ \ \ \ \ \ \ const\ FReal\ *const\ MultiExp\ =\ SourceCells[idx]-\/>getMultipole();}}
\DoxyCodeLine{00393\ \textcolor{comment}{}}
\DoxyCodeLine{00394\ \textcolor{comment}{\ \ \ \ \ \ \ \ //\ permute}}
\DoxyCodeLine{00395\ \textcolor{comment}{\ \ \ \ \ \ \ \ for\ (unsigned\ int\ n=0;\ n<nnodes;\ ++n)\ PermMultiExp[pvectors[idx][n]]\ =\ MultiExp[n];}}
\DoxyCodeLine{00396\ \textcolor{comment}{}}
\DoxyCodeLine{00397\ \textcolor{comment}{\ \ \ \ \ \ \ \ //\ mat-\/vec-\/mult\ (svd)}}
\DoxyCodeLine{00398\ \textcolor{comment}{\ \ \ \ \ \ \ \ assert(K[pindices[idx]]!=nullptr);}}
\DoxyCodeLine{00399\ \textcolor{comment}{\ \ \ \ \ \ \ \ const\ int\ rank\ =\ LowRank[pindices[idx]];}}
\DoxyCodeLine{00400\ \textcolor{comment}{\ \ \ \ \ \ \ \ FBlas::gemtv(nnodes,\ rank,\ FReal(1.),\ K[pindices[idx]]+rank*nnodes,\ PermMultiExp,\ Compressed);}}
\DoxyCodeLine{00401\ \textcolor{comment}{\ \ \ \ \ \ \ \ FBlas::gemv(\ nnodes,\ rank,\ scale,\ K[pindices[idx]],\ Compressed,\ PermLocalExp);}}
\DoxyCodeLine{00402\ \textcolor{comment}{}}
\DoxyCodeLine{00403\ \textcolor{comment}{\ \ \ \ \ \ \ \ //\ permute}}
\DoxyCodeLine{00404\ \textcolor{comment}{\ \ \ \ \ \ \ \ for\ (unsigned\ int\ n=0;\ n<nnodes;\ ++n)\ LocalExpansion[n]\ +=\ PermLocalExp[pvectors[idx][n]];}}
\DoxyCodeLine{00405\ \textcolor{comment}{\ \ \ \ \ \ \ \ \}}}
\DoxyCodeLine{00406\ \textcolor{comment}{}}
\DoxyCodeLine{00407\ \textcolor{comment}{\ \ \ \ \ \ \ \ \}}}
\DoxyCodeLine{00408\ \textcolor{comment}{\ \ \ \ \ \ \ \ \}}}
\DoxyCodeLine{00409\ \textcolor{comment}{\ \ \ \ \ \ \ \ \}}}
\DoxyCodeLine{00410\ \textcolor{comment}{}}
\DoxyCodeLine{00411\ \textcolor{comment}{\ \ \ \ \ \ \ \ \}}}
\DoxyCodeLine{00412\ \textcolor{comment}{\ \ \ \ */}}
\DoxyCodeLine{00413\ }
\DoxyCodeLine{00414\ }
\DoxyCodeLine{00415\ }
\DoxyCodeLine{00416\ \ \ \ \ \textcolor{keywordtype}{void}\ L2L(\textcolor{keyword}{const}\ CellClass*\ \textcolor{keyword}{const}\ FRestrict\ ParentCell,}
\DoxyCodeLine{00417\ \ \ \ \ \ \ \ \ \ \ \ \ \ CellClass*\ FRestrict\ *\textcolor{keyword}{const}\ FRestrict\ ChildCells,}
\DoxyCodeLine{00418\ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ \textcolor{comment}{/*TreeLevel*/})\textcolor{keyword}{\ override}}
\DoxyCodeLine{00419\ \textcolor{keyword}{\ \ \ \ }\{}
\DoxyCodeLine{00420\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ idxRhs\ =\ 0\ ;\ idxRhs\ <\ NVALS\ ;\ ++idxRhs)\{}
\DoxyCodeLine{00421\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ apply\ Sx}}
\DoxyCodeLine{00422\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ ChildIndex=0;\ ChildIndex\ <\ 8;\ ++ChildIndex)\{}
\DoxyCodeLine{00423\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (ChildCells[ChildIndex])\{}
\DoxyCodeLine{00424\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_f_abstract_cheb_kernel_af955284daad25daea271b4382fb88b05}{AbstractBaseClass::Interpolator}}-\/>applyL2L(ChildIndex,\ ParentCell-\/>getLocal(idxRhs),\ ChildCells[ChildIndex]-\/>getLocal(idxRhs));}
\DoxyCodeLine{00425\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00426\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00427\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00428\ \ \ \ \ \}}
\DoxyCodeLine{00429\ }
\DoxyCodeLine{00430\ }
\DoxyCodeLine{00431\ }
\DoxyCodeLine{00432\ \ \ \ \ \textcolor{keywordtype}{void}\ L2P(\textcolor{keyword}{const}\ CellClass*\ \textcolor{keyword}{const}\ LeafCell,}
\DoxyCodeLine{00433\ \ \ \ \ \ \ \ \ \ \ \ \ \ ContainerClass*\ \textcolor{keyword}{const}\ TargetParticles)\textcolor{keyword}{\ override}}
\DoxyCodeLine{00434\ \textcolor{keyword}{\ \ \ \ }\{}
\DoxyCodeLine{00435\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_f_point}{FPoint<FReal>}}\ LeafCellCenter(\mbox{\hyperlink{class_f_abstract_cheb_kernel_af57d7784efc2307a362e8546fbf6e0c2}{AbstractBaseClass::getLeafCellCenter}}(LeafCell-\/>getCoordinate()));}
\DoxyCodeLine{00436\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ \ \ \ \ \ //\ a)\ apply\ Sx}}
\DoxyCodeLine{00437\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ \ \ \ \ \ AbstractBaseClass::Interpolator-\/>applyL2P(LeafCellCenter,}}
\DoxyCodeLine{00438\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ AbstractBaseClass::BoxWidthLeaf,}}
\DoxyCodeLine{00439\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ LeafCell-\/>getLocal(),}}
\DoxyCodeLine{00440\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ TargetParticles);}}
\DoxyCodeLine{00441\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ \ \ \ \ \ //\ b)\ apply\ Px\ (grad\ Sx)}}
\DoxyCodeLine{00442\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ \ \ \ \ \ AbstractBaseClass::Interpolator-\/>applyL2PGradient(LeafCellCenter,}}
\DoxyCodeLine{00443\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ AbstractBaseClass::BoxWidthLeaf,}}
\DoxyCodeLine{00444\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ LeafCell-\/>getLocal(),}}
\DoxyCodeLine{00445\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ TargetParticles);}}
\DoxyCodeLine{00446\ }
\DoxyCodeLine{00447\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ c)\ apply\ Sx\ and\ Px\ (grad\ Sx)}}
\DoxyCodeLine{00448\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_f_abstract_cheb_kernel_af955284daad25daea271b4382fb88b05}{AbstractBaseClass::Interpolator}}-\/>applyL2PTotal(LeafCellCenter,\ \mbox{\hyperlink{class_f_abstract_cheb_kernel_a4d5f2c54264bdf5b5339901f129e4049}{AbstractBaseClass::BoxWidthLeaf}},}
\DoxyCodeLine{00449\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ LeafCell-\/>getLocal(0),\ TargetParticles);}
\DoxyCodeLine{00450\ }
\DoxyCodeLine{00451\ \ \ \ \ \}}
\DoxyCodeLine{00452\ }
\DoxyCodeLine{00453\ \ \ \ \ \textcolor{keywordtype}{void}\ P2P(\textcolor{keyword}{const}\ \mbox{\hyperlink{class_f_tree_coordinate}{FTreeCoordinate}}\&\ inPosition,}
\DoxyCodeLine{00454\ \ \ \ \ \ \ \ \ \ \ \ \ \ ContainerClass*\ \textcolor{keyword}{const}\ FRestrict\ inTargets,\ \textcolor{keyword}{const}\ ContainerClass*\ \textcolor{keyword}{const}\ FRestrict\ inSources,}
\DoxyCodeLine{00455\ \ \ \ \ \ \ \ \ \ \ \ \ \ ContainerClass*\ \textcolor{keyword}{const}\ inNeighbors[],\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ neighborPositions[],}
\DoxyCodeLine{00456\ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ inSize)\textcolor{keyword}{\ override\ }\{}
\DoxyCodeLine{00457\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(inTargets\ ==\ inSources)\{}
\DoxyCodeLine{00458\ \ \ \ \ \ \ \ \ \ \ \ \ P2POuter(inPosition,\ inTargets,\ inNeighbors,\ neighborPositions,\ inSize);}
\DoxyCodeLine{00459\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{struct_direct_interaction_computer}{DirectInteractionComputer<FReal,\ MatrixKernelClass::NCMP,\ NVALS>::P2PInner}}(inTargets,MatrixKernel);}
\DoxyCodeLine{00460\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00461\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\{}
\DoxyCodeLine{00462\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ ContainerClass*\ \textcolor{keyword}{const}\ srcPtr[1]\ =\ \{inSources\};}
\DoxyCodeLine{00463\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{struct_direct_interaction_computer}{DirectInteractionComputer<FReal,\ MatrixKernelClass::NCMP,\ NVALS>::P2PRemote}}(inTargets,srcPtr,1,MatrixKernel);}
\DoxyCodeLine{00464\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{struct_direct_interaction_computer}{DirectInteractionComputer<FReal,\ MatrixKernelClass::NCMP,\ NVALS>::P2PRemote}}(inTargets,inNeighbors,inSize,MatrixKernel);}
\DoxyCodeLine{00465\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00466\ \ \ \ \ \}}
\DoxyCodeLine{00467\ }
\DoxyCodeLine{00468\ \ \ \ \ \textcolor{keywordtype}{void}\ P2POuter(\textcolor{keyword}{const}\ \mbox{\hyperlink{class_f_tree_coordinate}{FTreeCoordinate}}\&\ \textcolor{comment}{/*inLeafPosition*/},}
\DoxyCodeLine{00469\ \ \ \ \ \ \ \ \ \ \ \ \ \ ContainerClass*\ \textcolor{keyword}{const}\ FRestrict\ inTargets,}
\DoxyCodeLine{00470\ \ \ \ \ \ \ \ \ \ \ \ \ \ ContainerClass*\ \textcolor{keyword}{const}\ inNeighbors[],\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ neighborPositions[],}
\DoxyCodeLine{00471\ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ inSize)\textcolor{keyword}{\ override\ }\{}
\DoxyCodeLine{00472\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ nbNeighborsToCompute\ =\ 0;}
\DoxyCodeLine{00473\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{while}(nbNeighborsToCompute\ <\ inSize}
\DoxyCodeLine{00474\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \&\&\ neighborPositions[nbNeighborsToCompute]\ <\ 14)\{}
\DoxyCodeLine{00475\ \ \ \ \ \ \ \ \ \ \ \ \ nbNeighborsToCompute\ +=\ 1;}
\DoxyCodeLine{00476\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00477\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{struct_direct_interaction_computer}{DirectInteractionComputer<FReal,\ MatrixKernelClass::NCMP,\ NVALS>::P2P}}(inTargets,inNeighbors,nbNeighborsToCompute,MatrixKernel);}
\DoxyCodeLine{00478\ \ \ \ \ \}}
\DoxyCodeLine{00479\ }
\DoxyCodeLine{00480\ }
\DoxyCodeLine{00481\ \ \ \ \ \textcolor{keywordtype}{void}\ P2PRemote(\textcolor{keyword}{const}\ \mbox{\hyperlink{class_f_tree_coordinate}{FTreeCoordinate}}\&\ \textcolor{comment}{/*inPosition*/},}
\DoxyCodeLine{00482\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ContainerClass*\ \textcolor{keyword}{const}\ FRestrict\ inTargets,\ \textcolor{keyword}{const}\ ContainerClass*\ \textcolor{keyword}{const}\ FRestrict\ \textcolor{comment}{/*inSources*/},}
\DoxyCodeLine{00483\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ ContainerClass*\ \textcolor{keyword}{const}\ inNeighbors[],\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ \textcolor{comment}{/*neighborPositions*/}[],}
\DoxyCodeLine{00484\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ inSize)\textcolor{keyword}{\ override\ }\{}
\DoxyCodeLine{00485\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{struct_direct_interaction_computer}{DirectInteractionComputer<FReal,\ MatrixKernelClass::NCMP,\ NVALS>::P2PRemote}}(inTargets,inNeighbors,inSize,MatrixKernel);}
\DoxyCodeLine{00486\ \ \ \ \ \}}
\DoxyCodeLine{00487\ }
\DoxyCodeLine{00488\ \};}
\DoxyCodeLine{00489\ }
\DoxyCodeLine{00490\ }
\DoxyCodeLine{00491\ }
\DoxyCodeLine{00492\ }
\DoxyCodeLine{00493\ }
\DoxyCodeLine{00494\ }
\DoxyCodeLine{00495\ }
\DoxyCodeLine{00496\ }
\DoxyCodeLine{00497\ \textcolor{preprocessor}{\#endif\ }\textcolor{comment}{//FCHEBSYMKERNELS\_HPP}}
\DoxyCodeLine{00498\ }
\DoxyCodeLine{00499\ \textcolor{comment}{//\ [-\/-\/END-\/-\/]}}

\end{DoxyCode}
