\doxysection{FGroup\+Task\+Starpu\+Algorithm.\+hpp}
\hypertarget{_f_group_task_starpu_algorithm_8hpp_source}{}\label{_f_group_task_starpu_algorithm_8hpp_source}\index{third\_party/ScalFMM/include/ScalFMM/GroupTree/Core/FGroupTaskStarpuAlgorithm.hpp@{third\_party/ScalFMM/include/ScalFMM/GroupTree/Core/FGroupTaskStarpuAlgorithm.hpp}}

\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{comment}{//\ Keep\ in\ private\ GIT}}
\DoxyCodeLine{00002\ \textcolor{preprocessor}{\#ifndef\ FGROUPTASKSTARPUALGORITHM\_HPP}}
\DoxyCodeLine{00003\ \textcolor{preprocessor}{\#define\ FGROUPTASKSTARPUALGORITHM\_HPP}}
\DoxyCodeLine{00004\ }
\DoxyCodeLine{00005\ \textcolor{preprocessor}{\#include\ "{}../../Utils/FGlobal.hpp"{}}}
\DoxyCodeLine{00006\ \textcolor{preprocessor}{\#include\ "{}../../Core/FCoreCommon.hpp"{}}}
\DoxyCodeLine{00007\ \textcolor{preprocessor}{\#include\ "{}../../Utils/FQuickSort.hpp"{}}}
\DoxyCodeLine{00008\ \textcolor{preprocessor}{\#include\ "{}../../Containers/FTreeCoordinate.hpp"{}}}
\DoxyCodeLine{00009\ \textcolor{preprocessor}{\#include\ "{}../../Utils/FLog.hpp"{}}}
\DoxyCodeLine{00010\ \textcolor{preprocessor}{\#include\ "{}../../Utils/FTic.hpp"{}}}
\DoxyCodeLine{00011\ \textcolor{preprocessor}{\#include\ "{}../../Utils/FAssert.hpp"{}}}
\DoxyCodeLine{00012\ \textcolor{preprocessor}{\#include\ "{}../../Utils/FEnv.hpp"{}}}
\DoxyCodeLine{00013\ }
\DoxyCodeLine{00014\ \textcolor{preprocessor}{\#include\ "{}FOutOfBlockInteraction.hpp"{}}}
\DoxyCodeLine{00015\ }
\DoxyCodeLine{00016\ \textcolor{preprocessor}{\#include\ <unordered\_set>}}
\DoxyCodeLine{00017\ }
\DoxyCodeLine{00018\ \textcolor{preprocessor}{\#include\ <vector>}}
\DoxyCodeLine{00019\ \textcolor{preprocessor}{\#include\ <memory>}}
\DoxyCodeLine{00020\ }
\DoxyCodeLine{00021\ \textcolor{preprocessor}{\#include\ <omp.h>}}
\DoxyCodeLine{00022\ }
\DoxyCodeLine{00023\ \textcolor{preprocessor}{\#include\ <starpu.h>}}
\DoxyCodeLine{00024\ \textcolor{preprocessor}{\#ifdef\ STARPU\_SIMGRID\_MLR\_MODELS}}
\DoxyCodeLine{00025\ \textcolor{preprocessor}{\#include\ "{}starpu\_codelet\_parameters.h"{}}}
\DoxyCodeLine{00026\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00027\ \textcolor{preprocessor}{\#include\ "{}../StarPUUtils/FStarPUUtils.hpp"{}}}
\DoxyCodeLine{00028\ \textcolor{preprocessor}{\#include\ "{}../StarPUUtils/FStarPUFmmPriorities.hpp"{}}}
\DoxyCodeLine{00029\ \textcolor{preprocessor}{\#include\ "{}../StarPUUtils/FStarPUFmmPrioritiesV2.hpp"{}}}
\DoxyCodeLine{00030\ \textcolor{preprocessor}{\#include\ "{}../StarPUUtils/FStarPUReduxCpu.hpp"{}}}
\DoxyCodeLine{00031\ }
\DoxyCodeLine{00032\ \textcolor{preprocessor}{\#ifdef\ STARPU\_USE\_CPU}}
\DoxyCodeLine{00033\ \textcolor{preprocessor}{\#include\ "{}../StarPUUtils/FStarPUCpuWrapper.hpp"{}}}
\DoxyCodeLine{00034\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00035\ \textcolor{preprocessor}{\#ifdef\ SCALFMM\_ENABLE\_CUDA\_KERNEL}}
\DoxyCodeLine{00036\ \textcolor{preprocessor}{\#include\ "{}../StarPUUtils/FStarPUCudaWrapper.hpp"{}}}
\DoxyCodeLine{00037\ \textcolor{preprocessor}{\#include\ "{}../Cuda/FCudaEmptyKernel.hpp"{}}}
\DoxyCodeLine{00038\ \textcolor{preprocessor}{\#include\ "{}../Cuda/FCudaGroupAttachedLeaf.hpp"{}}}
\DoxyCodeLine{00039\ \textcolor{preprocessor}{\#include\ "{}../Cuda/FCudaGroupOfParticles.hpp"{}}}
\DoxyCodeLine{00040\ \textcolor{preprocessor}{\#include\ "{}../Cuda/FCudaGroupOfCells.hpp"{}}}
\DoxyCodeLine{00041\ \textcolor{preprocessor}{\#include\ "{}../Cuda/FCudaEmptyCellSymb.hpp"{}}}
\DoxyCodeLine{00042\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00043\ \textcolor{preprocessor}{\#ifdef\ SCALFMM\_ENABLE\_OPENCL\_KERNEL}}
\DoxyCodeLine{00044\ \textcolor{preprocessor}{\#include\ "{}../StarPUUtils/FStarPUOpenClWrapper.hpp"{}}}
\DoxyCodeLine{00045\ \textcolor{preprocessor}{\#include\ "{}../OpenCl/FOpenCLDeviceWrapper.hpp"{}}}
\DoxyCodeLine{00046\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00047\ }
\DoxyCodeLine{00048\ \textcolor{preprocessor}{\#include\ "{}Containers/FBoolArray.hpp"{}}}
\DoxyCodeLine{00049\ }
\DoxyCodeLine{00050\ \textcolor{keyword}{template}\ <\textcolor{keyword}{class\ }OctreeClass,\ \textcolor{keyword}{class\ }CellContainerClass,\ \textcolor{keyword}{class\ }KernelClass,\ \textcolor{keyword}{class\ }ParticleGroupClass,\ \textcolor{keyword}{class\ }StarPUCpuWrapperClass,\ \textcolor{keyword}{class\ }GroupContainerClass}
\DoxyCodeLine{00051\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \#ifdef\ SCALFMM\_ENABLE\_CUDA\_KERNEL}}
\DoxyCodeLine{00052\ \ \ \ \ \ \ \ \ \ \ ,\ \textcolor{keyword}{class\ }StarPUCudaWrapperClass\ =\ \mbox{\hyperlink{class_f_star_p_u_cuda_wrapper}{FStarPUCudaWrapper<KernelClass,\ FCudaEmptyCellSymb,\ int,\ int,\ FCudaGroupOfCells<FCudaEmptyCellSymb,\ int,\ int>}},}
\DoxyCodeLine{00053\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_f_cuda_group_of_particles}{FCudaGroupOfParticles<int,\ 0,\ 0,\ int>}},\ \mbox{\hyperlink{class_f_cuda_group_attached_leaf}{FCudaGroupAttachedLeaf<int,\ 0,\ 0,\ int>}},\ \mbox{\hyperlink{class_f_cuda_empty_kernel}{FCudaEmptyKernel<int>}}\ >}
\DoxyCodeLine{00054\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \#endif}}
\DoxyCodeLine{00055\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \#ifdef\ SCALFMM\_ENABLE\_OPENCL\_KERNEL}}
\DoxyCodeLine{00056\ \ \ \ \ \ \ \ \ \ \ ,\ \textcolor{keyword}{class\ }StarPUOpenClWrapperClass\ =\ \mbox{\hyperlink{class_f_star_p_u_open_cl_wrapper}{FStarPUOpenClWrapper<KernelClass,\ FOpenCLDeviceWrapper<KernelClass>}}>}
\DoxyCodeLine{00057\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \#endif}}
\DoxyCodeLine{00058\ \ \ \ \ \ \ \ \ \ \ >}
\DoxyCodeLine{00059\ \textcolor{keyword}{class\ }\mbox{\hyperlink{class_f_group_task_star_p_u_algorithm}{FGroupTaskStarPUAlgorithm}}\ :\ \textcolor{keyword}{public}\ \mbox{\hyperlink{class_f_abstract_algorithm}{FAbstractAlgorithm}}\ \{}
\DoxyCodeLine{00060\ \textcolor{keyword}{protected}:}
\DoxyCodeLine{00061\ \ \ \ \ \textcolor{keyword}{typedef}\ \mbox{\hyperlink{class_f_group_task_star_p_u_algorithm}{FGroupTaskStarPUAlgorithm}}<OctreeClass,\ CellContainerClass,\ KernelClass,\ ParticleGroupClass,\ StarPUCpuWrapperClass,\ GroupContainerClass}
\DoxyCodeLine{00062\ \textcolor{preprocessor}{\#ifdef\ SCALFMM\_ENABLE\_CUDA\_KERNEL}}
\DoxyCodeLine{00063\ \ \ \ \ ,\ StarPUCudaWrapperClass}
\DoxyCodeLine{00064\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00065\ \textcolor{preprocessor}{\#ifdef\ SCALFMM\_ENABLE\_OPENCL\_KERNEL}}
\DoxyCodeLine{00066\ \ \ \ \ ,\ StarPUOpenClWrapperClass}
\DoxyCodeLine{00067\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00068\ \ \ \ \ >\ \mbox{\hyperlink{class_f_group_task_star_p_u_algorithm}{ThisClass}};}
\DoxyCodeLine{00069\ }
\DoxyCodeLine{00070\ \ \ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{class}\ OtherBlockClass>}
\DoxyCodeLine{00071\ \ \ \ \ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_f_group_task_star_p_u_algorithm_1_1_block_interactions}{BlockInteractions}}\{}
\DoxyCodeLine{00072\ \ \ \ \ \ \ \ \ OtherBlockClass*\ otherBlock;}
\DoxyCodeLine{00073\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ otherBlockId;}
\DoxyCodeLine{00074\ \ \ \ \ \ \ \ \ std::vector<OutOfBlockInteraction>\ interactions;}
\DoxyCodeLine{00075\ \ \ \ \ \};}
\DoxyCodeLine{00076\ }
\DoxyCodeLine{00077\ \ \ \ \ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_f_group_task_star_p_u_algorithm_1_1_cell_handles}{CellHandles}}\{}
\DoxyCodeLine{00078\ \ \ \ \ \ \ \ \ starpu\_data\_handle\_t\ symb;}
\DoxyCodeLine{00079\ \ \ \ \ \ \ \ \ starpu\_data\_handle\_t\ up;}
\DoxyCodeLine{00080\ \ \ \ \ \ \ \ \ starpu\_data\_handle\_t\ down;}
\DoxyCodeLine{00081\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ intervalSize;}
\DoxyCodeLine{00082\ \ \ \ \ \};}
\DoxyCodeLine{00083\ }
\DoxyCodeLine{00084\ \ \ \ \ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_f_group_task_star_p_u_algorithm_1_1_particle_handles}{ParticleHandles}}\{}
\DoxyCodeLine{00085\ \ \ \ \ \ \ \ \ starpu\_data\_handle\_t\ symb;}
\DoxyCodeLine{00086\ \ \ \ \ \ \ \ \ starpu\_data\_handle\_t\ down;}
\DoxyCodeLine{00087\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ intervalSize;}
\DoxyCodeLine{00088\ \ \ \ \ \};}
\DoxyCodeLine{00089\ }
\DoxyCodeLine{00090\ \ \ \ \ std::vector<\ std::vector<\ std::vector<BlockInteractions<CellContainerClass>>>>\ externalInteractionsAllLevel;}
\DoxyCodeLine{00091\ \ \ \ \ std::vector<\ std::vector<BlockInteractions<ParticleGroupClass>>>\ externalInteractionsLeafLevel;}
\DoxyCodeLine{00092\ }
\DoxyCodeLine{00093\ \ \ \ \ OctreeClass*\textcolor{keyword}{const}\ tree;\ \ \ \ \ \ \ \textcolor{comment}{//<\ The\ Tree}}
\DoxyCodeLine{00094\ \ \ \ \ KernelClass*\textcolor{keyword}{const}\ originalCpuKernel;}
\DoxyCodeLine{00095\ }
\DoxyCodeLine{00096\ \ \ \ \ std::vector<CellHandles>*\ cellHandles;}
\DoxyCodeLine{00097\ \ \ \ \ std::vector<ParticleHandles>\ particleHandles;}
\DoxyCodeLine{00098\ }
\DoxyCodeLine{00099\ \ \ \ \ starpu\_codelet\ p2m\_cl;}
\DoxyCodeLine{00100\ \ \ \ \ starpu\_codelet\ m2m\_cl;}
\DoxyCodeLine{00101\ \ \ \ \ starpu\_codelet\ l2l\_cl;}
\DoxyCodeLine{00102\ \ \ \ \ starpu\_codelet\ l2l\_cl\_nocommute;}
\DoxyCodeLine{00103\ \ \ \ \ starpu\_codelet\ l2p\_cl;}
\DoxyCodeLine{00104\ }
\DoxyCodeLine{00105\ \ \ \ \ starpu\_codelet\ m2l\_cl\_in;}
\DoxyCodeLine{00106\ \ \ \ \ starpu\_codelet\ m2l\_cl\_inout;}
\DoxyCodeLine{00107\ }
\DoxyCodeLine{00108\ \ \ \ \ starpu\_codelet\ p2p\_cl\_in;}
\DoxyCodeLine{00109\ \ \ \ \ starpu\_codelet\ p2p\_cl\_inout;}
\DoxyCodeLine{00110\ }
\DoxyCodeLine{00111\ \textcolor{preprocessor}{\#ifdef\ STARPU\_USE\_REDUX}}
\DoxyCodeLine{00112\ \ \ \ \ starpu\_codelet\ p2p\_redux\_init;}
\DoxyCodeLine{00113\ \ \ \ \ starpu\_codelet\ p2p\_redux\_perform;}
\DoxyCodeLine{00114\ \ \ \ \ starpu\_codelet\ p2p\_redux\_read;}
\DoxyCodeLine{00115\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00116\ }
\DoxyCodeLine{00117\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{bool}\ noCommuteAtLastLevel;}
\DoxyCodeLine{00118\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{bool}\ noCommuteBetweenLevel;}
\DoxyCodeLine{00119\ }
\DoxyCodeLine{00120\ \textcolor{preprocessor}{\#ifdef\ STARPU\_USE\_CPU}}
\DoxyCodeLine{00121\ \ \ \ \ StarPUCpuWrapperClass\ cpuWrapper;}
\DoxyCodeLine{00122\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00123\ \textcolor{preprocessor}{\#ifdef\ SCALFMM\_ENABLE\_CUDA\_KERNEL}}
\DoxyCodeLine{00124\ \ \ \ \ StarPUCudaWrapperClass\ cudaWrapper;}
\DoxyCodeLine{00125\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00126\ \textcolor{preprocessor}{\#ifdef\ SCALFMM\_ENABLE\_OPENCL\_KERNEL}}
\DoxyCodeLine{00127\ \ \ \ \ StarPUOpenClWrapperClass\ openclWrapper;}
\DoxyCodeLine{00128\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00129\ }
\DoxyCodeLine{00130\ \ \ \ \ \mbox{\hyperlink{class_f_star_p_u_ptr_interface}{FStarPUPtrInterface}}\ wrappers;}
\DoxyCodeLine{00131\ \ \ \ \ \mbox{\hyperlink{class_f_star_p_u_ptr_interface}{FStarPUPtrInterface}}*\ wrapperptr;}
\DoxyCodeLine{00132\ }
\DoxyCodeLine{00133\ \textcolor{preprocessor}{\#ifdef\ STARPU\_SUPPORT\_ARBITER}}
\DoxyCodeLine{00134\ \ \ \ \ starpu\_arbiter\_t\ arbiterGlobal;}
\DoxyCodeLine{00135\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00136\ }
\DoxyCodeLine{00137\ \textcolor{preprocessor}{\#ifdef\ STARPU\_USE\_TASK\_NAME}}
\DoxyCodeLine{00138\ \ \ \ \ std::vector<std::unique\_ptr<char[]>>\ m2mTaskNames;}
\DoxyCodeLine{00139\ \ \ \ \ std::vector<std::unique\_ptr<char[]>>\ m2lTaskNames;}
\DoxyCodeLine{00140\ \ \ \ \ std::vector<std::unique\_ptr<char[]>>\ m2lOuterTaskNames;}
\DoxyCodeLine{00141\ \ \ \ \ std::vector<std::unique\_ptr<char[]>>\ l2lTaskNames;}
\DoxyCodeLine{00142\ \ \ \ \ std::unique\_ptr<char[]>\ p2mTaskNames;}
\DoxyCodeLine{00143\ \ \ \ \ std::unique\_ptr<char[]>\ l2pTaskNames;}
\DoxyCodeLine{00144\ \ \ \ \ std::unique\_ptr<char[]>\ p2pTaskNames;}
\DoxyCodeLine{00145\ \ \ \ \ std::unique\_ptr<char[]>\ p2pOuterTaskNames;}
\DoxyCodeLine{00146\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00147\ \textcolor{preprocessor}{\#ifdef\ SCALFMM\_STARPU\_USE\_PRIO}}
\DoxyCodeLine{00148\ \ \ \ \ \textcolor{keyword}{typedef}\ FStarPUFmmPrioritiesV2\ PrioClass;\textcolor{comment}{//\ FStarPUFmmPriorities}}
\DoxyCodeLine{00149\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00150\ }
\DoxyCodeLine{00151\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00152\ \ \ \ \ \mbox{\hyperlink{class_f_group_task_star_p_u_algorithm}{FGroupTaskStarPUAlgorithm}}(OctreeClass*\textcolor{keyword}{const}\ inTree,\ KernelClass*\ inKernels)}
\DoxyCodeLine{00153\ \ \ \ \ \ \ \ \ :\ tree(inTree),\ originalCpuKernel(inKernels),}
\DoxyCodeLine{00154\ \ \ \ \ \ \ \ \ \ \ cellHandles(nullptr),\ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00155\ \ \ \ \ \ \ \ \ \ \ noCommuteAtLastLevel(FEnv::GetBool(\textcolor{stringliteral}{"{}SCALFMM\_NO\_COMMUTE\_LAST\_L2L"{}},\ true)),}
\DoxyCodeLine{00156\ \ \ \ \ \ \ \ \ \ \ noCommuteBetweenLevel(FEnv::GetBool(\textcolor{stringliteral}{"{}SCALFMM\_NO\_COMMUTE\_M2L\_L2L"{}},\ false)),}
\DoxyCodeLine{00157\ \ \ \ \ \ \ \#ifdef\ STARPU\_USE\_CPU}
\DoxyCodeLine{00158\ \ \ \ \ \ \ \ \ \ \ cpuWrapper(tree-\/>getHeight()),}
\DoxyCodeLine{00159\ \ \ \ \ \ \ \#endif}
\DoxyCodeLine{00160\ \ \ \ \ \ \ \#ifdef\ SCALFMM\_ENABLE\_CUDA\_KERNEL}
\DoxyCodeLine{00161\ \ \ \ \ \ \ \ \ \ \ cudaWrapper(tree-\/>getHeight()),}
\DoxyCodeLine{00162\ \ \ \ \ \ \ \#endif}
\DoxyCodeLine{00163\ \ \ \ \ \ \ \#ifdef\ SCALFMM\_ENABLE\_OPENCL\_KERNEL}
\DoxyCodeLine{00164\ \ \ \ \ \ \ \ \ \ \ openclWrapper(tree-\/>getHeight()),}
\DoxyCodeLine{00165\ \ \ \ \ \ \ \#endif}
\DoxyCodeLine{00166\ \ \ \ \ \ \ \ \ \ \ wrapperptr(\&wrappers)\{}
\DoxyCodeLine{00167\ \ \ \ \ \ \ \ \ FAssertLF(tree,\ \textcolor{stringliteral}{"{}tree\ cannot\ be\ null"{}});}
\DoxyCodeLine{00168\ \ \ \ \ \ \ \ \ FAssertLF(inKernels,\ \textcolor{stringliteral}{"{}kernels\ cannot\ be\ null"{}});}
\DoxyCodeLine{00169\ }
\DoxyCodeLine{00170\ \ \ \ \ \ \ \ \ FAbstractAlgorithm::setNbLevelsInTree(tree-\/>getHeight());}
\DoxyCodeLine{00171\ }
\DoxyCodeLine{00172\ \ \ \ \ \ \ \ \ \textcolor{keyword}{struct\ }starpu\_conf\ conf;}
\DoxyCodeLine{00173\ \ \ \ \ \ \ \ \ FAssertLF(starpu\_conf\_init(\&conf)\ ==\ 0);}
\DoxyCodeLine{00174\ \textcolor{preprocessor}{\#ifdef\ SCALFMM\_STARPU\_USE\_PRIO}}
\DoxyCodeLine{00175\ \ \ \ \ \ \ \ \ PrioClass::Controller().init(\&conf,\ tree-\/>getHeight(),\ inKernels);}
\DoxyCodeLine{00176\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00177\ \ \ \ \ \ \ \ \ FAssertLF(starpu\_init(\&conf)\ ==\ 0);}
\DoxyCodeLine{00178\ }
\DoxyCodeLine{00179\ \ \ \ \ \ \ \ \ starpu\_malloc\_set\_align(32);}
\DoxyCodeLine{00180\ }
\DoxyCodeLine{00181\ \ \ \ \ \ \ \ \ starpu\_pthread\_mutex\_t\ initMutex;}
\DoxyCodeLine{00182\ \ \ \ \ \ \ \ \ starpu\_pthread\_mutex\_init(\&initMutex,\ NULL);}
\DoxyCodeLine{00183\ \textcolor{preprocessor}{\#ifdef\ STARPU\_USE\_CPU}}
\DoxyCodeLine{00184\ \ \ \ \ \ \ \ \ FStarPUUtils::ExecOnWorkers(STARPU\_CPU,\ [\&]()\{}
\DoxyCodeLine{00185\ \ \ \ \ \ \ \ \ \ \ \ \ starpu\_pthread\_mutex\_lock(\&initMutex);}
\DoxyCodeLine{00186\ \ \ \ \ \ \ \ \ \ \ \ \ cpuWrapper.initKernel(starpu\_worker\_get\_id(),\ inKernels);}
\DoxyCodeLine{00187\ \ \ \ \ \ \ \ \ \ \ \ \ starpu\_pthread\_mutex\_unlock(\&initMutex);}
\DoxyCodeLine{00188\ \ \ \ \ \ \ \ \ \});}
\DoxyCodeLine{00189\ \ \ \ \ \ \ \ \ wrappers.set(FSTARPU\_CPU\_IDX,\ \&cpuWrapper);}
\DoxyCodeLine{00190\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00191\ \textcolor{preprocessor}{\#ifdef\ SCALFMM\_ENABLE\_CUDA\_KERNEL}}
\DoxyCodeLine{00192\ \ \ \ \ \ \ \ \ FStarPUUtils::ExecOnWorkers(STARPU\_CUDA,\ [\&]()\{}
\DoxyCodeLine{00193\ \ \ \ \ \ \ \ \ \ \ \ \ starpu\_pthread\_mutex\_lock(\&initMutex);}
\DoxyCodeLine{00194\ \ \ \ \ \ \ \ \ \ \ \ \ cudaWrapper.initKernel(starpu\_worker\_get\_id(),\ inKernels);}
\DoxyCodeLine{00195\ \ \ \ \ \ \ \ \ \ \ \ \ starpu\_pthread\_mutex\_unlock(\&initMutex);}
\DoxyCodeLine{00196\ \ \ \ \ \ \ \ \ \});}
\DoxyCodeLine{00197\ \ \ \ \ \ \ \ \ wrappers.set(FSTARPU\_CUDA\_IDX,\ \&cudaWrapper);}
\DoxyCodeLine{00198\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00199\ \textcolor{preprocessor}{\#ifdef\ SCALFMM\_ENABLE\_OPENCL\_KERNEL}}
\DoxyCodeLine{00200\ \ \ \ \ \ \ \ \ FStarPUUtils::ExecOnWorkers(STARPU\_OPENCL,\ [\&]()\{}
\DoxyCodeLine{00201\ \ \ \ \ \ \ \ \ \ \ \ \ starpu\_pthread\_mutex\_lock(\&initMutex);}
\DoxyCodeLine{00202\ \ \ \ \ \ \ \ \ \ \ \ \ openclWrapper.initKernel(starpu\_worker\_get\_id(),\ inKernels);}
\DoxyCodeLine{00203\ \ \ \ \ \ \ \ \ \ \ \ \ starpu\_pthread\_mutex\_unlock(\&initMutex);}
\DoxyCodeLine{00204\ \ \ \ \ \ \ \ \ \});}
\DoxyCodeLine{00205\ \ \ \ \ \ \ \ \ wrappers.set(FSTARPU\_OPENCL\_IDX,\ \&openclWrapper);}
\DoxyCodeLine{00206\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00207\ \ \ \ \ \ \ \ \ starpu\_pthread\_mutex\_destroy(\&initMutex);}
\DoxyCodeLine{00208\ }
\DoxyCodeLine{00209\ \ \ \ \ \ \ \ \ starpu\_pause();}
\DoxyCodeLine{00210\ }
\DoxyCodeLine{00211\ \ \ \ \ \ \ \ \ cellHandles\ \ \ =\ \textcolor{keyword}{new}\ std::vector<CellHandles>[tree-\/>getHeight()];}
\DoxyCodeLine{00212\ }
\DoxyCodeLine{00213\ \textcolor{preprocessor}{\#ifdef\ STARPU\_SUPPORT\_ARBITER}}
\DoxyCodeLine{00214\ \ \ \ \ \ \ \ \ arbiterGlobal\ =\ starpu\_arbiter\_create();}
\DoxyCodeLine{00215\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00216\ }
\DoxyCodeLine{00217\ \ \ \ \ \ \ \ \ initCodelet();}
\DoxyCodeLine{00218\ \ \ \ \ \ \ \ \ rebuildInteractions();}
\DoxyCodeLine{00219\ }
\DoxyCodeLine{00220\ \ \ \ \ \ \ \ \ FLOG(FLog::Controller\ <<\ \textcolor{stringliteral}{"{}FGroupTaskStarPUAlgorithm\ (Max\ Worker\ "{}}\ <<\ starpu\_worker\_get\_count()\ <<\ \textcolor{stringliteral}{"{})\(\backslash\)n"{}});}
\DoxyCodeLine{00221\ \textcolor{preprocessor}{\#ifdef\ STARPU\_USE\_CPU}}
\DoxyCodeLine{00222\ \ \ \ \ \ \ \ \ FLOG(FLog::Controller\ <<\ \textcolor{stringliteral}{"{}FGroupTaskStarPUAlgorithm\ (Max\ CPU\ "{}}\ <<\ starpu\_cpu\_worker\_get\_count()\ <<\ \textcolor{stringliteral}{"{})\(\backslash\)n"{}});}
\DoxyCodeLine{00223\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00224\ \textcolor{preprocessor}{\#ifdef\ SCALFMM\_ENABLE\_OPENCL\_KERNEL}}
\DoxyCodeLine{00225\ \ \ \ \ \ \ \ \ FLOG(FLog::Controller\ <<\ \textcolor{stringliteral}{"{}FGroupTaskStarPUAlgorithm\ (Max\ OpenCL\ "{}}\ <<\ starpu\_opencl\_worker\_get\_count()\ <<\ \textcolor{stringliteral}{"{})\(\backslash\)n"{}});}
\DoxyCodeLine{00226\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00227\ \textcolor{preprocessor}{\#ifdef\ SCALFMM\_ENABLE\_CUDA\_KERNEL}}
\DoxyCodeLine{00228\ \ \ \ \ \ \ \ \ FLOG(FLog::Controller\ <<\ \textcolor{stringliteral}{"{}FGroupTaskStarPUAlgorithm\ (Max\ CUDA\ "{}}\ <<\ starpu\_cuda\_worker\_get\_count()\ <<\ \textcolor{stringliteral}{"{})\(\backslash\)n"{}});}
\DoxyCodeLine{00229\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00230\ \ \ \ \ \ \ \ \ FLOG(FLog::Controller\ <<\ \textcolor{stringliteral}{"{}SCALFMM\_NO\_COMMUTE\_LAST\_L2L\ "{}}\ <<\ noCommuteAtLastLevel\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{00231\ \ \ \ \ \ \ \ \ FLOG(FLog::Controller\ <<\ \textcolor{stringliteral}{"{}SCALFMM\_NO\_COMMUTE\_M2L\_L2L\ "{}}\ <<\ noCommuteBetweenLevel\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{00232\ }
\DoxyCodeLine{00233\ \ \ \ \ \ \ \ \ buildTaskNames();}
\DoxyCodeLine{00234\ \ \ \ \ \}}
\DoxyCodeLine{00235\ }
\DoxyCodeLine{00236\ \ \ \ \ \textcolor{keywordtype}{void}\ buildTaskNames()\{}
\DoxyCodeLine{00237\ \textcolor{preprocessor}{\#ifdef\ STARPU\_USE\_TASK\_NAME}}
\DoxyCodeLine{00238\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ namesLength\ =\ 128;}
\DoxyCodeLine{00239\ \ \ \ \ \ \ \ \ m2mTaskNames.resize(tree-\/>getHeight());}
\DoxyCodeLine{00240\ \ \ \ \ \ \ \ \ m2lTaskNames.resize(tree-\/>getHeight());}
\DoxyCodeLine{00241\ \ \ \ \ \ \ \ \ m2lOuterTaskNames.resize(tree-\/>getHeight());}
\DoxyCodeLine{00242\ \ \ \ \ \ \ \ \ l2lTaskNames.resize(tree-\/>getHeight());}
\DoxyCodeLine{00243\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ idxLevel\ =\ 0\ ;\ idxLevel\ <\ tree-\/>getHeight()\ ;\ ++idxLevel)\{}
\DoxyCodeLine{00244\ \ \ \ \ \ \ \ \ \ \ \ \ m2mTaskNames[idxLevel].reset(\textcolor{keyword}{new}\ \textcolor{keywordtype}{char}[namesLength]);}
\DoxyCodeLine{00245\ \ \ \ \ \ \ \ \ \ \ \ \ snprintf(m2mTaskNames[idxLevel].get(),\ namesLength,\ \textcolor{stringliteral}{"{}M2M-\/level-\/\%d"{}},\ idxLevel);}
\DoxyCodeLine{00246\ \ \ \ \ \ \ \ \ \ \ \ \ m2lTaskNames[idxLevel].reset(\textcolor{keyword}{new}\ \textcolor{keywordtype}{char}[namesLength]);}
\DoxyCodeLine{00247\ \ \ \ \ \ \ \ \ \ \ \ \ snprintf(m2lTaskNames[idxLevel].get(),\ namesLength,\ \textcolor{stringliteral}{"{}M2L-\/level-\/\%d"{}},\ idxLevel);}
\DoxyCodeLine{00248\ \ \ \ \ \ \ \ \ \ \ \ \ m2lOuterTaskNames[idxLevel].reset(\textcolor{keyword}{new}\ \textcolor{keywordtype}{char}[namesLength]);}
\DoxyCodeLine{00249\ \ \ \ \ \ \ \ \ \ \ \ \ snprintf(m2lOuterTaskNames[idxLevel].get(),\ namesLength,\ \textcolor{stringliteral}{"{}M2L-\/out-\/level-\/\%d"{}},\ idxLevel);}
\DoxyCodeLine{00250\ \ \ \ \ \ \ \ \ \ \ \ \ l2lTaskNames[idxLevel].reset(\textcolor{keyword}{new}\ \textcolor{keywordtype}{char}[namesLength]);}
\DoxyCodeLine{00251\ \ \ \ \ \ \ \ \ \ \ \ \ snprintf(l2lTaskNames[idxLevel].get(),\ namesLength,\ \textcolor{stringliteral}{"{}L2L-\/level-\/\%d"{}},\ idxLevel);}
\DoxyCodeLine{00252\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00253\ }
\DoxyCodeLine{00254\ \ \ \ \ \ \ \ \ p2mTaskNames.reset(\textcolor{keyword}{new}\ \textcolor{keywordtype}{char}[namesLength]);}
\DoxyCodeLine{00255\ \ \ \ \ \ \ \ \ snprintf(p2mTaskNames.get(),\ namesLength,\ \textcolor{stringliteral}{"{}P2M"{}});}
\DoxyCodeLine{00256\ \ \ \ \ \ \ \ \ l2pTaskNames.reset(\textcolor{keyword}{new}\ \textcolor{keywordtype}{char}[namesLength]);}
\DoxyCodeLine{00257\ \ \ \ \ \ \ \ \ snprintf(l2pTaskNames.get(),\ namesLength,\ \textcolor{stringliteral}{"{}L2P"{}});}
\DoxyCodeLine{00258\ \ \ \ \ \ \ \ \ p2pTaskNames.reset(\textcolor{keyword}{new}\ \textcolor{keywordtype}{char}[namesLength]);}
\DoxyCodeLine{00259\ \ \ \ \ \ \ \ \ snprintf(p2pTaskNames.get(),\ namesLength,\ \textcolor{stringliteral}{"{}P2P"{}});}
\DoxyCodeLine{00260\ \ \ \ \ \ \ \ \ p2pOuterTaskNames.reset(\textcolor{keyword}{new}\ \textcolor{keywordtype}{char}[namesLength]);}
\DoxyCodeLine{00261\ \ \ \ \ \ \ \ \ snprintf(p2pOuterTaskNames.get(),\ namesLength,\ \textcolor{stringliteral}{"{}P2P-\/out"{}});}
\DoxyCodeLine{00262\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00263\ \ \ \ \ \}}
\DoxyCodeLine{00264\ }
\DoxyCodeLine{00265\ \ \ \ \ \textcolor{keywordtype}{void}\ syncData()\{}
\DoxyCodeLine{00266\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ idxLevel\ =\ 0\ ;\ idxLevel\ <\ tree-\/>getHeight()\ ;\ ++idxLevel)\{}
\DoxyCodeLine{00267\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ idxHandle\ =\ 0\ ;\ idxHandle\ <\ int(cellHandles[idxLevel].size())\ ;\ ++idxHandle)\{}
\DoxyCodeLine{00268\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ starpu\_data\_acquire(cellHandles[idxLevel][idxHandle].symb,\ STARPU\_R);}
\DoxyCodeLine{00269\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ starpu\_data\_release(cellHandles[idxLevel][idxHandle].symb);}
\DoxyCodeLine{00270\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ starpu\_data\_acquire(cellHandles[idxLevel][idxHandle].up,\ STARPU\_R);}
\DoxyCodeLine{00271\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ starpu\_data\_release(cellHandles[idxLevel][idxHandle].up);}
\DoxyCodeLine{00272\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ starpu\_data\_acquire(cellHandles[idxLevel][idxHandle].down,\ STARPU\_R);}
\DoxyCodeLine{00273\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ starpu\_data\_release(cellHandles[idxLevel][idxHandle].down);}
\DoxyCodeLine{00274\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00275\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00276\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00277\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ idxHandle\ =\ 0\ ;\ idxHandle\ <\ int(particleHandles.size())\ ;\ ++idxHandle)\{}
\DoxyCodeLine{00278\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ starpu\_data\_acquire(particleHandles[idxHandle].symb,\ STARPU\_R);}
\DoxyCodeLine{00279\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ starpu\_data\_release(particleHandles[idxHandle].symb);}
\DoxyCodeLine{00280\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ starpu\_data\_acquire(particleHandles[idxHandle].down,\ STARPU\_R);}
\DoxyCodeLine{00281\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ starpu\_data\_release(particleHandles[idxHandle].down);}
\DoxyCodeLine{00282\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00283\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00284\ \ \ \ \ \}}
\DoxyCodeLine{00285\ }
\DoxyCodeLine{00286\ \ \ \ \ \mbox{\hyperlink{class_f_group_task_star_p_u_algorithm}{\string~FGroupTaskStarPUAlgorithm}}()\{}
\DoxyCodeLine{00287\ \ \ \ \ \ \ \ \ starpu\_resume();}
\DoxyCodeLine{00288\ }
\DoxyCodeLine{00289\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_f_group_task_star_p_u_algorithm_a18d2e3d7f77bd86ca36215eb0b6cb875}{cleanHandle}}();}
\DoxyCodeLine{00290\ \ \ \ \ \ \ \ \ \textcolor{keyword}{delete}[]\ cellHandles;}
\DoxyCodeLine{00291\ }
\DoxyCodeLine{00292\ \ \ \ \ \ \ \ \ starpu\_pthread\_mutex\_t\ releaseMutex;}
\DoxyCodeLine{00293\ \ \ \ \ \ \ \ \ starpu\_pthread\_mutex\_init(\&releaseMutex,\ NULL);}
\DoxyCodeLine{00294\ \textcolor{preprocessor}{\#ifdef\ STARPU\_USE\_CPU}}
\DoxyCodeLine{00295\ \ \ \ \ \ \ \ \ FStarPUUtils::ExecOnWorkers(STARPU\_CPU,\ [\&]()\{}
\DoxyCodeLine{00296\ \ \ \ \ \ \ \ \ \ \ \ \ starpu\_pthread\_mutex\_lock(\&releaseMutex);}
\DoxyCodeLine{00297\ \ \ \ \ \ \ \ \ \ \ \ \ cpuWrapper.releaseKernel(starpu\_worker\_get\_id());}
\DoxyCodeLine{00298\ \ \ \ \ \ \ \ \ \ \ \ \ starpu\_pthread\_mutex\_unlock(\&releaseMutex);}
\DoxyCodeLine{00299\ \ \ \ \ \ \ \ \ \});}
\DoxyCodeLine{00300\ \ \ \ \ \ \ \ \ wrappers.set(FSTARPU\_CPU\_IDX,\ \&cpuWrapper);}
\DoxyCodeLine{00301\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00302\ \textcolor{preprocessor}{\#ifdef\ SCALFMM\_ENABLE\_CUDA\_KERNEL}}
\DoxyCodeLine{00303\ \ \ \ \ \ \ \ \ FStarPUUtils::ExecOnWorkers(STARPU\_CUDA,\ [\&]()\{}
\DoxyCodeLine{00304\ \ \ \ \ \ \ \ \ \ \ \ \ starpu\_pthread\_mutex\_lock(\&releaseMutex);}
\DoxyCodeLine{00305\ \ \ \ \ \ \ \ \ \ \ \ \ cudaWrapper.releaseKernel(starpu\_worker\_get\_id());}
\DoxyCodeLine{00306\ \ \ \ \ \ \ \ \ \ \ \ \ starpu\_pthread\_mutex\_unlock(\&releaseMutex);}
\DoxyCodeLine{00307\ \ \ \ \ \ \ \ \ \});}
\DoxyCodeLine{00308\ \ \ \ \ \ \ \ \ wrappers.set(FSTARPU\_CUDA\_IDX,\ \&cudaWrapper);}
\DoxyCodeLine{00309\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00310\ \textcolor{preprocessor}{\#ifdef\ SCALFMM\_ENABLE\_OPENCL\_KERNEL}}
\DoxyCodeLine{00311\ \ \ \ \ \ \ \ \ FStarPUUtils::ExecOnWorkers(STARPU\_OPENCL,\ [\&]()\{}
\DoxyCodeLine{00312\ \ \ \ \ \ \ \ \ \ \ \ \ starpu\_pthread\_mutex\_lock(\&releaseMutex);}
\DoxyCodeLine{00313\ \ \ \ \ \ \ \ \ \ \ \ \ openclWrapper.releaseKernel(starpu\_worker\_get\_id());}
\DoxyCodeLine{00314\ \ \ \ \ \ \ \ \ \ \ \ \ starpu\_pthread\_mutex\_unlock(\&releaseMutex);}
\DoxyCodeLine{00315\ \ \ \ \ \ \ \ \ \});}
\DoxyCodeLine{00316\ \ \ \ \ \ \ \ \ wrappers.set(FSTARPU\_OPENCL\_IDX,\ \&openclWrapper);}
\DoxyCodeLine{00317\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00318\ \ \ \ \ \ \ \ \ starpu\_pthread\_mutex\_destroy(\&releaseMutex);}
\DoxyCodeLine{00319\ }
\DoxyCodeLine{00320\ }
\DoxyCodeLine{00321\ \textcolor{preprocessor}{\#ifdef\ STARPU\_SUPPORT\_ARBITER}}
\DoxyCodeLine{00322\ \ \ \ \ \ \ \ \ starpu\_arbiter\_destroy(arbiterGlobal);}
\DoxyCodeLine{00323\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00324\ }
\DoxyCodeLine{00325\ \ \ \ \ \ \ \ \ starpu\_shutdown();}
\DoxyCodeLine{00326\ \ \ \ \ \}}
\DoxyCodeLine{00327\ }
\DoxyCodeLine{00328\ \ \ \ \ \textcolor{keywordtype}{void}\ rebuildInteractions()\{}
\DoxyCodeLine{00329\ \ \ \ \ \ \ \ \ FAssertLF(getenv(\textcolor{stringliteral}{"{}OMP\_WAIT\_POLICY"{}})\ ==\ \textcolor{keyword}{nullptr}}
\DoxyCodeLine{00330\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ||\ strcmp(getenv(\textcolor{stringliteral}{"{}OMP\_WAIT\_POLICY"{}}),\ \textcolor{stringliteral}{"{}PASSIVE"{}})\ ==\ 0}
\DoxyCodeLine{00331\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ||\ strcmp(getenv(\textcolor{stringliteral}{"{}OMP\_WAIT\_POLICY"{}}),\ \textcolor{stringliteral}{"{}passive"{}})\ ==\ 0);}
\DoxyCodeLine{00332\ }
\DoxyCodeLine{00333\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \#pragma\ omp\ parallel}}
\DoxyCodeLine{00334\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \#pragma\ omp\ single}}
\DoxyCodeLine{00335\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_f_group_task_star_p_u_algorithm_ac176711c0d4154af9c5dd905e69ba86f}{buildExternalInteractionVecs}}();}
\DoxyCodeLine{00336\ }
\DoxyCodeLine{00337\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_f_group_task_star_p_u_algorithm_aa4b5b6461001f3af07447ff9ecad8c5d}{buildHandles}}();}
\DoxyCodeLine{00338\ \ \ \ \ \}}
\DoxyCodeLine{00339\ }
\DoxyCodeLine{00340\ }
\DoxyCodeLine{00341\ \textcolor{preprocessor}{\#ifdef\ STARPU\_USE\_CPU}}
\DoxyCodeLine{00342\ \ \ \ \ \textcolor{keywordtype}{void}\ forEachCpuWorker(std::function<\textcolor{keywordtype}{void}(\textcolor{keywordtype}{void})>\ func)\{}
\DoxyCodeLine{00343\ \ \ \ \ \ \ \ \ starpu\_resume();}
\DoxyCodeLine{00344\ \ \ \ \ \ \ \ \ FStarPUUtils::ExecOnWorkers(STARPU\_CPU,\ func);}
\DoxyCodeLine{00345\ \ \ \ \ \ \ \ \ starpu\_pause();}
\DoxyCodeLine{00346\ \ \ \ \ \}}
\DoxyCodeLine{00347\ }
\DoxyCodeLine{00348\ \ \ \ \ \textcolor{keywordtype}{void}\ forEachCpuWorker(std::function<\textcolor{keywordtype}{void}(KernelClass*)>\ func)\{}
\DoxyCodeLine{00349\ \ \ \ \ \ \ \ \ starpu\_resume();}
\DoxyCodeLine{00350\ \ \ \ \ \ \ \ \ FStarPUUtils::ExecOnWorkers(STARPU\_CPU,\ [\&]()\{}
\DoxyCodeLine{00351\ \ \ \ \ \ \ \ \ \ \ \ \ func(cpuWrapper.getKernel(starpu\_worker\_get\_id()));}
\DoxyCodeLine{00352\ \ \ \ \ \ \ \ \ \});}
\DoxyCodeLine{00353\ \ \ \ \ \ \ \ \ starpu\_pause();}
\DoxyCodeLine{00354\ \ \ \ \ \}}
\DoxyCodeLine{00355\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00356\ \textcolor{preprocessor}{\#ifdef\ SCALFMM\_ENABLE\_CUDA\_KERNEL}}
\DoxyCodeLine{00357\ \ \ \ \ \textcolor{keywordtype}{void}\ forEachCudaWorker(std::function<\textcolor{keywordtype}{void}(\textcolor{keywordtype}{void})>\ func)\{}
\DoxyCodeLine{00358\ \ \ \ \ \ \ \ \ starpu\_resume();}
\DoxyCodeLine{00359\ \ \ \ \ \ \ \ \ FStarPUUtils::ExecOnWorkers(STARPU\_CUDA,\ func);}
\DoxyCodeLine{00360\ \ \ \ \ \ \ \ \ starpu\_pause();}
\DoxyCodeLine{00361\ \ \ \ \ \}}
\DoxyCodeLine{00362\ \ \ \ \ \textcolor{keywordtype}{void}\ forEachCudaWorker(std::function<\textcolor{keywordtype}{void}(\textcolor{keywordtype}{void}*)>\ func)\{}
\DoxyCodeLine{00363\ \ \ \ \ \ \ \ \ starpu\_resume();}
\DoxyCodeLine{00364\ \ \ \ \ \ \ \ \ FStarPUUtils::ExecOnWorkers(STARPU\_CUDA,\ [\&]()\{}
\DoxyCodeLine{00365\ \ \ \ \ \ \ \ \ \ \ \ \ func(cudaWrapper.getKernel(starpu\_worker\_get\_id()));}
\DoxyCodeLine{00366\ \ \ \ \ \ \ \ \ \});}
\DoxyCodeLine{00367\ \ \ \ \ \ \ \ \ starpu\_pause();}
\DoxyCodeLine{00368\ \ \ \ \ \}}
\DoxyCodeLine{00369\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00370\ \textcolor{preprocessor}{\#ifdef\ SCALFMM\_ENABLE\_OPENCL\_KERNEL}}
\DoxyCodeLine{00371\ \ \ \ \ \textcolor{keywordtype}{void}\ forEachOpenCLWorker(std::function<\textcolor{keywordtype}{void}(\textcolor{keywordtype}{void})>\ func)\{}
\DoxyCodeLine{00372\ \ \ \ \ \ \ \ \ starpu\_resume();}
\DoxyCodeLine{00373\ \ \ \ \ \ \ \ \ FStarPUUtils::ExecOnWorkers(STARPU\_OPENCL,\ func);}
\DoxyCodeLine{00374\ \ \ \ \ \ \ \ \ starpu\_pause();}
\DoxyCodeLine{00375\ \ \ \ \ \}}
\DoxyCodeLine{00376\ \ \ \ \ \textcolor{keywordtype}{void}\ forEachOpenCLWorker(std::function<\textcolor{keywordtype}{void}(\textcolor{keywordtype}{void}*)>\ func)\{}
\DoxyCodeLine{00377\ \ \ \ \ \ \ \ \ starpu\_resume();}
\DoxyCodeLine{00378\ \ \ \ \ \ \ \ \ FStarPUUtils::ExecOnWorkers(STARPU\_OPENCL,\ [\&]()\{}
\DoxyCodeLine{00379\ \ \ \ \ \ \ \ \ \ \ \ \ func(openclWrapper.getKernel(starpu\_worker\_get\_id()));}
\DoxyCodeLine{00380\ \ \ \ \ \ \ \ \ \});}
\DoxyCodeLine{00381\ \ \ \ \ \ \ \ \ starpu\_pause();}
\DoxyCodeLine{00382\ \ \ \ \ \}}
\DoxyCodeLine{00383\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00384\ }
\DoxyCodeLine{00385\ \textcolor{keyword}{protected}:}
\DoxyCodeLine{00389\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_f_group_task_star_p_u_algorithm_a2f1de612bd9b981e6eb15f5a782fa183}{executeCore}}(\textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ operationsToProceed)\textcolor{keyword}{\ override\ }\{}
\DoxyCodeLine{00390\ \ \ \ \ \ \ \ \ FLOG(\ FLog::Controller\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)tStart\ FGroupTaskStarPUAlgorithm\(\backslash\)n"{}}\ );}
\DoxyCodeLine{00391\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{bool}\ directOnly\ =\ (tree-\/>getHeight()\ <=\ 2);}
\DoxyCodeLine{00392\ }
\DoxyCodeLine{00393\ \textcolor{preprocessor}{\#ifdef\ STARPU\_USE\_CPU}}
\DoxyCodeLine{00394\ \ \ \ \ \ \ \ \ FTIME\_TASKS(cpuWrapper.taskTimeRecorder.start());}
\DoxyCodeLine{00395\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00396\ }
\DoxyCodeLine{00397\ \ \ \ \ \ \ \ \ starpu\_resume();}
\DoxyCodeLine{00398\ \ \ \ \ \ \ \ \ FLOG(\ \mbox{\hyperlink{class_f_tic}{FTic}}\ timerSoumission;\ );}
\DoxyCodeLine{00399\ }
\DoxyCodeLine{00400\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\ operationsToProceed\ \&\ FFmmP2P\ )\ \mbox{\hyperlink{class_f_group_task_star_p_u_algorithm_a268a77fbbd6d99c8ed48d2c795bb3273}{directPass}}();}
\DoxyCodeLine{00401\ }
\DoxyCodeLine{00402\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(operationsToProceed\ \&\ FFmmP2M\ \&\&\ !directOnly)\ \mbox{\hyperlink{class_f_group_task_star_p_u_algorithm_a232654dd8053610f2188bd7c0bbce091}{bottomPass}}();}
\DoxyCodeLine{00403\ }
\DoxyCodeLine{00404\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(operationsToProceed\ \&\ FFmmM2M\ \&\&\ !directOnly)\ \mbox{\hyperlink{class_f_group_task_star_p_u_algorithm_af45e860f3213015f3792c7402a02694d}{upwardPass}}();}
\DoxyCodeLine{00405\ }
\DoxyCodeLine{00406\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(operationsToProceed\ \&\ FFmmM2L\ \&\&\ !directOnly)\ \mbox{\hyperlink{class_f_group_task_star_p_u_algorithm_a718175b27bcb9009dea5a681f621e265}{transferPass}}(\mbox{\hyperlink{class_f_abstract_algorithm_ade49cb5ede82d078261e576a9d809dc2}{FAbstractAlgorithm::upperWorkingLevel}},\ \mbox{\hyperlink{class_f_abstract_algorithm_a694b8888186be58e38691ce08b177d46}{FAbstractAlgorithm::lowerWorkingLevel}}-\/1\ ,\ \textcolor{keyword}{true},\ \textcolor{keyword}{true});}
\DoxyCodeLine{00407\ }
\DoxyCodeLine{00408\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(operationsToProceed\ \&\ FFmmL2L\ \&\&\ !directOnly)\ \mbox{\hyperlink{class_f_group_task_star_p_u_algorithm_ab46d2c06fc74876926c03d010106bc8d}{downardPass}}();}
\DoxyCodeLine{00409\ }
\DoxyCodeLine{00410\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(operationsToProceed\ \&\ FFmmM2L\ \&\&\ !directOnly)\ \mbox{\hyperlink{class_f_group_task_star_p_u_algorithm_a718175b27bcb9009dea5a681f621e265}{transferPass}}(\mbox{\hyperlink{class_f_abstract_algorithm_a694b8888186be58e38691ce08b177d46}{FAbstractAlgorithm::lowerWorkingLevel}}-\/1,\ \mbox{\hyperlink{class_f_abstract_algorithm_a694b8888186be58e38691ce08b177d46}{FAbstractAlgorithm::lowerWorkingLevel}},\ \textcolor{keyword}{true},\ \textcolor{keyword}{true});}
\DoxyCodeLine{00411\ }
\DoxyCodeLine{00412\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\ operationsToProceed\ \&\ FFmmL2P\ \&\&\ !directOnly)\ \mbox{\hyperlink{class_f_group_task_star_p_u_algorithm_a498943f7344334509a7e6b98ddfdc7e1}{mergePass}}();}
\DoxyCodeLine{00413\ \textcolor{preprocessor}{\#ifdef\ STARPU\_USE\_REDUX}}
\DoxyCodeLine{00414\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\ operationsToProceed\ \&\ FFmmL2P\ \&\&\ !directOnly)\ readParticle();}
\DoxyCodeLine{00415\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00416\ }
\DoxyCodeLine{00417\ \ \ \ \ \ \ \ \ FLOG(\ FLog::Controller\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)t\(\backslash\)t\ Submitting\ the\ tasks\ took\ "{}}\ <<\ timerSoumission.tacAndElapsed()\ <<\ \textcolor{stringliteral}{"{}s\(\backslash\)n"{}}\ );}
\DoxyCodeLine{00418\ \ \ \ \ \ \ \ \ starpu\_task\_wait\_for\_all();}
\DoxyCodeLine{00419\ }
\DoxyCodeLine{00420\ \ \ \ \ \ \ \ \ FLOG(\ \mbox{\hyperlink{class_f_tic}{FTic}}\ timerSync;\ );}
\DoxyCodeLine{00421\ \ \ \ \ \ \ \ \ syncData();}
\DoxyCodeLine{00422\ \ \ \ \ \ \ \ \ FLOG(\ FLog::Controller\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)t\(\backslash\)t\ Moving\ data\ to\ the\ host\ took\ "{}}\ <<\ timerSync.tacAndElapsed()\ <<\ \textcolor{stringliteral}{"{}s\(\backslash\)n"{}}\ );}
\DoxyCodeLine{00423\ }
\DoxyCodeLine{00424\ \ \ \ \ \ \ \ \ starpu\_pause();}
\DoxyCodeLine{00425\ }
\DoxyCodeLine{00426\ \textcolor{preprocessor}{\#ifdef\ STARPU\_USE\_CPU}}
\DoxyCodeLine{00427\ \ \ \ \ \ \ \ \ FTIME\_TASKS(cpuWrapper.taskTimeRecorder.end());}
\DoxyCodeLine{00428\ \ \ \ \ \ \ \ \ FTIME\_TASKS(cpuWrapper.taskTimeRecorder.saveToDisk(\textcolor{stringliteral}{"{}/tmp/taskstime-\/FGroupTaskStarPUAlgorithm.txt"{}}));}
\DoxyCodeLine{00429\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00430\ \ \ \ \ \}}
\DoxyCodeLine{00431\ }
\DoxyCodeLine{00432\ }
\DoxyCodeLine{00433\ \ \ \ \ \textcolor{keywordtype}{void}\ initCodelet()\{}
\DoxyCodeLine{00434\ \ \ \ \ \ \ \ \ memset(\&p2m\_cl,\ 0,\ \textcolor{keyword}{sizeof}(p2m\_cl));}
\DoxyCodeLine{00435\ \textcolor{preprocessor}{\#ifdef\ STARPU\_USE\_CPU}}
\DoxyCodeLine{00436\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(originalCpuKernel-\/>supportP2M(FSTARPU\_CPU\_IDX))\{}
\DoxyCodeLine{00437\ \ \ \ \ \ \ \ \ \ \ \ \ p2m\_cl.cpu\_funcs[0]\ =\ StarPUCpuWrapperClass::bottomPassCallback;}
\DoxyCodeLine{00438\ \ \ \ \ \ \ \ \ \ \ \ \ p2m\_cl.where\ |=\ STARPU\_CPU;}
\DoxyCodeLine{00439\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00440\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00441\ \textcolor{preprocessor}{\#ifdef\ SCALFMM\_ENABLE\_CUDA\_KERNEL}}
\DoxyCodeLine{00442\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(originalCpuKernel-\/>supportP2M(FSTARPU\_CUDA\_IDX))\{}
\DoxyCodeLine{00443\ \ \ \ \ \ \ \ \ \ \ \ \ p2m\_cl.cuda\_funcs[0]\ =\ StarPUCudaWrapperClass::bottomPassCallback;}
\DoxyCodeLine{00444\ \ \ \ \ \ \ \ \ \ \ \ \ p2m\_cl.where\ |=\ STARPU\_CUDA;}
\DoxyCodeLine{00445\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00446\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00447\ \textcolor{preprocessor}{\#ifdef\ SCALFMM\_ENABLE\_OPENCL\_KERNEL}}
\DoxyCodeLine{00448\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(originalCpuKernel-\/>supportP2M(FSTARPU\_OPENCL\_IDX))\{}
\DoxyCodeLine{00449\ \ \ \ \ \ \ \ \ \ \ \ \ p2m\_cl.opencl\_funcs[0]\ =\ StarPUOpenClWrapperClass::bottomPassCallback;}
\DoxyCodeLine{00450\ \ \ \ \ \ \ \ \ \ \ \ \ p2m\_cl.where\ |=\ STARPU\_OPENCL;}
\DoxyCodeLine{00451\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00452\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00453\ \ \ \ \ \ \ \ \ p2m\_cl.nbuffers\ =\ 3;}
\DoxyCodeLine{00454\ \ \ \ \ \ \ \ \ p2m\_cl.modes[0]\ =\ STARPU\_R;}
\DoxyCodeLine{00455\ \ \ \ \ \ \ \ \ p2m\_cl.modes[1]\ =\ STARPU\_RW;}
\DoxyCodeLine{00456\ \ \ \ \ \ \ \ \ p2m\_cl.modes[2]\ =\ STARPU\_R;}
\DoxyCodeLine{00457\ \ \ \ \ \ \ \ \ p2m\_cl.name\ =\ \textcolor{stringliteral}{"{}p2m\_cl"{}};}
\DoxyCodeLine{00458\ \textcolor{preprocessor}{\#ifdef\ STARPU\_SIMGRID\_MLR\_MODELS}}
\DoxyCodeLine{00459\ \ \ \ \ p2m\_cl.model\ =\ (starpu\_perfmodel*)calloc(1,\textcolor{keyword}{sizeof}(starpu\_perfmodel));}
\DoxyCodeLine{00460\ \ \ \ \ p2m\_cl.model-\/>type\ =\ STARPU\_MULTIPLE\_REGRESSION\_BASED;}
\DoxyCodeLine{00461\ \ \ \ \ p2m\_cl.model-\/>symbol\ =\ p2m\_cl.name;}
\DoxyCodeLine{00462\ \ \ \ \ p2m\_cl.model-\/>parameters\ =\ p2m\_cl\_perf\_func;}
\DoxyCodeLine{00463\ \ \ \ \ p2m\_cl.model-\/>nparameters\ =\ 3;}
\DoxyCodeLine{00464\ \ \ \ \ p2m\_cl.model-\/>parameters\_names\ =\ p2m\_cl\_parameters\_names;}
\DoxyCodeLine{00465\ \ \ \ \ p2m\_cl.model-\/>ncombinations\ =\ 1;}
\DoxyCodeLine{00466\ \ \ \ \ p2m\_cl.model-\/>combinations\ =\ p2m\_cl\_combinations;}
\DoxyCodeLine{00467\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00468\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespace_f_mem_utils_a005b2bd1925d50a688606ed5877c5aec}{memset}}(\&m2m\_cl,\ 0,\ \textcolor{keyword}{sizeof}(m2m\_cl));}
\DoxyCodeLine{00469\ \textcolor{preprocessor}{\#ifdef\ STARPU\_USE\_CPU}}
\DoxyCodeLine{00470\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(originalCpuKernel-\/>supportM2M(FSTARPU\_CPU\_IDX))\{}
\DoxyCodeLine{00471\ \ \ \ \ \ \ \ \ \ \ \ \ m2m\_cl.cpu\_funcs[0]\ =\ StarPUCpuWrapperClass::upwardPassCallback;}
\DoxyCodeLine{00472\ \ \ \ \ \ \ \ \ \ \ \ \ m2m\_cl.where\ |=\ STARPU\_CPU;}
\DoxyCodeLine{00473\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00474\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00475\ \textcolor{preprocessor}{\#ifdef\ SCALFMM\_ENABLE\_CUDA\_KERNEL}}
\DoxyCodeLine{00476\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(originalCpuKernel-\/>supportM2M(FSTARPU\_CUDA\_IDX))\{}
\DoxyCodeLine{00477\ \ \ \ \ \ \ \ \ \ \ \ \ m2m\_cl.cuda\_funcs[0]\ =\ StarPUCudaWrapperClass::upwardPassCallback;}
\DoxyCodeLine{00478\ \ \ \ \ \ \ \ \ \ \ \ \ m2m\_cl.where\ |=\ STARPU\_CUDA;}
\DoxyCodeLine{00479\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00480\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00481\ \textcolor{preprocessor}{\#ifdef\ SCALFMM\_ENABLE\_OPENCL\_KERNEL}}
\DoxyCodeLine{00482\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(originalCpuKernel-\/>supportM2M(FSTARPU\_OPENCL\_IDX))\{}
\DoxyCodeLine{00483\ \ \ \ \ \ \ \ \ \ \ \ \ m2m\_cl.opencl\_funcs[0]\ =\ StarPUOpenClWrapperClass::upwardPassCallback;}
\DoxyCodeLine{00484\ \ \ \ \ \ \ \ \ \ \ \ \ m2m\_cl.where\ |=\ STARPU\_OPENCL;}
\DoxyCodeLine{00485\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00486\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00487\ \ \ \ \ \ \ \ \ m2m\_cl.nbuffers\ =\ 4;}
\DoxyCodeLine{00488\ \ \ \ \ \ \ \ \ m2m\_cl.dyn\_modes\ =\ (starpu\_data\_access\_mode*)malloc(m2m\_cl.nbuffers*\textcolor{keyword}{sizeof}(starpu\_data\_access\_mode));}
\DoxyCodeLine{00489\ \ \ \ \ \ \ \ \ m2m\_cl.dyn\_modes[0]\ =\ STARPU\_R;}
\DoxyCodeLine{00490\ \ \ \ \ \ \ \ \ m2m\_cl.dyn\_modes[1]\ =\ starpu\_data\_access\_mode(STARPU\_RW|STARPU\_COMMUTE\_IF\_SUPPORTED);}
\DoxyCodeLine{00491\ \ \ \ \ \ \ \ \ m2m\_cl.name\ =\ \textcolor{stringliteral}{"{}m2m\_cl"{}};}
\DoxyCodeLine{00492\ \ \ \ \ \ \ \ \ m2m\_cl.dyn\_modes[2]\ =\ STARPU\_R;}
\DoxyCodeLine{00493\ \ \ \ \ \ \ \ \ m2m\_cl.dyn\_modes[3]\ =\ STARPU\_R;}
\DoxyCodeLine{00494\ \textcolor{preprocessor}{\#ifdef\ STARPU\_SIMGRID\_MLR\_MODELS}}
\DoxyCodeLine{00495\ \ \ \ \ m2m\_cl.model\ =\ (starpu\_perfmodel*)calloc(1,\textcolor{keyword}{sizeof}(starpu\_perfmodel));}
\DoxyCodeLine{00496\ \ \ \ \ m2m\_cl.model-\/>type\ =\ STARPU\_MULTIPLE\_REGRESSION\_BASED;}
\DoxyCodeLine{00497\ \ \ \ \ m2m\_cl.model-\/>symbol\ =\ m2m\_cl.name;}
\DoxyCodeLine{00498\ \ \ \ \ m2m\_cl.model-\/>parameters\ =\ m2m\_cl\_perf\_func;}
\DoxyCodeLine{00499\ \ \ \ \ m2m\_cl.model-\/>nparameters\ =\ 7;}
\DoxyCodeLine{00500\ \ \ \ \ m2m\_cl.model-\/>parameters\_names\ =\ m2m\_cl\_parameters\_names;}
\DoxyCodeLine{00501\ \ \ \ \ m2m\_cl.model-\/>ncombinations\ =\ 2;}
\DoxyCodeLine{00502\ \ \ \ \ m2m\_cl.model-\/>combinations\ =\ m2m\_cl\_combinations;}
\DoxyCodeLine{00503\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00504\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespace_f_mem_utils_a005b2bd1925d50a688606ed5877c5aec}{memset}}(\&l2l\_cl,\ 0,\ \textcolor{keyword}{sizeof}(l2l\_cl));}
\DoxyCodeLine{00505\ \textcolor{preprocessor}{\#ifdef\ STARPU\_USE\_CPU}}
\DoxyCodeLine{00506\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(originalCpuKernel-\/>supportL2L(FSTARPU\_CPU\_IDX))\{}
\DoxyCodeLine{00507\ \ \ \ \ \ \ \ \ \ \ \ \ l2l\_cl.cpu\_funcs[0]\ =\ StarPUCpuWrapperClass::downardPassCallback;}
\DoxyCodeLine{00508\ \ \ \ \ \ \ \ \ \ \ \ \ l2l\_cl.where\ |=\ STARPU\_CPU;}
\DoxyCodeLine{00509\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00510\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00511\ \textcolor{preprocessor}{\#ifdef\ SCALFMM\_ENABLE\_CUDA\_KERNEL}}
\DoxyCodeLine{00512\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(originalCpuKernel-\/>supportL2L(FSTARPU\_CUDA\_IDX))\{}
\DoxyCodeLine{00513\ \ \ \ \ \ \ \ \ \ \ \ \ l2l\_cl.cuda\_funcs[0]\ =\ StarPUCudaWrapperClass::downardPassCallback;}
\DoxyCodeLine{00514\ \ \ \ \ \ \ \ \ \ \ \ \ l2l\_cl.where\ |=\ STARPU\_CUDA;}
\DoxyCodeLine{00515\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00516\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00517\ \textcolor{preprocessor}{\#ifdef\ SCALFMM\_ENABLE\_OPENCL\_KERNEL}}
\DoxyCodeLine{00518\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(originalCpuKernel-\/>supportL2L(FSTARPU\_OPENCL\_IDX))\{}
\DoxyCodeLine{00519\ \ \ \ \ \ \ \ \ \ \ \ \ l2l\_cl.opencl\_funcs[0]\ =\ StarPUOpenClWrapperClass::downardPassCallback;}
\DoxyCodeLine{00520\ \ \ \ \ \ \ \ \ \ \ \ \ l2l\_cl.where\ |=\ STARPU\_OPENCL;}
\DoxyCodeLine{00521\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00522\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00523\ \ \ \ \ \ \ \ \ l2l\_cl.nbuffers\ =\ 4;}
\DoxyCodeLine{00524\ \ \ \ \ \ \ \ \ l2l\_cl.dyn\_modes\ =\ (starpu\_data\_access\_mode*)malloc(l2l\_cl.nbuffers*\textcolor{keyword}{sizeof}(starpu\_data\_access\_mode));}
\DoxyCodeLine{00525\ \ \ \ \ \ \ \ \ l2l\_cl.dyn\_modes[0]\ =\ STARPU\_R;}
\DoxyCodeLine{00526\ \ \ \ \ \ \ \ \ l2l\_cl.dyn\_modes[1]\ =\ STARPU\_R;}
\DoxyCodeLine{00527\ \ \ \ \ \ \ \ \ l2l\_cl.name\ =\ \textcolor{stringliteral}{"{}l2l\_cl"{}};}
\DoxyCodeLine{00528\ \ \ \ \ \ \ \ \ l2l\_cl.dyn\_modes[2]\ =\ STARPU\_R;}
\DoxyCodeLine{00529\ \ \ \ \ \ \ \ \ l2l\_cl.dyn\_modes[3]\ =\ starpu\_data\_access\_mode(STARPU\_RW|STARPU\_COMMUTE\_IF\_SUPPORTED);}
\DoxyCodeLine{00530\ \textcolor{preprocessor}{\#ifdef\ STARPU\_SIMGRID\_MLR\_MODELS}}
\DoxyCodeLine{00531\ \ \ \ \ l2l\_cl.model\ =\ (starpu\_perfmodel*)calloc(1,\textcolor{keyword}{sizeof}(starpu\_perfmodel));}
\DoxyCodeLine{00532\ \ \ \ \ l2l\_cl.model-\/>type\ =\ STARPU\_MULTIPLE\_REGRESSION\_BASED;}
\DoxyCodeLine{00533\ \ \ \ \ l2l\_cl.model-\/>symbol\ =\ l2l\_cl.name;}
\DoxyCodeLine{00534\ \ \ \ \ l2l\_cl.model-\/>parameters\ =\ l2l\_cl\_perf\_func;}
\DoxyCodeLine{00535\ \ \ \ \ l2l\_cl.model-\/>nparameters\ =\ 7;}
\DoxyCodeLine{00536\ \ \ \ \ l2l\_cl.model-\/>parameters\_names\ =\ l2l\_cl\_parameters\_names;}
\DoxyCodeLine{00537\ \ \ \ \ l2l\_cl.model-\/>ncombinations\ =\ 1;}
\DoxyCodeLine{00538\ \ \ \ \ l2l\_cl.model-\/>combinations\ =\ l2l\_cl\_combinations;}
\DoxyCodeLine{00539\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00540\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespace_f_mem_utils_a005b2bd1925d50a688606ed5877c5aec}{memset}}(\&l2l\_cl\_nocommute,\ 0,\ \textcolor{keyword}{sizeof}(l2l\_cl\_nocommute));}
\DoxyCodeLine{00541\ \textcolor{preprocessor}{\#ifdef\ STARPU\_USE\_CPU}}
\DoxyCodeLine{00542\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(originalCpuKernel-\/>supportL2L(FSTARPU\_CPU\_IDX))\{}
\DoxyCodeLine{00543\ \ \ \ \ \ \ \ \ \ \ \ \ l2l\_cl\_nocommute.cpu\_funcs[0]\ =\ StarPUCpuWrapperClass::downardPassCallback;}
\DoxyCodeLine{00544\ \ \ \ \ \ \ \ \ \ \ \ \ l2l\_cl\_nocommute.where\ |=\ STARPU\_CPU;}
\DoxyCodeLine{00545\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00546\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00547\ \textcolor{preprocessor}{\#ifdef\ SCALFMM\_ENABLE\_CUDA\_KERNEL}}
\DoxyCodeLine{00548\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(originalCpuKernel-\/>supportL2L(FSTARPU\_CUDA\_IDX))\{}
\DoxyCodeLine{00549\ \ \ \ \ \ \ \ \ \ \ \ \ l2l\_cl\_nocommute.cuda\_funcs[0]\ =\ StarPUCudaWrapperClass::downardPassCallback;}
\DoxyCodeLine{00550\ \ \ \ \ \ \ \ \ \ \ \ \ l2l\_cl\_nocommute.where\ |=\ STARPU\_CUDA;}
\DoxyCodeLine{00551\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00552\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00553\ \textcolor{preprocessor}{\#ifdef\ SCALFMM\_ENABLE\_OPENCL\_KERNEL}}
\DoxyCodeLine{00554\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(originalCpuKernel-\/>supportL2L(FSTARPU\_OPENCL\_IDX))\{}
\DoxyCodeLine{00555\ \ \ \ \ \ \ \ \ \ \ \ \ l2l\_cl\_nocommute.opencl\_funcs[0]\ =\ StarPUOpenClWrapperClass::downardPassCallback;}
\DoxyCodeLine{00556\ \ \ \ \ \ \ \ \ \ \ \ \ l2l\_cl\_nocommute.where\ |=\ STARPU\_OPENCL;}
\DoxyCodeLine{00557\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00558\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00559\ \ \ \ \ \ \ \ \ l2l\_cl\_nocommute.nbuffers\ =\ 4;}
\DoxyCodeLine{00560\ \ \ \ \ \ \ \ \ l2l\_cl\_nocommute.dyn\_modes\ =\ (starpu\_data\_access\_mode*)malloc(l2l\_cl\_nocommute.nbuffers*\textcolor{keyword}{sizeof}(starpu\_data\_access\_mode));}
\DoxyCodeLine{00561\ \ \ \ \ \ \ \ \ l2l\_cl\_nocommute.dyn\_modes[0]\ =\ STARPU\_R;}
\DoxyCodeLine{00562\ \ \ \ \ \ \ \ \ l2l\_cl\_nocommute.dyn\_modes[1]\ =\ STARPU\_R;}
\DoxyCodeLine{00563\ \ \ \ \ \ \ \ \ l2l\_cl\_nocommute.name\ =\ \textcolor{stringliteral}{"{}l2l\_cl\_nocommute"{}};}
\DoxyCodeLine{00564\ \ \ \ \ \ \ \ \ l2l\_cl\_nocommute.dyn\_modes[2]\ =\ STARPU\_R;}
\DoxyCodeLine{00565\ \ \ \ \ \ \ \ \ l2l\_cl\_nocommute.dyn\_modes[3]\ =\ STARPU\_RW;}
\DoxyCodeLine{00566\ \textcolor{preprocessor}{\#ifdef\ STARPU\_SIMGRID\_MLR\_MODELS}}
\DoxyCodeLine{00567\ \ \ \ \ l2l\_cl\_nocommute.model\ =\ (starpu\_perfmodel*)calloc(1,\textcolor{keyword}{sizeof}(starpu\_perfmodel));}
\DoxyCodeLine{00568\ \ \ \ \ l2l\_cl\_nocommute.model-\/>type\ =\ STARPU\_MULTIPLE\_REGRESSION\_BASED;}
\DoxyCodeLine{00569\ \ \ \ \ l2l\_cl\_nocommute.model-\/>symbol\ =\ l2l\_cl\_nocommute.name;}
\DoxyCodeLine{00570\ \ \ \ \ l2l\_cl\_nocommute.model-\/>parameters\ =\ l2l\_cl\_nocommute\_perf\_func;}
\DoxyCodeLine{00571\ \ \ \ \ l2l\_cl\_nocommute.model-\/>nparameters\ =\ 7;}
\DoxyCodeLine{00572\ \ \ \ \ l2l\_cl\_nocommute.model-\/>parameters\_names\ =\ l2l\_cl\_nocommute\_parameters\_names;}
\DoxyCodeLine{00573\ \ \ \ \ l2l\_cl\_nocommute.model-\/>ncombinations\ =\ 1;}
\DoxyCodeLine{00574\ \ \ \ \ l2l\_cl\_nocommute.model-\/>combinations\ =\ l2l\_cl\_nocommute\_combinations;}
\DoxyCodeLine{00575\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00576\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespace_f_mem_utils_a005b2bd1925d50a688606ed5877c5aec}{memset}}(\&l2p\_cl,\ 0,\ \textcolor{keyword}{sizeof}(l2p\_cl));}
\DoxyCodeLine{00577\ \textcolor{preprocessor}{\#ifdef\ STARPU\_USE\_CPU}}
\DoxyCodeLine{00578\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(originalCpuKernel-\/>supportL2P(FSTARPU\_CPU\_IDX))\{}
\DoxyCodeLine{00579\ \ \ \ \ \ \ \ \ \ \ \ \ l2p\_cl.cpu\_funcs[0]\ =\ StarPUCpuWrapperClass::mergePassCallback;}
\DoxyCodeLine{00580\ \ \ \ \ \ \ \ \ \ \ \ \ l2p\_cl.where\ |=\ STARPU\_CPU;}
\DoxyCodeLine{00581\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00582\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00583\ \textcolor{preprocessor}{\#ifdef\ SCALFMM\_ENABLE\_CUDA\_KERNEL}}
\DoxyCodeLine{00584\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(originalCpuKernel-\/>supportL2P(FSTARPU\_CUDA\_IDX))\{}
\DoxyCodeLine{00585\ \ \ \ \ \ \ \ \ \ \ \ \ l2p\_cl.cuda\_funcs[0]\ =\ StarPUCudaWrapperClass::mergePassCallback;}
\DoxyCodeLine{00586\ \ \ \ \ \ \ \ \ \ \ \ \ l2p\_cl.where\ |=\ STARPU\_CUDA;}
\DoxyCodeLine{00587\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00588\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00589\ \textcolor{preprocessor}{\#ifdef\ SCALFMM\_ENABLE\_OPENCL\_KERNEL}}
\DoxyCodeLine{00590\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(originalCpuKernel-\/>supportL2P(FSTARPU\_OPENCL\_IDX))\{}
\DoxyCodeLine{00591\ \ \ \ \ \ \ \ \ \ \ \ \ l2p\_cl.opencl\_funcs[0]\ =\ StarPUOpenClWrapperClass::mergePassCallback;}
\DoxyCodeLine{00592\ \ \ \ \ \ \ \ \ \ \ \ \ l2p\_cl.where\ |=\ STARPU\_OPENCL;}
\DoxyCodeLine{00593\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00594\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00595\ \ \ \ \ \ \ \ \ l2p\_cl.nbuffers\ =\ 4;}
\DoxyCodeLine{00596\ \ \ \ \ \ \ \ \ l2p\_cl.modes[0]\ =\ STARPU\_R;}
\DoxyCodeLine{00597\ \ \ \ \ \ \ \ \ l2p\_cl.modes[1]\ =\ STARPU\_R;}
\DoxyCodeLine{00598\ \ \ \ \ \ \ \ \ l2p\_cl.modes[2]\ =\ STARPU\_R;}
\DoxyCodeLine{00599\ \textcolor{preprocessor}{\#ifdef\ STARPU\_USE\_REDUX}}
\DoxyCodeLine{00600\ \ \ \ \ \ \ \ \ l2p\_cl.modes[3]\ =\ STARPU\_REDUX;}
\DoxyCodeLine{00601\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{00602\ \ \ \ \ \ \ \ \ l2p\_cl.modes[3]\ =\ starpu\_data\_access\_mode(STARPU\_RW|STARPU\_COMMUTE\_IF\_SUPPORTED);}
\DoxyCodeLine{00603\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00604\ \ \ \ \ \ \ \ \ l2p\_cl.name\ =\ \textcolor{stringliteral}{"{}l2p\_cl"{}};}
\DoxyCodeLine{00605\ \textcolor{preprocessor}{\#ifdef\ STARPU\_SIMGRID\_MLR\_MODELS}}
\DoxyCodeLine{00606\ \ \ \ \ l2p\_cl.model\ =\ (starpu\_perfmodel*)calloc(1,\textcolor{keyword}{sizeof}(starpu\_perfmodel));}
\DoxyCodeLine{00607\ \ \ \ \ l2p\_cl.model-\/>type\ =\ STARPU\_MULTIPLE\_REGRESSION\_BASED;}
\DoxyCodeLine{00608\ \ \ \ \ l2p\_cl.model-\/>symbol\ =\ l2p\_cl.name;}
\DoxyCodeLine{00609\ \ \ \ \ l2p\_cl.model-\/>parameters\ =\ l2p\_cl\_perf\_func;}
\DoxyCodeLine{00610\ \ \ \ \ l2p\_cl.model-\/>nparameters\ =\ 3;}
\DoxyCodeLine{00611\ \ \ \ \ l2p\_cl.model-\/>parameters\_names\ =\ l2p\_cl\_parameters\_names;}
\DoxyCodeLine{00612\ \ \ \ \ l2p\_cl.model-\/>ncombinations\ =\ 1;}
\DoxyCodeLine{00613\ \ \ \ \ l2p\_cl.model-\/>combinations\ =\ l2p\_cl\_combinations;}
\DoxyCodeLine{00614\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00615\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespace_f_mem_utils_a005b2bd1925d50a688606ed5877c5aec}{memset}}(\&p2p\_cl\_in,\ 0,\ \textcolor{keyword}{sizeof}(p2p\_cl\_in));}
\DoxyCodeLine{00616\ \textcolor{preprocessor}{\#ifdef\ STARPU\_USE\_CPU}}
\DoxyCodeLine{00617\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(originalCpuKernel-\/>supportP2P(FSTARPU\_CPU\_IDX))\{}
\DoxyCodeLine{00618\ \ \ \ \ \ \ \ \ \ \ \ \ p2p\_cl\_in.cpu\_funcs[0]\ =\ StarPUCpuWrapperClass::directInPassCallback;}
\DoxyCodeLine{00619\ \ \ \ \ \ \ \ \ \ \ \ \ p2p\_cl\_in.where\ |=\ STARPU\_CPU;}
\DoxyCodeLine{00620\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00621\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00622\ \textcolor{preprocessor}{\#ifdef\ SCALFMM\_ENABLE\_CUDA\_KERNEL}}
\DoxyCodeLine{00623\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(originalCpuKernel-\/>supportP2P(FSTARPU\_CUDA\_IDX))\{}
\DoxyCodeLine{00624\ \ \ \ \ \ \ \ \ \ \ \ \ p2p\_cl\_in.cuda\_funcs[0]\ =\ StarPUCudaWrapperClass::directInPassCallback;}
\DoxyCodeLine{00625\ \ \ \ \ \ \ \ \ \ \ \ \ p2p\_cl\_in.where\ |=\ STARPU\_CUDA;}
\DoxyCodeLine{00626\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00627\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00628\ \textcolor{preprocessor}{\#ifdef\ SCALFMM\_ENABLE\_OPENCL\_KERNEL}}
\DoxyCodeLine{00629\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(originalCpuKernel-\/>supportP2P(FSTARPU\_OPENCL\_IDX))\{}
\DoxyCodeLine{00630\ \ \ \ \ \ \ \ \ \ \ \ \ p2p\_cl\_in.opencl\_funcs[0]\ =\ StarPUOpenClWrapperClass::directInPassCallback;}
\DoxyCodeLine{00631\ \ \ \ \ \ \ \ \ \ \ \ \ p2p\_cl\_in.where\ |=\ STARPU\_OPENCL;}
\DoxyCodeLine{00632\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00633\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00634\ \ \ \ \ \ \ \ \ p2p\_cl\_in.nbuffers\ =\ 2;}
\DoxyCodeLine{00635\ \ \ \ \ \ \ \ \ p2p\_cl\_in.modes[0]\ =\ STARPU\_R;}
\DoxyCodeLine{00636\ \textcolor{preprocessor}{\#ifdef\ STARPU\_USE\_REDUX}}
\DoxyCodeLine{00637\ \ \ \ \ \ \ \ \ p2p\_cl\_in.modes[1]\ =\ STARPU\_REDUX;}
\DoxyCodeLine{00638\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{00639\ \ \ \ \ \ \ \ \ p2p\_cl\_in.modes[1]\ =\ starpu\_data\_access\_mode(STARPU\_RW|STARPU\_COMMUTE\_IF\_SUPPORTED);}
\DoxyCodeLine{00640\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00641\ \ \ \ \ \ \ \ \ p2p\_cl\_in.name\ =\ \textcolor{stringliteral}{"{}p2p\_cl\_in"{}};}
\DoxyCodeLine{00642\ \textcolor{preprocessor}{\#ifdef\ STARPU\_SIMGRID\_MLR\_MODELS}}
\DoxyCodeLine{00643\ \ \ \ \ p2p\_cl\_in.model\ =\ (starpu\_perfmodel*)calloc(1,\textcolor{keyword}{sizeof}(starpu\_perfmodel));}
\DoxyCodeLine{00644\ \ \ \ \ p2p\_cl\_in.model-\/>type\ =\ STARPU\_MULTIPLE\_REGRESSION\_BASED;}
\DoxyCodeLine{00645\ \ \ \ \ \ \ \ \ p2p\_cl\_in.model-\/>symbol\ =\ p2p\_cl\_in.name;}
\DoxyCodeLine{00646\ \ \ \ \ p2p\_cl\_in.model-\/>parameters\ =\ p2p\_cl\_in\_perf\_func;}
\DoxyCodeLine{00647\ \ \ \ \ p2p\_cl\_in.model-\/>nparameters\ =\ 4;}
\DoxyCodeLine{00648\ \ \ \ \ p2p\_cl\_in.model-\/>parameters\_names\ =\ p2p\_cl\_in\_parameters\_names;}
\DoxyCodeLine{00649\ \ \ \ \ p2p\_cl\_in.model-\/>ncombinations\ =\ 2;}
\DoxyCodeLine{00650\ \ \ \ \ p2p\_cl\_in.model-\/>combinations\ =\ p2p\_cl\_in\_combinations;}
\DoxyCodeLine{00651\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00652\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespace_f_mem_utils_a005b2bd1925d50a688606ed5877c5aec}{memset}}(\&p2p\_cl\_inout,\ 0,\ \textcolor{keyword}{sizeof}(p2p\_cl\_inout));}
\DoxyCodeLine{00653\ \textcolor{preprocessor}{\#ifdef\ STARPU\_USE\_CPU}}
\DoxyCodeLine{00654\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(originalCpuKernel-\/>supportP2PExtern(FSTARPU\_CPU\_IDX))\{}
\DoxyCodeLine{00655\ \ \ \ \ \ \ \ \ \ \ \ \ p2p\_cl\_inout.cpu\_funcs[0]\ =\ StarPUCpuWrapperClass::directInoutPassCallback;}
\DoxyCodeLine{00656\ \ \ \ \ \ \ \ \ \ \ \ \ p2p\_cl\_inout.where\ |=\ STARPU\_CPU;}
\DoxyCodeLine{00657\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00658\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00659\ \textcolor{preprocessor}{\#ifdef\ SCALFMM\_ENABLE\_CUDA\_KERNEL}}
\DoxyCodeLine{00660\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(originalCpuKernel-\/>supportP2PExtern(FSTARPU\_CUDA\_IDX))\{}
\DoxyCodeLine{00661\ \ \ \ \ \ \ \ \ \ \ \ \ p2p\_cl\_inout.cuda\_funcs[0]\ =\ StarPUCudaWrapperClass::directInoutPassCallback;}
\DoxyCodeLine{00662\ \ \ \ \ \ \ \ \ \ \ \ \ p2p\_cl\_inout.where\ |=\ STARPU\_CUDA;}
\DoxyCodeLine{00663\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00664\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00665\ \textcolor{preprocessor}{\#ifdef\ SCALFMM\_ENABLE\_OPENCL\_KERNEL}}
\DoxyCodeLine{00666\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(originalCpuKernel-\/>supportP2PExtern(FSTARPU\_OPENCL\_IDX))\{}
\DoxyCodeLine{00667\ \ \ \ \ \ \ \ \ \ \ \ \ p2p\_cl\_inout.opencl\_funcs[0]\ =\ StarPUOpenClWrapperClass::directInoutPassCallback;}
\DoxyCodeLine{00668\ \ \ \ \ \ \ \ \ \ \ \ \ p2p\_cl\_inout.where\ |=\ STARPU\_OPENCL;}
\DoxyCodeLine{00669\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00670\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00671\ \ \ \ \ \ \ \ \ p2p\_cl\_inout.nbuffers\ =\ 4;}
\DoxyCodeLine{00672\ \ \ \ \ \ \ \ \ p2p\_cl\_inout.modes[0]\ =\ STARPU\_R;}
\DoxyCodeLine{00673\ \textcolor{preprocessor}{\#ifdef\ STARPU\_USE\_REDUX}}
\DoxyCodeLine{00674\ \ \ \ \ \ \ \ \ p2p\_cl\_inout.modes[1]\ =\ STARPU\_REDUX;}
\DoxyCodeLine{00675\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{00676\ \ \ \ \ \ \ \ \ p2p\_cl\_inout.modes[1]\ =\ starpu\_data\_access\_mode(STARPU\_RW|STARPU\_COMMUTE\_IF\_SUPPORTED);}
\DoxyCodeLine{00677\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00678\ \ \ \ \ \ \ \ \ p2p\_cl\_inout.modes[2]\ =\ STARPU\_R;}
\DoxyCodeLine{00679\ \textcolor{preprocessor}{\#ifdef\ STARPU\_USE\_REDUX}}
\DoxyCodeLine{00680\ \ \ \ \ \ \ \ \ p2p\_cl\_inout.modes[3]\ =\ STARPU\_REDUX;}
\DoxyCodeLine{00681\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{00682\ \ \ \ \ \ \ \ \ p2p\_cl\_inout.modes[3]\ =\ starpu\_data\_access\_mode(STARPU\_RW|STARPU\_COMMUTE\_IF\_SUPPORTED);}
\DoxyCodeLine{00683\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00684\ \ \ \ \ \ \ \ \ p2p\_cl\_inout.name\ =\ \textcolor{stringliteral}{"{}p2p\_cl\_inout"{}};}
\DoxyCodeLine{00685\ \textcolor{preprocessor}{\#ifdef\ STARPU\_SIMGRID\_MLR\_MODELS}}
\DoxyCodeLine{00686\ \ \ \ \ p2p\_cl\_inout.model\ =\ (starpu\_perfmodel*)calloc(1,\textcolor{keyword}{sizeof}(starpu\_perfmodel));}
\DoxyCodeLine{00687\ \ \ \ \ p2p\_cl\_inout.model-\/>type\ =\ STARPU\_MULTIPLE\_REGRESSION\_BASED;}
\DoxyCodeLine{00688\ \ \ \ \ p2p\_cl\_inout.model-\/>symbol\ =\ p2p\_cl\_inout.name;}
\DoxyCodeLine{00689\ \ \ \ \ p2p\_cl\_inout.model-\/>parameters\ =\ p2p\_cl\_inout\_perf\_func;}
\DoxyCodeLine{00690\ \ \ \ \ p2p\_cl\_inout.model-\/>nparameters\ =\ 10;}
\DoxyCodeLine{00691\ \ \ \ \ p2p\_cl\_inout.model-\/>parameters\_names\ =\ p2p\_cl\_inout\_parameters\_names;}
\DoxyCodeLine{00692\ \ \ \ \ p2p\_cl\_inout.model-\/>ncombinations\ =\ 7;}
\DoxyCodeLine{00693\ \ \ \ \ p2p\_cl\_inout.model-\/>combinations\ =\ p2p\_cl\_inout\_combinations;}
\DoxyCodeLine{00694\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00695\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespace_f_mem_utils_a005b2bd1925d50a688606ed5877c5aec}{memset}}(\&m2l\_cl\_in,\ 0,\ \textcolor{keyword}{sizeof}(m2l\_cl\_in));}
\DoxyCodeLine{00696\ \textcolor{preprocessor}{\#ifdef\ STARPU\_USE\_CPU}}
\DoxyCodeLine{00697\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(originalCpuKernel-\/>supportM2L(FSTARPU\_CPU\_IDX))\{}
\DoxyCodeLine{00698\ \ \ \ \ \ \ \ \ \ \ \ \ m2l\_cl\_in.cpu\_funcs[0]\ =\ StarPUCpuWrapperClass::transferInPassCallback;}
\DoxyCodeLine{00699\ \ \ \ \ \ \ \ \ \ \ \ \ m2l\_cl\_in.where\ |=\ STARPU\_CPU;}
\DoxyCodeLine{00700\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00701\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00702\ \textcolor{preprocessor}{\#ifdef\ SCALFMM\_ENABLE\_CUDA\_KERNEL}}
\DoxyCodeLine{00703\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(originalCpuKernel-\/>supportM2L(FSTARPU\_CUDA\_IDX))\{}
\DoxyCodeLine{00704\ \ \ \ \ \ \ \ \ \ \ \ \ m2l\_cl\_in.cuda\_funcs[0]\ =\ StarPUCudaWrapperClass::transferInPassCallback;}
\DoxyCodeLine{00705\ \ \ \ \ \ \ \ \ \ \ \ \ m2l\_cl\_in.where\ |=\ STARPU\_CUDA;}
\DoxyCodeLine{00706\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00707\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00708\ \textcolor{preprocessor}{\#ifdef\ SCALFMM\_ENABLE\_OPENCL\_KERNEL}}
\DoxyCodeLine{00709\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(originalCpuKernel-\/>supportM2L(FSTARPU\_OPENCL\_IDX))\{}
\DoxyCodeLine{00710\ \ \ \ \ \ \ \ \ \ \ \ \ m2l\_cl\_in.opencl\_funcs[0]\ =\ StarPUOpenClWrapperClass::transferInPassCallback;}
\DoxyCodeLine{00711\ \ \ \ \ \ \ \ \ \ \ \ \ m2l\_cl\_in.where\ |=\ STARPU\_OPENCL;}
\DoxyCodeLine{00712\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00713\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00714\ \ \ \ \ \ \ \ \ m2l\_cl\_in.nbuffers\ =\ 3;}
\DoxyCodeLine{00715\ \ \ \ \ \ \ \ \ m2l\_cl\_in.modes[0]\ =\ STARPU\_R;}
\DoxyCodeLine{00716\ \ \ \ \ \ \ \ \ m2l\_cl\_in.modes[1]\ =\ STARPU\_R;}
\DoxyCodeLine{00717\ \ \ \ \ \ \ \ \ m2l\_cl\_in.modes[2]\ =\ starpu\_data\_access\_mode(STARPU\_RW|STARPU\_COMMUTE\_IF\_SUPPORTED);}
\DoxyCodeLine{00718\ \ \ \ \ \ \ \ \ m2l\_cl\_in.name\ =\ \textcolor{stringliteral}{"{}m2l\_cl\_in"{}};}
\DoxyCodeLine{00719\ \textcolor{preprocessor}{\#ifdef\ STARPU\_SIMGRID\_MLR\_MODELS}}
\DoxyCodeLine{00720\ \ \ \ \ m2l\_cl\_in.model\ =\ (starpu\_perfmodel*)calloc(1,\textcolor{keyword}{sizeof}(starpu\_perfmodel));}
\DoxyCodeLine{00721\ \ \ \ \ m2l\_cl\_in.model-\/>type\ =\ STARPU\_MULTIPLE\_REGRESSION\_BASED;}
\DoxyCodeLine{00722\ \ \ \ \ m2l\_cl\_in.model-\/>symbol\ =\ m2l\_cl\_in.name;}
\DoxyCodeLine{00723\ \ \ \ \ m2l\_cl\_in.model-\/>parameters\ =\ m2l\_cl\_in\_perf\_func;}
\DoxyCodeLine{00724\ \ \ \ \ m2l\_cl\_in.model-\/>nparameters\ =\ 4;}
\DoxyCodeLine{00725\ \ \ \ \ m2l\_cl\_in.model-\/>parameters\_names\ =\ m2l\_cl\_in\_parameters\_names;}
\DoxyCodeLine{00726\ \ \ \ \ m2l\_cl\_in.model-\/>ncombinations\ =\ 1;}
\DoxyCodeLine{00727\ \ \ \ \ m2l\_cl\_in.model-\/>combinations\ =\ m2l\_cl\_in\_combinations;}
\DoxyCodeLine{00728\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00729\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespace_f_mem_utils_a005b2bd1925d50a688606ed5877c5aec}{memset}}(\&m2l\_cl\_inout,\ 0,\ \textcolor{keyword}{sizeof}(m2l\_cl\_inout));}
\DoxyCodeLine{00730\ \textcolor{preprocessor}{\#ifdef\ STARPU\_USE\_CPU}}
\DoxyCodeLine{00731\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(originalCpuKernel-\/>supportM2LExtern(FSTARPU\_CPU\_IDX))\{}
\DoxyCodeLine{00732\ \ \ \ \ \ \ \ \ \ \ \ \ m2l\_cl\_inout.cpu\_funcs[0]\ =\ StarPUCpuWrapperClass::transferInoutPassCallback;}
\DoxyCodeLine{00733\ \ \ \ \ \ \ \ \ \ \ \ \ m2l\_cl\_inout.where\ |=\ STARPU\_CPU;}
\DoxyCodeLine{00734\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00735\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00736\ \textcolor{preprocessor}{\#ifdef\ SCALFMM\_ENABLE\_CUDA\_KERNEL}}
\DoxyCodeLine{00737\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(originalCpuKernel-\/>supportM2LExtern(FSTARPU\_CUDA\_IDX))\{}
\DoxyCodeLine{00738\ \ \ \ \ \ \ \ \ \ \ \ \ m2l\_cl\_inout.cuda\_funcs[0]\ =\ StarPUCudaWrapperClass::transferInoutPassCallback;}
\DoxyCodeLine{00739\ \ \ \ \ \ \ \ \ \ \ \ \ m2l\_cl\_inout.where\ |=\ STARPU\_CUDA;}
\DoxyCodeLine{00740\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00741\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00742\ \textcolor{preprocessor}{\#ifdef\ SCALFMM\_ENABLE\_OPENCL\_KERNEL}}
\DoxyCodeLine{00743\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(originalCpuKernel-\/>supportM2LExtern(FSTARPU\_OPENCL\_IDX))\{}
\DoxyCodeLine{00744\ \ \ \ \ \ \ \ \ \ \ \ \ m2l\_cl\_inout.opencl\_funcs[0]\ =\ StarPUOpenClWrapperClass::transferInoutPassCallback;}
\DoxyCodeLine{00745\ \ \ \ \ \ \ \ \ \ \ \ \ m2l\_cl\_inout.where\ |=\ STARPU\_OPENCL;}
\DoxyCodeLine{00746\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00747\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00748\ \ \ \ \ \ \ \ \ m2l\_cl\_inout.nbuffers\ =\ 4;}
\DoxyCodeLine{00749\ \ \ \ \ \ \ \ \ m2l\_cl\_inout.modes[0]\ =\ STARPU\_R;}
\DoxyCodeLine{00750\ \ \ \ \ \ \ \ \ m2l\_cl\_inout.modes[1]\ =\ starpu\_data\_access\_mode(STARPU\_RW|STARPU\_COMMUTE\_IF\_SUPPORTED);}
\DoxyCodeLine{00751\ \ \ \ \ \ \ \ \ m2l\_cl\_inout.modes[2]\ =\ STARPU\_R;}
\DoxyCodeLine{00752\ \ \ \ \ \ \ \ \ m2l\_cl\_inout.modes[3]\ =\ STARPU\_R;}
\DoxyCodeLine{00753\ \ \ \ \ \ \ \ \ m2l\_cl\_inout.name\ =\ \textcolor{stringliteral}{"{}m2l\_cl\_inout"{}};}
\DoxyCodeLine{00754\ \textcolor{preprocessor}{\#ifdef\ STARPU\_SIMGRID\_MLR\_MODELS}}
\DoxyCodeLine{00755\ \ \ \ \ m2l\_cl\_inout.model\ =\ (starpu\_perfmodel*)calloc(1,\textcolor{keyword}{sizeof}(starpu\_perfmodel));}
\DoxyCodeLine{00756\ \ \ \ \ m2l\_cl\_inout.model-\/>type\ =\ STARPU\_MULTIPLE\_REGRESSION\_BASED;}
\DoxyCodeLine{00757\ \ \ \ \ m2l\_cl\_inout.model-\/>symbol\ =\ m2l\_cl\_inout.name;}
\DoxyCodeLine{00758\ \ \ \ \ m2l\_cl\_inout.model-\/>parameters\ =\ m2l\_cl\_inout\_perf\_func;}
\DoxyCodeLine{00759\ \ \ \ \ m2l\_cl\_inout.model-\/>nparameters\ =\ 8;}
\DoxyCodeLine{00760\ \ \ \ \ m2l\_cl\_inout.model-\/>parameters\_names\ =\ m2l\_cl\_inout\_parameters\_names;}
\DoxyCodeLine{00761\ \ \ \ \ m2l\_cl\_inout.model-\/>ncombinations\ =\ 2;}
\DoxyCodeLine{00762\ \ \ \ \ m2l\_cl\_inout.model-\/>combinations\ =\ m2l\_cl\_inout\_combinations;}
\DoxyCodeLine{00763\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00764\ \textcolor{preprocessor}{\#ifdef\ STARPU\_USE\_REDUX}}
\DoxyCodeLine{00765\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespace_f_mem_utils_a005b2bd1925d50a688606ed5877c5aec}{memset}}(\&p2p\_redux\_init,\ 0,\ \textcolor{keyword}{sizeof}(p2p\_redux\_init));}
\DoxyCodeLine{00766\ \textcolor{preprocessor}{\#ifdef\ STARPU\_USE\_CPU}}
\DoxyCodeLine{00767\ \ \ \ \ \ \ \ \ p2p\_redux\_init.cpu\_funcs[0]\ =\ FStarPUReduxCpu::InitData<typename\ ParticleGroupClass::ParticleDataType>;}
\DoxyCodeLine{00768\ \ \ \ \ \ \ \ \ p2p\_redux\_init.where\ |=\ STARPU\_CPU;}
\DoxyCodeLine{00769\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00770\ \ \ \ \ \ \ \ \ p2p\_redux\_init.nbuffers\ =\ 1;}
\DoxyCodeLine{00771\ \ \ \ \ \ \ \ \ p2p\_redux\_init.modes[0]\ =\ STARPU\_RW;}
\DoxyCodeLine{00772\ \ \ \ \ \ \ \ \ p2p\_redux\_init.name\ =\ \textcolor{stringliteral}{"{}p2p\_redux\_init"{}};}
\DoxyCodeLine{00773\ }
\DoxyCodeLine{00774\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespace_f_mem_utils_a005b2bd1925d50a688606ed5877c5aec}{memset}}(\&p2p\_redux\_perform,\ 0,\ \textcolor{keyword}{sizeof}(p2p\_redux\_perform));}
\DoxyCodeLine{00775\ \textcolor{preprocessor}{\#ifdef\ STARPU\_USE\_CPU}}
\DoxyCodeLine{00776\ \ \ \ \ \ \ \ \ p2p\_redux\_perform.cpu\_funcs[0]\ =\ FStarPUReduxCpu::ReduceData<typename\ ParticleGroupClass::ParticleDataType>;}
\DoxyCodeLine{00777\ \ \ \ \ \ \ \ \ p2p\_redux\_perform.where\ |=\ STARPU\_CPU;}
\DoxyCodeLine{00778\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00779\ \ \ \ \ \ \ \ \ p2p\_redux\_perform.nbuffers\ =\ 2;}
\DoxyCodeLine{00780\ \ \ \ \ \ \ \ \ p2p\_redux\_perform.modes[0]\ =\ STARPU\_RW;}
\DoxyCodeLine{00781\ \ \ \ \ \ \ \ \ p2p\_redux\_perform.modes[1]\ =\ STARPU\_R;}
\DoxyCodeLine{00782\ \ \ \ \ \ \ \ \ p2p\_redux\_perform.name\ =\ \textcolor{stringliteral}{"{}p2p\_redux\_perform"{}};}
\DoxyCodeLine{00783\ }
\DoxyCodeLine{00784\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespace_f_mem_utils_a005b2bd1925d50a688606ed5877c5aec}{memset}}(\&p2p\_redux\_read,\ 0,\ \textcolor{keyword}{sizeof}(p2p\_redux\_read));}
\DoxyCodeLine{00785\ \textcolor{preprocessor}{\#ifdef\ STARPU\_USE\_CPU}}
\DoxyCodeLine{00786\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(originalCpuKernel-\/>supportL2P(FSTARPU\_CPU\_IDX))\{}
\DoxyCodeLine{00787\ \ \ \ \ \ \ \ \ \ \ \ \ p2p\_redux\_read.cpu\_funcs[0]\ =\ FStarPUReduxCpu::EmptyCodelet<typename\ ParticleGroupClass::ParticleDataType>;}
\DoxyCodeLine{00788\ \ \ \ \ \ \ \ \ \ \ \ \ p2p\_redux\_read.where\ |=\ STARPU\_CPU;}
\DoxyCodeLine{00789\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00790\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00791\ \textcolor{preprocessor}{\#ifdef\ SCALFMM\_ENABLE\_CUDA\_KERNEL}}
\DoxyCodeLine{00792\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(originalCpuKernel-\/>supportL2P(FSTARPU\_CUDA\_IDX))\{}
\DoxyCodeLine{00793\ \ \ \ \ \ \ \ \ \ \ \ \ p2p\_redux\_read.cuda\_funcs[0]\ =\ FStarPUReduxCpu::EmptyCodelet<typename\ ParticleGroupClass::ParticleDataType>;}
\DoxyCodeLine{00794\ \ \ \ \ \ \ \ \ \ \ \ \ p2p\_redux\_read.where\ |=\ STARPU\_CUDA;}
\DoxyCodeLine{00795\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00796\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00797\ \textcolor{preprocessor}{\#ifdef\ SCALFMM\_ENABLE\_OPENCL\_KERNEL}}
\DoxyCodeLine{00798\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(originalCpuKernel-\/>supportL2P(FSTARPU\_OPENCL\_IDX))\{}
\DoxyCodeLine{00799\ \ \ \ \ \ \ \ \ \ \ \ \ p2p\_redux\_read.opencl\_funcs[0]\ =\ FStarPUReduxCpu::EmptyCodelet<typename\ ParticleGroupClass::ParticleDataType>;}
\DoxyCodeLine{00800\ \ \ \ \ \ \ \ \ \ \ \ \ p2p\_redux\_read.where\ |=\ STARPU\_OPENCL;}
\DoxyCodeLine{00801\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00802\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00803\ \ \ \ \ \ \ \ \ p2p\_redux\_read.nbuffers\ =\ 1;}
\DoxyCodeLine{00804\ \ \ \ \ \ \ \ \ p2p\_redux\_read.modes[0]\ =\ STARPU\_R;}
\DoxyCodeLine{00805\ \ \ \ \ \ \ \ \ p2p\_redux\_read.name\ =\ \textcolor{stringliteral}{"{}p2p\_redux\_read"{}};}
\DoxyCodeLine{00806\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00807\ \ \ \ \ \}}
\DoxyCodeLine{00808\ }
\DoxyCodeLine{00810\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_f_group_task_star_p_u_algorithm_a18d2e3d7f77bd86ca36215eb0b6cb875}{cleanHandle}}()\{}
\DoxyCodeLine{00811\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ idxLevel\ =\ 0\ ;\ idxLevel\ <\ tree-\/>getHeight()\ ;\ ++idxLevel)\{}
\DoxyCodeLine{00812\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ idxHandle\ =\ 0\ ;\ idxHandle\ <\ int(cellHandles[idxLevel].size())\ ;\ ++idxHandle)\{}
\DoxyCodeLine{00813\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ starpu\_data\_unregister(cellHandles[idxLevel][idxHandle].symb);}
\DoxyCodeLine{00814\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ starpu\_data\_unregister(cellHandles[idxLevel][idxHandle].up);}
\DoxyCodeLine{00815\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ starpu\_data\_unregister(cellHandles[idxLevel][idxHandle].down);}
\DoxyCodeLine{00816\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00817\ \ \ \ \ \ \ \ \ \ \ \ \ cellHandles[idxLevel].clear();}
\DoxyCodeLine{00818\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00819\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00820\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ idxHandle\ =\ 0\ ;\ idxHandle\ <\ int(particleHandles.size())\ ;\ ++idxHandle)\{}
\DoxyCodeLine{00821\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ starpu\_data\_unregister(particleHandles[idxHandle].symb);}
\DoxyCodeLine{00822\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ starpu\_data\_unregister(particleHandles[idxHandle].down);}
\DoxyCodeLine{00823\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00824\ \ \ \ \ \ \ \ \ \ \ \ \ particleHandles.clear();}
\DoxyCodeLine{00825\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00826\ \ \ \ \ \}}
\DoxyCodeLine{00827\ }
\DoxyCodeLine{00831\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_f_group_task_star_p_u_algorithm_aa4b5b6461001f3af07447ff9ecad8c5d}{buildHandles}}()\{}
\DoxyCodeLine{00832\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_f_group_task_star_p_u_algorithm_a18d2e3d7f77bd86ca36215eb0b6cb875}{cleanHandle}}();}
\DoxyCodeLine{00833\ }
\DoxyCodeLine{00834\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ idxLevel\ =\ 2\ ;\ idxLevel\ <\ tree-\/>getHeight()\ ;\ ++idxLevel)\{}
\DoxyCodeLine{00835\ \ \ \ \ \ \ \ \ \ \ \ \ cellHandles[idxLevel].resize(tree-\/>getNbCellGroupAtLevel(idxLevel));}
\DoxyCodeLine{00836\ }
\DoxyCodeLine{00837\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ idxGroup\ =\ 0\ ;\ idxGroup\ <\ tree-\/>getNbCellGroupAtLevel(idxLevel)\ ;\ ++idxGroup)\{}
\DoxyCodeLine{00838\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ CellContainerClass*\ currentCells\ =\ tree-\/>getCellGroup(idxLevel,\ idxGroup);}
\DoxyCodeLine{00839\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ starpu\_variable\_data\_register(\&cellHandles[idxLevel][idxGroup].symb,\ 0,}
\DoxyCodeLine{00840\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (uintptr\_t)currentCells-\/>getRawBuffer(),\ currentCells-\/>getBufferSizeInByte());}
\DoxyCodeLine{00841\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ starpu\_variable\_data\_register(\&cellHandles[idxLevel][idxGroup].up,\ 0,}
\DoxyCodeLine{00842\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (uintptr\_t)currentCells-\/>getRawMultipoleBuffer(),\ currentCells-\/>getMultipoleBufferSizeInByte());}
\DoxyCodeLine{00843\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ starpu\_variable\_data\_register(\&cellHandles[idxLevel][idxGroup].down,\ 0,}
\DoxyCodeLine{00844\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (uintptr\_t)currentCells-\/>getRawLocalBuffer(),\ currentCells-\/>getLocalBufferSizeInByte());}
\DoxyCodeLine{00845\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ cellHandles[idxLevel][idxGroup].intervalSize\ =\ int(currentCells-\/>getNumberOfCellsInBlock());}
\DoxyCodeLine{00846\ \textcolor{preprocessor}{\#ifdef\ STARPU\_SUPPORT\_ARBITER}}
\DoxyCodeLine{00847\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ starpu\_data\_assign\_arbiter(cellHandles[idxLevel][idxGroup].up,\ arbiterGlobal);}
\DoxyCodeLine{00848\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ starpu\_data\_assign\_arbiter(cellHandles[idxLevel][idxGroup].down,\ arbiterGlobal);}
\DoxyCodeLine{00849\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00850\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00851\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00852\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00853\ \ \ \ \ \ \ \ \ \ \ \ \ particleHandles.resize(tree-\/>getNbParticleGroup());}
\DoxyCodeLine{00854\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ idxGroup\ =\ 0\ ;\ idxGroup\ <\ tree-\/>getNbParticleGroup()\ ;\ ++idxGroup)\{}
\DoxyCodeLine{00855\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ParticleGroupClass*\ containers\ =\ tree-\/>getParticleGroup(idxGroup);}
\DoxyCodeLine{00856\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ starpu\_variable\_data\_register(\&particleHandles[idxGroup].symb,\ 0,}
\DoxyCodeLine{00857\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (uintptr\_t)containers-\/>getRawBuffer(),\ containers-\/>getBufferSizeInByte());}
\DoxyCodeLine{00858\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ starpu\_variable\_data\_register(\&particleHandles[idxGroup].down,\ 0,}
\DoxyCodeLine{00859\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (uintptr\_t)containers-\/>getRawAttributesBuffer(),\ containers-\/>getAttributesBufferSizeInByte());}
\DoxyCodeLine{00860\ \textcolor{preprocessor}{\#ifdef\ STARPU\_USE\_REDUX}}
\DoxyCodeLine{00861\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ starpu\_data\_set\_reduction\_methods(particleHandles[idxGroup].down,\ \&p2p\_redux\_perform,}
\DoxyCodeLine{00862\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \&p2p\_redux\_init);}
\DoxyCodeLine{00863\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{00864\ \textcolor{preprocessor}{\#ifdef\ STARPU\_SUPPORT\_ARBITER}}
\DoxyCodeLine{00865\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ starpu\_data\_assign\_arbiter(particleHandles[idxGroup].down,\ arbiterGlobal);}
\DoxyCodeLine{00866\ \textcolor{preprocessor}{\#endif\ }\textcolor{comment}{//\ STARPU\_SUPPORT\_ARBITER}}
\DoxyCodeLine{00867\ \textcolor{preprocessor}{\#endif\ }\textcolor{comment}{//\ STARPU\_USE\_REDUX}}
\DoxyCodeLine{00868\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ particleHandles[idxGroup].intervalSize\ =\ int(containers-\/>getNumberOfLeavesInBlock());}
\DoxyCodeLine{00869\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00870\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00871\ \ \ \ \ \}}
\DoxyCodeLine{00872\ }
\DoxyCodeLine{00879\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_f_group_task_star_p_u_algorithm_ac176711c0d4154af9c5dd905e69ba86f}{buildExternalInteractionVecs}}()\{}
\DoxyCodeLine{00880\ \ \ \ \ \ \ \ \ FLOG(\ \mbox{\hyperlink{class_f_tic}{FTic}}\ timer;\ \mbox{\hyperlink{class_f_tic}{FTic}}\ leafTimer;\ \mbox{\hyperlink{class_f_tic}{FTic}}\ cellTimer;\ );}
\DoxyCodeLine{00881\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Reset\ interactions}}
\DoxyCodeLine{00882\ \ \ \ \ \ \ \ \ externalInteractionsAllLevel.clear();}
\DoxyCodeLine{00883\ \ \ \ \ \ \ \ \ externalInteractionsLeafLevel.clear();}
\DoxyCodeLine{00884\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ One\ per\ level\ +\ leaf\ level}}
\DoxyCodeLine{00885\ \ \ \ \ \ \ \ \ externalInteractionsAllLevel.resize(tree-\/>getHeight());}
\DoxyCodeLine{00886\ }
\DoxyCodeLine{00887\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ First\ leaf\ level}}
\DoxyCodeLine{00888\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00889\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ We\ create\ one\ big\ vector\ per\ block}}
\DoxyCodeLine{00890\ \ \ \ \ \ \ \ \ \ \ \ \ externalInteractionsLeafLevel.resize(tree-\/>getNbParticleGroup());}
\DoxyCodeLine{00891\ }
\DoxyCodeLine{00892\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ idxGroup\ =\ 0\ ;\ idxGroup\ <\ tree-\/>getNbParticleGroup()\ ;\ ++idxGroup)\{}
\DoxyCodeLine{00893\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Create\ the\ vector}}
\DoxyCodeLine{00894\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ParticleGroupClass*\ containers\ =\ tree-\/>getParticleGroup(idxGroup);}
\DoxyCodeLine{00895\ }
\DoxyCodeLine{00896\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ std::vector<BlockInteractions<ParticleGroupClass>>*\ externalInteractions\ =\ \&externalInteractionsLeafLevel[idxGroup];}
\DoxyCodeLine{00897\ }
\DoxyCodeLine{00898\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \#pragma\ omp\ task\ default(none)\ firstprivate(idxGroup,\ containers,\ externalInteractions)}}
\DoxyCodeLine{00899\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{\ \textcolor{comment}{//\ Can\ be\ a\ task(inout:iterCells)}}
\DoxyCodeLine{00900\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ std::vector<OutOfBlockInteraction>\ outsideInteractions;}
\DoxyCodeLine{00901\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ MortonIndex\ blockStartIdx\ =\ containers-\/>getStartingIndex();}
\DoxyCodeLine{00902\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ MortonIndex\ blockEndIdx\ \ \ =\ containers-\/>getEndingIndex();}
\DoxyCodeLine{00903\ }
\DoxyCodeLine{00904\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ leafIdx\ =\ 0\ ;\ leafIdx\ <\ containers-\/>getNumberOfLeavesInBlock()\ ;\ ++leafIdx)\{}
\DoxyCodeLine{00905\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ MortonIndex\ mindex\ =\ containers-\/>getLeafMortonIndex(leafIdx);}
\DoxyCodeLine{00906\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ GroupContainerClass\ particles\ =\ containers-\/>template\ getLeaf<GroupContainerClass>(leafIdx);}}
\DoxyCodeLine{00907\ }
\DoxyCodeLine{00908\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ MortonIndex\ interactionsIndexes[26];}
\DoxyCodeLine{00909\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ interactionsPosition[26];}
\DoxyCodeLine{00910\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_f_tree_coordinate}{FTreeCoordinate}}\ coord(mindex,\ tree-\/>getHeight()-\/1);}
\DoxyCodeLine{00911\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ counter\ =\ coord.\mbox{\hyperlink{class_f_tree_coordinate_ac74ca299cacd624e1aca5b49e4b62709}{getNeighborsIndexes}}(tree-\/>getHeight(),interactionsIndexes,interactionsPosition);}
\DoxyCodeLine{00912\ }
\DoxyCodeLine{00913\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ idxInter\ =\ 0\ ;\ idxInter\ <\ counter\ ;\ ++idxInter)\{}
\DoxyCodeLine{00914\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\ blockStartIdx\ <=\ interactionsIndexes[idxInter]\ \&\&\ interactionsIndexes[idxInter]\ <\ blockEndIdx\ )\{}
\DoxyCodeLine{00915\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Inside\ block\ interaction,\ do\ nothing}}
\DoxyCodeLine{00916\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00917\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}(interactionsIndexes[idxInter]\ <\ mindex)\{}
\DoxyCodeLine{00918\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{struct_out_of_block_interaction}{OutOfBlockInteraction}}\ property;}
\DoxyCodeLine{00919\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{property}.insideIndex\ =\ mindex;}
\DoxyCodeLine{00920\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{property}.outIndex\ \ \ \ =\ interactionsIndexes[idxInter];}
\DoxyCodeLine{00921\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{property}.relativeOutPosition\ =\ interactionsPosition[idxInter];}
\DoxyCodeLine{00922\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{property}.insideIdxInBlock\ =\ leafIdx;}
\DoxyCodeLine{00923\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{property}.outsideIdxInBlock\ =\ -\/1;}
\DoxyCodeLine{00924\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ outsideInteractions.push\_back(property);}
\DoxyCodeLine{00925\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00926\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00927\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00928\ }
\DoxyCodeLine{00929\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Sort\ to\ match\ external\ order}}
\DoxyCodeLine{00930\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_f_quick_sort}{FQuickSort<OutOfBlockInteraction,\ int>::QsSequential}}(outsideInteractions.data(),\textcolor{keywordtype}{int}(outsideInteractions.size()));}
\DoxyCodeLine{00931\ }
\DoxyCodeLine{00932\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ currentOutInteraction\ =\ 0;}
\DoxyCodeLine{00933\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ idxLeftGroup\ =\ 0\ ;\ idxLeftGroup\ <\ idxGroup\ \&\&\ currentOutInteraction\ <\ int(outsideInteractions.size())\ ;\ ++idxLeftGroup)\{}
\DoxyCodeLine{00934\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ParticleGroupClass*\ leftContainers\ =\ tree-\/>getParticleGroup(idxLeftGroup);}
\DoxyCodeLine{00935\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ MortonIndex\ blockStartIdxOther\ \ \ \ =\ leftContainers-\/>getStartingIndex();}
\DoxyCodeLine{00936\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ MortonIndex\ blockEndIdxOther\ \ \ \ \ \ =\ leftContainers-\/>getEndingIndex();}
\DoxyCodeLine{00937\ }
\DoxyCodeLine{00938\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{while}(currentOutInteraction\ <\ \textcolor{keywordtype}{int}(outsideInteractions.size())}
\DoxyCodeLine{00939\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \&\&\ (outsideInteractions[currentOutInteraction].outIndex\ <\ blockStartIdxOther}
\DoxyCodeLine{00940\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ||\ leftContainers-\/>getLeafIndex(outsideInteractions[currentOutInteraction].outIndex)\ ==\ -\/1)}
\DoxyCodeLine{00941\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \&\&\ outsideInteractions[currentOutInteraction].outIndex\ <\ blockEndIdxOther)\{}
\DoxyCodeLine{00942\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ currentOutInteraction\ +=\ 1;}
\DoxyCodeLine{00943\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00944\ }
\DoxyCodeLine{00945\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ lastOutInteraction\ =\ currentOutInteraction;}
\DoxyCodeLine{00946\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ copyExistingInteraction\ =\ currentOutInteraction;}
\DoxyCodeLine{00947\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{while}(lastOutInteraction\ <\ \textcolor{keywordtype}{int}(outsideInteractions.size())\ \&\&\ outsideInteractions[lastOutInteraction].outIndex\ <\ blockEndIdxOther)\{}
\DoxyCodeLine{00948\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ leafPos\ =\ leftContainers-\/>getLeafIndex(outsideInteractions[lastOutInteraction].outIndex);}
\DoxyCodeLine{00949\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(leafPos\ !=\ -\/1)\{}
\DoxyCodeLine{00950\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(copyExistingInteraction\ !=\ lastOutInteraction)\{}
\DoxyCodeLine{00951\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ outsideInteractions[copyExistingInteraction]\ =\ outsideInteractions[lastOutInteraction];}
\DoxyCodeLine{00952\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00953\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ outsideInteractions[copyExistingInteraction].outsideIdxInBlock\ =\ leafPos;}
\DoxyCodeLine{00954\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ copyExistingInteraction\ +=\ 1;}
\DoxyCodeLine{00955\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00956\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ lastOutInteraction\ +=\ 1;}
\DoxyCodeLine{00957\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00958\ }
\DoxyCodeLine{00959\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ nbInteractionsBetweenBlocks\ =\ (copyExistingInteraction-\/currentOutInteraction);}
\DoxyCodeLine{00960\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(nbInteractionsBetweenBlocks)\{}
\DoxyCodeLine{00961\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ externalInteractions-\/>emplace\_back();}
\DoxyCodeLine{00962\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{struct_f_group_task_star_p_u_algorithm_1_1_block_interactions}{BlockInteractions<ParticleGroupClass>}}*\ interactions\ =\ \&externalInteractions-\/>back();}
\DoxyCodeLine{00963\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ interactions-\/>otherBlock\ =\ leftContainers;}
\DoxyCodeLine{00964\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ interactions-\/>otherBlockId\ =\ idxLeftGroup;}
\DoxyCodeLine{00965\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ interactions-\/>interactions.resize(nbInteractionsBetweenBlocks);}
\DoxyCodeLine{00966\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ std::copy(outsideInteractions.begin()\ +\ currentOutInteraction,}
\DoxyCodeLine{00967\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ outsideInteractions.begin()\ +\ copyExistingInteraction,}
\DoxyCodeLine{00968\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ interactions-\/>interactions.begin());}
\DoxyCodeLine{00969\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00970\ }
\DoxyCodeLine{00971\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ currentOutInteraction\ =\ lastOutInteraction;}
\DoxyCodeLine{00972\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00973\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00974\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00975\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00976\ \ \ \ \ \ \ \ \ FLOG(\ leafTimer.tac();\ );}
\DoxyCodeLine{00977\ \ \ \ \ \ \ \ \ FLOG(\ cellTimer.\mbox{\hyperlink{class_f_tic_ac0e070e65af128fbe5af711e51033b0a}{tic}}();\ );}
\DoxyCodeLine{00978\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00979\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ idxLevel\ =\ tree-\/>getHeight()-\/1\ ;\ idxLevel\ >=\ 2\ ;\ -\/-\/idxLevel)\{}
\DoxyCodeLine{00980\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ externalInteractionsAllLevel[idxLevel].resize(tree-\/>getNbCellGroupAtLevel(idxLevel));}
\DoxyCodeLine{00981\ }
\DoxyCodeLine{00982\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ idxGroup\ =\ 0\ ;\ idxGroup\ <\ tree-\/>getNbCellGroupAtLevel(idxLevel)\ ;\ ++idxGroup)\{}
\DoxyCodeLine{00983\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ CellContainerClass*\ currentCells\ =\ tree-\/>getCellGroup(idxLevel,\ idxGroup);}
\DoxyCodeLine{00984\ }
\DoxyCodeLine{00985\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ std::vector<BlockInteractions<CellContainerClass>>*\ externalInteractions\ =\ \&externalInteractionsAllLevel[idxLevel][idxGroup];}
\DoxyCodeLine{00986\ }
\DoxyCodeLine{00987\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \#pragma\ omp\ task\ default(none)\ firstprivate(idxGroup,\ currentCells,\ idxLevel,\ externalInteractions)}}
\DoxyCodeLine{00988\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00989\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ std::vector<OutOfBlockInteraction>\ outsideInteractions;}
\DoxyCodeLine{00990\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ MortonIndex\ blockStartIdx\ =\ currentCells-\/>getStartingIndex();}
\DoxyCodeLine{00991\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ MortonIndex\ blockEndIdx\ \ \ =\ currentCells-\/>getEndingIndex();}
\DoxyCodeLine{00992\ }
\DoxyCodeLine{00993\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ cellIdx\ =\ 0\ ;\ cellIdx\ <\ currentCells-\/>getNumberOfCellsInBlock()\ ;\ ++cellIdx)\{}
\DoxyCodeLine{00994\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ MortonIndex\ mindex\ =\ currentCells-\/>getCellMortonIndex(cellIdx);}
\DoxyCodeLine{00995\ }
\DoxyCodeLine{00996\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ MortonIndex\ interactionsIndexes[189];}
\DoxyCodeLine{00997\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ interactionsPosition[189];}
\DoxyCodeLine{00998\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_f_tree_coordinate}{FTreeCoordinate}}\ coord(mindex,\ idxLevel);}
\DoxyCodeLine{00999\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ counter\ =\ coord.\mbox{\hyperlink{class_f_tree_coordinate_ad9a4eeadc6666916ebfb35fa9f794abd}{getInteractionNeighbors}}(idxLevel,interactionsIndexes,interactionsPosition);}
\DoxyCodeLine{01000\ }
\DoxyCodeLine{01001\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ idxInter\ =\ 0\ ;\ idxInter\ <\ counter\ ;\ ++idxInter)\{}
\DoxyCodeLine{01002\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\ blockStartIdx\ <=\ interactionsIndexes[idxInter]\ \&\&\ interactionsIndexes[idxInter]\ <\ blockEndIdx\ )\{}
\DoxyCodeLine{01003\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Nothing\ to\ do}}
\DoxyCodeLine{01004\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01005\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}(interactionsIndexes[idxInter]\ <\ mindex)\{}
\DoxyCodeLine{01006\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{struct_out_of_block_interaction}{OutOfBlockInteraction}}\ property;}
\DoxyCodeLine{01007\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{property}.insideIndex\ =\ mindex;}
\DoxyCodeLine{01008\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{property}.outIndex\ \ \ \ =\ interactionsIndexes[idxInter];}
\DoxyCodeLine{01009\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{property}.relativeOutPosition\ =\ interactionsPosition[idxInter];}
\DoxyCodeLine{01010\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{property}.insideIdxInBlock\ =\ cellIdx;}
\DoxyCodeLine{01011\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{property}.outsideIdxInBlock\ =\ -\/1;}
\DoxyCodeLine{01012\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ outsideInteractions.push\_back(property);}
\DoxyCodeLine{01013\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01014\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01015\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01016\ }
\DoxyCodeLine{01017\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Manage\ outofblock\ interaction}}
\DoxyCodeLine{01018\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_f_quick_sort}{FQuickSort<OutOfBlockInteraction,\ int>::QsSequential}}(outsideInteractions.data(),\textcolor{keywordtype}{int}(outsideInteractions.size()));}
\DoxyCodeLine{01019\ }
\DoxyCodeLine{01020\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ currentOutInteraction\ =\ 0;}
\DoxyCodeLine{01021\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ idxLeftGroup\ =\ 0\ ;\ idxLeftGroup\ <\ idxGroup\ \&\&\ currentOutInteraction\ <\ int(outsideInteractions.size())\ ;\ ++idxLeftGroup)\{}
\DoxyCodeLine{01022\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ CellContainerClass*\ leftCells\ \ \ =\ tree-\/>getCellGroup(idxLevel,\ idxLeftGroup);}
\DoxyCodeLine{01023\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ MortonIndex\ blockStartIdxOther\ =\ leftCells-\/>getStartingIndex();}
\DoxyCodeLine{01024\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ MortonIndex\ blockEndIdxOther\ \ \ =\ leftCells-\/>getEndingIndex();}
\DoxyCodeLine{01025\ }
\DoxyCodeLine{01026\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{while}(currentOutInteraction\ <\ \textcolor{keywordtype}{int}(outsideInteractions.size())}
\DoxyCodeLine{01027\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \&\&\ (outsideInteractions[currentOutInteraction].outIndex\ <\ blockStartIdxOther}
\DoxyCodeLine{01028\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ||\ leftCells-\/>getCellIndex(outsideInteractions[currentOutInteraction].outIndex)\ ==\ -\/1)}
\DoxyCodeLine{01029\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \&\&\ outsideInteractions[currentOutInteraction].outIndex\ <\ blockEndIdxOther)\{}
\DoxyCodeLine{01030\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ currentOutInteraction\ +=\ 1;}
\DoxyCodeLine{01031\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01032\ }
\DoxyCodeLine{01033\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ lastOutInteraction\ =\ currentOutInteraction;}
\DoxyCodeLine{01034\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ copyExistingInteraction\ =\ currentOutInteraction;}
\DoxyCodeLine{01035\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{while}(lastOutInteraction\ <\ \textcolor{keywordtype}{int}(outsideInteractions.size())\ \&\&\ outsideInteractions[lastOutInteraction].outIndex\ <\ blockEndIdxOther)\{}
\DoxyCodeLine{01036\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ cellPos\ =\ leftCells-\/>getCellIndex(outsideInteractions[lastOutInteraction].outIndex);}
\DoxyCodeLine{01037\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(cellPos\ !=\ -\/1)\{}
\DoxyCodeLine{01038\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(copyExistingInteraction\ !=\ lastOutInteraction)\{}
\DoxyCodeLine{01039\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ outsideInteractions[copyExistingInteraction]\ =\ outsideInteractions[lastOutInteraction];}
\DoxyCodeLine{01040\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01041\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ outsideInteractions[copyExistingInteraction].outsideIdxInBlock\ =\ cellPos;}
\DoxyCodeLine{01042\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ copyExistingInteraction\ +=\ 1;}
\DoxyCodeLine{01043\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01044\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ lastOutInteraction\ +=\ 1;}
\DoxyCodeLine{01045\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01046\ }
\DoxyCodeLine{01047\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Create\ interactions}}
\DoxyCodeLine{01048\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ nbInteractionsBetweenBlocks\ =\ (copyExistingInteraction-\/currentOutInteraction);}
\DoxyCodeLine{01049\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(nbInteractionsBetweenBlocks)\{}
\DoxyCodeLine{01050\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ externalInteractions-\/>emplace\_back();}
\DoxyCodeLine{01051\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{struct_f_group_task_star_p_u_algorithm_1_1_block_interactions}{BlockInteractions<CellContainerClass>}}*\ interactions\ =\ \&externalInteractions-\/>back();}
\DoxyCodeLine{01052\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ interactions-\/>otherBlock\ =\ leftCells;}
\DoxyCodeLine{01053\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ interactions-\/>otherBlockId\ =\ idxLeftGroup;}
\DoxyCodeLine{01054\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ interactions-\/>interactions.resize(nbInteractionsBetweenBlocks);}
\DoxyCodeLine{01055\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ std::copy(outsideInteractions.begin()\ +\ currentOutInteraction,}
\DoxyCodeLine{01056\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ outsideInteractions.begin()\ +\ copyExistingInteraction,}
\DoxyCodeLine{01057\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ interactions-\/>interactions.begin());}
\DoxyCodeLine{01058\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01059\ }
\DoxyCodeLine{01060\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ currentOutInteraction\ =\ lastOutInteraction;}
\DoxyCodeLine{01061\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01062\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01063\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01064\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01065\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01066\ \ \ \ \ \ \ \ \ FLOG(\ cellTimer.\mbox{\hyperlink{class_f_tic_a3efff71f7c95acd38451bfab08fa4583}{tac}}();\ );}
\DoxyCodeLine{01067\ }
\DoxyCodeLine{01068\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \#pragma\ omp\ taskwait}}
\DoxyCodeLine{01069\ }
\DoxyCodeLine{01070\ \ \ \ \ \ \ \ \ FLOG(\ FLog::Controller\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)t\(\backslash\)t\ Prepare\ in\ "{}}\ <<\ timer.tacAndElapsed()\ <<\ \textcolor{stringliteral}{"{}s\(\backslash\)n"{}}\ );}
\DoxyCodeLine{01071\ \ \ \ \ \ \ \ \ FLOG(\ FLog::Controller\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)t\(\backslash\)t\(\backslash\)t\ Prepare\ at\ leaf\ level\ in\ \ \ "{}}\ <<\ leafTimer.elapsed()\ <<\ \textcolor{stringliteral}{"{}s\(\backslash\)n"{}}\ );}
\DoxyCodeLine{01072\ \ \ \ \ \ \ \ \ FLOG(\ FLog::Controller\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)t\(\backslash\)t\(\backslash\)t\ Prepare\ at\ other\ levels\ in\ "{}}\ <<\ cellTimer.\mbox{\hyperlink{class_f_tic_a30b9f876fb7188f85b4c2b9d7fd7943e}{elapsed}}()\ <<\ \textcolor{stringliteral}{"{}s\(\backslash\)n"{}}\ );}
\DoxyCodeLine{01073\ \ \ \ \ \}}
\DoxyCodeLine{01074\ }
\DoxyCodeLine{01078\ }
\DoxyCodeLine{01079\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_f_group_task_star_p_u_algorithm_a232654dd8053610f2188bd7c0bbce091}{bottomPass}}()\{}
\DoxyCodeLine{01080\ \ \ \ \ \ \ \ \ FLOG(\ \mbox{\hyperlink{class_f_tic}{FTic}}\ timer;\ );}
\DoxyCodeLine{01081\ }
\DoxyCodeLine{01082\ \ \ \ \ \ \ \ \ FAssertLF(cellHandles[tree-\/>getHeight()-\/1].size()\ ==\ particleHandles.size());}
\DoxyCodeLine{01083\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ idxGroup\ =\ 0\ ;\ idxGroup\ <\ tree-\/>getNbParticleGroup()\ ;\ ++idxGroup)\{}
\DoxyCodeLine{01084\ \textcolor{preprocessor}{\#ifdef\ STARPU\_SIMGRID\_MLR\_MODELS}}
\DoxyCodeLine{01085\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ *parameters\ =\ (\textcolor{keywordtype}{double}*)\ calloc(1,p2m\_cl.model-\/>nparameters*\textcolor{keyword}{sizeof}(\textcolor{keywordtype}{double}));}
\DoxyCodeLine{01086\ \ \ \ \ \ \ \ \ parameters[0]\ =\ (double)\ tree-\/>getCellGroup(tree-\/>getHeight()-\/1,idxGroup)-\/>getNumberOfCellsInBlock();}
\DoxyCodeLine{01087\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ parameters[1]\ =\ (double)\ tree-\/>getCellGroup(tree-\/>getHeight()-\/1,idxGroup)-\/>getSizeOfInterval();}
\DoxyCodeLine{01088\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ parameters[2]\ =\ (double)\ tree-\/>getParticleGroup(idxGroup)-\/>getNbParticlesInGroup();}
\DoxyCodeLine{01089\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{01090\ \ \ \ \ \ \ }
\DoxyCodeLine{01091\ \ \ \ \ \ \ \ \ \ \ \ \ starpu\_insert\_task(\&p2m\_cl,}
\DoxyCodeLine{01092\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_VALUE,\ \&wrapperptr,\ \textcolor{keyword}{sizeof}(wrapperptr),}
\DoxyCodeLine{01093\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_VALUE,\ \&cellHandles[tree-\/>getHeight()-\/1][idxGroup].intervalSize,\ \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{int}),}
\DoxyCodeLine{01094\ \#ifdef\ STARPU\_SIMGRID\_MLR\_MODELS}
\DoxyCodeLine{01095\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_VALUE,\ \&parameters[0],\ \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{double}),}
\DoxyCodeLine{01096\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_VALUE,\ \&parameters[1],\ \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{double}),\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{01097\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_VALUE,\ \&parameters[2],\ \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{double}),}
\DoxyCodeLine{01098\ \#endif}
\DoxyCodeLine{01099\ \#ifdef\ SCALFMM\_STARPU\_USE\_PRIO}
\DoxyCodeLine{01100\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_PRIORITY,\ PrioClass::Controller().getInsertionPosP2M(),}
\DoxyCodeLine{01101\ \#endif}
\DoxyCodeLine{01102\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_R,\ cellHandles[tree-\/>getHeight()-\/1][idxGroup].symb,}
\DoxyCodeLine{01103\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_RW,\ cellHandles[tree-\/>getHeight()-\/1][idxGroup].up,}
\DoxyCodeLine{01104\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_R,\ particleHandles[idxGroup].symb,}
\DoxyCodeLine{01105\ \#ifdef\ STARPU\_USE\_TASK\_NAME}
\DoxyCodeLine{01106\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_NAME,\ p2mTaskNames.get(),}
\DoxyCodeLine{01107\ \#endif}
\DoxyCodeLine{01108\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 0);}
\DoxyCodeLine{01109\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01110\ }
\DoxyCodeLine{01111\ \ \ \ \ \ \ \ \ FLOG(\ FLog::Controller\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)t\(\backslash\)t\ bottomPass\ in\ "{}}\ <<\ timer.tacAndElapsed()\ <<\ \textcolor{stringliteral}{"{}s\(\backslash\)n"{}}\ );}
\DoxyCodeLine{01112\ \ \ \ \ \}}
\DoxyCodeLine{01113\ }
\DoxyCodeLine{01117\ }
\DoxyCodeLine{01118\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_f_group_task_star_p_u_algorithm_af45e860f3213015f3792c7402a02694d}{upwardPass}}()\{}
\DoxyCodeLine{01119\ \ \ \ \ \ \ \ \ FLOG(\ \mbox{\hyperlink{class_f_tic}{FTic}}\ timer;\ );}
\DoxyCodeLine{01120\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ idxLevel\ =\ \mbox{\hyperlink{struct_f_math_a43635af3d44bb1868015681ce994df7b}{FMath::Min}}(tree-\/>getHeight()\ -\/\ 2,\ \mbox{\hyperlink{class_f_abstract_algorithm_a694b8888186be58e38691ce08b177d46}{FAbstractAlgorithm::lowerWorkingLevel}}\ -\/\ 1)\ ;\ idxLevel\ >=\ \mbox{\hyperlink{class_f_abstract_algorithm_ade49cb5ede82d078261e576a9d809dc2}{FAbstractAlgorithm::upperWorkingLevel}}\ ;\ -\/-\/idxLevel)\{}
\DoxyCodeLine{01121\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ idxSubGroup\ =\ 0;}
\DoxyCodeLine{01122\ }
\DoxyCodeLine{01123\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ idxGroup\ =\ 0\ ;\ idxGroup\ <\ tree-\/>getNbCellGroupAtLevel(idxLevel)\ ;\ ++idxGroup)\{}
\DoxyCodeLine{01124\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ CellContainerClass*\textcolor{keyword}{const}\ currentCells\ =\ tree-\/>getCellGroup(idxLevel,\ idxGroup);}
\DoxyCodeLine{01125\ }
\DoxyCodeLine{01126\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Skip\ current\ group\ if\ needed}}
\DoxyCodeLine{01127\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\ tree-\/>getCellGroup(idxLevel+1,\ idxSubGroup)-\/>getEndingIndex()\ <=\ (currentCells-\/>getStartingIndex()<<3)\ )\{}
\DoxyCodeLine{01128\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ++idxSubGroup;}
\DoxyCodeLine{01129\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ FAssertLF(\ idxSubGroup\ !=\ tree-\/>getNbCellGroupAtLevel(idxLevel+1)\ );}
\DoxyCodeLine{01130\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ FAssertLF(\ (tree-\/>getCellGroup(idxLevel+1,\ idxSubGroup)-\/>getStartingIndex()>>3)\ ==\ currentCells-\/>getStartingIndex()\ );}
\DoxyCodeLine{01131\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01132\ }
\DoxyCodeLine{01133\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Copy\ at\ max\ 8\ groups}}
\DoxyCodeLine{01134\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01135\ }
\DoxyCodeLine{01136\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{struct\ }starpu\_task*\ \textcolor{keyword}{const}\ task\ =\ starpu\_task\_create();}
\DoxyCodeLine{01137\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ task-\/>dyn\_handles\ =\ (starpu\_data\_handle\_t*)malloc(\textcolor{keyword}{sizeof}(starpu\_data\_handle\_t)*20);}
\DoxyCodeLine{01138\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ task-\/>dyn\_handles[0]\ =\ cellHandles[idxLevel][idxGroup].symb;}
\DoxyCodeLine{01139\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ task-\/>dyn\_handles[1]\ =\ cellHandles[idxLevel][idxGroup].up;}
\DoxyCodeLine{01140\ }
\DoxyCodeLine{01141\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ task-\/>dyn\_handles[2]\ =\ cellHandles[idxLevel+1][idxSubGroup].symb;}
\DoxyCodeLine{01142\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ task-\/>dyn\_handles[3]\ =\ cellHandles[idxLevel+1][idxSubGroup].up;}
\DoxyCodeLine{01143\ }
\DoxyCodeLine{01144\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ put\ the\ right\ codelet}}
\DoxyCodeLine{01145\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ task-\/>cl\ =\ \&m2m\_cl;}
\DoxyCodeLine{01146\ \textcolor{preprocessor}{\#ifdef\ STARPU\_SIMGRID\_MLR\_MODELS}}
\DoxyCodeLine{01147\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ nbChildParent\ =\ 0;}
\DoxyCodeLine{01148\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01149\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ CellContainerClass*\textcolor{keyword}{const}\ currentCells\ =\ tree-\/>getCellGroup(idxLevel,\ idxGroup);}
\DoxyCodeLine{01150\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ CellContainerClass*\textcolor{keyword}{const}\ subCellGroup\ =\ tree-\/>getCellGroup(idxLevel+1,\ idxSubGroup);}
\DoxyCodeLine{01151\ }
\DoxyCodeLine{01152\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ MortonIndex\ firstParent\ =\ \mbox{\hyperlink{struct_f_math_ada359f2b021ce4b999c0fd7a6e9daae6}{FMath::Max}}(currentCells-\/>getStartingIndex(),\ subCellGroup-\/>getStartingIndex()>>3);}
\DoxyCodeLine{01153\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ MortonIndex\ lastParent\ =\ \mbox{\hyperlink{struct_f_math_a43635af3d44bb1868015681ce994df7b}{FMath::Min}}(currentCells-\/>getEndingIndex()-\/1,\ (subCellGroup-\/>getEndingIndex()-\/1)>>3);}
\DoxyCodeLine{01154\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ idxParentCell\ =\ currentCells-\/>getCellIndex(firstParent);}
\DoxyCodeLine{01155\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ idxChildCell\ \ =\ subCellGroup-\/>getFistChildIdx(firstParent);}
\DoxyCodeLine{01156\ }
\DoxyCodeLine{01157\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{while}(\textcolor{keyword}{true})\{}
\DoxyCodeLine{01158\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ cell\ =\ currentCells-\/>getUpCell(idxParentCell);}
\DoxyCodeLine{01159\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{do}\{}
\DoxyCodeLine{01160\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ idxChildCell\ +=\ 1;}
\DoxyCodeLine{01161\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}\textcolor{keywordflow}{while}(idxChildCell\ !=\ subCellGroup-\/>getNumberOfCellsInBlock()\ \&\&\ cell.getMortonIndex()\ ==\ (subCellGroup-\/>getCellMortonIndex(idxChildCell)>>3));}
\DoxyCodeLine{01162\ }
\DoxyCodeLine{01163\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ nbChildParent\ +=\ 1;}
\DoxyCodeLine{01164\ }
\DoxyCodeLine{01165\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(currentCells-\/>getCellMortonIndex(idxParentCell)\ ==\ lastParent)\{}
\DoxyCodeLine{01166\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01167\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01168\ }
\DoxyCodeLine{01169\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ idxParentCell\ +=\ 1;}
\DoxyCodeLine{01170\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01171\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01172\ }
\DoxyCodeLine{01173\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ *parameters\ =\ (\textcolor{keywordtype}{double}*)\ calloc(1,m2m\_cl.model-\/>nparameters*\textcolor{keyword}{sizeof}(\textcolor{keywordtype}{double}));}
\DoxyCodeLine{01174\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ parameters[0]\ =\ (double)\ idxLevel;}
\DoxyCodeLine{01175\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ parameters[1]\ =\ (double)\ tree-\/>getCellGroup(idxLevel,idxGroup)-\/>getNumberOfCellsInBlock();}
\DoxyCodeLine{01176\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ parameters[2]\ =\ (double)\ tree-\/>getCellGroup(idxLevel,idxGroup)-\/>getSizeOfInterval();}
\DoxyCodeLine{01177\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ parameters[3]\ =\ (double)\ tree-\/>getCellGroup(idxLevel+1,idxSubGroup)-\/>getNumberOfCellsInBlock();}
\DoxyCodeLine{01178\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ parameters[4]\ =\ (double)\ tree-\/>getCellGroup(idxLevel+1,idxSubGroup)-\/>getSizeOfInterval();}
\DoxyCodeLine{01179\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ parameters[5]\ =\ (double)\ \mbox{\hyperlink{struct_f_math_a43635af3d44bb1868015681ce994df7b}{FMath::Min}}(tree-\/>getCellGroup(idxLevel,idxGroup)-\/>getEndingIndex()-\/1,\ (tree-\/>getCellGroup(idxLevel+1,idxSubGroup)-\/>getEndingIndex()-\/1)>>3)-\/}
\DoxyCodeLine{01180\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{struct_f_math_ada359f2b021ce4b999c0fd7a6e9daae6}{FMath::Max}}(tree-\/>getCellGroup(idxLevel,idxGroup)-\/>getStartingIndex(),\ tree-\/>getCellGroup(idxLevel+1,idxSubGroup)-\/>getStartingIndex()>>3);}
\DoxyCodeLine{01181\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ parameters[6]\ =\ (double)\ nbChildParent;}
\DoxyCodeLine{01182\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{01183\ }
\DoxyCodeLine{01184\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ put\ args\ values}}
\DoxyCodeLine{01185\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{char}\ *arg\_buffer;}
\DoxyCodeLine{01186\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ arg\_buffer\_size;}
\DoxyCodeLine{01187\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ starpu\_codelet\_pack\_args((\textcolor{keywordtype}{void}**)\&arg\_buffer,\ \&arg\_buffer\_size,}
\DoxyCodeLine{01188\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_VALUE,\ \&wrapperptr,\ \textcolor{keyword}{sizeof}(wrapperptr),}
\DoxyCodeLine{01189\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_VALUE,\ \&idxLevel,\ \textcolor{keyword}{sizeof}(idxLevel),}
\DoxyCodeLine{01190\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_VALUE,\ \&cellHandles[idxLevel][idxGroup].intervalSize,\ \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{int}),}
\DoxyCodeLine{01191\ \#ifdef\ STARPU\_SIMGRID\_MLR\_MODELS}
\DoxyCodeLine{01192\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_VALUE,\ \&parameters[0],\ \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{double}),}
\DoxyCodeLine{01193\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_VALUE,\ \&parameters[1],\ \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{double}),}
\DoxyCodeLine{01194\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_VALUE,\ \&parameters[2],\ \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{double}),}
\DoxyCodeLine{01195\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_VALUE,\ \&parameters[3],\ \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{double}),}
\DoxyCodeLine{01196\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_VALUE,\ \&parameters[4],\ \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{double}),}
\DoxyCodeLine{01197\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_VALUE,\ \&parameters[5],\ \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{double}),}
\DoxyCodeLine{01198\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_VALUE,\ \&parameters[6],\ \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{double}),}
\DoxyCodeLine{01199\ \#endif}
\DoxyCodeLine{01200\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 0);}
\DoxyCodeLine{01201\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ task-\/>cl\_arg\ =\ arg\_buffer;}
\DoxyCodeLine{01202\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ task-\/>cl\_arg\_size\ =\ arg\_buffer\_size;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{01203\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ task-\/>cl\_arg\_free\ =\ 1;}
\DoxyCodeLine{01204\ \textcolor{preprocessor}{\#ifdef\ SCALFMM\_STARPU\_USE\_PRIO}}
\DoxyCodeLine{01205\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ task-\/>priority\ =\ PrioClass::Controller().getInsertionPosM2M(idxLevel);}
\DoxyCodeLine{01206\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{01207\ \textcolor{preprocessor}{\ \ \ \ \#ifdef\ STARPU\_USE\_TASK\_NAME}}
\DoxyCodeLine{01208\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ task-\/>name\ =\ m2mTaskNames[idxLevel].get();}
\DoxyCodeLine{01209\ \textcolor{preprocessor}{\ \ \ \ \#endif}}
\DoxyCodeLine{01210\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ FAssertLF(starpu\_task\_submit(task)\ ==\ 0);}
\DoxyCodeLine{01211\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01212\ }
\DoxyCodeLine{01213\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{while}(tree-\/>getCellGroup(idxLevel+1,\ idxSubGroup)-\/>getEndingIndex()\ <=\ (((currentCells-\/>getEndingIndex()-\/1)<<3)+7)}
\DoxyCodeLine{01214\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \&\&\ (idxSubGroup+1)\ !=\ tree-\/>getNbCellGroupAtLevel(idxLevel+1)}
\DoxyCodeLine{01215\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \&\&\ tree-\/>getCellGroup(idxLevel+1,\ idxSubGroup+1)-\/>getStartingIndex()\ <=\ ((currentCells-\/>getEndingIndex()-\/1)<<3)+7\ )\{}
\DoxyCodeLine{01216\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ idxSubGroup\ +=\ 1;}
\DoxyCodeLine{01217\ }
\DoxyCodeLine{01218\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{struct\ }starpu\_task*\ \textcolor{keyword}{const}\ task\ =\ starpu\_task\_create();}
\DoxyCodeLine{01219\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ task-\/>dyn\_handles\ =\ (starpu\_data\_handle\_t*)malloc(\textcolor{keyword}{sizeof}(starpu\_data\_handle\_t)*20);}
\DoxyCodeLine{01220\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ task-\/>dyn\_handles[0]\ =\ cellHandles[idxLevel][idxGroup].symb;}
\DoxyCodeLine{01221\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ task-\/>dyn\_handles[1]\ =\ cellHandles[idxLevel][idxGroup].up;}
\DoxyCodeLine{01222\ }
\DoxyCodeLine{01223\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ task-\/>dyn\_handles[2]\ =\ cellHandles[idxLevel+1][idxSubGroup].symb;}
\DoxyCodeLine{01224\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ task-\/>dyn\_handles[3]\ =\ cellHandles[idxLevel+1][idxSubGroup].up;}
\DoxyCodeLine{01225\ }
\DoxyCodeLine{01226\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ put\ the\ right\ codelet}}
\DoxyCodeLine{01227\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ task-\/>cl\ =\ \&m2m\_cl;}
\DoxyCodeLine{01228\ \textcolor{preprocessor}{\#ifdef\ STARPU\_SIMGRID\_MLR\_MODELS}}
\DoxyCodeLine{01229\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ nbChildParent\ =\ 0;}
\DoxyCodeLine{01230\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01231\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ CellContainerClass*\textcolor{keyword}{const}\ currentCells\ =\ tree-\/>getCellGroup(idxLevel,\ idxGroup);}
\DoxyCodeLine{01232\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ CellContainerClass*\textcolor{keyword}{const}\ subCellGroup\ =\ tree-\/>getCellGroup(idxLevel+1,\ idxSubGroup);}
\DoxyCodeLine{01233\ }
\DoxyCodeLine{01234\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ MortonIndex\ firstParent\ =\ \mbox{\hyperlink{struct_f_math_ada359f2b021ce4b999c0fd7a6e9daae6}{FMath::Max}}(currentCells-\/>getStartingIndex(),\ subCellGroup-\/>getStartingIndex()>>3);}
\DoxyCodeLine{01235\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ MortonIndex\ lastParent\ =\ \mbox{\hyperlink{struct_f_math_a43635af3d44bb1868015681ce994df7b}{FMath::Min}}(currentCells-\/>getEndingIndex()-\/1,\ (subCellGroup-\/>getEndingIndex()-\/1)>>3);}
\DoxyCodeLine{01236\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ idxParentCell\ =\ currentCells-\/>getCellIndex(firstParent);}
\DoxyCodeLine{01237\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ idxChildCell\ \ =\ subCellGroup-\/>getFistChildIdx(firstParent);}
\DoxyCodeLine{01238\ }
\DoxyCodeLine{01239\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{while}(\textcolor{keyword}{true})\{}
\DoxyCodeLine{01240\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ cell\ =\ currentCells-\/>getUpCell(idxParentCell);}
\DoxyCodeLine{01241\ }
\DoxyCodeLine{01242\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{do}\{}
\DoxyCodeLine{01243\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ idxChildCell\ +=\ 1;}
\DoxyCodeLine{01244\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}\textcolor{keywordflow}{while}(idxChildCell\ !=\ subCellGroup-\/>getNumberOfCellsInBlock()\ \&\&\ cell.getMortonIndex()\ ==\ (subCellGroup-\/>getCellMortonIndex(idxChildCell)>>3));}
\DoxyCodeLine{01245\ }
\DoxyCodeLine{01246\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ nbChildParent\ +=\ 1;}
\DoxyCodeLine{01247\ }
\DoxyCodeLine{01248\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(currentCells-\/>getCellMortonIndex(idxParentCell)\ ==\ lastParent)\{}
\DoxyCodeLine{01249\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01250\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01251\ }
\DoxyCodeLine{01252\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ idxParentCell\ +=\ 1;}
\DoxyCodeLine{01253\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01254\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01255\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ *parameters\ =\ (\textcolor{keywordtype}{double}*)\ calloc(1,m2m\_cl.model-\/>nparameters*\textcolor{keyword}{sizeof}(\textcolor{keywordtype}{double}));}
\DoxyCodeLine{01256\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ parameters[0]\ =\ (double)\ idxLevel;}
\DoxyCodeLine{01257\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ parameters[1]\ =\ (double)\ tree-\/>getCellGroup(idxLevel,idxGroup)-\/>getNumberOfCellsInBlock();}
\DoxyCodeLine{01258\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ parameters[2]\ =\ (double)\ tree-\/>getCellGroup(idxLevel,idxGroup)-\/>getSizeOfInterval();}
\DoxyCodeLine{01259\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ parameters[3]\ =\ (double)\ tree-\/>getCellGroup(idxLevel+1,idxSubGroup)-\/>getNumberOfCellsInBlock();}
\DoxyCodeLine{01260\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ parameters[4]\ =\ (double)\ tree-\/>getCellGroup(idxLevel+1,idxSubGroup)-\/>getSizeOfInterval();}
\DoxyCodeLine{01261\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ parameters[5]\ =\ (double)\ \mbox{\hyperlink{struct_f_math_a43635af3d44bb1868015681ce994df7b}{FMath::Min}}(tree-\/>getCellGroup(idxLevel,idxGroup)-\/>getEndingIndex()-\/1,\ (tree-\/>getCellGroup(idxLevel+1,idxSubGroup)-\/>getEndingIndex()-\/1)>>3)-\/}
\DoxyCodeLine{01262\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{struct_f_math_ada359f2b021ce4b999c0fd7a6e9daae6}{FMath::Max}}(tree-\/>getCellGroup(idxLevel,idxGroup)-\/>getStartingIndex(),\ tree-\/>getCellGroup(idxLevel+1,idxSubGroup)-\/>getStartingIndex()>>3);}
\DoxyCodeLine{01263\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ parameters[6]\ =\ (double)\ nbChildParent;}
\DoxyCodeLine{01264\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{01265\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ put\ args\ values}}
\DoxyCodeLine{01266\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{char}\ *arg\_buffer;}
\DoxyCodeLine{01267\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ arg\_buffer\_size;}
\DoxyCodeLine{01268\ }
\DoxyCodeLine{01269\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ starpu\_codelet\_pack\_args((\textcolor{keywordtype}{void}**)\&arg\_buffer,\ \&arg\_buffer\_size,}
\DoxyCodeLine{01270\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_VALUE,\ \&wrapperptr,\ \textcolor{keyword}{sizeof}(wrapperptr),}
\DoxyCodeLine{01271\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_VALUE,\ \&idxLevel,\ \textcolor{keyword}{sizeof}(idxLevel),}
\DoxyCodeLine{01272\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_VALUE,\ \&cellHandles[idxLevel][idxGroup].intervalSize,\ \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{int}),}
\DoxyCodeLine{01273\ \#ifdef\ STARPU\_SIMGRID\_MLR\_MODELS}
\DoxyCodeLine{01274\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_VALUE,\ \&parameters[0],\ \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{double}),}
\DoxyCodeLine{01275\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_VALUE,\ \&parameters[1],\ \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{double}),}
\DoxyCodeLine{01276\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_VALUE,\ \&parameters[2],\ \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{double}),}
\DoxyCodeLine{01277\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_VALUE,\ \&parameters[3],\ \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{double}),}
\DoxyCodeLine{01278\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_VALUE,\ \&parameters[4],\ \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{double}),}
\DoxyCodeLine{01279\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_VALUE,\ \&parameters[5],\ \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{double}),}
\DoxyCodeLine{01280\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_VALUE,\ \&parameters[6],\ \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{double}),}
\DoxyCodeLine{01281\ \#endif}
\DoxyCodeLine{01282\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 0);}
\DoxyCodeLine{01283\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ task-\/>cl\_arg\ =\ arg\_buffer;}
\DoxyCodeLine{01284\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ task-\/>cl\_arg\_size\ =\ arg\_buffer\_size;}
\DoxyCodeLine{01285\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ task-\/>cl\_arg\_free\ =\ 1;}
\DoxyCodeLine{01286\ }
\DoxyCodeLine{01287\ \textcolor{preprocessor}{\#ifdef\ SCALFMM\_STARPU\_USE\_PRIO}}
\DoxyCodeLine{01288\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ task-\/>priority\ =\ PrioClass::Controller().getInsertionPosM2M(idxLevel);}
\DoxyCodeLine{01289\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{01290\ \textcolor{preprocessor}{\ \ \ \ \#ifdef\ STARPU\_USE\_TASK\_NAME}}
\DoxyCodeLine{01291\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ task-\/>name\ =\ m2mTaskNames[idxLevel].get();}
\DoxyCodeLine{01292\ \textcolor{preprocessor}{\ \ \ \ \#endif}}
\DoxyCodeLine{01293\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ FAssertLF(starpu\_task\_submit(task)\ ==\ 0);}
\DoxyCodeLine{01294\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01295\ }
\DoxyCodeLine{01296\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01297\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01298\ \ \ \ \ \ \ \ \ FLOG(\ FLog::Controller\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)t\(\backslash\)t\ upwardPass\ in\ "{}}\ <<\ timer.tacAndElapsed()\ <<\ \textcolor{stringliteral}{"{}s\(\backslash\)n"{}}\ );}
\DoxyCodeLine{01299\ \ \ \ \ \}}
\DoxyCodeLine{01300\ }
\DoxyCodeLine{01304\ }
\DoxyCodeLine{01305\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_f_group_task_star_p_u_algorithm_a718175b27bcb9009dea5a681f621e265}{transferPass}}(\textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ fromLevel,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ toLevel,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{bool}\ inner,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{bool}\ outer)\{}
\DoxyCodeLine{01306\ \ \ \ \ \ \ \ \ FLOG(\ \mbox{\hyperlink{class_f_tic}{FTic}}\ timer;\ );}
\DoxyCodeLine{01307\ \ \ \ \ \ \ \ \ FLOG(\ \mbox{\hyperlink{class_f_tic}{FTic}}\ timerInBlock;\ \mbox{\hyperlink{class_f_tic}{FTic}}\ timerOutBlock;\ );}
\DoxyCodeLine{01308\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ idxLevel\ =\ fromLevel\ ;\ idxLevel\ <\ toLevel\ ;\ ++idxLevel)\{}
\DoxyCodeLine{01309\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(inner)\{}
\DoxyCodeLine{01310\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ FLOG(\ timerInBlock.tic()\ );}
\DoxyCodeLine{01311\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ idxGroup\ =\ 0\ ;\ idxGroup\ <\ tree-\/>getNbCellGroupAtLevel(idxLevel)\ ;\ ++idxGroup)\{}
\DoxyCodeLine{01312\ \textcolor{preprocessor}{\#ifdef\ STARPU\_SIMGRID\_MLR\_MODELS}}
\DoxyCodeLine{01313\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ nbM2LInteractions\ =\ 0;}
\DoxyCodeLine{01314\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01315\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ CellContainerClass*\textcolor{keyword}{const}\ currentCells\ =\ tree-\/>getCellGroup(idxLevel,\ idxGroup);}
\DoxyCodeLine{01316\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ MortonIndex\ blockStartIdx\ =\ currentCells-\/>getStartingIndex();}
\DoxyCodeLine{01317\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ MortonIndex\ blockEndIdx\ \ \ =\ currentCells-\/>getEndingIndex();}
\DoxyCodeLine{01318\ }
\DoxyCodeLine{01319\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ cellIdx\ =\ 0\ ;\ cellIdx\ <\ currentCells-\/>getNumberOfCellsInBlock()\ ;\ ++cellIdx)\{}
\DoxyCodeLine{01320\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ cell\ =\ currentCells-\/>getDownCell(cellIdx);}
\DoxyCodeLine{01321\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ MortonIndex\ interactionsIndexes[189];}
\DoxyCodeLine{01322\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ interactionsPosition[189];}
\DoxyCodeLine{01323\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_f_tree_coordinate}{FTreeCoordinate}}\ coord(cell.getCoordinate());}
\DoxyCodeLine{01324\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ counter\ =\ coord.\mbox{\hyperlink{class_f_tree_coordinate_ad9a4eeadc6666916ebfb35fa9f794abd}{getInteractionNeighbors}}(idxLevel,interactionsIndexes,interactionsPosition);}
\DoxyCodeLine{01325\ }
\DoxyCodeLine{01326\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ idxInter\ =\ 0\ ;\ idxInter\ <\ counter\ ;\ ++idxInter)\{}
\DoxyCodeLine{01327\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\ blockStartIdx\ <=\ interactionsIndexes[idxInter]\ \&\&\ interactionsIndexes[idxInter]\ <\ blockEndIdx\ )\{}
\DoxyCodeLine{01328\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ cellPos\ =\ currentCells-\/>getCellIndex(interactionsIndexes[idxInter]);}
\DoxyCodeLine{01329\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(cellPos\ !=\ -\/1)\{}
\DoxyCodeLine{01330\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ nbM2LInteractions\ +=\ 1;}
\DoxyCodeLine{01331\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01332\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01333\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01334\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01335\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01336\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ *parameters\ =\ (\textcolor{keywordtype}{double}*)\ calloc(1,m2l\_cl\_in.model-\/>nparameters*\textcolor{keyword}{sizeof}(\textcolor{keywordtype}{double}));}
\DoxyCodeLine{01337\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ parameters[0]\ =\ (double)\ idxLevel;}
\DoxyCodeLine{01338\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ parameters[1]\ =\ (double)\ tree-\/>getCellGroup(idxLevel,idxGroup)-\/>getNumberOfCellsInBlock();}
\DoxyCodeLine{01339\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ parameters[2]\ =\ (double)\ tree-\/>getCellGroup(idxLevel,idxGroup)-\/>getSizeOfInterval();}
\DoxyCodeLine{01340\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ parameters[3]\ =\ (double)\ nbM2LInteractions;}
\DoxyCodeLine{01341\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{01342\ \ \ \ \ \ \ }
\DoxyCodeLine{01343\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ starpu\_insert\_task(\&m2l\_cl\_in,}
\DoxyCodeLine{01344\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_VALUE,\ \&wrapperptr,\ \textcolor{keyword}{sizeof}(wrapperptr),}
\DoxyCodeLine{01345\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_VALUE,\ \&idxLevel,\ \textcolor{keyword}{sizeof}(idxLevel),}
\DoxyCodeLine{01346\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_VALUE,\ \&cellHandles[idxLevel][idxGroup].intervalSize,\ \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{int}),}
\DoxyCodeLine{01347\ \#ifdef\ STARPU\_SIMGRID\_MLR\_MODELS}
\DoxyCodeLine{01348\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_VALUE,\ \&parameters[0],\ \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{double}),}
\DoxyCodeLine{01349\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_VALUE,\ \&parameters[1],\ \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{double}),}
\DoxyCodeLine{01350\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_VALUE,\ \&parameters[2],\ \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{double}),}
\DoxyCodeLine{01351\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_VALUE,\ \&parameters[3],\ \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{double}),}
\DoxyCodeLine{01352\ \#endif}
\DoxyCodeLine{01353\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \#ifdef\ SCALFMM\_STARPU\_USE\_PRIO}
\DoxyCodeLine{01354\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_PRIORITY,\ PrioClass::Controller().getInsertionPosM2L(idxLevel),}
\DoxyCodeLine{01355\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_TAG\_ONLY,\ (starpu\_tag\_t)\ PrioClass::Controller().getInsertionPosM2L(idxLevel),}
\DoxyCodeLine{01356\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \#endif}
\DoxyCodeLine{01357\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_R,\ cellHandles[idxLevel][idxGroup].symb,}
\DoxyCodeLine{01358\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_R,\ cellHandles[idxLevel][idxGroup].up,}
\DoxyCodeLine{01359\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (STARPU\_RW|STARPU\_COMMUTE\_IF\_SUPPORTED),\ cellHandles[idxLevel][idxGroup].down,}
\DoxyCodeLine{01360\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \#ifdef\ STARPU\_USE\_TASK\_NAME}
\DoxyCodeLine{01361\ }
\DoxyCodeLine{01362\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_NAME,\ m2lTaskNames[idxLevel].get(),}
\DoxyCodeLine{01363\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \#endif}
\DoxyCodeLine{01364\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 0);}
\DoxyCodeLine{01365\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01366\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ FLOG(\ timerInBlock.tac()\ );}
\DoxyCodeLine{01367\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01368\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(outer)\{}
\DoxyCodeLine{01369\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ FLOG(\ timerOutBlock.tic()\ );}
\DoxyCodeLine{01370\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ idxGroup\ =\ 0\ ;\ idxGroup\ <\ tree-\/>getNbCellGroupAtLevel(idxLevel)\ ;\ ++idxGroup)\{}
\DoxyCodeLine{01371\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ idxInteraction\ =\ 0;\ idxInteraction\ <\ int(externalInteractionsAllLevel[idxLevel][idxGroup].size())\ ;\ ++idxInteraction)\{}
\DoxyCodeLine{01372\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ interactionid\ =\ externalInteractionsAllLevel[idxLevel][idxGroup][idxInteraction].otherBlockId;}
\DoxyCodeLine{01373\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::vector<OutOfBlockInteraction>*\ outsideInteractions\ =\ \&externalInteractionsAllLevel[idxLevel][idxGroup][idxInteraction].interactions;}
\DoxyCodeLine{01374\ \textcolor{preprocessor}{\#ifdef\ STARPU\_SIMGRID\_MLR\_MODELS}}
\DoxyCodeLine{01375\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ nbDiff0\ =\ 0;}
\DoxyCodeLine{01376\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ nbDiff1\ =\ 0;}
\DoxyCodeLine{01377\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01378\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ std::unordered\_set<int>\ exist0;}
\DoxyCodeLine{01379\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ std::unordered\_set<int>\ exist1;}
\DoxyCodeLine{01380\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ outInterIdx\ =\ 0\ ;\ outInterIdx\ <\ int(outsideInteractions-\/>size())\ ;\ ++outInterIdx)\{}
\DoxyCodeLine{01381\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(exist0.find((*outsideInteractions)[outInterIdx].insideIdxInBlock)\ ==\ exist0.end())\{}
\DoxyCodeLine{01382\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ exist0.insert((*outsideInteractions)[outInterIdx].insideIdxInBlock);}
\DoxyCodeLine{01383\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ nbDiff0\ +=\ 1;}
\DoxyCodeLine{01384\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01385\ }
\DoxyCodeLine{01386\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(exist1.find((*outsideInteractions)[outInterIdx].outsideIdxInBlock)\ ==\ exist1.end())\{}
\DoxyCodeLine{01387\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ exist1.insert((*outsideInteractions)[outInterIdx].outsideIdxInBlock);}
\DoxyCodeLine{01388\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ nbDiff1\ +=\ 1;}
\DoxyCodeLine{01389\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01390\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01391\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01392\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ *parameters\ =\ (\textcolor{keywordtype}{double}*)\ calloc(1,m2l\_cl\_inout.model-\/>nparameters*\textcolor{keyword}{sizeof}(\textcolor{keywordtype}{double}));}
\DoxyCodeLine{01393\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ parameters[0]\ =\ (double)\ idxLevel;}
\DoxyCodeLine{01394\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ parameters[1]\ =\ (double)\ tree-\/>getCellGroup(idxLevel,idxGroup)-\/>getNumberOfCellsInBlock();}
\DoxyCodeLine{01395\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ parameters[2]\ =\ (double)\ tree-\/>getCellGroup(idxLevel,idxGroup)-\/>getSizeOfInterval();}
\DoxyCodeLine{01396\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ parameters[3]\ =\ (double)\ tree-\/>getCellGroup(idxLevel,interactionid)-\/>getNumberOfCellsInBlock();}
\DoxyCodeLine{01397\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ parameters[4]\ =\ (double)\ tree-\/>getCellGroup(idxLevel,interactionid)-\/>getSizeOfInterval();}
\DoxyCodeLine{01398\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ parameters[5]\ =\ (double)\ outsideInteractions-\/>size();}
\DoxyCodeLine{01399\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ parameters[6]\ =\ (double)\ nbDiff0;}
\DoxyCodeLine{01400\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ parameters[7]\ =\ (double)\ nbDiff1;}
\DoxyCodeLine{01401\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{01402\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ mode\ =\ 1;}
\DoxyCodeLine{01403\ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{01404\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ starpu\_insert\_task(\&m2l\_cl\_inout,}
\DoxyCodeLine{01405\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_VALUE,\ \&wrapperptr,\ \textcolor{keyword}{sizeof}(wrapperptr),}
\DoxyCodeLine{01406\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_VALUE,\ \&idxLevel,\ \textcolor{keyword}{sizeof}(idxLevel),}
\DoxyCodeLine{01407\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_VALUE,\ \&outsideInteractions,\ \textcolor{keyword}{sizeof}(outsideInteractions),}
\DoxyCodeLine{01408\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_VALUE,\ \&cellHandles[idxLevel][idxGroup].intervalSize,\ \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{int}),}
\DoxyCodeLine{01409\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_VALUE,\ \&mode,\ \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{int}),}
\DoxyCodeLine{01410\ \#ifdef\ STARPU\_SIMGRID\_MLR\_MODELS}
\DoxyCodeLine{01411\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_VALUE,\ \&parameters[0],\ \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{double}),}
\DoxyCodeLine{01412\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_VALUE,\ \&parameters[1],\ \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{double}),}
\DoxyCodeLine{01413\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_VALUE,\ \&parameters[2],\ \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{double}),}
\DoxyCodeLine{01414\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_VALUE,\ \&parameters[3],\ \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{double}),}
\DoxyCodeLine{01415\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_VALUE,\ \&parameters[4],\ \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{double}),}
\DoxyCodeLine{01416\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_VALUE,\ \&parameters[5],\ \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{double}),}
\DoxyCodeLine{01417\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_VALUE,\ \&parameters[6],\ \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{double}),}
\DoxyCodeLine{01418\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_VALUE,\ \&parameters[7],\ \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{double}),}
\DoxyCodeLine{01419\ \#endif}
\DoxyCodeLine{01420\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \#ifdef\ SCALFMM\_STARPU\_USE\_PRIO}
\DoxyCodeLine{01421\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_PRIORITY,\ PrioClass::Controller().getInsertionPosM2LExtern(idxLevel),}
\DoxyCodeLine{01422\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_TAG\_ONLY,\ (starpu\_tag\_t)\ PrioClass::Controller().getInsertionPosM2LExtern(idxLevel),}
\DoxyCodeLine{01423\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \#endif}
\DoxyCodeLine{01424\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_R,\ cellHandles[idxLevel][idxGroup].symb,}
\DoxyCodeLine{01425\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (STARPU\_RW|STARPU\_COMMUTE\_IF\_SUPPORTED),\ cellHandles[idxLevel][idxGroup].down,}
\DoxyCodeLine{01426\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_R,\ cellHandles[idxLevel][interactionid].symb,}
\DoxyCodeLine{01427\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_R,\ cellHandles[idxLevel][interactionid].up,}
\DoxyCodeLine{01428\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \#ifdef\ STARPU\_USE\_TASK\_NAME}
\DoxyCodeLine{01429\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_NAME,\ m2lOuterTaskNames[idxLevel].get(),}
\DoxyCodeLine{01430\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \#endif}
\DoxyCodeLine{01431\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 0);}
\DoxyCodeLine{01432\ }
\DoxyCodeLine{01433\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ mode\ =\ 2;}
\DoxyCodeLine{01434\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ starpu\_insert\_task(\&m2l\_cl\_inout,}
\DoxyCodeLine{01435\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_VALUE,\ \&wrapperptr,\ \textcolor{keyword}{sizeof}(wrapperptr),}
\DoxyCodeLine{01436\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_VALUE,\ \&idxLevel,\ \textcolor{keyword}{sizeof}(idxLevel),}
\DoxyCodeLine{01437\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_VALUE,\ \&outsideInteractions,\ \textcolor{keyword}{sizeof}(outsideInteractions),}
\DoxyCodeLine{01438\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_VALUE,\ \&cellHandles[idxLevel][idxGroup].intervalSize,\ \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{int}),}
\DoxyCodeLine{01439\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_VALUE,\ \&mode,\ \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{int}),}
\DoxyCodeLine{01440\ \#ifdef\ STARPU\_SIMGRID\_MLR\_MODELS}
\DoxyCodeLine{01441\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_VALUE,\ \&parameters[0],\ \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{double}),}
\DoxyCodeLine{01442\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_VALUE,\ \&parameters[1],\ \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{double}),}
\DoxyCodeLine{01443\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_VALUE,\ \&parameters[2],\ \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{double}),}
\DoxyCodeLine{01444\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_VALUE,\ \&parameters[3],\ \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{double}),}
\DoxyCodeLine{01445\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_VALUE,\ \&parameters[4],\ \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{double}),}
\DoxyCodeLine{01446\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_VALUE,\ \&parameters[5],\ \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{double}),}
\DoxyCodeLine{01447\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_VALUE,\ \&parameters[6],\ \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{double}),}
\DoxyCodeLine{01448\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_VALUE,\ \&parameters[7],\ \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{double}),}
\DoxyCodeLine{01449\ \#endif}
\DoxyCodeLine{01450\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \#ifdef\ SCALFMM\_STARPU\_USE\_PRIO}
\DoxyCodeLine{01451\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_PRIORITY,\ PrioClass::Controller().getInsertionPosM2LExtern(idxLevel),}
\DoxyCodeLine{01452\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_TAG\_ONLY,\ (starpu\_tag\_t)\ PrioClass::Controller().getInsertionPosM2LExtern(idxLevel),}
\DoxyCodeLine{01453\ }
\DoxyCodeLine{01454\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \#endif}
\DoxyCodeLine{01455\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_R,\ cellHandles[idxLevel][interactionid].symb,}
\DoxyCodeLine{01456\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (STARPU\_RW|STARPU\_COMMUTE\_IF\_SUPPORTED),\ cellHandles[idxLevel][interactionid].down,}
\DoxyCodeLine{01457\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_R,\ cellHandles[idxLevel][idxGroup].symb,}
\DoxyCodeLine{01458\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_R,\ cellHandles[idxLevel][idxGroup].up,}
\DoxyCodeLine{01459\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \#ifdef\ STARPU\_USE\_TASK\_NAME}
\DoxyCodeLine{01460\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_NAME,\ m2lOuterTaskNames[idxLevel].get(),}
\DoxyCodeLine{01461\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \#endif}
\DoxyCodeLine{01462\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 0);}
\DoxyCodeLine{01463\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01464\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01465\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ FLOG(\ timerOutBlock.tac()\ );}
\DoxyCodeLine{01466\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01467\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01468\ \ \ \ \ \ \ \ \ FLOG(\ FLog::Controller\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)t\(\backslash\)t\ transferPass\ in\ "{}}\ <<\ timer.tacAndElapsed()\ <<\ \textcolor{stringliteral}{"{}s\(\backslash\)n"{}}\ );}
\DoxyCodeLine{01469\ \ \ \ \ \ \ \ \ FLOG(\ FLog::Controller\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)t\(\backslash\)t\(\backslash\)t\ inblock\ in\ \ "{}}\ <<\ timerInBlock.elapsed()\ <<\ \textcolor{stringliteral}{"{}s\(\backslash\)n"{}}\ );}
\DoxyCodeLine{01470\ \ \ \ \ \ \ \ \ FLOG(\ FLog::Controller\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)t\(\backslash\)t\(\backslash\)t\ outblock\ in\ "{}}\ <<\ timerOutBlock.elapsed()\ <<\ \textcolor{stringliteral}{"{}s\(\backslash\)n"{}}\ );}
\DoxyCodeLine{01471\ \ \ \ \ \}}
\DoxyCodeLine{01472\ }
\DoxyCodeLine{01476\ }
\DoxyCodeLine{01477\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_f_group_task_star_p_u_algorithm_ab46d2c06fc74876926c03d010106bc8d}{downardPass}}()\{}
\DoxyCodeLine{01478\ \ \ \ \ \ \ \ \ FLOG(\ \mbox{\hyperlink{class_f_tic}{FTic}}\ timer;\ );}
\DoxyCodeLine{01479\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ idxLevel\ =\ \mbox{\hyperlink{class_f_abstract_algorithm_ade49cb5ede82d078261e576a9d809dc2}{FAbstractAlgorithm::upperWorkingLevel}}\ ;\ idxLevel\ <\ \mbox{\hyperlink{class_f_abstract_algorithm_a694b8888186be58e38691ce08b177d46}{FAbstractAlgorithm::lowerWorkingLevel}}\ -\/\ 1\ ;\ ++idxLevel)\{}
\DoxyCodeLine{01480\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ idxSubGroup\ =\ 0;}
\DoxyCodeLine{01481\ }
\DoxyCodeLine{01482\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ idxGroup\ =\ 0\ ;\ idxGroup\ <\ tree-\/>getNbCellGroupAtLevel(idxLevel)\ ;\ ++idxGroup)\{}
\DoxyCodeLine{01483\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ CellContainerClass*\textcolor{keyword}{const}\ currentCells\ =\ tree-\/>getCellGroup(idxLevel,\ idxGroup);}
\DoxyCodeLine{01484\ }
\DoxyCodeLine{01485\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Skip\ current\ group\ if\ needed}}
\DoxyCodeLine{01486\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\ tree-\/>getCellGroup(idxLevel+1,\ idxSubGroup)-\/>getEndingIndex()\ <=\ (currentCells-\/>getStartingIndex()<<3)\ )\{}
\DoxyCodeLine{01487\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ++idxSubGroup;}
\DoxyCodeLine{01488\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ FAssertLF(\ idxSubGroup\ !=\ tree-\/>getNbCellGroupAtLevel(idxLevel+1)\ );}
\DoxyCodeLine{01489\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ FAssertLF(\ (tree-\/>getCellGroup(idxLevel+1,\ idxSubGroup)-\/>getStartingIndex()>>3)\ ==\ currentCells-\/>getStartingIndex()\ );}
\DoxyCodeLine{01490\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01491\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Copy\ at\ max\ 8\ groups}}
\DoxyCodeLine{01492\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01493\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{struct\ }starpu\_task*\ \textcolor{keyword}{const}\ task\ =\ starpu\_task\_create();}
\DoxyCodeLine{01494\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ task-\/>dyn\_handles\ =\ (starpu\_data\_handle\_t*)malloc(\textcolor{keyword}{sizeof}(starpu\_data\_handle\_t)*20);}
\DoxyCodeLine{01495\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ task-\/>dyn\_handles[0]\ =\ cellHandles[idxLevel][idxGroup].symb;}
\DoxyCodeLine{01496\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ task-\/>dyn\_handles[1]\ =\ cellHandles[idxLevel][idxGroup].down;}
\DoxyCodeLine{01497\ }
\DoxyCodeLine{01498\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ task-\/>dyn\_handles[2]\ =\ cellHandles[idxLevel+1][idxSubGroup].symb;}
\DoxyCodeLine{01499\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ task-\/>dyn\_handles[3]\ =\ cellHandles[idxLevel+1][idxSubGroup].down;}
\DoxyCodeLine{01500\ }
\DoxyCodeLine{01501\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ put\ the\ right\ codelet}}
\DoxyCodeLine{01502\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}((noCommuteAtLastLevel\ \&\&\ (idxLevel\ ==\ \mbox{\hyperlink{class_f_abstract_algorithm_a694b8888186be58e38691ce08b177d46}{FAbstractAlgorithm::lowerWorkingLevel}}\ -\/\ 2))\ ||\ noCommuteBetweenLevel)\{}
\DoxyCodeLine{01503\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ task-\/>cl\ =\ \&l2l\_cl\_nocommute;}
\DoxyCodeLine{01504\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01505\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\{}
\DoxyCodeLine{01506\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ task-\/>cl\ =\ \&l2l\_cl;}
\DoxyCodeLine{01507\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01508\ \textcolor{preprocessor}{\#ifdef\ STARPU\_SIMGRID\_MLR\_MODELS}}
\DoxyCodeLine{01509\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ nbChildParent\ =\ 0;}
\DoxyCodeLine{01510\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01511\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ CellContainerClass*\textcolor{keyword}{const}\ currentCells\ =\ tree-\/>getCellGroup(idxLevel,\ idxGroup);}
\DoxyCodeLine{01512\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ CellContainerClass*\textcolor{keyword}{const}\ subCellGroup\ =\ tree-\/>getCellGroup(idxLevel+1,\ idxSubGroup);}
\DoxyCodeLine{01513\ }
\DoxyCodeLine{01514\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ MortonIndex\ firstParent\ =\ \mbox{\hyperlink{struct_f_math_ada359f2b021ce4b999c0fd7a6e9daae6}{FMath::Max}}(currentCells-\/>getStartingIndex(),\ subCellGroup-\/>getStartingIndex()>>3);}
\DoxyCodeLine{01515\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ MortonIndex\ lastParent\ =\ \mbox{\hyperlink{struct_f_math_a43635af3d44bb1868015681ce994df7b}{FMath::Min}}(currentCells-\/>getEndingIndex()-\/1,\ (subCellGroup-\/>getEndingIndex()-\/1)>>3);}
\DoxyCodeLine{01516\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ idxParentCell\ =\ currentCells-\/>getCellIndex(firstParent);}
\DoxyCodeLine{01517\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ idxChildCell\ \ =\ subCellGroup-\/>getFistChildIdx(firstParent);}
\DoxyCodeLine{01518\ }
\DoxyCodeLine{01519\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{while}(\textcolor{keyword}{true})\{}
\DoxyCodeLine{01520\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ cell\ =\ currentCells-\/>getUpCell(idxParentCell);}
\DoxyCodeLine{01521\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{do}\{}
\DoxyCodeLine{01522\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ idxChildCell\ +=\ 1;}
\DoxyCodeLine{01523\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}\textcolor{keywordflow}{while}(idxChildCell\ !=\ subCellGroup-\/>getNumberOfCellsInBlock()\ \&\&\ cell.getMortonIndex()\ ==\ (subCellGroup-\/>getCellMortonIndex(idxChildCell)>>3));}
\DoxyCodeLine{01524\ }
\DoxyCodeLine{01525\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ nbChildParent\ +=\ 1;}
\DoxyCodeLine{01526\ }
\DoxyCodeLine{01527\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(currentCells-\/>getCellMortonIndex(idxParentCell)\ ==\ lastParent)\{}
\DoxyCodeLine{01528\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01529\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01530\ }
\DoxyCodeLine{01531\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ idxParentCell\ +=\ 1;}
\DoxyCodeLine{01532\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01533\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01534\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ *parameters\ =\ (\textcolor{keywordtype}{double}*)\ calloc(1,l2l\_cl.model-\/>nparameters*\textcolor{keyword}{sizeof}(\textcolor{keywordtype}{double}));}
\DoxyCodeLine{01535\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ parameters[0]\ =\ (double)\ idxLevel;}
\DoxyCodeLine{01536\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ parameters[1]\ =\ (double)\ tree-\/>getCellGroup(idxLevel,idxGroup)-\/>getNumberOfCellsInBlock();}
\DoxyCodeLine{01537\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ parameters[2]\ =\ (double)\ tree-\/>getCellGroup(idxLevel,idxGroup)-\/>getSizeOfInterval();}
\DoxyCodeLine{01538\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ parameters[3]\ =\ (double)\ tree-\/>getCellGroup(idxLevel+1,idxSubGroup)-\/>getNumberOfCellsInBlock();}
\DoxyCodeLine{01539\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ parameters[4]\ =\ (double)\ tree-\/>getCellGroup(idxLevel+1,idxSubGroup)-\/>getSizeOfInterval();}
\DoxyCodeLine{01540\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ parameters[5]\ =\ (double)\ \mbox{\hyperlink{struct_f_math_a43635af3d44bb1868015681ce994df7b}{FMath::Min}}(tree-\/>getCellGroup(idxLevel,idxGroup)-\/>getEndingIndex()-\/1,\ (tree-\/>getCellGroup(idxLevel+1,idxSubGroup)-\/>getEndingIndex()-\/1)>>3)-\/}
\DoxyCodeLine{01541\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{struct_f_math_ada359f2b021ce4b999c0fd7a6e9daae6}{FMath::Max}}(tree-\/>getCellGroup(idxLevel,idxGroup)-\/>getStartingIndex(),\ tree-\/>getCellGroup(idxLevel+1,idxSubGroup)-\/>getStartingIndex()>>3);}
\DoxyCodeLine{01542\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ parameters[6]\ =\ (double)\ nbChildParent;}
\DoxyCodeLine{01543\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{01544\ }
\DoxyCodeLine{01545\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ put\ args\ values}}
\DoxyCodeLine{01546\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{char}\ *arg\_buffer;}
\DoxyCodeLine{01547\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ arg\_buffer\_size;}
\DoxyCodeLine{01548\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ starpu\_codelet\_pack\_args((\textcolor{keywordtype}{void}**)\&arg\_buffer,\ \&arg\_buffer\_size,}
\DoxyCodeLine{01549\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_VALUE,\ \&wrapperptr,\ \textcolor{keyword}{sizeof}(wrapperptr),}
\DoxyCodeLine{01550\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_VALUE,\ \&idxLevel,\ \textcolor{keyword}{sizeof}(idxLevel),}
\DoxyCodeLine{01551\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_VALUE,\ \&cellHandles[idxLevel][idxGroup].intervalSize,\ \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{int}),}
\DoxyCodeLine{01552\ \#ifdef\ STARPU\_SIMGRID\_MLR\_MODELS}
\DoxyCodeLine{01553\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_VALUE,\ \&parameters[0],\ \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{double}),}
\DoxyCodeLine{01554\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_VALUE,\ \&parameters[1],\ \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{double}),}
\DoxyCodeLine{01555\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_VALUE,\ \&parameters[2],\ \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{double}),}
\DoxyCodeLine{01556\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_VALUE,\ \&parameters[3],\ \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{double}),}
\DoxyCodeLine{01557\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_VALUE,\ \&parameters[4],\ \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{double}),}
\DoxyCodeLine{01558\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_VALUE,\ \&parameters[5],\ \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{double}),}
\DoxyCodeLine{01559\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_VALUE,\ \&parameters[6],\ \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{double}),}
\DoxyCodeLine{01560\ \#endif}
\DoxyCodeLine{01561\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 0);}
\DoxyCodeLine{01562\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ task-\/>cl\_arg\ =\ arg\_buffer;}
\DoxyCodeLine{01563\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ task-\/>cl\_arg\_size\ =\ arg\_buffer\_size;}
\DoxyCodeLine{01564\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ task-\/>cl\_arg\_free\ =\ 1;}
\DoxyCodeLine{01565\ \textcolor{preprocessor}{\#ifdef\ SCALFMM\_STARPU\_USE\_PRIO}}
\DoxyCodeLine{01566\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ task-\/>priority\ =\ PrioClass::Controller().getInsertionPosL2L(idxLevel);}
\DoxyCodeLine{01567\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{01568\ \textcolor{preprocessor}{\ \ \ \ \#ifdef\ STARPU\_USE\_TASK\_NAME}}
\DoxyCodeLine{01569\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ task-\/>name\ =\ l2lTaskNames[idxLevel].get();}
\DoxyCodeLine{01570\ \textcolor{preprocessor}{\ \ \ \ \#endif}}
\DoxyCodeLine{01571\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ FAssertLF(starpu\_task\_submit(task)\ ==\ 0);}
\DoxyCodeLine{01572\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01573\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{while}(tree-\/>getCellGroup(idxLevel+1,\ idxSubGroup)-\/>getEndingIndex()\ <=\ (((currentCells-\/>getEndingIndex()-\/1)<<3)+7)}
\DoxyCodeLine{01574\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \&\&\ (idxSubGroup+1)\ !=\ tree-\/>getNbCellGroupAtLevel(idxLevel+1)}
\DoxyCodeLine{01575\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \&\&\ tree-\/>getCellGroup(idxLevel+1,\ idxSubGroup+1)-\/>getStartingIndex()\ <=\ ((currentCells-\/>getEndingIndex()-\/1)<<3)+7\ )\{}
\DoxyCodeLine{01576\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ idxSubGroup\ +=\ 1;}
\DoxyCodeLine{01577\ }
\DoxyCodeLine{01578\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{struct\ }starpu\_task*\ \textcolor{keyword}{const}\ task\ =\ starpu\_task\_create();}
\DoxyCodeLine{01579\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ task-\/>dyn\_handles\ =\ (starpu\_data\_handle\_t*)malloc(\textcolor{keyword}{sizeof}(starpu\_data\_handle\_t)*20);}
\DoxyCodeLine{01580\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ task-\/>dyn\_handles[0]\ =\ cellHandles[idxLevel][idxGroup].symb;}
\DoxyCodeLine{01581\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ task-\/>dyn\_handles[1]\ =\ cellHandles[idxLevel][idxGroup].down;}
\DoxyCodeLine{01582\ }
\DoxyCodeLine{01583\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ task-\/>dyn\_handles[2]\ =\ cellHandles[idxLevel+1][idxSubGroup].symb;}
\DoxyCodeLine{01584\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ task-\/>dyn\_handles[3]\ =\ cellHandles[idxLevel+1][idxSubGroup].down;}
\DoxyCodeLine{01585\ }
\DoxyCodeLine{01586\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ put\ the\ right\ codelet}}
\DoxyCodeLine{01587\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}((noCommuteAtLastLevel\ \&\&\ (idxLevel\ ==\ \mbox{\hyperlink{class_f_abstract_algorithm_a694b8888186be58e38691ce08b177d46}{FAbstractAlgorithm::lowerWorkingLevel}}\ -\/\ 2))\ ||\ noCommuteBetweenLevel)\{}
\DoxyCodeLine{01588\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ task-\/>cl\ =\ \&l2l\_cl\_nocommute;}
\DoxyCodeLine{01589\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01590\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\{}
\DoxyCodeLine{01591\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ task-\/>cl\ =\ \&l2l\_cl;}
\DoxyCodeLine{01592\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01593\ \textcolor{preprocessor}{\#ifdef\ STARPU\_SIMGRID\_MLR\_MODELS}}
\DoxyCodeLine{01594\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ nbChildParent\ =\ 0;}
\DoxyCodeLine{01595\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01596\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ CellContainerClass*\textcolor{keyword}{const}\ currentCells\ =\ tree-\/>getCellGroup(idxLevel,\ idxGroup);}
\DoxyCodeLine{01597\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ CellContainerClass*\textcolor{keyword}{const}\ subCellGroup\ =\ tree-\/>getCellGroup(idxLevel+1,\ idxSubGroup);}
\DoxyCodeLine{01598\ }
\DoxyCodeLine{01599\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ MortonIndex\ firstParent\ =\ \mbox{\hyperlink{struct_f_math_ada359f2b021ce4b999c0fd7a6e9daae6}{FMath::Max}}(currentCells-\/>getStartingIndex(),\ subCellGroup-\/>getStartingIndex()>>3);}
\DoxyCodeLine{01600\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ MortonIndex\ lastParent\ =\ \mbox{\hyperlink{struct_f_math_a43635af3d44bb1868015681ce994df7b}{FMath::Min}}(currentCells-\/>getEndingIndex()-\/1,\ (subCellGroup-\/>getEndingIndex()-\/1)>>3);}
\DoxyCodeLine{01601\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ idxParentCell\ =\ currentCells-\/>getCellIndex(firstParent);}
\DoxyCodeLine{01602\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ idxChildCell\ \ =\ subCellGroup-\/>getFistChildIdx(firstParent);}
\DoxyCodeLine{01603\ }
\DoxyCodeLine{01604\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{while}(\textcolor{keyword}{true})\{}
\DoxyCodeLine{01605\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ cell\ =\ currentCells-\/>getUpCell(idxParentCell);}
\DoxyCodeLine{01606\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{do}\{}
\DoxyCodeLine{01607\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ idxChildCell\ +=\ 1;}
\DoxyCodeLine{01608\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}\textcolor{keywordflow}{while}(idxChildCell\ !=\ subCellGroup-\/>getNumberOfCellsInBlock()\ \&\&\ cell.getMortonIndex()\ ==\ (subCellGroup-\/>getCellMortonIndex(idxChildCell)>>3));}
\DoxyCodeLine{01609\ }
\DoxyCodeLine{01610\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ nbChildParent\ +=\ 1;}
\DoxyCodeLine{01611\ }
\DoxyCodeLine{01612\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(currentCells-\/>getCellMortonIndex(idxParentCell)\ ==\ lastParent)\{}
\DoxyCodeLine{01613\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01614\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01615\ }
\DoxyCodeLine{01616\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ idxParentCell\ +=\ 1;}
\DoxyCodeLine{01617\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01618\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01619\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ *parameters\ =\ (\textcolor{keywordtype}{double}*)\ calloc(1,l2l\_cl.model-\/>nparameters*\textcolor{keyword}{sizeof}(\textcolor{keywordtype}{double}));}
\DoxyCodeLine{01620\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ parameters[0]\ =\ (double)\ idxLevel;}
\DoxyCodeLine{01621\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ parameters[1]\ =\ (double)\ tree-\/>getCellGroup(idxLevel,idxGroup)-\/>getNumberOfCellsInBlock();}
\DoxyCodeLine{01622\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ parameters[2]\ =\ (double)\ tree-\/>getCellGroup(idxLevel,idxGroup)-\/>getSizeOfInterval();}
\DoxyCodeLine{01623\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ parameters[3]\ =\ (double)\ tree-\/>getCellGroup(idxLevel+1,idxSubGroup)-\/>getNumberOfCellsInBlock();}
\DoxyCodeLine{01624\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ parameters[4]\ =\ (double)\ tree-\/>getCellGroup(idxLevel+1,idxSubGroup)-\/>getSizeOfInterval();}
\DoxyCodeLine{01625\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ parameters[5]\ =\ (double)\ \mbox{\hyperlink{struct_f_math_a43635af3d44bb1868015681ce994df7b}{FMath::Min}}(tree-\/>getCellGroup(idxLevel,idxGroup)-\/>getEndingIndex()-\/1,\ (tree-\/>getCellGroup(idxLevel+1,idxSubGroup)-\/>getEndingIndex()-\/1)>>3)-\/}
\DoxyCodeLine{01626\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{struct_f_math_ada359f2b021ce4b999c0fd7a6e9daae6}{FMath::Max}}(tree-\/>getCellGroup(idxLevel,idxGroup)-\/>getStartingIndex(),\ tree-\/>getCellGroup(idxLevel+1,idxSubGroup)-\/>getStartingIndex()>>3);}
\DoxyCodeLine{01627\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ parameters[6]\ =\ (double)\ nbChildParent;}
\DoxyCodeLine{01628\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{01629\ }
\DoxyCodeLine{01630\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ put\ args\ values}}
\DoxyCodeLine{01631\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{char}\ *arg\_buffer;}
\DoxyCodeLine{01632\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ arg\_buffer\_size;}
\DoxyCodeLine{01633\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ starpu\_codelet\_pack\_args((\textcolor{keywordtype}{void}**)\&arg\_buffer,\ \&arg\_buffer\_size,}
\DoxyCodeLine{01634\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_VALUE,\ \&wrapperptr,\ \textcolor{keyword}{sizeof}(wrapperptr),}
\DoxyCodeLine{01635\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_VALUE,\ \&idxLevel,\ \textcolor{keyword}{sizeof}(idxLevel),}
\DoxyCodeLine{01636\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_VALUE,\ \&cellHandles[idxLevel][idxGroup].intervalSize,\ \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{int}),}
\DoxyCodeLine{01637\ \#ifdef\ STARPU\_SIMGRID\_MLR\_MODELS}
\DoxyCodeLine{01638\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_VALUE,\ \&parameters[0],\ \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{double}),}
\DoxyCodeLine{01639\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_VALUE,\ \&parameters[1],\ \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{double}),}
\DoxyCodeLine{01640\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_VALUE,\ \&parameters[2],\ \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{double}),}
\DoxyCodeLine{01641\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_VALUE,\ \&parameters[3],\ \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{double}),}
\DoxyCodeLine{01642\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_VALUE,\ \&parameters[4],\ \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{double}),}
\DoxyCodeLine{01643\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_VALUE,\ \&parameters[5],\ \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{double}),}
\DoxyCodeLine{01644\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_VALUE,\ \&parameters[6],\ \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{double}),}
\DoxyCodeLine{01645\ \#endif}
\DoxyCodeLine{01646\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 0);}
\DoxyCodeLine{01647\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ task-\/>cl\_arg\ =\ arg\_buffer;}
\DoxyCodeLine{01648\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ task-\/>cl\_arg\_size\ =\ arg\_buffer\_size;}
\DoxyCodeLine{01649\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ task-\/>cl\_arg\_free\ =\ 1;}
\DoxyCodeLine{01650\ \textcolor{preprocessor}{\#ifdef\ SCALFMM\_STARPU\_USE\_PRIO}}
\DoxyCodeLine{01651\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ task-\/>priority\ =\ PrioClass::Controller().getInsertionPosL2L(idxLevel);}
\DoxyCodeLine{01652\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{01653\ \textcolor{preprocessor}{\ \ \ \ \#ifdef\ STARPU\_USE\_TASK\_NAME}}
\DoxyCodeLine{01654\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ task-\/>name\ =\ l2lTaskNames[idxLevel].get();}
\DoxyCodeLine{01655\ \textcolor{preprocessor}{\ \ \ \ \#endif}}
\DoxyCodeLine{01656\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ FAssertLF(starpu\_task\_submit(task)\ ==\ 0);}
\DoxyCodeLine{01657\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01658\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01659\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01660\ \ \ \ \ \ \ \ \ FLOG(\ FLog::Controller\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)t\(\backslash\)t\ downardPass\ in\ "{}}\ <<\ timer.tacAndElapsed()\ <<\ \textcolor{stringliteral}{"{}s\(\backslash\)n"{}}\ );}
\DoxyCodeLine{01661\ \ \ \ \ \}}
\DoxyCodeLine{01662\ }
\DoxyCodeLine{01666\ }
\DoxyCodeLine{01667\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_f_group_task_star_p_u_algorithm_a268a77fbbd6d99c8ed48d2c795bb3273}{directPass}}()\{}
\DoxyCodeLine{01668\ \ \ \ \ \ \ \ \ FLOG(\ \mbox{\hyperlink{class_f_tic}{FTic}}\ timer;\ );}
\DoxyCodeLine{01669\ \ \ \ \ \ \ \ \ FLOG(\ \mbox{\hyperlink{class_f_tic}{FTic}}\ timerInBlock;\ \mbox{\hyperlink{class_f_tic}{FTic}}\ timerOutBlock;\ );}
\DoxyCodeLine{01670\ }
\DoxyCodeLine{01671\ \ \ \ \ \ \ \ \ FLOG(\ timerOutBlock.tic()\ );}
\DoxyCodeLine{01672\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ idxGroup\ =\ 0\ ;\ idxGroup\ <\ tree-\/>getNbParticleGroup()\ ;\ ++idxGroup)\{}
\DoxyCodeLine{01673\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ idxInteraction\ =\ 0;\ idxInteraction\ <\ int(externalInteractionsLeafLevel[idxGroup].size())\ ;\ ++idxInteraction)\{}
\DoxyCodeLine{01674\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ interactionid\ =\ externalInteractionsLeafLevel[idxGroup][idxInteraction].otherBlockId;}
\DoxyCodeLine{01675\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::vector<OutOfBlockInteraction>*\ outsideInteractions\ =\ \&externalInteractionsLeafLevel[idxGroup][idxInteraction].interactions;}
\DoxyCodeLine{01676\ \textcolor{preprocessor}{\#ifdef\ STARPU\_SIMGRID\_MLR\_MODELS}}
\DoxyCodeLine{01677\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ nbDiff0\ =\ 0;}
\DoxyCodeLine{01678\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ nbDiff1\ =\ 0;}
\DoxyCodeLine{01679\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ nbInteractions\ =\ 0;}
\DoxyCodeLine{01680\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01681\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ std::unordered\_set<int>\ exist0;}
\DoxyCodeLine{01682\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ std::unordered\_set<int>\ exist1;}
\DoxyCodeLine{01683\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ outInterIdx\ =\ 0\ ;\ outInterIdx\ <\ int(outsideInteractions-\/>size())\ ;\ ++outInterIdx)\{}
\DoxyCodeLine{01684\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ GroupContainerClass\ interParticles\ =\ tree-\/>getParticleGroup(interactionid)-\/>template\ getLeaf<GroupContainerClass>((*outsideInteractions)[outInterIdx].outsideIdxInBlock);}
\DoxyCodeLine{01685\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ GroupContainerClass\ particles\ =\ tree-\/>getParticleGroup(idxGroup)-\/>template\ getLeaf<GroupContainerClass>((*outsideInteractions)[outInterIdx].insideIdxInBlock);}
\DoxyCodeLine{01686\ }
\DoxyCodeLine{01687\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ nbInteractions\ +=\ interParticles.getNbParticles()\ *\ particles.getNbParticles();}
\DoxyCodeLine{01688\ }
\DoxyCodeLine{01689\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(exist0.find((*outsideInteractions)[outInterIdx].insideIdxInBlock)\ ==\ exist0.end())\{}
\DoxyCodeLine{01690\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ exist0.insert((*outsideInteractions)[outInterIdx].insideIdxInBlock);}
\DoxyCodeLine{01691\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ nbDiff0\ +=\ 1;}
\DoxyCodeLine{01692\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01693\ }
\DoxyCodeLine{01694\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(exist1.find((*outsideInteractions)[outInterIdx].outsideIdxInBlock)\ ==\ exist1.end())\{}
\DoxyCodeLine{01695\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ exist1.insert((*outsideInteractions)[outInterIdx].outsideIdxInBlock);}
\DoxyCodeLine{01696\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ nbDiff1\ +=\ 1;}
\DoxyCodeLine{01697\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01698\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01699\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01700\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ *parameters\ =\ (\textcolor{keywordtype}{double}*)\ calloc(1,p2p\_cl\_inout.model-\/>nparameters*\textcolor{keyword}{sizeof}(\textcolor{keywordtype}{double}));}
\DoxyCodeLine{01701\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ parameters[0]\ =\ (double)\ tree-\/>getParticleGroup(idxGroup)-\/>getNumberOfLeavesInBlock();}
\DoxyCodeLine{01702\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ parameters[1]\ =\ (double)\ tree-\/>getParticleGroup(idxGroup)-\/>getSizeOfInterval();}
\DoxyCodeLine{01703\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ parameters[2]\ =\ (double)\ tree-\/>getParticleGroup(idxGroup)-\/>getNbParticlesInGroup();}
\DoxyCodeLine{01704\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ parameters[3]\ =\ (double)\ tree-\/>getParticleGroup(interactionid)-\/>getNumberOfLeavesInBlock();}
\DoxyCodeLine{01705\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ parameters[4]\ =\ (double)\ tree-\/>getParticleGroup(interactionid)-\/>getSizeOfInterval();}
\DoxyCodeLine{01706\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ parameters[5]\ =\ (double)\ tree-\/>getParticleGroup(interactionid)-\/>getNbParticlesInGroup();}
\DoxyCodeLine{01707\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ parameters[6]\ =\ (double)\ outsideInteractions-\/>size();}
\DoxyCodeLine{01708\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ parameters[7]\ =\ (double)\ nbDiff0;}
\DoxyCodeLine{01709\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ parameters[8]\ =\ (double)\ nbDiff1;}
\DoxyCodeLine{01710\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ parameters[9]\ =\ (double)\ nbInteractions;}
\DoxyCodeLine{01711\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{01712\ }
\DoxyCodeLine{01713\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ starpu\_insert\_task(\&p2p\_cl\_inout,}
\DoxyCodeLine{01714\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_VALUE,\ \&wrapperptr,\ \textcolor{keyword}{sizeof}(wrapperptr),}
\DoxyCodeLine{01715\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_VALUE,\ \&outsideInteractions,\ \textcolor{keyword}{sizeof}(outsideInteractions),}
\DoxyCodeLine{01716\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_VALUE,\ \&particleHandles[idxGroup].intervalSize,\ \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{int}),}
\DoxyCodeLine{01717\ \#ifdef\ STARPU\_SIMGRID\_MLR\_MODELS}
\DoxyCodeLine{01718\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_VALUE,\ \&parameters[0],\ \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{double}),}
\DoxyCodeLine{01719\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_VALUE,\ \&parameters[1],\ \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{double}),\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{01720\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_VALUE,\ \&parameters[2],\ \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{double}),}
\DoxyCodeLine{01721\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_VALUE,\ \&parameters[3],\ \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{double}),\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{01722\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_VALUE,\ \&parameters[4],\ \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{double}),}
\DoxyCodeLine{01723\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_VALUE,\ \&parameters[5],\ \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{double}),\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{01724\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_VALUE,\ \&parameters[6],\ \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{double}),}
\DoxyCodeLine{01725\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_VALUE,\ \&parameters[7],\ \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{double}),}
\DoxyCodeLine{01726\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_VALUE,\ \&parameters[8],\ \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{double}),}
\DoxyCodeLine{01727\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_VALUE,\ \&parameters[9],\ \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{double}),}
\DoxyCodeLine{01728\ \#endif}
\DoxyCodeLine{01729\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \#ifdef\ SCALFMM\_STARPU\_USE\_PRIO}
\DoxyCodeLine{01730\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_PRIORITY,\ PrioClass::Controller().getInsertionPosP2PExtern(),}
\DoxyCodeLine{01731\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \#endif}
\DoxyCodeLine{01732\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_R,\ particleHandles[idxGroup].symb,}
\DoxyCodeLine{01733\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \#ifdef\ STARPU\_USE\_REDUX}
\DoxyCodeLine{01734\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_REDUX,\ particleHandles[idxGroup].down,}
\DoxyCodeLine{01735\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \#\textcolor{keywordflow}{else}}
\DoxyCodeLine{01736\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (STARPU\_RW|STARPU\_COMMUTE\_IF\_SUPPORTED),\ particleHandles[idxGroup].down,}
\DoxyCodeLine{01737\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \#endif}
\DoxyCodeLine{01738\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_R,\ particleHandles[interactionid].symb,}
\DoxyCodeLine{01739\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \#ifdef\ STARPU\_USE\_REDUX}
\DoxyCodeLine{01740\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_REDUX,\ particleHandles[interactionid].down,}
\DoxyCodeLine{01741\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \#\textcolor{keywordflow}{else}}
\DoxyCodeLine{01742\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (STARPU\_RW|STARPU\_COMMUTE\_IF\_SUPPORTED),\ particleHandles[interactionid].down,}
\DoxyCodeLine{01743\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \#endif}
\DoxyCodeLine{01744\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \#ifdef\ STARPU\_USE\_TASK\_NAME}
\DoxyCodeLine{01745\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_NAME,\ p2pOuterTaskNames.get(),}
\DoxyCodeLine{01746\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \#endif}
\DoxyCodeLine{01747\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 0);}
\DoxyCodeLine{01748\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01749\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01750\ \ \ \ \ \ \ \ \ FLOG(\ timerOutBlock.tac()\ );}
\DoxyCodeLine{01751\ \ \ \ \ \ \ \ \ FLOG(\ timerInBlock.tic()\ );}
\DoxyCodeLine{01752\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ idxGroup\ =\ 0\ ;\ idxGroup\ <\ tree-\/>getNbParticleGroup()\ ;\ ++idxGroup)\{}
\DoxyCodeLine{01753\ \textcolor{preprocessor}{\#ifdef\ STARPU\_SIMGRID\_MLR\_MODELS}}
\DoxyCodeLine{01754\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ nbInteractions\ =\ 0;}
\DoxyCodeLine{01755\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01756\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ParticleGroupClass*\ containers\ =\ tree-\/>getParticleGroup(idxGroup);}
\DoxyCodeLine{01757\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ MortonIndex\ blockStartIdx\ =\ containers-\/>getStartingIndex();}
\DoxyCodeLine{01758\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ MortonIndex\ blockEndIdx\ =\ containers-\/>getEndingIndex();}
\DoxyCodeLine{01759\ }
\DoxyCodeLine{01760\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ leafIdx\ =\ 0\ ;\ leafIdx\ <\ containers-\/>getNumberOfLeavesInBlock()\ ;\ ++leafIdx)\{}
\DoxyCodeLine{01761\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ GroupContainerClass\ particles\ =\ containers-\/>template\ getLeaf<GroupContainerClass>(leafIdx);}
\DoxyCodeLine{01762\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ MortonIndex\ mindex\ =\ containers-\/>getLeafMortonIndex(leafIdx);}
\DoxyCodeLine{01763\ }
\DoxyCodeLine{01764\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ MortonIndex\ interactionsIndexes[26];}
\DoxyCodeLine{01765\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ interactionsPosition[26];}
\DoxyCodeLine{01766\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_f_tree_coordinate}{FTreeCoordinate}}\ coord(mindex,\ tree-\/>getHeight()-\/1);}
\DoxyCodeLine{01767\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ counter\ =\ coord.\mbox{\hyperlink{class_f_tree_coordinate_ac74ca299cacd624e1aca5b49e4b62709}{getNeighborsIndexes}}(tree-\/>getHeight(),interactionsIndexes,interactionsPosition);}
\DoxyCodeLine{01768\ }
\DoxyCodeLine{01769\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ nbInteractions\ +=\ particles.getNbParticles()\ *\ particles.getNbParticles();}
\DoxyCodeLine{01770\ }
\DoxyCodeLine{01771\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ idxInter\ =\ 0\ ;\ idxInter\ <\ counter\ ;\ ++idxInter)\{}
\DoxyCodeLine{01772\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\ blockStartIdx\ <=\ interactionsIndexes[idxInter]\ \&\&\ interactionsIndexes[idxInter]\ <\ blockEndIdx\ )\{}
\DoxyCodeLine{01773\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ leafPos\ =\ containers-\/>getLeafIndex(interactionsIndexes[idxInter]);}
\DoxyCodeLine{01774\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(leafPos\ !=\ -\/1)\{}
\DoxyCodeLine{01775\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ GroupContainerClass\ particlesOther\ =\ containers-\/>template\ getLeaf<GroupContainerClass>(leafIdx);}
\DoxyCodeLine{01776\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ nbInteractions\ +=\ particles.getNbParticles()\ *\ particlesOther.getNbParticles();}
\DoxyCodeLine{01777\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01778\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01779\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01780\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01781\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01782\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ *parameters\ =\ (\textcolor{keywordtype}{double}*)\ calloc(1,p2p\_cl\_in.model-\/>nparameters*\textcolor{keyword}{sizeof}(\textcolor{keywordtype}{double}));}
\DoxyCodeLine{01783\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ parameters[0]\ =\ (double)\ tree-\/>getParticleGroup(idxGroup)-\/>getNumberOfLeavesInBlock();}
\DoxyCodeLine{01784\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ parameters[1]\ =\ (double)\ tree-\/>getParticleGroup(idxGroup)-\/>getSizeOfInterval();}
\DoxyCodeLine{01785\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ parameters[2]\ =\ (double)\ tree-\/>getParticleGroup(idxGroup)-\/>getNbParticlesInGroup();}
\DoxyCodeLine{01786\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ parameters[3]\ =\ (double)\ nbInteractions;}
\DoxyCodeLine{01787\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{01788\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{01789\ \ \ \ \ \ \ \ \ \ \ \ \ starpu\_insert\_task(\&p2p\_cl\_in,}
\DoxyCodeLine{01790\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_VALUE,\ \&wrapperptr,\ \textcolor{keyword}{sizeof}(wrapperptr),}
\DoxyCodeLine{01791\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_VALUE,\ \&particleHandles[idxGroup].intervalSize,\ \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{int}),}
\DoxyCodeLine{01792\ \#ifdef\ STARPU\_SIMGRID\_MLR\_MODELS}
\DoxyCodeLine{01793\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_VALUE,\ \&parameters[0],\ \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{double}),}
\DoxyCodeLine{01794\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_VALUE,\ \&parameters[1],\ \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{double}),\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{01795\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_VALUE,\ \&parameters[2],\ \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{double}),}
\DoxyCodeLine{01796\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_VALUE,\ \&parameters[3],\ \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{double}),}
\DoxyCodeLine{01797\ \#endif}
\DoxyCodeLine{01798\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \#ifdef\ SCALFMM\_STARPU\_USE\_PRIO}
\DoxyCodeLine{01799\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_PRIORITY,\ PrioClass::Controller().getInsertionPosP2P(),}
\DoxyCodeLine{01800\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \#endif}
\DoxyCodeLine{01801\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_R,\ particleHandles[idxGroup].symb,}
\DoxyCodeLine{01802\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \#ifdef\ STARPU\_USE\_REDUX}
\DoxyCodeLine{01803\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_REDUX,\ particleHandles[idxGroup].down,}
\DoxyCodeLine{01804\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \#\textcolor{keywordflow}{else}}
\DoxyCodeLine{01805\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (STARPU\_RW|STARPU\_COMMUTE\_IF\_SUPPORTED),\ particleHandles[idxGroup].down,}
\DoxyCodeLine{01806\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \#endif}
\DoxyCodeLine{01807\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \#ifdef\ STARPU\_USE\_TASK\_NAME}
\DoxyCodeLine{01808\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_NAME,\ p2pTaskNames.get(),}
\DoxyCodeLine{01809\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \#endif}
\DoxyCodeLine{01810\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 0);}
\DoxyCodeLine{01811\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01812\ \ \ \ \ \ \ \ \ FLOG(\ timerInBlock.tac()\ );}
\DoxyCodeLine{01813\ }
\DoxyCodeLine{01814\ \ \ \ \ \ \ \ \ FLOG(\ FLog::Controller\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)t\(\backslash\)t\ directPass\ in\ "{}}\ <<\ timer.tacAndElapsed()\ <<\ \textcolor{stringliteral}{"{}s\(\backslash\)n"{}}\ );}
\DoxyCodeLine{01815\ \ \ \ \ \ \ \ \ FLOG(\ FLog::Controller\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)t\(\backslash\)t\(\backslash\)t\ inblock\ \ in\ "{}}\ <<\ timerInBlock.elapsed()\ <<\ \textcolor{stringliteral}{"{}s\(\backslash\)n"{}}\ );}
\DoxyCodeLine{01816\ \ \ \ \ \ \ \ \ FLOG(\ FLog::Controller\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)t\(\backslash\)t\(\backslash\)t\ outblock\ in\ "{}}\ <<\ timerOutBlock.elapsed()\ <<\ \textcolor{stringliteral}{"{}s\(\backslash\)n"{}}\ );}
\DoxyCodeLine{01817\ \ \ \ \ \}}
\DoxyCodeLine{01821\ }
\DoxyCodeLine{01822\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_f_group_task_star_p_u_algorithm_a498943f7344334509a7e6b98ddfdc7e1}{mergePass}}()\{}
\DoxyCodeLine{01823\ \ \ \ \ \ \ \ \ FLOG(\ \mbox{\hyperlink{class_f_tic}{FTic}}\ timer;\ );}
\DoxyCodeLine{01824\ }
\DoxyCodeLine{01825\ \ \ \ \ \ \ \ \ FAssertLF(cellHandles[tree-\/>getHeight()-\/1].size()\ ==\ particleHandles.size());}
\DoxyCodeLine{01826\ }
\DoxyCodeLine{01827\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ idxGroup\ =\ 0\ ;\ idxGroup\ <\ tree-\/>getNbParticleGroup()\ ;\ ++idxGroup)\{}
\DoxyCodeLine{01828\ \textcolor{preprocessor}{\#ifdef\ STARPU\_SIMGRID\_MLR\_MODELS}}
\DoxyCodeLine{01829\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ *parameters\ =\ (\textcolor{keywordtype}{double}*)\ calloc(1,p2m\_cl.model-\/>nparameters*\textcolor{keyword}{sizeof}(\textcolor{keywordtype}{double}));}
\DoxyCodeLine{01830\ \ \ \ \ \ \ \ \ \ \ \ \ parameters[0]\ =\ (double)\ tree-\/>getCellGroup(tree-\/>getHeight()-\/1,idxGroup)-\/>getNumberOfCellsInBlock();}
\DoxyCodeLine{01831\ \ \ \ \ \ \ \ \ \ \ \ \ parameters[1]\ =\ (double)\ tree-\/>getCellGroup(tree-\/>getHeight()-\/1,idxGroup)-\/>getSizeOfInterval();}
\DoxyCodeLine{01832\ \ \ \ \ \ \ \ \ \ \ \ \ parameters[2]\ =\ (double)\ tree-\/>getParticleGroup(idxGroup)-\/>getNbParticlesInGroup();}
\DoxyCodeLine{01833\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{01834\ \ \ \ \ \ \ \ \ \ \ \ \ starpu\_insert\_task(\&l2p\_cl,}
\DoxyCodeLine{01835\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_VALUE,\ \&wrapperptr,\ \textcolor{keyword}{sizeof}(wrapperptr),}
\DoxyCodeLine{01836\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_VALUE,\ \&cellHandles[tree-\/>getHeight()-\/1][idxGroup].intervalSize,\ \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{int}),}
\DoxyCodeLine{01837\ \#ifdef\ STARPU\_SIMGRID\_MLR\_MODELS}
\DoxyCodeLine{01838\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_VALUE,\ \&parameters[0],\ \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{double}),}
\DoxyCodeLine{01839\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_VALUE,\ \&parameters[1],\ \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{double}),}
\DoxyCodeLine{01840\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_VALUE,\ \&parameters[2],\ \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{double}),}
\DoxyCodeLine{01841\ \#endif}
\DoxyCodeLine{01842\ \ \ \ \ \ \ \ \ \#ifdef\ SCALFMM\_STARPU\_USE\_PRIO}
\DoxyCodeLine{01843\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_PRIORITY,\ PrioClass::Controller().getInsertionPosL2P(),}
\DoxyCodeLine{01844\ \ \ \ \ \ \ \ \ \#endif}
\DoxyCodeLine{01845\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_R,\ cellHandles[tree-\/>getHeight()-\/1][idxGroup].symb,}
\DoxyCodeLine{01846\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_R,\ cellHandles[tree-\/>getHeight()-\/1][idxGroup].down,}
\DoxyCodeLine{01847\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_R,\ particleHandles[idxGroup].symb,}
\DoxyCodeLine{01848\ \#ifdef\ STARPU\_USE\_REDUX}
\DoxyCodeLine{01849\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_REDUX,\ particleHandles[idxGroup].down,}
\DoxyCodeLine{01850\ \#else}
\DoxyCodeLine{01851\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (STARPU\_RW|STARPU\_COMMUTE\_IF\_SUPPORTED),\ particleHandles[idxGroup].down,}
\DoxyCodeLine{01852\ \#endif}
\DoxyCodeLine{01853\ \ \ \ \ \ \ \ \ \#ifdef\ STARPU\_USE\_TASK\_NAME}
\DoxyCodeLine{01854\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_NAME,\ l2pTaskNames.get(),}
\DoxyCodeLine{01855\ \ \ \ \ \ \ \ \ \#endif}
\DoxyCodeLine{01856\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 0);}
\DoxyCodeLine{01857\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01858\ }
\DoxyCodeLine{01859\ \ \ \ \ \ \ \ \ FLOG(\ FLog::Controller\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)t\(\backslash\)t\ L2P\ in\ "{}}\ <<\ timer.tacAndElapsed()\ <<\ \textcolor{stringliteral}{"{}s\(\backslash\)n"{}}\ );}
\DoxyCodeLine{01860\ \ \ \ \ \}}
\DoxyCodeLine{01861\ }
\DoxyCodeLine{01862\ }
\DoxyCodeLine{01863\ \textcolor{preprocessor}{\#ifdef\ STARPU\_USE\_REDUX}}
\DoxyCodeLine{01864\ \ \ \ \ \textcolor{keywordtype}{void}\ readParticle()\{}
\DoxyCodeLine{01865\ \ \ \ \ \ \ \ \ FLOG(\ \mbox{\hyperlink{class_f_tic}{FTic}}\ timer;\ );}
\DoxyCodeLine{01866\ }
\DoxyCodeLine{01867\ \ \ \ \ \ \ \ \ FAssertLF(cellHandles[tree-\/>getHeight()-\/1].size()\ ==\ particleHandles.size());}
\DoxyCodeLine{01868\ }
\DoxyCodeLine{01869\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ idxGroup\ =\ 0\ ;\ idxGroup\ <\ tree-\/>getNbParticleGroup()\ ;\ ++idxGroup)\{}
\DoxyCodeLine{01870\ \ \ \ \ \ \ \ \ \ \ \ \ starpu\_insert\_task(\&p2p\_redux\_read,}
\DoxyCodeLine{01871\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \#ifdef\ SCALFMM\_STARPU\_USE\_PRIO}
\DoxyCodeLine{01872\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_PRIORITY,\ PrioClass::Controller().getInsertionPosL2P(),}
\DoxyCodeLine{01873\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \#endif}
\DoxyCodeLine{01874\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_R,\ particleHandles[idxGroup].down,}
\DoxyCodeLine{01875\ \#ifdef\ STARPU\_USE\_TASK\_NAME}
\DoxyCodeLine{01876\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_NAME,\ \textcolor{stringliteral}{"{}read-\/particle"{}},}
\DoxyCodeLine{01877\ \#endif}
\DoxyCodeLine{01878\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 0);}
\DoxyCodeLine{01879\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01880\ \ \ \ \ \}}
\DoxyCodeLine{01881\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{01882\ }
\DoxyCodeLine{01883\ \};}
\DoxyCodeLine{01884\ }
\DoxyCodeLine{01885\ \textcolor{preprocessor}{\#endif\ }\textcolor{comment}{//\ FGROUPTASKSTARPUALGORITHM\_HPP}}

\end{DoxyCode}
