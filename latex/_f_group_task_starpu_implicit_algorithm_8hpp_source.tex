\doxysection{FGroup\+Task\+Starpu\+Implicit\+Algorithm.\+hpp}
\hypertarget{_f_group_task_starpu_implicit_algorithm_8hpp_source}{}\label{_f_group_task_starpu_implicit_algorithm_8hpp_source}\index{third\_party/ScalFMM/include/ScalFMM/GroupTree/Core/FGroupTaskStarpuImplicitAlgorithm.hpp@{third\_party/ScalFMM/include/ScalFMM/GroupTree/Core/FGroupTaskStarpuImplicitAlgorithm.hpp}}

\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{comment}{//\ Keep\ in\ private\ GIT}}
\DoxyCodeLine{00002\ \textcolor{preprocessor}{\#ifndef\ FGROUPTASKSTARPUALGORITHM\_HPP}}
\DoxyCodeLine{00003\ \textcolor{preprocessor}{\#define\ FGROUPTASKSTARPUALGORITHM\_HPP}}
\DoxyCodeLine{00004\ }
\DoxyCodeLine{00005\ \textcolor{preprocessor}{\#include\ "{}../../Utils/FGlobal.hpp"{}}}
\DoxyCodeLine{00006\ \textcolor{preprocessor}{\#include\ "{}../../Core/FCoreCommon.hpp"{}}}
\DoxyCodeLine{00007\ \textcolor{preprocessor}{\#include\ "{}../../Utils/FQuickSort.hpp"{}}}
\DoxyCodeLine{00008\ \textcolor{preprocessor}{\#include\ "{}../../Containers/FTreeCoordinate.hpp"{}}}
\DoxyCodeLine{00009\ \textcolor{preprocessor}{\#include\ "{}../../Utils/FLog.hpp"{}}}
\DoxyCodeLine{00010\ \textcolor{preprocessor}{\#include\ "{}../../Utils/FTic.hpp"{}}}
\DoxyCodeLine{00011\ \textcolor{preprocessor}{\#include\ "{}../../Utils/FAssert.hpp"{}}}
\DoxyCodeLine{00012\ \textcolor{preprocessor}{\#include\ "{}../../Utils/FEnv.hpp"{}}}
\DoxyCodeLine{00013\ }
\DoxyCodeLine{00014\ \textcolor{preprocessor}{\#include\ "{}FOutOfBlockInteraction.hpp"{}}}
\DoxyCodeLine{00015\ }
\DoxyCodeLine{00016\ \textcolor{preprocessor}{\#include\ <vector>}}
\DoxyCodeLine{00017\ \textcolor{preprocessor}{\#include\ <memory>}}
\DoxyCodeLine{00018\ \textcolor{preprocessor}{\#ifdef\ SCALFMM\_USE\_STARPU\_EXTRACT}}
\DoxyCodeLine{00019\ \textcolor{preprocessor}{\#include\ <list>}}
\DoxyCodeLine{00020\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00021\ }
\DoxyCodeLine{00022\ \textcolor{preprocessor}{\#include\ <omp.h>}}
\DoxyCodeLine{00023\ }
\DoxyCodeLine{00024\ \textcolor{preprocessor}{\#include\ <starpu.h>}}
\DoxyCodeLine{00025\ \textcolor{preprocessor}{\#include\ <starpu\_mpi.h>}}
\DoxyCodeLine{00026\ \textcolor{preprocessor}{\#ifdef\ SCALFMM\_USE\_STARPU\_EXTRACT}}
\DoxyCodeLine{00027\ \textcolor{preprocessor}{\#include\ <algorithm>}}
\DoxyCodeLine{00028\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00029\ \textcolor{preprocessor}{\#include\ "{}../StarPUUtils/FStarPUUtils.hpp"{}}}
\DoxyCodeLine{00030\ \textcolor{preprocessor}{\#include\ "{}../StarPUUtils/FStarPUFmmPriorities.hpp"{}}}
\DoxyCodeLine{00031\ \textcolor{preprocessor}{\#include\ "{}../StarPUUtils/FStarPUFmmPrioritiesV2.hpp"{}}}
\DoxyCodeLine{00032\ \textcolor{preprocessor}{\#include\ "{}../StarPUUtils/FStarPUReduxCpu.hpp"{}}}
\DoxyCodeLine{00033\ }
\DoxyCodeLine{00034\ \textcolor{preprocessor}{\#ifdef\ STARPU\_USE\_CPU}}
\DoxyCodeLine{00035\ \textcolor{preprocessor}{\#include\ "{}../StarPUUtils/FStarPUCpuWrapper.hpp"{}}}
\DoxyCodeLine{00036\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00037\ \textcolor{preprocessor}{\#ifdef\ SCALFMM\_ENABLE\_CUDA\_KERNEL}}
\DoxyCodeLine{00038\ \textcolor{preprocessor}{\#include\ "{}../StarPUUtils/FStarPUCudaWrapper.hpp"{}}}
\DoxyCodeLine{00039\ \textcolor{preprocessor}{\#include\ "{}../Cuda/FCudaEmptyKernel.hpp"{}}}
\DoxyCodeLine{00040\ \textcolor{preprocessor}{\#include\ "{}../Cuda/FCudaGroupAttachedLeaf.hpp"{}}}
\DoxyCodeLine{00041\ \textcolor{preprocessor}{\#include\ "{}../Cuda/FCudaGroupOfParticles.hpp"{}}}
\DoxyCodeLine{00042\ \textcolor{preprocessor}{\#include\ "{}../Cuda/FCudaGroupOfCells.hpp"{}}}
\DoxyCodeLine{00043\ \textcolor{preprocessor}{\#include\ "{}../Cuda/FCudaEmptyCellSymb.hpp"{}}}
\DoxyCodeLine{00044\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00045\ \textcolor{preprocessor}{\#ifdef\ SCALFMM\_ENABLE\_OPENCL\_KERNEL}}
\DoxyCodeLine{00046\ \textcolor{preprocessor}{\#include\ "{}../StarPUUtils/FStarPUOpenClWrapper.hpp"{}}}
\DoxyCodeLine{00047\ \textcolor{preprocessor}{\#include\ "{}../OpenCl/FOpenCLDeviceWrapper.hpp"{}}}
\DoxyCodeLine{00048\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00049\ }
\DoxyCodeLine{00050\ \textcolor{preprocessor}{\#ifdef\ SCALFMM\_SIMGRID\_TASKNAMEPARAMS}}
\DoxyCodeLine{00051\ \textcolor{preprocessor}{\#include\ "{}../StarPUUtils/FStarPUTaskNameParams.hpp"{}}}
\DoxyCodeLine{00052\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00053\ }
\DoxyCodeLine{00054\ \textcolor{preprocessor}{\#include\ "{}Containers/FBoolArray.hpp"{}}}
\DoxyCodeLine{00055\ \textcolor{preprocessor}{\#include\ <iostream>}}
\DoxyCodeLine{00056\ \textcolor{preprocessor}{\#include\ <vector>}}
\DoxyCodeLine{00057\ \textcolor{keyword}{using\ namespace\ }std;}
\DoxyCodeLine{00058\ }
\DoxyCodeLine{00059\ \textcolor{comment}{//\#define\ STARPU\_USE\_REDUX}}
\DoxyCodeLine{00060\ \textcolor{keyword}{template}\ <\textcolor{keyword}{class\ }OctreeClass,\ \textcolor{keyword}{class\ }CellContainerClass,\ \textcolor{keyword}{class\ }KernelClass,\ \textcolor{keyword}{class\ }ParticleGroupClass,\ \textcolor{keyword}{class\ }StarPUCpuWrapperClass}
\DoxyCodeLine{00061\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \#ifdef\ SCALFMM\_ENABLE\_CUDA\_KERNEL}}
\DoxyCodeLine{00062\ \ \ \ \ \ \ \ \ \ \ ,\ \textcolor{keyword}{class\ }StarPUCudaWrapperClass\ =\ \mbox{\hyperlink{class_f_star_p_u_cuda_wrapper}{FStarPUCudaWrapper<KernelClass,\ FCudaEmptyCellSymb,\ int,\ int,\ FCudaGroupOfCells<FCudaEmptyCellSymb,\ int,\ int>}},}
\DoxyCodeLine{00063\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_f_cuda_group_of_particles}{FCudaGroupOfParticles<int,\ 0,\ 0,\ int>}},\ \mbox{\hyperlink{class_f_cuda_group_attached_leaf}{FCudaGroupAttachedLeaf<int,\ 0,\ 0,\ int>}},\ \mbox{\hyperlink{class_f_cuda_empty_kernel}{FCudaEmptyKernel<int>}}\ >}
\DoxyCodeLine{00064\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \#endif}}
\DoxyCodeLine{00065\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \#ifdef\ SCALFMM\_ENABLE\_OPENCL\_KERNEL}}
\DoxyCodeLine{00066\ \ \ \ \ \ \ \ \ \ \ ,\ \textcolor{keyword}{class\ }StarPUOpenClWrapperClass\ =\ \mbox{\hyperlink{class_f_star_p_u_open_cl_wrapper}{FStarPUOpenClWrapper<KernelClass,\ FOpenCLDeviceWrapper<KernelClass>}}>}
\DoxyCodeLine{00067\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \#endif}}
\DoxyCodeLine{00068\ \ \ \ \ \ \ \ \ \ \ >}
\DoxyCodeLine{00069\ \textcolor{keyword}{class\ }\mbox{\hyperlink{class_f_group_task_star_p_u_implicit_algorithm}{FGroupTaskStarPUImplicitAlgorithm}}\ :\ \textcolor{keyword}{public}\ \mbox{\hyperlink{class_f_abstract_algorithm}{FAbstractAlgorithm}}\ \{}
\DoxyCodeLine{00070\ \textcolor{keyword}{protected}:}
\DoxyCodeLine{00071\ \ \ \ \ \textcolor{keyword}{typedef}\ \mbox{\hyperlink{class_f_group_task_star_p_u_implicit_algorithm}{FGroupTaskStarPUImplicitAlgorithm}}<OctreeClass,\ CellContainerClass,\ KernelClass,\ ParticleGroupClass,\ StarPUCpuWrapperClass}
\DoxyCodeLine{00072\ \textcolor{preprocessor}{\#ifdef\ SCALFMM\_ENABLE\_CUDA\_KERNEL}}
\DoxyCodeLine{00073\ \ \ \ \ ,\ StarPUCudaWrapperClass}
\DoxyCodeLine{00074\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00075\ \textcolor{preprocessor}{\#ifdef\ SCALFMM\_ENABLE\_OPENCL\_KERNEL}}
\DoxyCodeLine{00076\ \ \ \ \ ,\ StarPUOpenClWrapperClass}
\DoxyCodeLine{00077\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00078\ \ \ \ \ >\ \mbox{\hyperlink{class_f_group_task_star_p_u_implicit_algorithm}{ThisClass}};}
\DoxyCodeLine{00079\ }
\DoxyCodeLine{00080\ \ \ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{class}\ OtherBlockClass>}
\DoxyCodeLine{00081\ \ \ \ \ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_f_group_task_star_p_u_implicit_algorithm_1_1_block_interactions}{BlockInteractions}}\{}
\DoxyCodeLine{00082\ \ \ \ \ \ \ \ \ OtherBlockClass*\ otherBlock;}
\DoxyCodeLine{00083\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ otherBlockId;}
\DoxyCodeLine{00084\ \ \ \ \ \ \ \ \ std::vector<OutOfBlockInteraction>\ interactions;}
\DoxyCodeLine{00085\ \ \ \ \ \};}
\DoxyCodeLine{00086\ }
\DoxyCodeLine{00087\ \ \ \ \ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_f_group_task_star_p_u_implicit_algorithm_1_1_cell_handles}{CellHandles}}\{}
\DoxyCodeLine{00088\ \ \ \ \ \ \ \ \ starpu\_data\_handle\_t\ symb;}
\DoxyCodeLine{00089\ \ \ \ \ \ \ \ \ starpu\_data\_handle\_t\ up;}
\DoxyCodeLine{00090\ \ \ \ \ \ \ \ \ starpu\_data\_handle\_t\ down;}
\DoxyCodeLine{00091\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ intervalSize;}
\DoxyCodeLine{00092\ \ \ \ \ \};}
\DoxyCodeLine{00093\ }
\DoxyCodeLine{00094\ \ \ \ \ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_f_group_task_star_p_u_implicit_algorithm_1_1_particle_handles}{ParticleHandles}}\{}
\DoxyCodeLine{00095\ \ \ \ \ \ \ \ \ starpu\_data\_handle\_t\ symb;}
\DoxyCodeLine{00096\ \ \ \ \ \ \ \ \ starpu\_data\_handle\_t\ down;}
\DoxyCodeLine{00097\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ intervalSize;}
\DoxyCodeLine{00098\ \ \ \ \ \};}
\DoxyCodeLine{00099\ }
\DoxyCodeLine{00100\ \ \ \ \ std::vector<\ std::vector<\ std::vector<BlockInteractions<CellContainerClass>>>>\ externalInteractionsAllLevel;}
\DoxyCodeLine{00101\ \textcolor{preprocessor}{\#ifdef\ SCALFMM\_USE\_STARPU\_EXTRACT}}
\DoxyCodeLine{00102\ \ \ \ \ std::vector<\ std::vector<\ std::vector<std::vector<int>>>>\ externalInteractionsAllLevelInnerIndexes;}
\DoxyCodeLine{00103\ \ \ \ \ std::vector<\ std::vector<\ std::vector<std::vector<int>>>>\ externalInteractionsAllLevelOuterIndexes;}
\DoxyCodeLine{00104\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00105\ \ \ \ \ std::vector<\ std::vector<BlockInteractions<ParticleGroupClass>>>\ externalInteractionsLeafLevel;}
\DoxyCodeLine{00106\ \textcolor{preprocessor}{\#ifdef\ SCALFMM\_USE\_STARPU\_EXTRACT}}
\DoxyCodeLine{00107\ \ \ \ \ std::vector<\ std::vector<std::vector<int>>>\ externalInteractionsLeafLevelOuter;}
\DoxyCodeLine{00108\ \ \ \ \ std::vector<\ std::vector<std::vector<int>>>\ externalInteractionsLeafLevelInner;}
\DoxyCodeLine{00109\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00110\ \ \ \ \ std::list<const\ std::vector<OutOfBlockInteraction>*>\ externalInteractionsLeafLevelOpposite;}
\DoxyCodeLine{00111\ }
\DoxyCodeLine{00112\ \ \ \ \ OctreeClass*\textcolor{keyword}{const}\ tree;\ \ \ \ \ \ \ \textcolor{comment}{//<\ The\ Tree}}
\DoxyCodeLine{00113\ \ \ \ \ KernelClass*\textcolor{keyword}{const}\ originalCpuKernel;}
\DoxyCodeLine{00114\ }
\DoxyCodeLine{00115\ \ \ \ \ std::vector<CellHandles>*\ cellHandles;}
\DoxyCodeLine{00116\ \ \ \ \ std::vector<ParticleHandles>\ particleHandles;}
\DoxyCodeLine{00117\ }
\DoxyCodeLine{00118\ \ \ \ \ starpu\_codelet\ p2m\_cl;}
\DoxyCodeLine{00119\ \ \ \ \ starpu\_codelet\ m2m\_cl;}
\DoxyCodeLine{00120\ \ \ \ \ starpu\_codelet\ l2l\_cl;}
\DoxyCodeLine{00121\ \ \ \ \ starpu\_codelet\ l2l\_cl\_nocommute;}
\DoxyCodeLine{00122\ \ \ \ \ starpu\_codelet\ l2p\_cl;}
\DoxyCodeLine{00123\ }
\DoxyCodeLine{00124\ \ \ \ \ starpu\_codelet\ m2l\_cl\_in;}
\DoxyCodeLine{00125\ \ \ \ \ starpu\_codelet\ m2l\_cl\_inout;}
\DoxyCodeLine{00126\ \ \ \ \ starpu\_codelet\ m2l\_cl\_inout\_mpi;}
\DoxyCodeLine{00127\ }
\DoxyCodeLine{00128\ \ \ \ \ starpu\_codelet\ p2p\_cl\_in;}
\DoxyCodeLine{00129\ \ \ \ \ starpu\_codelet\ p2p\_cl\_inout;}
\DoxyCodeLine{00130\ \ \ \ \ starpu\_codelet\ p2p\_cl\_inout\_mpi;}
\DoxyCodeLine{00131\ }
\DoxyCodeLine{00132\ \textcolor{preprocessor}{\#ifdef\ STARPU\_USE\_REDUX}}
\DoxyCodeLine{00133\ \ \ \ \ starpu\_codelet\ p2p\_redux\_init;}
\DoxyCodeLine{00134\ \ \ \ \ starpu\_codelet\ p2p\_redux\_perform;}
\DoxyCodeLine{00135\ \ \ \ \ starpu\_codelet\ p2p\_redux\_read;}
\DoxyCodeLine{00136\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00137\ }
\DoxyCodeLine{00138\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{bool}\ noCommuteAtLastLevel;}
\DoxyCodeLine{00139\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{bool}\ noCommuteBetweenLevel;}
\DoxyCodeLine{00140\ }
\DoxyCodeLine{00141\ \textcolor{preprocessor}{\#ifdef\ STARPU\_USE\_CPU}}
\DoxyCodeLine{00142\ \ \ \ \ StarPUCpuWrapperClass\ cpuWrapper;}
\DoxyCodeLine{00143\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00144\ \textcolor{preprocessor}{\#ifdef\ SCALFMM\_ENABLE\_CUDA\_KERNEL}}
\DoxyCodeLine{00145\ \ \ \ \ StarPUCudaWrapperClass\ cudaWrapper;}
\DoxyCodeLine{00146\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00147\ \textcolor{preprocessor}{\#ifdef\ SCALFMM\_ENABLE\_OPENCL\_KERNEL}}
\DoxyCodeLine{00148\ \ \ \ \ StarPUOpenClWrapperClass\ openclWrapper;}
\DoxyCodeLine{00149\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00150\ }
\DoxyCodeLine{00151\ \ \ \ \ \mbox{\hyperlink{class_f_star_p_u_ptr_interface}{FStarPUPtrInterface}}\ wrappers;}
\DoxyCodeLine{00152\ \ \ \ \ \mbox{\hyperlink{class_f_star_p_u_ptr_interface}{FStarPUPtrInterface}}*\ wrapperptr;}
\DoxyCodeLine{00153\ }
\DoxyCodeLine{00154\ \textcolor{preprocessor}{\#ifdef\ STARPU\_SUPPORT\_ARBITER}}
\DoxyCodeLine{00155\ \ \ \ \ starpu\_arbiter\_t\ arbiterGlobal;}
\DoxyCodeLine{00156\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00157\ }
\DoxyCodeLine{00158\ \textcolor{preprocessor}{\#ifdef\ STARPU\_USE\_TASK\_NAME}}
\DoxyCodeLine{00159\ \textcolor{preprocessor}{\#ifndef\ SCALFMM\_SIMGRID\_TASKNAMEPARAMS}}
\DoxyCodeLine{00160\ \ \ \ \ std::vector<std::unique\_ptr<char[]>>\ m2mTaskNames;}
\DoxyCodeLine{00161\ \ \ \ \ std::vector<std::unique\_ptr<char[]>>\ m2lTaskNames;}
\DoxyCodeLine{00162\ \ \ \ \ std::vector<std::unique\_ptr<char[]>>\ m2lOuterTaskNames;}
\DoxyCodeLine{00163\ \ \ \ \ std::vector<std::unique\_ptr<char[]>>\ l2lTaskNames;}
\DoxyCodeLine{00164\ \ \ \ \ std::unique\_ptr<char[]>\ p2mTaskNames;}
\DoxyCodeLine{00165\ \ \ \ \ std::unique\_ptr<char[]>\ l2pTaskNames;}
\DoxyCodeLine{00166\ \ \ \ \ std::unique\_ptr<char[]>\ p2pTaskNames;}
\DoxyCodeLine{00167\ \ \ \ \ std::unique\_ptr<char[]>\ p2pOuterTaskNames;}
\DoxyCodeLine{00168\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{00169\ \ \ \ \ FStarPUTaskNameParams*\ taskNames\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00170\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00171\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00172\ \textcolor{preprocessor}{\#ifdef\ SCALFMM\_STARPU\_USE\_PRIO}}
\DoxyCodeLine{00173\ \ \ \ \ \textcolor{keyword}{typedef}\ FStarPUFmmPrioritiesV2\ PrioClass;\textcolor{comment}{//\ FStarPUFmmPriorities}}
\DoxyCodeLine{00174\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00175\ \ \ \ \ \textcolor{keywordtype}{int}\ mpi\_rank,\ nproc;}
\DoxyCodeLine{00176\ \ \ \ \ std::vector<std::vector<std::vector<MortonIndex>>>\ nodeRepartition;}
\DoxyCodeLine{00177\ }
\DoxyCodeLine{00178\ \textcolor{preprocessor}{\#ifdef\ SCALFMM\_USE\_STARPU\_EXTRACT}}
\DoxyCodeLine{00179\ \ \ \ \ \textcolor{keyword}{struct\ }ParticleExtractedHandles\{}
\DoxyCodeLine{00180\ \ \ \ \ \ \ \ \ starpu\_data\_handle\_t\ symb;}
\DoxyCodeLine{00181\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ size;}
\DoxyCodeLine{00182\ \ \ \ \ \ \ \ \ std::unique\_ptr<unsigned\ char[]>\ data;}
\DoxyCodeLine{00183\ \ \ \ \ \ \ \ \ std::vector<int>\ leavesToExtract;}
\DoxyCodeLine{00184\ \ \ \ \ \};}
\DoxyCodeLine{00185\ }
\DoxyCodeLine{00186\ \ \ \ \ std::list<ParticleExtractedHandles>\ extractedParticlesBuffer;}
\DoxyCodeLine{00187\ }
\DoxyCodeLine{00188\ \ \ \ \ \textcolor{keyword}{struct\ }DuplicatedParticlesHandle\{}
\DoxyCodeLine{00189\ \ \ \ \ \ \ \ \ starpu\_data\_handle\_t\ symb;}
\DoxyCodeLine{00190\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ size;}
\DoxyCodeLine{00191\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}*\ data;\ \textcolor{comment}{//\ Never\ delete\ it,\ we\ reuse\ already\ allocate\ memory\ here}}
\DoxyCodeLine{00192\ \ \ \ \ \};}
\DoxyCodeLine{00193\ }
\DoxyCodeLine{00194\ \ \ \ \ std::list<DuplicatedParticlesHandle>\ duplicatedParticlesBuffer;}
\DoxyCodeLine{00195\ }
\DoxyCodeLine{00196\ \ \ \ \ starpu\_codelet\ p2p\_extract;}
\DoxyCodeLine{00197\ \ \ \ \ starpu\_codelet\ p2p\_insert;}
\DoxyCodeLine{00198\ \ \ \ \ starpu\_codelet\ p2p\_insert\_bis;}
\DoxyCodeLine{00199\ }
\DoxyCodeLine{00200\ \ \ \ \ \textcolor{keyword}{struct\ }CellExtractedHandles\{}
\DoxyCodeLine{00201\ \ \ \ \ \ \ \ \ starpu\_data\_handle\_t\ all;}
\DoxyCodeLine{00202\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ size;}
\DoxyCodeLine{00203\ \ \ \ \ \ \ \ \ std::unique\_ptr<unsigned\ char[]>\ data;}
\DoxyCodeLine{00204\ \ \ \ \ \ \ \ \ std::vector<int>\ cellsToExtract;}
\DoxyCodeLine{00205\ \ \ \ \ \};}
\DoxyCodeLine{00206\ }
\DoxyCodeLine{00207\ \ \ \ \ std::list<CellExtractedHandles>\ extractedCellBuffer;}
\DoxyCodeLine{00208\ }
\DoxyCodeLine{00209\ \ \ \ \ \textcolor{keyword}{struct\ }DuplicatedCellHandle\{}
\DoxyCodeLine{00210\ \ \ \ \ \ \ \ \ starpu\_data\_handle\_t\ symb;}
\DoxyCodeLine{00211\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ sizeSymb;}
\DoxyCodeLine{00212\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}*\ dataSymb;\ \textcolor{comment}{//\ Never\ delete\ it,\ we\ reuse\ already\ allocate\ memory\ here}}
\DoxyCodeLine{00213\ \ \ \ \ \ \ \ \ starpu\_data\_handle\_t\ other;}
\DoxyCodeLine{00214\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ sizeOther;}
\DoxyCodeLine{00215\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}*\ dataOther;\ \textcolor{comment}{//\ Never\ delete\ it,\ we\ reuse\ already\ allocate\ memory\ here}}
\DoxyCodeLine{00216\ }
\DoxyCodeLine{00217\ \ \ \ \ \ \ \ \ std::unique\_ptr<unsigned\ char[]>\ dataSymbPtr;}
\DoxyCodeLine{00218\ \ \ \ \ \ \ \ \ std::unique\_ptr<unsigned\ char[]>\ dataOtherPtr;}
\DoxyCodeLine{00219\ \ \ \ \ \};}
\DoxyCodeLine{00220\ }
\DoxyCodeLine{00221\ \ \ \ \ std::list<DuplicatedCellHandle>\ duplicatedCellBuffer;}
\DoxyCodeLine{00222\ }
\DoxyCodeLine{00223\ \ \ \ \ starpu\_codelet\ cell\_extract\_up;}
\DoxyCodeLine{00224\ \ \ \ \ starpu\_codelet\ cell\_insert\_up;}
\DoxyCodeLine{00225\ \ \ \ \ starpu\_codelet\ cell\_insert\_up\_bis;}
\DoxyCodeLine{00226\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00227\ }
\DoxyCodeLine{00228\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00229\ \ \ \ \ \mbox{\hyperlink{class_f_group_task_star_p_u_implicit_algorithm}{FGroupTaskStarPUImplicitAlgorithm}}(OctreeClass*\textcolor{keyword}{const}\ inTree,\ KernelClass*\ inKernels,\ std::vector<MortonIndex>\&\ distributedMortonIndex)}
\DoxyCodeLine{00230\ \ \ \ \ \ \ \ \ :\ tree(inTree),\ originalCpuKernel(inKernels),}
\DoxyCodeLine{00231\ \ \ \ \ \ \ \ \ \ \ cellHandles(nullptr),}
\DoxyCodeLine{00232\ \ \ \ \ \ \ \ \ \ \ noCommuteAtLastLevel(FEnv::GetBool(\textcolor{stringliteral}{"{}SCALFMM\_NO\_COMMUTE\_LAST\_L2L"{}},\ true)),}
\DoxyCodeLine{00233\ \ \ \ \ \ \ \ \ \ \ noCommuteBetweenLevel(FEnv::GetBool(\textcolor{stringliteral}{"{}SCALFMM\_NO\_COMMUTE\_M2L\_L2L"{}},\ false)),}
\DoxyCodeLine{00234\ \ \ \ \ \ \ \#ifdef\ STARPU\_USE\_CPU}
\DoxyCodeLine{00235\ \ \ \ \ \ \ \ \ \ \ cpuWrapper(tree-\/>getHeight()),}
\DoxyCodeLine{00236\ \ \ \ \ \ \ \#endif}
\DoxyCodeLine{00237\ \ \ \ \ \ \ \#ifdef\ SCALFMM\_ENABLE\_CUDA\_KERNEL}
\DoxyCodeLine{00238\ \ \ \ \ \ \ \ \ \ \ cudaWrapper(tree-\/>getHeight()),}
\DoxyCodeLine{00239\ \ \ \ \ \ \ \#endif}
\DoxyCodeLine{00240\ \ \ \ \ \ \ \#ifdef\ SCALFMM\_ENABLE\_OPENCL\_KERNEL}
\DoxyCodeLine{00241\ \ \ \ \ \ \ \ \ \ \ openclWrapper(tree-\/>getHeight()),}
\DoxyCodeLine{00242\ \ \ \ \ \ \ \#endif}
\DoxyCodeLine{00243\ \ \ \ \ \ \ \ \ \ \ wrapperptr(\&wrappers)\{}
\DoxyCodeLine{00244\ \ \ \ \ \ \ \ \ FAssertLF(tree,\ \textcolor{stringliteral}{"{}tree\ cannot\ be\ null"{}});}
\DoxyCodeLine{00245\ \ \ \ \ \ \ \ \ FAssertLF(inKernels,\ \textcolor{stringliteral}{"{}kernels\ cannot\ be\ null"{}});}
\DoxyCodeLine{00246\ }
\DoxyCodeLine{00247\ \ \ \ \ \ \ \ \ FAbstractAlgorithm::setNbLevelsInTree(tree-\/>getHeight());}
\DoxyCodeLine{00248\ \ \ \ \ \ \ \ \ \textcolor{keyword}{struct\ }starpu\_conf\ conf;}
\DoxyCodeLine{00249\ \ \ \ \ \ \ \ \ FAssertLF(starpu\_conf\_init(\&conf)\ ==\ 0);}
\DoxyCodeLine{00250\ \textcolor{preprocessor}{\#ifdef\ SCALFMM\_STARPU\_USE\_PRIO}}
\DoxyCodeLine{00251\ \ \ \ \ \ \ \ \ PrioClass::Controller().init(\&conf,\ tree-\/>getHeight(),\ inKernels);}
\DoxyCodeLine{00252\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00253\ \ \ \ \ \ \ \ \ FAssertLF(starpu\_init(\&conf)\ ==\ 0);}
\DoxyCodeLine{00254\ \ \ \ \ \ \ \ \ FAssertLF(starpu\_mpi\_init\ (\ 0,\ 0,\ 0\ )\ ==\ 0);}
\DoxyCodeLine{00255\ \ \ \ \ \ \ \ \ MPI\_Comm\_rank(MPI\_COMM\_WORLD,\&mpi\_rank);}
\DoxyCodeLine{00256\ \ \ \ \ \ \ \ \ MPI\_Comm\_size(MPI\_COMM\_WORLD,\&nproc);}
\DoxyCodeLine{00257\ \textcolor{preprocessor}{\#ifdef\ STARPU\_USE\_TASK\_NAME}}
\DoxyCodeLine{00258\ \textcolor{preprocessor}{\#ifdef\ SCALFMM\_SIMGRID\_TASKNAMEPARAMS}}
\DoxyCodeLine{00259\ \ \ \ \ \ \ \ \ taskNames\ =\ \textcolor{keyword}{new}\ FStarPUTaskNameParams(mpi\_rank,\ nproc);}
\DoxyCodeLine{00260\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00261\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00262\ \ \ \ \ \ \ \ \ starpu\_malloc\_set\_align(32);}
\DoxyCodeLine{00263\ }
\DoxyCodeLine{00264\ \ \ \ \ \ \ \ \ starpu\_pthread\_mutex\_t\ initMutex;}
\DoxyCodeLine{00265\ \ \ \ \ \ \ \ \ starpu\_pthread\_mutex\_init(\&initMutex,\ NULL);}
\DoxyCodeLine{00266\ \textcolor{preprocessor}{\#ifdef\ STARPU\_USE\_CPU}}
\DoxyCodeLine{00267\ \ \ \ \ \ \ \ \ FStarPUUtils::ExecOnWorkers(STARPU\_CPU,\ [\&]()\{}
\DoxyCodeLine{00268\ \ \ \ \ \ \ \ \ \ \ \ \ starpu\_pthread\_mutex\_lock(\&initMutex);}
\DoxyCodeLine{00269\ \ \ \ \ \ \ \ \ \ \ \ \ cpuWrapper.initKernel(starpu\_worker\_get\_id(),\ inKernels);}
\DoxyCodeLine{00270\ \ \ \ \ \ \ \ \ \ \ \ \ starpu\_pthread\_mutex\_unlock(\&initMutex);}
\DoxyCodeLine{00271\ \ \ \ \ \ \ \ \ \});}
\DoxyCodeLine{00272\ \ \ \ \ \ \ \ \ wrappers.set(FSTARPU\_CPU\_IDX,\ \&cpuWrapper);}
\DoxyCodeLine{00273\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00274\ \textcolor{preprocessor}{\#ifdef\ SCALFMM\_ENABLE\_CUDA\_KERNEL}}
\DoxyCodeLine{00275\ \ \ \ \ \ \ \ \ FStarPUUtils::ExecOnWorkers(STARPU\_CUDA,\ [\&]()\{}
\DoxyCodeLine{00276\ \ \ \ \ \ \ \ \ \ \ \ \ starpu\_pthread\_mutex\_lock(\&initMutex);}
\DoxyCodeLine{00277\ \ \ \ \ \ \ \ \ \ \ \ \ cudaWrapper.initKernel(starpu\_worker\_get\_id(),\ inKernels);}
\DoxyCodeLine{00278\ \ \ \ \ \ \ \ \ \ \ \ \ starpu\_pthread\_mutex\_unlock(\&initMutex);}
\DoxyCodeLine{00279\ \ \ \ \ \ \ \ \ \});}
\DoxyCodeLine{00280\ \ \ \ \ \ \ \ \ wrappers.set(FSTARPU\_CUDA\_IDX,\ \&cudaWrapper);}
\DoxyCodeLine{00281\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00282\ \textcolor{preprocessor}{\#ifdef\ SCALFMM\_ENABLE\_OPENCL\_KERNEL}}
\DoxyCodeLine{00283\ \ \ \ \ \ \ \ \ FStarPUUtils::ExecOnWorkers(STARPU\_OPENCL,\ [\&]()\{}
\DoxyCodeLine{00284\ \ \ \ \ \ \ \ \ \ \ \ \ starpu\_pthread\_mutex\_lock(\&initMutex);}
\DoxyCodeLine{00285\ \ \ \ \ \ \ \ \ \ \ \ \ openclWrapper.initKernel(starpu\_worker\_get\_id(),\ inKernels);}
\DoxyCodeLine{00286\ \ \ \ \ \ \ \ \ \ \ \ \ starpu\_pthread\_mutex\_unlock(\&initMutex);}
\DoxyCodeLine{00287\ \ \ \ \ \ \ \ \ \});}
\DoxyCodeLine{00288\ \ \ \ \ \ \ \ \ wrappers.set(FSTARPU\_OPENCL\_IDX,\ \&openclWrapper);}
\DoxyCodeLine{00289\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00290\ \ \ \ \ \ \ \ \ starpu\_pthread\_mutex\_destroy(\&initMutex);}
\DoxyCodeLine{00291\ }
\DoxyCodeLine{00292\ \ \ \ \ \ \ \ \ starpu\_pause();}
\DoxyCodeLine{00293\ }
\DoxyCodeLine{00294\ \ \ \ \ \ \ \ \ cellHandles\ \ \ =\ \textcolor{keyword}{new}\ std::vector<CellHandles>[tree-\/>getHeight()];}
\DoxyCodeLine{00295\ }
\DoxyCodeLine{00296\ \textcolor{preprocessor}{\#ifdef\ STARPU\_SUPPORT\_ARBITER}}
\DoxyCodeLine{00297\ \ \ \ \ \ \ \ \ arbiterGlobal\ =\ starpu\_arbiter\_create();}
\DoxyCodeLine{00298\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00299\ }
\DoxyCodeLine{00300\ \ \ \ \ \ \ \ \ initCodelet();}
\DoxyCodeLine{00301\ \ \ \ \ \ \ \ \ initCodeletMpi();}
\DoxyCodeLine{00302\ \ \ \ \ \ \ \ \ createMachinChose(distributedMortonIndex);}
\DoxyCodeLine{00303\ \ \ \ \ \ \ \ \ rebuildInteractions();}
\DoxyCodeLine{00304\ }
\DoxyCodeLine{00305\ \ \ \ \ \ \ \ \ FLOG(FLog::Controller\ <<\ \textcolor{stringliteral}{"{}FGroupTaskStarPUAlgorithm\ (Max\ Worker\ "{}}\ <<\ starpu\_worker\_get\_count()\ <<\ \textcolor{stringliteral}{"{})\(\backslash\)n"{}});}
\DoxyCodeLine{00306\ \textcolor{preprocessor}{\#ifdef\ STARPU\_USE\_CPU}}
\DoxyCodeLine{00307\ \ \ \ \ \ \ \ \ FLOG(FLog::Controller\ <<\ \textcolor{stringliteral}{"{}FGroupTaskStarPUAlgorithm\ (Max\ CPU\ "{}}\ <<\ starpu\_cpu\_worker\_get\_count()\ <<\ \textcolor{stringliteral}{"{})\(\backslash\)n"{}});}
\DoxyCodeLine{00308\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00309\ \textcolor{preprocessor}{\#ifdef\ SCALFMM\_ENABLE\_OPENCL\_KERNEL}}
\DoxyCodeLine{00310\ \ \ \ \ \ \ \ \ FLOG(FLog::Controller\ <<\ \textcolor{stringliteral}{"{}FGroupTaskStarPUAlgorithm\ (Max\ OpenCL\ "{}}\ <<\ starpu\_opencl\_worker\_get\_count()\ <<\ \textcolor{stringliteral}{"{})\(\backslash\)n"{}});}
\DoxyCodeLine{00311\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00312\ \textcolor{preprocessor}{\#ifdef\ SCALFMM\_ENABLE\_CUDA\_KERNEL}}
\DoxyCodeLine{00313\ \ \ \ \ \ \ \ \ FLOG(FLog::Controller\ <<\ \textcolor{stringliteral}{"{}FGroupTaskStarPUAlgorithm\ (Max\ CUDA\ "{}}\ <<\ starpu\_cuda\_worker\_get\_count()\ <<\ \textcolor{stringliteral}{"{})\(\backslash\)n"{}});}
\DoxyCodeLine{00314\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00315\ \ \ \ \ \ \ \ \ FLOG(FLog::Controller\ <<\ \textcolor{stringliteral}{"{}SCALFMM\_NO\_COMMUTE\_LAST\_L2L\ "{}}\ <<\ noCommuteAtLastLevel\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{00316\ \ \ \ \ \ \ \ \ FLOG(FLog::Controller\ <<\ \textcolor{stringliteral}{"{}SCALFMM\_NO\_COMMUTE\_M2L\_L2L\ "{}}\ <<\ noCommuteBetweenLevel\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{00317\ }
\DoxyCodeLine{00318\ \ \ \ \ \ \ \ \ buildTaskNames();}
\DoxyCodeLine{00319\ \ \ \ \ \}}
\DoxyCodeLine{00320\ }
\DoxyCodeLine{00321\ \ \ \ \ \textcolor{keywordtype}{void}\ buildTaskNames()\{}
\DoxyCodeLine{00322\ \textcolor{preprocessor}{\#ifdef\ STARPU\_USE\_TASK\_NAME}}
\DoxyCodeLine{00323\ \textcolor{preprocessor}{\#ifndef\ SCALFMM\_SIMGRID\_TASKNAMEPARAMS}}
\DoxyCodeLine{00324\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ namesLength\ =\ 128;}
\DoxyCodeLine{00325\ \ \ \ \ \ \ \ \ m2mTaskNames.resize(tree-\/>getHeight());}
\DoxyCodeLine{00326\ \ \ \ \ \ \ \ \ m2lTaskNames.resize(tree-\/>getHeight());}
\DoxyCodeLine{00327\ \ \ \ \ \ \ \ \ m2lOuterTaskNames.resize(tree-\/>getHeight());}
\DoxyCodeLine{00328\ \ \ \ \ \ \ \ \ l2lTaskNames.resize(tree-\/>getHeight());}
\DoxyCodeLine{00329\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ idxLevel\ =\ 0\ ;\ idxLevel\ <\ tree-\/>getHeight()\ ;\ ++idxLevel)\{}
\DoxyCodeLine{00330\ \ \ \ \ \ \ \ \ \ \ \ \ m2mTaskNames[idxLevel].reset(\textcolor{keyword}{new}\ \textcolor{keywordtype}{char}[namesLength]);}
\DoxyCodeLine{00331\ \ \ \ \ \ \ \ \ \ \ \ \ snprintf(m2mTaskNames[idxLevel].get(),\ namesLength,\ \textcolor{stringliteral}{"{}M2M-\/level-\/\%d"{}},\ idxLevel);}
\DoxyCodeLine{00332\ \ \ \ \ \ \ \ \ \ \ \ \ m2lTaskNames[idxLevel].reset(\textcolor{keyword}{new}\ \textcolor{keywordtype}{char}[namesLength]);}
\DoxyCodeLine{00333\ \ \ \ \ \ \ \ \ \ \ \ \ snprintf(m2lTaskNames[idxLevel].get(),\ namesLength,\ \textcolor{stringliteral}{"{}M2L-\/level-\/\%d"{}},\ idxLevel);}
\DoxyCodeLine{00334\ \ \ \ \ \ \ \ \ \ \ \ \ m2lOuterTaskNames[idxLevel].reset(\textcolor{keyword}{new}\ \textcolor{keywordtype}{char}[namesLength]);}
\DoxyCodeLine{00335\ \ \ \ \ \ \ \ \ \ \ \ \ snprintf(m2lOuterTaskNames[idxLevel].get(),\ namesLength,\ \textcolor{stringliteral}{"{}M2L-\/out-\/level-\/\%d"{}},\ idxLevel);}
\DoxyCodeLine{00336\ \ \ \ \ \ \ \ \ \ \ \ \ l2lTaskNames[idxLevel].reset(\textcolor{keyword}{new}\ \textcolor{keywordtype}{char}[namesLength]);}
\DoxyCodeLine{00337\ \ \ \ \ \ \ \ \ \ \ \ \ snprintf(l2lTaskNames[idxLevel].get(),\ namesLength,\ \textcolor{stringliteral}{"{}L2L-\/level-\/\%d"{}},\ idxLevel);}
\DoxyCodeLine{00338\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00339\ }
\DoxyCodeLine{00340\ \ \ \ \ \ \ \ \ p2mTaskNames.reset(\textcolor{keyword}{new}\ \textcolor{keywordtype}{char}[namesLength]);}
\DoxyCodeLine{00341\ \ \ \ \ \ \ \ \ snprintf(p2mTaskNames.get(),\ namesLength,\ \textcolor{stringliteral}{"{}P2M"{}});}
\DoxyCodeLine{00342\ \ \ \ \ \ \ \ \ l2pTaskNames.reset(\textcolor{keyword}{new}\ \textcolor{keywordtype}{char}[namesLength]);}
\DoxyCodeLine{00343\ \ \ \ \ \ \ \ \ snprintf(l2pTaskNames.get(),\ namesLength,\ \textcolor{stringliteral}{"{}L2P"{}});}
\DoxyCodeLine{00344\ \ \ \ \ \ \ \ \ p2pTaskNames.reset(\textcolor{keyword}{new}\ \textcolor{keywordtype}{char}[namesLength]);}
\DoxyCodeLine{00345\ \ \ \ \ \ \ \ \ snprintf(p2pTaskNames.get(),\ namesLength,\ \textcolor{stringliteral}{"{}P2P"{}});}
\DoxyCodeLine{00346\ \ \ \ \ \ \ \ \ p2pOuterTaskNames.reset(\textcolor{keyword}{new}\ \textcolor{keywordtype}{char}[namesLength]);}
\DoxyCodeLine{00347\ \ \ \ \ \ \ \ \ snprintf(p2pOuterTaskNames.get(),\ namesLength,\ \textcolor{stringliteral}{"{}P2P-\/out"{}});}
\DoxyCodeLine{00348\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00349\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00350\ \ \ \ \ \}}
\DoxyCodeLine{00351\ }
\DoxyCodeLine{00352\ \ \ \ \ \textcolor{keywordtype}{void}\ syncData()\{}
\DoxyCodeLine{00353\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ idxLevel\ =\ 0\ ;\ idxLevel\ <\ tree-\/>getHeight()\ ;\ ++idxLevel)\{}
\DoxyCodeLine{00354\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ idxHandle\ =\ 0\ ;\ idxHandle\ <\ int(cellHandles[idxLevel].size())\ ;\ ++idxHandle)\{}
\DoxyCodeLine{00355\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(isDataOwnedBerenger(tree-\/>getCellGroup(idxLevel,\ idxHandle)-\/>getStartingIndex(),\ idxLevel))\ \{\textcolor{comment}{//Clean\ only\ our\ data\ handle}}
\DoxyCodeLine{00356\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ starpu\_data\_acquire(cellHandles[idxLevel][idxHandle].symb,\ STARPU\_R);}
\DoxyCodeLine{00357\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ starpu\_data\_release(cellHandles[idxLevel][idxHandle].symb);}
\DoxyCodeLine{00358\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ starpu\_data\_acquire(cellHandles[idxLevel][idxHandle].up,\ STARPU\_R);}
\DoxyCodeLine{00359\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ starpu\_data\_release(cellHandles[idxLevel][idxHandle].up);}
\DoxyCodeLine{00360\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ starpu\_data\_acquire(cellHandles[idxLevel][idxHandle].down,\ STARPU\_R);}
\DoxyCodeLine{00361\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ starpu\_data\_release(cellHandles[idxLevel][idxHandle].down);}
\DoxyCodeLine{00362\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00363\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00364\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00365\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00366\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ idxHandle\ =\ 0\ ;\ idxHandle\ <\ int(particleHandles.size())\ ;\ ++idxHandle)\{}
\DoxyCodeLine{00367\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(isDataOwnedBerenger(tree-\/>getCellGroup(tree-\/>getHeight()-\/1,\ idxHandle)-\/>getStartingIndex(),\ tree-\/>getHeight()-\/1))\ \{\textcolor{comment}{//Clean\ only\ our\ data\ handle}}
\DoxyCodeLine{00368\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ starpu\_data\_acquire(particleHandles[idxHandle].symb,\ STARPU\_R);}
\DoxyCodeLine{00369\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ starpu\_data\_release(particleHandles[idxHandle].symb);}
\DoxyCodeLine{00370\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ starpu\_data\_acquire(particleHandles[idxHandle].down,\ STARPU\_R);}
\DoxyCodeLine{00371\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ starpu\_data\_release(particleHandles[idxHandle].down);}
\DoxyCodeLine{00372\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00373\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00374\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00375\ \ \ \ \ \}}
\DoxyCodeLine{00376\ }
\DoxyCodeLine{00377\ \ \ \ \ \mbox{\hyperlink{class_f_group_task_star_p_u_implicit_algorithm}{\string~FGroupTaskStarPUImplicitAlgorithm}}()\{}
\DoxyCodeLine{00378\ \ \ \ \ \ \ \ \ starpu\_resume();}
\DoxyCodeLine{00379\ }
\DoxyCodeLine{00380\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_f_group_task_star_p_u_implicit_algorithm_a224aa23fa3665a05ca679b926128806e}{cleanHandle}}();}
\DoxyCodeLine{00381\ \ \ \ \ \ \ \ \ \textcolor{keyword}{delete}[]\ cellHandles;}
\DoxyCodeLine{00382\ }
\DoxyCodeLine{00383\ \ \ \ \ \ \ \ \ starpu\_pthread\_mutex\_t\ releaseMutex;}
\DoxyCodeLine{00384\ \ \ \ \ \ \ \ \ starpu\_pthread\_mutex\_init(\&releaseMutex,\ NULL);}
\DoxyCodeLine{00385\ \textcolor{preprocessor}{\#ifdef\ STARPU\_USE\_CPU}}
\DoxyCodeLine{00386\ \ \ \ \ \ \ \ \ FStarPUUtils::ExecOnWorkers(STARPU\_CPU,\ [\&]()\{}
\DoxyCodeLine{00387\ \ \ \ \ \ \ \ \ \ \ \ \ starpu\_pthread\_mutex\_lock(\&releaseMutex);}
\DoxyCodeLine{00388\ \ \ \ \ \ \ \ \ \ \ \ \ cpuWrapper.releaseKernel(starpu\_worker\_get\_id());}
\DoxyCodeLine{00389\ \ \ \ \ \ \ \ \ \ \ \ \ starpu\_pthread\_mutex\_unlock(\&releaseMutex);}
\DoxyCodeLine{00390\ \ \ \ \ \ \ \ \ \});}
\DoxyCodeLine{00391\ \ \ \ \ \ \ \ \ wrappers.set(FSTARPU\_CPU\_IDX,\ \&cpuWrapper);}
\DoxyCodeLine{00392\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00393\ \textcolor{preprocessor}{\#ifdef\ SCALFMM\_ENABLE\_CUDA\_KERNEL}}
\DoxyCodeLine{00394\ \ \ \ \ \ \ \ \ FStarPUUtils::ExecOnWorkers(STARPU\_CUDA,\ [\&]()\{}
\DoxyCodeLine{00395\ \ \ \ \ \ \ \ \ \ \ \ \ starpu\_pthread\_mutex\_lock(\&releaseMutex);}
\DoxyCodeLine{00396\ \ \ \ \ \ \ \ \ \ \ \ \ cudaWrapper.releaseKernel(starpu\_worker\_get\_id());}
\DoxyCodeLine{00397\ \ \ \ \ \ \ \ \ \ \ \ \ starpu\_pthread\_mutex\_unlock(\&releaseMutex);}
\DoxyCodeLine{00398\ \ \ \ \ \ \ \ \ \});}
\DoxyCodeLine{00399\ \ \ \ \ \ \ \ \ wrappers.set(FSTARPU\_CUDA\_IDX,\ \&cudaWrapper);}
\DoxyCodeLine{00400\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00401\ \textcolor{preprocessor}{\#ifdef\ SCALFMM\_ENABLE\_OPENCL\_KERNEL}}
\DoxyCodeLine{00402\ \ \ \ \ \ \ \ \ FStarPUUtils::ExecOnWorkers(STARPU\_OPENCL,\ [\&]()\{}
\DoxyCodeLine{00403\ \ \ \ \ \ \ \ \ \ \ \ \ starpu\_pthread\_mutex\_lock(\&releaseMutex);}
\DoxyCodeLine{00404\ \ \ \ \ \ \ \ \ \ \ \ \ openclWrapper.releaseKernel(starpu\_worker\_get\_id());}
\DoxyCodeLine{00405\ \ \ \ \ \ \ \ \ \ \ \ \ starpu\_pthread\_mutex\_unlock(\&releaseMutex);}
\DoxyCodeLine{00406\ \ \ \ \ \ \ \ \ \});}
\DoxyCodeLine{00407\ \ \ \ \ \ \ \ \ wrappers.set(FSTARPU\_OPENCL\_IDX,\ \&openclWrapper);}
\DoxyCodeLine{00408\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00409\ \ \ \ \ \ \ \ \ starpu\_pthread\_mutex\_destroy(\&releaseMutex);}
\DoxyCodeLine{00410\ }
\DoxyCodeLine{00411\ }
\DoxyCodeLine{00412\ \textcolor{preprocessor}{\#ifdef\ STARPU\_SUPPORT\_ARBITER}}
\DoxyCodeLine{00413\ \ \ \ \ \ \ \ \ starpu\_arbiter\_destroy(arbiterGlobal);}
\DoxyCodeLine{00414\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00415\ }
\DoxyCodeLine{00416\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keyword}{auto}\ externalInteraction\ :\ externalInteractionsLeafLevelOpposite)}
\DoxyCodeLine{00417\ \ \ \ \ \ \ \ \ \ \ \ \ delete\ externalInteraction;}
\DoxyCodeLine{00418\ }
\DoxyCodeLine{00419\ \ \ \ \ \ \ \ \ starpu\_mpi\_shutdown();}
\DoxyCodeLine{00420\ \ \ \ \ \ \ \ \ starpu\_shutdown();}
\DoxyCodeLine{00421\ \ \ \ \ \}}
\DoxyCodeLine{00422\ }
\DoxyCodeLine{00423\ \ \ \ \ \textcolor{keywordtype}{void}\ rebuildInteractions()\{}
\DoxyCodeLine{00424\ \ \ \ \ \ \ \ \ FAssertLF(getenv(\textcolor{stringliteral}{"{}OMP\_WAIT\_POLICY"{}})\ ==\ \textcolor{keyword}{nullptr}}
\DoxyCodeLine{00425\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ||\ strcmp(getenv(\textcolor{stringliteral}{"{}OMP\_WAIT\_POLICY"{}}),\ \textcolor{stringliteral}{"{}PASSIVE"{}})\ ==\ 0}
\DoxyCodeLine{00426\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ||\ strcmp(getenv(\textcolor{stringliteral}{"{}OMP\_WAIT\_POLICY"{}}),\ \textcolor{stringliteral}{"{}passive"{}})\ ==\ 0);}
\DoxyCodeLine{00427\ }
\DoxyCodeLine{00428\ \textcolor{preprocessor}{\#pragma\ omp\ parallel}}
\DoxyCodeLine{00429\ \textcolor{preprocessor}{\#pragma\ omp\ single}}
\DoxyCodeLine{00430\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_f_group_task_star_p_u_implicit_algorithm_a2aee22c84ad5b40475f9abeae14b94d7}{buildExternalInteractionVecs}}();}
\DoxyCodeLine{00431\ }
\DoxyCodeLine{00432\ \ \ \ \ \ \ \ \ buildHandles();}
\DoxyCodeLine{00433\ \ \ \ \ \}}
\DoxyCodeLine{00434\ }
\DoxyCodeLine{00435\ }
\DoxyCodeLine{00436\ \textcolor{preprocessor}{\#ifdef\ STARPU\_USE\_CPU}}
\DoxyCodeLine{00437\ \ \ \ \ \textcolor{keywordtype}{void}\ forEachCpuWorker(std::function<\textcolor{keywordtype}{void}(\textcolor{keywordtype}{void})>\ func)\{}
\DoxyCodeLine{00438\ \ \ \ \ \ \ \ \ starpu\_resume();}
\DoxyCodeLine{00439\ \ \ \ \ \ \ \ \ FStarPUUtils::ExecOnWorkers(STARPU\_CPU,\ func);}
\DoxyCodeLine{00440\ \ \ \ \ \ \ \ \ starpu\_pause();}
\DoxyCodeLine{00441\ \ \ \ \ \}}
\DoxyCodeLine{00442\ }
\DoxyCodeLine{00443\ \ \ \ \ \textcolor{keywordtype}{void}\ forEachCpuWorker(std::function<\textcolor{keywordtype}{void}(KernelClass*)>\ func)\{}
\DoxyCodeLine{00444\ \ \ \ \ \ \ \ \ starpu\_resume();}
\DoxyCodeLine{00445\ \ \ \ \ \ \ \ \ FStarPUUtils::ExecOnWorkers(STARPU\_CPU,\ [\&]()\{}
\DoxyCodeLine{00446\ \ \ \ \ \ \ \ \ \ \ \ \ func(cpuWrapper.getKernel(starpu\_worker\_get\_id()));}
\DoxyCodeLine{00447\ \ \ \ \ \ \ \ \ \});}
\DoxyCodeLine{00448\ \ \ \ \ \ \ \ \ starpu\_pause();}
\DoxyCodeLine{00449\ \ \ \ \ \}}
\DoxyCodeLine{00450\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00451\ \textcolor{preprocessor}{\#ifdef\ SCALFMM\_ENABLE\_CUDA\_KERNEL}}
\DoxyCodeLine{00452\ \ \ \ \ \textcolor{keywordtype}{void}\ forEachCudaWorker(std::function<\textcolor{keywordtype}{void}(\textcolor{keywordtype}{void})>\ func)\{}
\DoxyCodeLine{00453\ \ \ \ \ \ \ \ \ starpu\_resume();}
\DoxyCodeLine{00454\ \ \ \ \ \ \ \ \ FStarPUUtils::ExecOnWorkers(STARPU\_CUDA,\ func);}
\DoxyCodeLine{00455\ \ \ \ \ \ \ \ \ starpu\_pause();}
\DoxyCodeLine{00456\ \ \ \ \ \}}
\DoxyCodeLine{00457\ \ \ \ \ \textcolor{keywordtype}{void}\ forEachCudaWorker(std::function<\textcolor{keywordtype}{void}(\textcolor{keywordtype}{void}*)>\ func)\{}
\DoxyCodeLine{00458\ \ \ \ \ \ \ \ \ starpu\_resume();}
\DoxyCodeLine{00459\ \ \ \ \ \ \ \ \ FStarPUUtils::ExecOnWorkers(STARPU\_CUDA,\ [\&]()\{}
\DoxyCodeLine{00460\ \ \ \ \ \ \ \ \ \ \ \ \ func(cudaWrapper.getKernel(starpu\_worker\_get\_id()));}
\DoxyCodeLine{00461\ \ \ \ \ \ \ \ \ \});}
\DoxyCodeLine{00462\ \ \ \ \ \ \ \ \ starpu\_pause();}
\DoxyCodeLine{00463\ \ \ \ \ \}}
\DoxyCodeLine{00464\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00465\ \textcolor{preprocessor}{\#ifdef\ SCALFMM\_ENABLE\_OPENCL\_KERNEL}}
\DoxyCodeLine{00466\ \ \ \ \ \textcolor{keywordtype}{void}\ forEachOpenCLWorker(std::function<\textcolor{keywordtype}{void}(\textcolor{keywordtype}{void})>\ func)\{}
\DoxyCodeLine{00467\ \ \ \ \ \ \ \ \ starpu\_resume();}
\DoxyCodeLine{00468\ \ \ \ \ \ \ \ \ FStarPUUtils::ExecOnWorkers(STARPU\_OPENCL,\ func);}
\DoxyCodeLine{00469\ \ \ \ \ \ \ \ \ starpu\_pause();}
\DoxyCodeLine{00470\ \ \ \ \ \}}
\DoxyCodeLine{00471\ \ \ \ \ \textcolor{keywordtype}{void}\ forEachOpenCLWorker(std::function<\textcolor{keywordtype}{void}(\textcolor{keywordtype}{void}*)>\ func)\{}
\DoxyCodeLine{00472\ \ \ \ \ \ \ \ \ starpu\_resume();}
\DoxyCodeLine{00473\ \ \ \ \ \ \ \ \ FStarPUUtils::ExecOnWorkers(STARPU\_OPENCL,\ [\&]()\{}
\DoxyCodeLine{00474\ \ \ \ \ \ \ \ \ \ \ \ \ func(openclWrapper.getKernel(starpu\_worker\_get\_id()));}
\DoxyCodeLine{00475\ \ \ \ \ \ \ \ \ \});}
\DoxyCodeLine{00476\ \ \ \ \ \ \ \ \ starpu\_pause();}
\DoxyCodeLine{00477\ \ \ \ \ \}}
\DoxyCodeLine{00478\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00479\ }
\DoxyCodeLine{00480\ \ \ \ \ \textcolor{keywordtype}{int}\ getRank(\textcolor{keywordtype}{void})\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00481\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ mpi\_rank;}
\DoxyCodeLine{00482\ \ \ \ \ \}}
\DoxyCodeLine{00483\ \ \ \ \ \textcolor{keywordtype}{int}\ getNProc(\textcolor{keywordtype}{void})\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00484\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ nproc;}
\DoxyCodeLine{00485\ \ \ \ \ \}}
\DoxyCodeLine{00486\ \ \ \ \ \textcolor{keywordtype}{bool}\ isDataOwnedBerenger(MortonIndex\ \textcolor{keyword}{const}\ idx,\ \textcolor{keywordtype}{int}\ \textcolor{keyword}{const}\ idxLevel)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00487\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ dataMappingBerenger(idx,\ idxLevel)\ ==\ mpi\_rank;}
\DoxyCodeLine{00488\ \ \ \ \ \}}
\DoxyCodeLine{00489\ \ \ \ \ \textcolor{keywordtype}{void}\ createMachinChose(std::vector<MortonIndex>\ distributedMortonIndex)\ \{}
\DoxyCodeLine{00490\ \ \ \ \ \ \ \ \ nodeRepartition.resize(tree-\/>getHeight(),\ std::vector<std::vector<MortonIndex>>(nproc,\ std::vector<MortonIndex>(2)));}
\DoxyCodeLine{00491\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ node\_id\ =\ 0;\ node\_id\ <\ nproc;\ ++node\_id)\{}
\DoxyCodeLine{00492\ \ \ \ \ \ \ \ \ \ \ \ \ nodeRepartition[tree-\/>getHeight()-\/1][node\_id][0]\ =\ distributedMortonIndex[node\_id*2];}
\DoxyCodeLine{00493\ \ \ \ \ \ \ \ \ \ \ \ \ nodeRepartition[tree-\/>getHeight()-\/1][node\_id][1]\ =\ distributedMortonIndex[node\_id*2+1];}
\DoxyCodeLine{00494\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00495\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ idxLevel\ =\ tree-\/>getHeight()\ -\/\ 2;\ idxLevel\ >=\ 0\ \ ;\ -\/-\/idxLevel)\{}
\DoxyCodeLine{00496\ \ \ \ \ \ \ \ \ \ \ \ \ nodeRepartition[idxLevel][0][0]\ =\ nodeRepartition[idxLevel+1][0][0]\ >>\ 3;}
\DoxyCodeLine{00497\ \ \ \ \ \ \ \ \ \ \ \ \ nodeRepartition[idxLevel][0][1]\ =\ nodeRepartition[idxLevel+1][0][1]\ >>\ 3;}
\DoxyCodeLine{00498\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ node\_id\ =\ 1;\ node\_id\ <\ nproc;\ ++node\_id)\{}
\DoxyCodeLine{00499\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ nodeRepartition[idxLevel][node\_id][0]\ =\ \mbox{\hyperlink{struct_f_math_ada359f2b021ce4b999c0fd7a6e9daae6}{FMath::Max}}(nodeRepartition[idxLevel+1][node\_id][0]\ >>\ 3,\ nodeRepartition[idxLevel][node\_id-\/1][0]+1);\ \textcolor{comment}{//Berenger\ phd\ :)}}
\DoxyCodeLine{00500\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ nodeRepartition[idxLevel][node\_id][1]\ =\ nodeRepartition[idxLevel+1][node\_id][1]\ >>\ 3;}
\DoxyCodeLine{00501\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00502\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00503\ \ \ \ \ \}}
\DoxyCodeLine{00504\ \ \ \ \ \textcolor{keywordtype}{int}\ getOppositeInterIndex(\textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ index)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00505\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ (((\ (xdiff+3)\ *\ 7)\ +\ (ydiff+3)))\ *\ 7\ +\ zdiff\ +\ 3}}
\DoxyCodeLine{00506\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ 343-\/index-\/1;}
\DoxyCodeLine{00507\ \ \ \ \ \}}
\DoxyCodeLine{00508\ \textcolor{keyword}{protected}:}
\DoxyCodeLine{00512\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_f_group_task_star_p_u_implicit_algorithm_a46b7936ac044e89b440dd501aed93871}{executeCore}}(\textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ operationsToProceed)\textcolor{keyword}{\ override\ }\{}
\DoxyCodeLine{00513\ \ \ \ \ \ \ \ \ FLOG(\ FLog::Controller\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)tStart\ FGroupTaskStarPUAlgorithm\(\backslash\)n"{}}\ );}
\DoxyCodeLine{00514\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{bool}\ directOnly\ =\ (tree-\/>getHeight()\ <=\ 2);}
\DoxyCodeLine{00515\ }
\DoxyCodeLine{00516\ \textcolor{preprocessor}{\#ifdef\ STARPU\_USE\_CPU}}
\DoxyCodeLine{00517\ \ \ \ \ \ \ \ \ FTIME\_TASKS(cpuWrapper.taskTimeRecorder.start());}
\DoxyCodeLine{00518\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00519\ \ \ \ \ \ \ \ \ starpu\_resume();}
\DoxyCodeLine{00520\ \ \ \ \ \ \ \ \ FLOG(\ \mbox{\hyperlink{class_f_tic}{FTic}}\ timerSoumission;\ );}
\DoxyCodeLine{00521\ }
\DoxyCodeLine{00522\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\ operationsToProceed\ \&\ FFmmP2P\ )\ \mbox{\hyperlink{class_f_group_task_star_p_u_implicit_algorithm_a9678bd9990abfcda33d670294d3f1b6c}{directPass}}();}
\DoxyCodeLine{00523\ }
\DoxyCodeLine{00524\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(operationsToProceed\ \&\ FFmmP2M\ \&\&\ !directOnly)\ \mbox{\hyperlink{class_f_group_task_star_p_u_implicit_algorithm_abb95c6fe9f716d92eedbdf0890a5a849}{bottomPass}}();}
\DoxyCodeLine{00525\ }
\DoxyCodeLine{00526\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(operationsToProceed\ \&\ FFmmM2M\ \&\&\ !directOnly)\ \mbox{\hyperlink{class_f_group_task_star_p_u_implicit_algorithm_aa546e6b9870f5f75a0b122c43c1338aa}{upwardPass}}();}
\DoxyCodeLine{00527\ }
\DoxyCodeLine{00528\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(operationsToProceed\ \&\ FFmmM2L\ \&\&\ !directOnly)\ \mbox{\hyperlink{class_f_group_task_star_p_u_implicit_algorithm_a29f5963406d404f73a36d38091647ed3}{transferPass}}(\mbox{\hyperlink{class_f_abstract_algorithm_ade49cb5ede82d078261e576a9d809dc2}{FAbstractAlgorithm::upperWorkingLevel}},\ \mbox{\hyperlink{class_f_abstract_algorithm_a694b8888186be58e38691ce08b177d46}{FAbstractAlgorithm::lowerWorkingLevel}}-\/1\ ,\ \textcolor{keyword}{true},\ \textcolor{keyword}{true});}
\DoxyCodeLine{00529\ }
\DoxyCodeLine{00530\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(operationsToProceed\ \&\ FFmmL2L\ \&\&\ !directOnly)\ \mbox{\hyperlink{class_f_group_task_star_p_u_implicit_algorithm_a44c6a6655a4038a2b3223795b2227c2f}{downardPass}}();}
\DoxyCodeLine{00531\ }
\DoxyCodeLine{00532\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(operationsToProceed\ \&\ FFmmM2L\ \&\&\ !directOnly)\ \mbox{\hyperlink{class_f_group_task_star_p_u_implicit_algorithm_a29f5963406d404f73a36d38091647ed3}{transferPass}}(\mbox{\hyperlink{class_f_abstract_algorithm_a694b8888186be58e38691ce08b177d46}{FAbstractAlgorithm::lowerWorkingLevel}}-\/1,\ \mbox{\hyperlink{class_f_abstract_algorithm_a694b8888186be58e38691ce08b177d46}{FAbstractAlgorithm::lowerWorkingLevel}},\ \textcolor{keyword}{true},\ \textcolor{keyword}{true});}
\DoxyCodeLine{00533\ }
\DoxyCodeLine{00534\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\ operationsToProceed\ \&\ FFmmL2P\ \&\&\ !directOnly)\ \mbox{\hyperlink{class_f_group_task_star_p_u_implicit_algorithm_a0d0498a1039d763e8360b9ef8bc27125}{mergePass}}();}
\DoxyCodeLine{00535\ \textcolor{preprocessor}{\#ifdef\ STARPU\_USE\_REDUX}}
\DoxyCodeLine{00536\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\ operationsToProceed\ \&\ FFmmL2P\ \&\&\ !directOnly)\ readParticle();}
\DoxyCodeLine{00537\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00538\ }
\DoxyCodeLine{00539\ \ \ \ \ \ \ \ \ FLOG(\ FLog::Controller\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)t\(\backslash\)t\ Submitting\ the\ tasks\ took\ "{}}\ <<\ timerSoumission.tacAndElapsed()\ <<\ \textcolor{stringliteral}{"{}s\(\backslash\)n"{}}\ );}
\DoxyCodeLine{00540\ }
\DoxyCodeLine{00541\ \ \ \ \ \ \ \ \ starpu\_task\_wait\_for\_all();}
\DoxyCodeLine{00542\ }
\DoxyCodeLine{00543\ \ \ \ \ \ \ \ \ FLOG(\ \mbox{\hyperlink{class_f_tic}{FTic}}\ timerSync;\ );}
\DoxyCodeLine{00544\ \ \ \ \ \ \ \ \ syncData();}
\DoxyCodeLine{00545\ \ \ \ \ \ \ \ \ FLOG(\ FLog::Controller\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)t\(\backslash\)t\ Moving\ data\ to\ the\ host\ took\ "{}}\ <<\ timerSync.tacAndElapsed()\ <<\ \textcolor{stringliteral}{"{}s\(\backslash\)n"{}}\ );}
\DoxyCodeLine{00546\ }
\DoxyCodeLine{00547\ \ \ \ \ \ \ \ \ starpu\_pause();}
\DoxyCodeLine{00548\ }
\DoxyCodeLine{00549\ \textcolor{preprocessor}{\#ifdef\ STARPU\_USE\_CPU}}
\DoxyCodeLine{00550\ \ \ \ \ \ \ \ \ FTIME\_TASKS(cpuWrapper.taskTimeRecorder.end());}
\DoxyCodeLine{00551\ \ \ \ \ \ \ \ \ FTIME\_TASKS(cpuWrapper.taskTimeRecorder.saveToDisk(\textcolor{stringliteral}{"{}/tmp/taskstime-\/FGroupTaskStarPUAlgorithm.txt"{}}));}
\DoxyCodeLine{00552\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00553\ \ \ \ \ \}}
\DoxyCodeLine{00554\ }
\DoxyCodeLine{00555\ }
\DoxyCodeLine{00556\ \ \ \ \ \textcolor{keywordtype}{void}\ initCodelet()\{}
\DoxyCodeLine{00557\ \ \ \ \ \ \ \ \ memset(\&p2m\_cl,\ 0,\ \textcolor{keyword}{sizeof}(p2m\_cl));}
\DoxyCodeLine{00558\ \textcolor{preprocessor}{\#ifdef\ STARPU\_USE\_CPU}}
\DoxyCodeLine{00559\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(originalCpuKernel-\/>supportP2M(FSTARPU\_CPU\_IDX))\{}
\DoxyCodeLine{00560\ \ \ \ \ \ \ \ \ \ \ \ \ p2m\_cl.cpu\_funcs[0]\ =\ StarPUCpuWrapperClass::bottomPassCallback;}
\DoxyCodeLine{00561\ \ \ \ \ \ \ \ \ \ \ \ \ p2m\_cl.where\ |=\ STARPU\_CPU;}
\DoxyCodeLine{00562\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00563\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00564\ \textcolor{preprocessor}{\#ifdef\ SCALFMM\_ENABLE\_CUDA\_KERNEL}}
\DoxyCodeLine{00565\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(originalCpuKernel-\/>supportP2M(FSTARPU\_CUDA\_IDX))\{}
\DoxyCodeLine{00566\ \ \ \ \ \ \ \ \ \ \ \ \ p2m\_cl.cuda\_funcs[0]\ =\ StarPUCudaWrapperClass::bottomPassCallback;}
\DoxyCodeLine{00567\ \ \ \ \ \ \ \ \ \ \ \ \ p2m\_cl.where\ |=\ STARPU\_CUDA;}
\DoxyCodeLine{00568\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00569\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00570\ \textcolor{preprocessor}{\#ifdef\ SCALFMM\_ENABLE\_OPENCL\_KERNEL}}
\DoxyCodeLine{00571\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(originalCpuKernel-\/>supportP2M(FSTARPU\_OPENCL\_IDX))\{}
\DoxyCodeLine{00572\ \ \ \ \ \ \ \ \ \ \ \ \ p2m\_cl.opencl\_funcs[0]\ =\ StarPUOpenClWrapperClass::bottomPassCallback;}
\DoxyCodeLine{00573\ \ \ \ \ \ \ \ \ \ \ \ \ p2m\_cl.where\ |=\ STARPU\_OPENCL;}
\DoxyCodeLine{00574\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00575\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00576\ \ \ \ \ \ \ \ \ p2m\_cl.nbuffers\ =\ 3;}
\DoxyCodeLine{00577\ \ \ \ \ \ \ \ \ p2m\_cl.modes[0]\ =\ STARPU\_R;}
\DoxyCodeLine{00578\ \ \ \ \ \ \ \ \ p2m\_cl.modes[1]\ =\ STARPU\_RW;}
\DoxyCodeLine{00579\ \ \ \ \ \ \ \ \ p2m\_cl.modes[2]\ =\ STARPU\_R;}
\DoxyCodeLine{00580\ \ \ \ \ \ \ \ \ p2m\_cl.name\ =\ \textcolor{stringliteral}{"{}p2m\_cl"{}};}
\DoxyCodeLine{00581\ }
\DoxyCodeLine{00582\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespace_f_mem_utils_a005b2bd1925d50a688606ed5877c5aec}{memset}}(\&m2m\_cl,\ 0,\ \textcolor{keyword}{sizeof}(m2m\_cl));}
\DoxyCodeLine{00583\ \textcolor{preprocessor}{\#ifdef\ STARPU\_USE\_CPU}}
\DoxyCodeLine{00584\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(originalCpuKernel-\/>supportM2M(FSTARPU\_CPU\_IDX))\{}
\DoxyCodeLine{00585\ \ \ \ \ \ \ \ \ \ \ \ \ m2m\_cl.cpu\_funcs[0]\ =\ StarPUCpuWrapperClass::upwardPassCallback;}
\DoxyCodeLine{00586\ \ \ \ \ \ \ \ \ \ \ \ \ m2m\_cl.where\ |=\ STARPU\_CPU;}
\DoxyCodeLine{00587\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00588\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00589\ \textcolor{preprocessor}{\#ifdef\ SCALFMM\_ENABLE\_CUDA\_KERNEL}}
\DoxyCodeLine{00590\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(originalCpuKernel-\/>supportM2M(FSTARPU\_CUDA\_IDX))\{}
\DoxyCodeLine{00591\ \ \ \ \ \ \ \ \ \ \ \ \ m2m\_cl.cuda\_funcs[0]\ =\ StarPUCudaWrapperClass::upwardPassCallback;}
\DoxyCodeLine{00592\ \ \ \ \ \ \ \ \ \ \ \ \ m2m\_cl.where\ |=\ STARPU\_CUDA;}
\DoxyCodeLine{00593\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00594\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00595\ \textcolor{preprocessor}{\#ifdef\ SCALFMM\_ENABLE\_OPENCL\_KERNEL}}
\DoxyCodeLine{00596\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(originalCpuKernel-\/>supportM2M(FSTARPU\_OPENCL\_IDX))\{}
\DoxyCodeLine{00597\ \ \ \ \ \ \ \ \ \ \ \ \ m2m\_cl.opencl\_funcs[0]\ =\ StarPUOpenClWrapperClass::upwardPassCallback;}
\DoxyCodeLine{00598\ \ \ \ \ \ \ \ \ \ \ \ \ m2m\_cl.where\ |=\ STARPU\_OPENCL;}
\DoxyCodeLine{00599\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00600\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00601\ \ \ \ \ \ \ \ \ m2m\_cl.nbuffers\ =\ 4;}
\DoxyCodeLine{00602\ \ \ \ \ \ \ \ \ m2m\_cl.dyn\_modes\ =\ (starpu\_data\_access\_mode*)malloc(m2m\_cl.nbuffers*\textcolor{keyword}{sizeof}(starpu\_data\_access\_mode));}
\DoxyCodeLine{00603\ \ \ \ \ \ \ \ \ m2m\_cl.dyn\_modes[0]\ =\ STARPU\_R;}
\DoxyCodeLine{00604\ \ \ \ \ \ \ \ \ m2m\_cl.dyn\_modes[1]\ =\ starpu\_data\_access\_mode(STARPU\_RW|STARPU\_COMMUTE\_IF\_SUPPORTED);}
\DoxyCodeLine{00605\ \ \ \ \ \ \ \ \ m2m\_cl.name\ =\ \textcolor{stringliteral}{"{}m2m\_cl"{}};}
\DoxyCodeLine{00606\ \ \ \ \ \ \ \ \ m2m\_cl.dyn\_modes[2]\ =\ STARPU\_R;}
\DoxyCodeLine{00607\ \ \ \ \ \ \ \ \ m2m\_cl.dyn\_modes[3]\ =\ STARPU\_R;}
\DoxyCodeLine{00608\ }
\DoxyCodeLine{00609\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespace_f_mem_utils_a005b2bd1925d50a688606ed5877c5aec}{memset}}(\&l2l\_cl,\ 0,\ \textcolor{keyword}{sizeof}(l2l\_cl));}
\DoxyCodeLine{00610\ \textcolor{preprocessor}{\#ifdef\ STARPU\_USE\_CPU}}
\DoxyCodeLine{00611\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(originalCpuKernel-\/>supportL2L(FSTARPU\_CPU\_IDX))\{}
\DoxyCodeLine{00612\ \ \ \ \ \ \ \ \ \ \ \ \ l2l\_cl.cpu\_funcs[0]\ =\ StarPUCpuWrapperClass::downardPassCallback;}
\DoxyCodeLine{00613\ \ \ \ \ \ \ \ \ \ \ \ \ l2l\_cl.where\ |=\ STARPU\_CPU;}
\DoxyCodeLine{00614\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00615\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00616\ \textcolor{preprocessor}{\#ifdef\ SCALFMM\_ENABLE\_CUDA\_KERNEL}}
\DoxyCodeLine{00617\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(originalCpuKernel-\/>supportL2L(FSTARPU\_CUDA\_IDX))\{}
\DoxyCodeLine{00618\ \ \ \ \ \ \ \ \ \ \ \ \ l2l\_cl.cuda\_funcs[0]\ =\ StarPUCudaWrapperClass::downardPassCallback;}
\DoxyCodeLine{00619\ \ \ \ \ \ \ \ \ \ \ \ \ l2l\_cl.where\ |=\ STARPU\_CUDA;}
\DoxyCodeLine{00620\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00621\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00622\ \textcolor{preprocessor}{\#ifdef\ SCALFMM\_ENABLE\_OPENCL\_KERNEL}}
\DoxyCodeLine{00623\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(originalCpuKernel-\/>supportL2L(FSTARPU\_OPENCL\_IDX))\{}
\DoxyCodeLine{00624\ \ \ \ \ \ \ \ \ \ \ \ \ l2l\_cl.opencl\_funcs[0]\ =\ StarPUOpenClWrapperClass::downardPassCallback;}
\DoxyCodeLine{00625\ \ \ \ \ \ \ \ \ \ \ \ \ l2l\_cl.where\ |=\ STARPU\_OPENCL;}
\DoxyCodeLine{00626\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00627\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00628\ \ \ \ \ \ \ \ \ l2l\_cl.nbuffers\ =\ 4;}
\DoxyCodeLine{00629\ \ \ \ \ \ \ \ \ l2l\_cl.dyn\_modes\ =\ (starpu\_data\_access\_mode*)malloc(l2l\_cl.nbuffers*\textcolor{keyword}{sizeof}(starpu\_data\_access\_mode));}
\DoxyCodeLine{00630\ \ \ \ \ \ \ \ \ l2l\_cl.dyn\_modes[0]\ =\ STARPU\_R;}
\DoxyCodeLine{00631\ \ \ \ \ \ \ \ \ l2l\_cl.dyn\_modes[1]\ =\ STARPU\_R;}
\DoxyCodeLine{00632\ \ \ \ \ \ \ \ \ l2l\_cl.name\ =\ \textcolor{stringliteral}{"{}l2l\_cl"{}};}
\DoxyCodeLine{00633\ \ \ \ \ \ \ \ \ l2l\_cl.dyn\_modes[2]\ =\ STARPU\_R;}
\DoxyCodeLine{00634\ \ \ \ \ \ \ \ \ l2l\_cl.dyn\_modes[3]\ =\ starpu\_data\_access\_mode(STARPU\_RW|STARPU\_COMMUTE\_IF\_SUPPORTED);}
\DoxyCodeLine{00635\ }
\DoxyCodeLine{00636\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespace_f_mem_utils_a005b2bd1925d50a688606ed5877c5aec}{memset}}(\&l2l\_cl\_nocommute,\ 0,\ \textcolor{keyword}{sizeof}(l2l\_cl\_nocommute));}
\DoxyCodeLine{00637\ \textcolor{preprocessor}{\#ifdef\ STARPU\_USE\_CPU}}
\DoxyCodeLine{00638\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(originalCpuKernel-\/>supportL2L(FSTARPU\_CPU\_IDX))\{}
\DoxyCodeLine{00639\ \ \ \ \ \ \ \ \ \ \ \ \ l2l\_cl\_nocommute.cpu\_funcs[0]\ =\ StarPUCpuWrapperClass::downardPassCallback;}
\DoxyCodeLine{00640\ \ \ \ \ \ \ \ \ \ \ \ \ l2l\_cl\_nocommute.where\ |=\ STARPU\_CPU;}
\DoxyCodeLine{00641\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00642\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00643\ \textcolor{preprocessor}{\#ifdef\ SCALFMM\_ENABLE\_CUDA\_KERNEL}}
\DoxyCodeLine{00644\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(originalCpuKernel-\/>supportL2L(FSTARPU\_CUDA\_IDX))\{}
\DoxyCodeLine{00645\ \ \ \ \ \ \ \ \ \ \ \ \ l2l\_cl\_nocommute.cuda\_funcs[0]\ =\ StarPUCudaWrapperClass::downardPassCallback;}
\DoxyCodeLine{00646\ \ \ \ \ \ \ \ \ \ \ \ \ l2l\_cl\_nocommute.where\ |=\ STARPU\_CUDA;}
\DoxyCodeLine{00647\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00648\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00649\ \textcolor{preprocessor}{\#ifdef\ SCALFMM\_ENABLE\_OPENCL\_KERNEL}}
\DoxyCodeLine{00650\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(originalCpuKernel-\/>supportL2L(FSTARPU\_OPENCL\_IDX))\{}
\DoxyCodeLine{00651\ \ \ \ \ \ \ \ \ \ \ \ \ l2l\_cl\_nocommute.opencl\_funcs[0]\ =\ StarPUOpenClWrapperClass::downardPassCallback;}
\DoxyCodeLine{00652\ \ \ \ \ \ \ \ \ \ \ \ \ l2l\_cl\_nocommute.where\ |=\ STARPU\_OPENCL;}
\DoxyCodeLine{00653\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00654\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00655\ \ \ \ \ \ \ \ \ l2l\_cl\_nocommute.nbuffers\ =\ 4;}
\DoxyCodeLine{00656\ \ \ \ \ \ \ \ \ l2l\_cl\_nocommute.dyn\_modes\ =\ (starpu\_data\_access\_mode*)malloc(l2l\_cl\_nocommute.nbuffers*\textcolor{keyword}{sizeof}(starpu\_data\_access\_mode));}
\DoxyCodeLine{00657\ \ \ \ \ \ \ \ \ l2l\_cl\_nocommute.dyn\_modes[0]\ =\ STARPU\_R;}
\DoxyCodeLine{00658\ \ \ \ \ \ \ \ \ l2l\_cl\_nocommute.dyn\_modes[1]\ =\ STARPU\_R;}
\DoxyCodeLine{00659\ \ \ \ \ \ \ \ \ l2l\_cl\_nocommute.name\ =\ \textcolor{stringliteral}{"{}l2l\_cl"{}};}
\DoxyCodeLine{00660\ \ \ \ \ \ \ \ \ l2l\_cl\_nocommute.dyn\_modes[2]\ =\ STARPU\_R;}
\DoxyCodeLine{00661\ \ \ \ \ \ \ \ \ l2l\_cl\_nocommute.dyn\_modes[3]\ =\ STARPU\_RW;}
\DoxyCodeLine{00662\ }
\DoxyCodeLine{00663\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespace_f_mem_utils_a005b2bd1925d50a688606ed5877c5aec}{memset}}(\&l2p\_cl,\ 0,\ \textcolor{keyword}{sizeof}(l2p\_cl));}
\DoxyCodeLine{00664\ \textcolor{preprocessor}{\#ifdef\ STARPU\_USE\_CPU}}
\DoxyCodeLine{00665\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(originalCpuKernel-\/>supportL2P(FSTARPU\_CPU\_IDX))\{}
\DoxyCodeLine{00666\ \ \ \ \ \ \ \ \ \ \ \ \ l2p\_cl.cpu\_funcs[0]\ =\ StarPUCpuWrapperClass::mergePassCallback;}
\DoxyCodeLine{00667\ \ \ \ \ \ \ \ \ \ \ \ \ l2p\_cl.where\ |=\ STARPU\_CPU;}
\DoxyCodeLine{00668\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00669\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00670\ \textcolor{preprocessor}{\#ifdef\ SCALFMM\_ENABLE\_CUDA\_KERNEL}}
\DoxyCodeLine{00671\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(originalCpuKernel-\/>supportL2P(FSTARPU\_CUDA\_IDX))\{}
\DoxyCodeLine{00672\ \ \ \ \ \ \ \ \ \ \ \ \ l2p\_cl.cuda\_funcs[0]\ =\ StarPUCudaWrapperClass::mergePassCallback;}
\DoxyCodeLine{00673\ \ \ \ \ \ \ \ \ \ \ \ \ l2p\_cl.where\ |=\ STARPU\_CUDA;}
\DoxyCodeLine{00674\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00675\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00676\ \textcolor{preprocessor}{\#ifdef\ SCALFMM\_ENABLE\_OPENCL\_KERNEL}}
\DoxyCodeLine{00677\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(originalCpuKernel-\/>supportL2P(FSTARPU\_OPENCL\_IDX))\{}
\DoxyCodeLine{00678\ \ \ \ \ \ \ \ \ \ \ \ \ l2p\_cl.opencl\_funcs[0]\ =\ StarPUOpenClWrapperClass::mergePassCallback;}
\DoxyCodeLine{00679\ \ \ \ \ \ \ \ \ \ \ \ \ l2p\_cl.where\ |=\ STARPU\_OPENCL;}
\DoxyCodeLine{00680\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00681\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00682\ \ \ \ \ \ \ \ \ l2p\_cl.nbuffers\ =\ 4;}
\DoxyCodeLine{00683\ \ \ \ \ \ \ \ \ l2p\_cl.modes[0]\ =\ STARPU\_R;}
\DoxyCodeLine{00684\ \ \ \ \ \ \ \ \ l2p\_cl.modes[1]\ =\ STARPU\_R;}
\DoxyCodeLine{00685\ \ \ \ \ \ \ \ \ l2p\_cl.modes[2]\ =\ STARPU\_R;}
\DoxyCodeLine{00686\ \textcolor{preprocessor}{\#ifdef\ STARPU\_USE\_REDUX}}
\DoxyCodeLine{00687\ \ \ \ \ \ \ \ \ l2p\_cl.modes[3]\ =\ STARPU\_REDUX;}
\DoxyCodeLine{00688\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{00689\ \ \ \ \ \ \ \ \ l2p\_cl.modes[3]\ =\ starpu\_data\_access\_mode(STARPU\_RW|STARPU\_COMMUTE\_IF\_SUPPORTED);}
\DoxyCodeLine{00690\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00691\ \ \ \ \ \ \ \ \ l2p\_cl.name\ =\ \textcolor{stringliteral}{"{}l2p\_cl"{}};}
\DoxyCodeLine{00692\ }
\DoxyCodeLine{00693\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespace_f_mem_utils_a005b2bd1925d50a688606ed5877c5aec}{memset}}(\&p2p\_cl\_in,\ 0,\ \textcolor{keyword}{sizeof}(p2p\_cl\_in));}
\DoxyCodeLine{00694\ \textcolor{preprocessor}{\#ifdef\ STARPU\_USE\_CPU}}
\DoxyCodeLine{00695\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(originalCpuKernel-\/>supportP2P(FSTARPU\_CPU\_IDX))\{}
\DoxyCodeLine{00696\ \ \ \ \ \ \ \ \ \ \ \ \ p2p\_cl\_in.cpu\_funcs[0]\ =\ StarPUCpuWrapperClass::directInPassCallback;}
\DoxyCodeLine{00697\ \ \ \ \ \ \ \ \ \ \ \ \ p2p\_cl\_in.where\ |=\ STARPU\_CPU;}
\DoxyCodeLine{00698\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00699\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00700\ \textcolor{preprocessor}{\#ifdef\ SCALFMM\_ENABLE\_CUDA\_KERNEL}}
\DoxyCodeLine{00701\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(originalCpuKernel-\/>supportP2P(FSTARPU\_CUDA\_IDX))\{}
\DoxyCodeLine{00702\ \ \ \ \ \ \ \ \ \ \ \ \ p2p\_cl\_in.cuda\_funcs[0]\ =\ StarPUCudaWrapperClass::directInPassCallback;}
\DoxyCodeLine{00703\ \ \ \ \ \ \ \ \ \ \ \ \ p2p\_cl\_in.where\ |=\ STARPU\_CUDA;}
\DoxyCodeLine{00704\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00705\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00706\ \textcolor{preprocessor}{\#ifdef\ SCALFMM\_ENABLE\_OPENCL\_KERNEL}}
\DoxyCodeLine{00707\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(originalCpuKernel-\/>supportP2P(FSTARPU\_OPENCL\_IDX))\{}
\DoxyCodeLine{00708\ \ \ \ \ \ \ \ \ \ \ \ \ p2p\_cl\_in.opencl\_funcs[0]\ =\ StarPUOpenClWrapperClass::directInPassCallback;}
\DoxyCodeLine{00709\ \ \ \ \ \ \ \ \ \ \ \ \ p2p\_cl\_in.where\ |=\ STARPU\_OPENCL;}
\DoxyCodeLine{00710\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00711\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00712\ \ \ \ \ \ \ \ \ p2p\_cl\_in.nbuffers\ =\ 2;}
\DoxyCodeLine{00713\ \ \ \ \ \ \ \ \ p2p\_cl\_in.modes[0]\ =\ STARPU\_R;}
\DoxyCodeLine{00714\ \textcolor{preprocessor}{\#ifdef\ STARPU\_USE\_REDUX}}
\DoxyCodeLine{00715\ \ \ \ \ \ \ \ \ p2p\_cl\_in.modes[1]\ =\ STARPU\_REDUX;}
\DoxyCodeLine{00716\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{00717\ \ \ \ \ \ \ \ \ p2p\_cl\_in.modes[1]\ =\ starpu\_data\_access\_mode(STARPU\_RW|STARPU\_COMMUTE\_IF\_SUPPORTED);}
\DoxyCodeLine{00718\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00719\ \ \ \ \ \ \ \ \ p2p\_cl\_in.name\ =\ \textcolor{stringliteral}{"{}p2p\_cl\_in"{}};}
\DoxyCodeLine{00720\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespace_f_mem_utils_a005b2bd1925d50a688606ed5877c5aec}{memset}}(\&p2p\_cl\_inout,\ 0,\ \textcolor{keyword}{sizeof}(p2p\_cl\_inout));}
\DoxyCodeLine{00721\ \textcolor{preprocessor}{\#ifdef\ STARPU\_USE\_CPU}}
\DoxyCodeLine{00722\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(originalCpuKernel-\/>supportP2PExtern(FSTARPU\_CPU\_IDX))\{}
\DoxyCodeLine{00723\ \ \ \ \ \ \ \ \ \ \ \ \ p2p\_cl\_inout.cpu\_funcs[0]\ =\ StarPUCpuWrapperClass::directInoutPassCallback;}
\DoxyCodeLine{00724\ \ \ \ \ \ \ \ \ \ \ \ \ p2p\_cl\_inout.where\ |=\ STARPU\_CPU;}
\DoxyCodeLine{00725\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00726\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00727\ \textcolor{preprocessor}{\#ifdef\ SCALFMM\_ENABLE\_CUDA\_KERNEL}}
\DoxyCodeLine{00728\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(originalCpuKernel-\/>supportP2PExtern(FSTARPU\_CUDA\_IDX))\{}
\DoxyCodeLine{00729\ \ \ \ \ \ \ \ \ \ \ \ \ p2p\_cl\_inout.cuda\_funcs[0]\ =\ StarPUCudaWrapperClass::directInoutPassCallback;}
\DoxyCodeLine{00730\ \ \ \ \ \ \ \ \ \ \ \ \ p2p\_cl\_inout.where\ |=\ STARPU\_CUDA;}
\DoxyCodeLine{00731\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00732\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00733\ \textcolor{preprocessor}{\#ifdef\ SCALFMM\_ENABLE\_OPENCL\_KERNEL}}
\DoxyCodeLine{00734\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(originalCpuKernel-\/>supportP2PExtern(FSTARPU\_OPENCL\_IDX))\{}
\DoxyCodeLine{00735\ \ \ \ \ \ \ \ \ \ \ \ \ p2p\_cl\_inout.opencl\_funcs[0]\ =\ StarPUOpenClWrapperClass::directInoutPassCallback;}
\DoxyCodeLine{00736\ \ \ \ \ \ \ \ \ \ \ \ \ p2p\_cl\_inout.where\ |=\ STARPU\_OPENCL;}
\DoxyCodeLine{00737\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00738\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00739\ \ \ \ \ \ \ \ \ p2p\_cl\_inout.nbuffers\ =\ 4;}
\DoxyCodeLine{00740\ \ \ \ \ \ \ \ \ p2p\_cl\_inout.modes[0]\ =\ STARPU\_R;}
\DoxyCodeLine{00741\ \textcolor{preprocessor}{\#ifdef\ STARPU\_USE\_REDUX}}
\DoxyCodeLine{00742\ \ \ \ \ \ \ \ \ p2p\_cl\_inout.modes[1]\ =\ STARPU\_REDUX;}
\DoxyCodeLine{00743\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{00744\ \ \ \ \ \ \ \ \ p2p\_cl\_inout.modes[1]\ =\ starpu\_data\_access\_mode(STARPU\_RW\ |\ STARPU\_COMMUTE\_IF\_SUPPORTED);}
\DoxyCodeLine{00745\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00746\ \ \ \ \ \ \ \ \ p2p\_cl\_inout.modes[2]\ =\ STARPU\_R;}
\DoxyCodeLine{00747\ \textcolor{preprocessor}{\#ifdef\ STARPU\_USE\_REDUX}}
\DoxyCodeLine{00748\ \ \ \ \ \ \ \ \ p2p\_cl\_inout.modes[3]\ =\ STARPU\_REDUX;}
\DoxyCodeLine{00749\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{00750\ \ \ \ \ \ \ \ \ p2p\_cl\_inout.modes[3]\ =\ starpu\_data\_access\_mode(STARPU\_RW\ |\ STARPU\_COMMUTE\_IF\_SUPPORTED);}
\DoxyCodeLine{00751\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00752\ \ \ \ \ \ \ \ \ p2p\_cl\_inout.name\ =\ \textcolor{stringliteral}{"{}p2p\_cl\_inout"{}};}
\DoxyCodeLine{00753\ }
\DoxyCodeLine{00754\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespace_f_mem_utils_a005b2bd1925d50a688606ed5877c5aec}{memset}}(\&m2l\_cl\_in,\ 0,\ \textcolor{keyword}{sizeof}(m2l\_cl\_in));}
\DoxyCodeLine{00755\ \textcolor{preprocessor}{\#ifdef\ STARPU\_USE\_CPU}}
\DoxyCodeLine{00756\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(originalCpuKernel-\/>supportM2L(FSTARPU\_CPU\_IDX))\{}
\DoxyCodeLine{00757\ \ \ \ \ \ \ \ \ \ \ \ \ m2l\_cl\_in.cpu\_funcs[0]\ =\ StarPUCpuWrapperClass::transferInPassCallback;}
\DoxyCodeLine{00758\ \ \ \ \ \ \ \ \ \ \ \ \ m2l\_cl\_in.where\ |=\ STARPU\_CPU;}
\DoxyCodeLine{00759\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00760\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00761\ \textcolor{preprocessor}{\#ifdef\ SCALFMM\_ENABLE\_CUDA\_KERNEL}}
\DoxyCodeLine{00762\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(originalCpuKernel-\/>supportM2L(FSTARPU\_CUDA\_IDX))\{}
\DoxyCodeLine{00763\ \ \ \ \ \ \ \ \ \ \ \ \ m2l\_cl\_in.cuda\_funcs[0]\ =\ StarPUCudaWrapperClass::transferInPassCallback;}
\DoxyCodeLine{00764\ \ \ \ \ \ \ \ \ \ \ \ \ m2l\_cl\_in.where\ |=\ STARPU\_CUDA;}
\DoxyCodeLine{00765\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00766\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00767\ \textcolor{preprocessor}{\#ifdef\ SCALFMM\_ENABLE\_OPENCL\_KERNEL}}
\DoxyCodeLine{00768\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(originalCpuKernel-\/>supportM2L(FSTARPU\_OPENCL\_IDX))\{}
\DoxyCodeLine{00769\ \ \ \ \ \ \ \ \ \ \ \ \ m2l\_cl\_in.opencl\_funcs[0]\ =\ StarPUOpenClWrapperClass::transferInPassCallback;}
\DoxyCodeLine{00770\ \ \ \ \ \ \ \ \ \ \ \ \ m2l\_cl\_in.where\ |=\ STARPU\_OPENCL;}
\DoxyCodeLine{00771\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00772\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00773\ \ \ \ \ \ \ \ \ m2l\_cl\_in.nbuffers\ =\ 3;}
\DoxyCodeLine{00774\ \ \ \ \ \ \ \ \ m2l\_cl\_in.modes[0]\ =\ STARPU\_R;}
\DoxyCodeLine{00775\ \ \ \ \ \ \ \ \ m2l\_cl\_in.modes[1]\ =\ STARPU\_R;}
\DoxyCodeLine{00776\ \ \ \ \ \ \ \ \ m2l\_cl\_in.modes[2]\ =\ starpu\_data\_access\_mode(STARPU\_RW|STARPU\_COMMUTE\_IF\_SUPPORTED);}
\DoxyCodeLine{00777\ \ \ \ \ \ \ \ \ m2l\_cl\_in.name\ =\ \textcolor{stringliteral}{"{}m2l\_cl\_in"{}};}
\DoxyCodeLine{00778\ }
\DoxyCodeLine{00779\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespace_f_mem_utils_a005b2bd1925d50a688606ed5877c5aec}{memset}}(\&m2l\_cl\_inout,\ 0,\ \textcolor{keyword}{sizeof}(m2l\_cl\_inout));}
\DoxyCodeLine{00780\ \textcolor{preprocessor}{\#ifdef\ STARPU\_USE\_CPU}}
\DoxyCodeLine{00781\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(originalCpuKernel-\/>supportM2LExtern(FSTARPU\_CPU\_IDX))\{}
\DoxyCodeLine{00782\ \ \ \ \ \ \ \ \ \ \ \ \ m2l\_cl\_inout.cpu\_funcs[0]\ =\ StarPUCpuWrapperClass::transferInoutPassCallback;}
\DoxyCodeLine{00783\ \ \ \ \ \ \ \ \ \ \ \ \ m2l\_cl\_inout.where\ |=\ STARPU\_CPU;}
\DoxyCodeLine{00784\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00785\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00786\ \textcolor{preprocessor}{\#ifdef\ SCALFMM\_ENABLE\_CUDA\_KERNEL}}
\DoxyCodeLine{00787\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(originalCpuKernel-\/>supportM2LExtern(FSTARPU\_CUDA\_IDX))\{}
\DoxyCodeLine{00788\ \ \ \ \ \ \ \ \ \ \ \ \ m2l\_cl\_inout.cuda\_funcs[0]\ =\ StarPUCudaWrapperClass::transferInoutPassCallback;}
\DoxyCodeLine{00789\ \ \ \ \ \ \ \ \ \ \ \ \ m2l\_cl\_inout.where\ |=\ STARPU\_CUDA;}
\DoxyCodeLine{00790\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00791\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00792\ \textcolor{preprocessor}{\#ifdef\ SCALFMM\_ENABLE\_OPENCL\_KERNEL}}
\DoxyCodeLine{00793\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(originalCpuKernel-\/>supportM2LExtern(FSTARPU\_OPENCL\_IDX))\{}
\DoxyCodeLine{00794\ \ \ \ \ \ \ \ \ \ \ \ \ m2l\_cl\_inout.opencl\_funcs[0]\ =\ StarPUOpenClWrapperClass::transferInoutPassCallback;}
\DoxyCodeLine{00795\ \ \ \ \ \ \ \ \ \ \ \ \ m2l\_cl\_inout.where\ |=\ STARPU\_OPENCL;}
\DoxyCodeLine{00796\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00797\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00798\ \ \ \ \ \ \ \ \ m2l\_cl\_inout.nbuffers\ =\ 4;}
\DoxyCodeLine{00799\ \ \ \ \ \ \ \ \ m2l\_cl\_inout.modes[0]\ =\ STARPU\_R;}
\DoxyCodeLine{00800\ \ \ \ \ \ \ \ \ m2l\_cl\_inout.modes[1]\ =\ starpu\_data\_access\_mode(STARPU\_RW|STARPU\_COMMUTE\_IF\_SUPPORTED);}
\DoxyCodeLine{00801\ \ \ \ \ \ \ \ \ m2l\_cl\_inout.modes[2]\ =\ STARPU\_R;}
\DoxyCodeLine{00802\ \ \ \ \ \ \ \ \ m2l\_cl\_inout.modes[3]\ =\ STARPU\_R;}
\DoxyCodeLine{00803\ \ \ \ \ \ \ \ \ m2l\_cl\_inout.name\ =\ \textcolor{stringliteral}{"{}m2l\_cl\_inout"{}};}
\DoxyCodeLine{00804\ }
\DoxyCodeLine{00805\ \textcolor{preprocessor}{\#ifdef\ STARPU\_USE\_REDUX}}
\DoxyCodeLine{00806\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespace_f_mem_utils_a005b2bd1925d50a688606ed5877c5aec}{memset}}(\&p2p\_redux\_init,\ 0,\ \textcolor{keyword}{sizeof}(p2p\_redux\_init));}
\DoxyCodeLine{00807\ \textcolor{preprocessor}{\#ifdef\ STARPU\_USE\_CPU}}
\DoxyCodeLine{00808\ \ \ \ \ \ \ \ \ p2p\_redux\_init.cpu\_funcs[0]\ =\ FStarPUReduxCpu::InitData<typename\ ParticleGroupClass::ParticleDataType>;}
\DoxyCodeLine{00809\ \ \ \ \ \ \ \ \ p2p\_redux\_init.where\ |=\ STARPU\_CPU;}
\DoxyCodeLine{00810\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00811\ \ \ \ \ \ \ \ \ p2p\_redux\_init.nbuffers\ =\ 1;}
\DoxyCodeLine{00812\ \ \ \ \ \ \ \ \ p2p\_redux\_init.modes[0]\ =\ STARPU\_RW;}
\DoxyCodeLine{00813\ \ \ \ \ \ \ \ \ p2p\_redux\_init.name\ =\ \textcolor{stringliteral}{"{}p2p\_redux\_init"{}};}
\DoxyCodeLine{00814\ }
\DoxyCodeLine{00815\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespace_f_mem_utils_a005b2bd1925d50a688606ed5877c5aec}{memset}}(\&p2p\_redux\_perform,\ 0,\ \textcolor{keyword}{sizeof}(p2p\_redux\_perform));}
\DoxyCodeLine{00816\ \textcolor{preprocessor}{\#ifdef\ STARPU\_USE\_CPU}}
\DoxyCodeLine{00817\ \ \ \ \ \ \ \ \ p2p\_redux\_perform.cpu\_funcs[0]\ =\ FStarPUReduxCpu::ReduceData<typename\ ParticleGroupClass::ParticleDataType>;}
\DoxyCodeLine{00818\ \ \ \ \ \ \ \ \ p2p\_redux\_perform.where\ |=\ STARPU\_CPU;}
\DoxyCodeLine{00819\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00820\ \ \ \ \ \ \ \ \ p2p\_redux\_perform.nbuffers\ =\ 2;}
\DoxyCodeLine{00821\ \ \ \ \ \ \ \ \ p2p\_redux\_perform.modes[0]\ =\ STARPU\_RW;}
\DoxyCodeLine{00822\ \ \ \ \ \ \ \ \ p2p\_redux\_perform.modes[1]\ =\ STARPU\_R;}
\DoxyCodeLine{00823\ \ \ \ \ \ \ \ \ p2p\_redux\_perform.name\ =\ \textcolor{stringliteral}{"{}p2p\_redux\_perform"{}};}
\DoxyCodeLine{00824\ }
\DoxyCodeLine{00825\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespace_f_mem_utils_a005b2bd1925d50a688606ed5877c5aec}{memset}}(\&p2p\_redux\_read,\ 0,\ \textcolor{keyword}{sizeof}(p2p\_redux\_read));}
\DoxyCodeLine{00826\ \textcolor{preprocessor}{\#ifdef\ STARPU\_USE\_CPU}}
\DoxyCodeLine{00827\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(originalCpuKernel-\/>supportL2P(FSTARPU\_CPU\_IDX))\{}
\DoxyCodeLine{00828\ \ \ \ \ \ \ \ \ \ \ \ \ p2p\_redux\_read.cpu\_funcs[0]\ =\ FStarPUReduxCpu::EmptyCodelet<typename\ ParticleGroupClass::ParticleDataType>;}
\DoxyCodeLine{00829\ \ \ \ \ \ \ \ \ \ \ \ \ p2p\_redux\_read.where\ |=\ STARPU\_CPU;}
\DoxyCodeLine{00830\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00831\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00832\ \textcolor{preprocessor}{\#ifdef\ SCALFMM\_ENABLE\_CUDA\_KERNEL}}
\DoxyCodeLine{00833\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(originalCpuKernel-\/>supportL2P(FSTARPU\_CUDA\_IDX))\{}
\DoxyCodeLine{00834\ \ \ \ \ \ \ \ \ \ \ \ \ p2p\_redux\_read.cuda\_funcs[0]\ =\ FStarPUReduxCpu::EmptyCodelet<typename\ ParticleGroupClass::ParticleDataType>;}
\DoxyCodeLine{00835\ \ \ \ \ \ \ \ \ \ \ \ \ p2p\_redux\_read.where\ |=\ STARPU\_CUDA;}
\DoxyCodeLine{00836\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00837\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00838\ \textcolor{preprocessor}{\#ifdef\ SCALFMM\_ENABLE\_OPENCL\_KERNEL}}
\DoxyCodeLine{00839\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(originalCpuKernel-\/>supportL2P(FSTARPU\_OPENCL\_IDX))\{}
\DoxyCodeLine{00840\ \ \ \ \ \ \ \ \ \ \ \ \ p2p\_redux\_read.opencl\_funcs[0]\ =\ FStarPUReduxCpu::EmptyCodelet<typename\ ParticleGroupClass::ParticleDataType>;}
\DoxyCodeLine{00841\ \ \ \ \ \ \ \ \ \ \ \ \ p2p\_redux\_read.where\ |=\ STARPU\_OPENCL;}
\DoxyCodeLine{00842\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00843\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00844\ \ \ \ \ \ \ \ \ p2p\_redux\_read.nbuffers\ =\ 1;}
\DoxyCodeLine{00845\ \ \ \ \ \ \ \ \ p2p\_redux\_read.modes[0]\ =\ STARPU\_R;}
\DoxyCodeLine{00846\ \ \ \ \ \ \ \ \ p2p\_redux\_read.name\ =\ \textcolor{stringliteral}{"{}p2p\_redux\_read"{}};}
\DoxyCodeLine{00847\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00848\ }
\DoxyCodeLine{00849\ \textcolor{preprocessor}{\#ifdef\ SCALFMM\_USE\_STARPU\_EXTRACT}}
\DoxyCodeLine{00850\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespace_f_mem_utils_a005b2bd1925d50a688606ed5877c5aec}{memset}}(\&p2p\_extract,\ 0,\ \textcolor{keyword}{sizeof}(p2p\_extract));}
\DoxyCodeLine{00851\ \ \ \ \ \ \ \ \ p2p\_extract.nbuffers\ =\ 2;}
\DoxyCodeLine{00852\ \ \ \ \ \ \ \ \ p2p\_extract.modes[0]\ =\ STARPU\_R;}
\DoxyCodeLine{00853\ \ \ \ \ \ \ \ \ p2p\_extract.modes[1]\ =\ STARPU\_RW;}
\DoxyCodeLine{00854\ \ \ \ \ \ \ \ \ p2p\_extract.name\ =\ \textcolor{stringliteral}{"{}p2p\_extract"{}};}
\DoxyCodeLine{00855\ \ \ \ \ \ \ \ \ p2p\_extract.cpu\_funcs[0]\ =\ ThisClass::ExtractP2P;}
\DoxyCodeLine{00856\ \ \ \ \ \ \ \ \ p2p\_extract.where\ |=\ STARPU\_CPU;}
\DoxyCodeLine{00857\ }
\DoxyCodeLine{00858\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespace_f_mem_utils_a005b2bd1925d50a688606ed5877c5aec}{memset}}(\&p2p\_insert,\ 0,\ \textcolor{keyword}{sizeof}(p2p\_insert));}
\DoxyCodeLine{00859\ \ \ \ \ \ \ \ \ p2p\_insert.nbuffers\ =\ 2;}
\DoxyCodeLine{00860\ \ \ \ \ \ \ \ \ p2p\_insert.modes[0]\ =\ STARPU\_R;}
\DoxyCodeLine{00861\ \ \ \ \ \ \ \ \ p2p\_insert.modes[1]\ =\ STARPU\_RW;}
\DoxyCodeLine{00862\ \ \ \ \ \ \ \ \ p2p\_insert.name\ =\ \textcolor{stringliteral}{"{}p2p\_insert"{}};}
\DoxyCodeLine{00863\ \ \ \ \ \ \ \ \ p2p\_insert.cpu\_funcs[0]\ =\ ThisClass::InsertP2P;}
\DoxyCodeLine{00864\ \ \ \ \ \ \ \ \ p2p\_insert.where\ |=\ STARPU\_CPU;}
\DoxyCodeLine{00865\ }
\DoxyCodeLine{00866\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespace_f_mem_utils_a005b2bd1925d50a688606ed5877c5aec}{memset}}(\&p2p\_insert\_bis,\ 0,\ \textcolor{keyword}{sizeof}(p2p\_insert\_bis));}
\DoxyCodeLine{00867\ \ \ \ \ \ \ \ \ p2p\_insert\_bis.nbuffers\ =\ 2;}
\DoxyCodeLine{00868\ \ \ \ \ \ \ \ \ p2p\_insert\_bis.modes[0]\ =\ STARPU\_R;}
\DoxyCodeLine{00869\ \ \ \ \ \ \ \ \ p2p\_insert\_bis.modes[1]\ =\ STARPU\_RW;}
\DoxyCodeLine{00870\ \ \ \ \ \ \ \ \ p2p\_insert\_bis.name\ =\ \textcolor{stringliteral}{"{}p2p\_insert\_bis"{}};}
\DoxyCodeLine{00871\ \ \ \ \ \ \ \ \ p2p\_insert\_bis.cpu\_funcs[0]\ =\ ThisClass::InsertP2PBis;}
\DoxyCodeLine{00872\ \ \ \ \ \ \ \ \ p2p\_insert\_bis.where\ |=\ STARPU\_CPU;}
\DoxyCodeLine{00873\ }
\DoxyCodeLine{00874\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespace_f_mem_utils_a005b2bd1925d50a688606ed5877c5aec}{memset}}(\&cell\_extract\_up,\ 0,\ \textcolor{keyword}{sizeof}(cell\_extract\_up));}
\DoxyCodeLine{00875\ \ \ \ \ \ \ \ \ cell\_extract\_up.nbuffers\ =\ 3;}
\DoxyCodeLine{00876\ \ \ \ \ \ \ \ \ cell\_extract\_up.modes[0]\ =\ STARPU\_R;}
\DoxyCodeLine{00877\ \ \ \ \ \ \ \ \ cell\_extract\_up.modes[1]\ =\ STARPU\_R;}
\DoxyCodeLine{00878\ \ \ \ \ \ \ \ \ cell\_extract\_up.modes[2]\ =\ STARPU\_RW;}
\DoxyCodeLine{00879\ \ \ \ \ \ \ \ \ cell\_extract\_up.name\ =\ \textcolor{stringliteral}{"{}cell\_extract\_up"{}};}
\DoxyCodeLine{00880\ \ \ \ \ \ \ \ \ cell\_extract\_up.cpu\_funcs[0]\ =\ ThisClass::ExtractCellUp;}
\DoxyCodeLine{00881\ \ \ \ \ \ \ \ \ cell\_extract\_up.where\ |=\ STARPU\_CPU;}
\DoxyCodeLine{00882\ }
\DoxyCodeLine{00883\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespace_f_mem_utils_a005b2bd1925d50a688606ed5877c5aec}{memset}}(\&cell\_insert\_up,\ 0,\ \textcolor{keyword}{sizeof}(cell\_insert\_up));}
\DoxyCodeLine{00884\ \ \ \ \ \ \ \ \ cell\_insert\_up.nbuffers\ =\ 3;}
\DoxyCodeLine{00885\ \ \ \ \ \ \ \ \ cell\_insert\_up.modes[0]\ =\ STARPU\_R;}
\DoxyCodeLine{00886\ \ \ \ \ \ \ \ \ cell\_insert\_up.modes[1]\ =\ STARPU\_RW;}
\DoxyCodeLine{00887\ \ \ \ \ \ \ \ \ cell\_insert\_up.modes[2]\ =\ STARPU\_RW;}
\DoxyCodeLine{00888\ \ \ \ \ \ \ \ \ cell\_insert\_up.name\ =\ \textcolor{stringliteral}{"{}cell\_insert\_up"{}};}
\DoxyCodeLine{00889\ \ \ \ \ \ \ \ \ cell\_insert\_up.cpu\_funcs[0]\ =\ ThisClass::InsertCellUp;}
\DoxyCodeLine{00890\ \ \ \ \ \ \ \ \ cell\_insert\_up.where\ |=\ STARPU\_CPU;}
\DoxyCodeLine{00891\ }
\DoxyCodeLine{00892\ }
\DoxyCodeLine{00893\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespace_f_mem_utils_a005b2bd1925d50a688606ed5877c5aec}{memset}}(\&cell\_insert\_up\_bis,\ 0,\ \textcolor{keyword}{sizeof}(cell\_insert\_up\_bis));}
\DoxyCodeLine{00894\ \ \ \ \ \ \ \ \ cell\_insert\_up\_bis.nbuffers\ =\ 3;}
\DoxyCodeLine{00895\ \ \ \ \ \ \ \ \ cell\_insert\_up\_bis.modes[0]\ =\ STARPU\_R;}
\DoxyCodeLine{00896\ \ \ \ \ \ \ \ \ cell\_insert\_up\_bis.modes[1]\ =\ STARPU\_RW;}
\DoxyCodeLine{00897\ \ \ \ \ \ \ \ \ cell\_insert\_up\_bis.modes[2]\ =\ STARPU\_RW;}
\DoxyCodeLine{00898\ \ \ \ \ \ \ \ \ cell\_insert\_up\_bis.name\ =\ \textcolor{stringliteral}{"{}cell\_insert\_up\_bis"{}};}
\DoxyCodeLine{00899\ \ \ \ \ \ \ \ \ cell\_insert\_up\_bis.cpu\_funcs[0]\ =\ ThisClass::InsertCellUpBis;}
\DoxyCodeLine{00900\ \ \ \ \ \ \ \ \ cell\_insert\_up\_bis.where\ |=\ STARPU\_CPU;}
\DoxyCodeLine{00901\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00902\ \ \ \ \ \}}
\DoxyCodeLine{00903\ }
\DoxyCodeLine{00904\ \textcolor{preprocessor}{\#ifdef\ SCALFMM\_USE\_STARPU\_EXTRACT}}
\DoxyCodeLine{00905\ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keywordtype}{void}\ InsertP2P(\textcolor{keywordtype}{void}\ *buffers[],\ \textcolor{keywordtype}{void}\ *cl\_arg)\{}
\DoxyCodeLine{00906\ \ \ \ \ \ \ \ \ ParticleGroupClass\ containers((\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}*)STARPU\_VECTOR\_GET\_PTR(buffers[1]),}
\DoxyCodeLine{00907\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_VECTOR\_GET\_NX(buffers[1]),}
\DoxyCodeLine{00908\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{nullptr});}
\DoxyCodeLine{00909\ }
\DoxyCodeLine{00910\ \ \ \ \ \ \ \ \ ParticleExtractedHandles*\ interactionBufferPtr;}
\DoxyCodeLine{00911\ \ \ \ \ \ \ \ \ starpu\_codelet\_unpack\_args(cl\_arg,\ \&interactionBufferPtr);}
\DoxyCodeLine{00912\ }
\DoxyCodeLine{00913\ \ \ \ \ \ \ \ \ containers.restoreData(interactionBufferPtr-\/>leavesToExtract,}
\DoxyCodeLine{00914\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}*)STARPU\_VECTOR\_GET\_PTR(buffers[0]),}
\DoxyCodeLine{00915\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_VECTOR\_GET\_NX(buffers[0]));}
\DoxyCodeLine{00916\ \ \ \ \ \}}
\DoxyCodeLine{00917\ }
\DoxyCodeLine{00918\ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keywordtype}{void}\ InsertP2PBis(\textcolor{keywordtype}{void}\ *buffers[],\ \textcolor{keywordtype}{void}\ *cl\_arg)\{}
\DoxyCodeLine{00919\ \ \ \ \ \ \ \ \ ParticleExtractedHandles*\ interactionBufferPtr;}
\DoxyCodeLine{00920\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}*\ dataPtr;}
\DoxyCodeLine{00921\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ datasize;}
\DoxyCodeLine{00922\ \ \ \ \ \ \ \ \ starpu\_codelet\_unpack\_args(cl\_arg,\ \&interactionBufferPtr,\ \&dataPtr,\ \&datasize);}
\DoxyCodeLine{00923\ }
\DoxyCodeLine{00924\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespace_f_mem_utils_afba06a533855d38cf96cddbec48f155a}{memcpy}}((\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}*)STARPU\_VECTOR\_GET\_PTR(buffers[1]),\ dataPtr,\ datasize);}
\DoxyCodeLine{00925\ }
\DoxyCodeLine{00926\ \ \ \ \ \ \ \ \ ParticleGroupClass\ containers((\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}*)STARPU\_VECTOR\_GET\_PTR(buffers[1]),}
\DoxyCodeLine{00927\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_VECTOR\_GET\_NX(buffers[1]),}
\DoxyCodeLine{00928\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{nullptr});}
\DoxyCodeLine{00929\ }
\DoxyCodeLine{00930\ }
\DoxyCodeLine{00931\ \ \ \ \ \ \ \ \ containers.restoreData(interactionBufferPtr-\/>leavesToExtract,}
\DoxyCodeLine{00932\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}*)STARPU\_VECTOR\_GET\_PTR(buffers[0]),}
\DoxyCodeLine{00933\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_VECTOR\_GET\_NX(buffers[0]));}
\DoxyCodeLine{00934\ \ \ \ \ \}}
\DoxyCodeLine{00935\ }
\DoxyCodeLine{00936\ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keywordtype}{void}\ ExtractP2P(\textcolor{keywordtype}{void}\ *buffers[],\ \textcolor{keywordtype}{void}\ *cl\_arg)\{}
\DoxyCodeLine{00937\ \ \ \ \ \ \ \ \ ParticleGroupClass\ containers((\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}*)STARPU\_VECTOR\_GET\_PTR(buffers[0]),}
\DoxyCodeLine{00938\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_VECTOR\_GET\_NX(buffers[0]),}
\DoxyCodeLine{00939\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{nullptr});}
\DoxyCodeLine{00940\ }
\DoxyCodeLine{00941\ \ \ \ \ \ \ \ \ ParticleExtractedHandles*\ interactionBufferPtr;}
\DoxyCodeLine{00942\ \ \ \ \ \ \ \ \ starpu\_codelet\_unpack\_args(cl\_arg,\ \&interactionBufferPtr);}
\DoxyCodeLine{00943\ }
\DoxyCodeLine{00944\ \ \ \ \ \ \ \ \ containers.extractData(interactionBufferPtr-\/>leavesToExtract,}
\DoxyCodeLine{00945\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}*)STARPU\_VECTOR\_GET\_PTR(buffers[1]),}
\DoxyCodeLine{00946\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_VECTOR\_GET\_NX(buffers[1]));}
\DoxyCodeLine{00947\ \ \ \ \ \}}
\DoxyCodeLine{00948\ }
\DoxyCodeLine{00949\ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keywordtype}{void}\ InsertCellUp(\textcolor{keywordtype}{void}\ *buffers[],\ \textcolor{keywordtype}{void}\ *cl\_arg)\{}
\DoxyCodeLine{00950\ \ \ \ \ \ \ \ \ CellContainerClass\ currentCells((\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}*)STARPU\_VECTOR\_GET\_PTR(buffers[1]),}
\DoxyCodeLine{00951\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_VECTOR\_GET\_NX(buffers[1]),}
\DoxyCodeLine{00952\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}*)STARPU\_VECTOR\_GET\_PTR(buffers[2]),}
\DoxyCodeLine{00953\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{nullptr});}
\DoxyCodeLine{00954\ }
\DoxyCodeLine{00955\ \ \ \ \ \ \ \ \ CellExtractedHandles*\ interactionBufferPtr;}
\DoxyCodeLine{00956\ \ \ \ \ \ \ \ \ starpu\_codelet\_unpack\_args(cl\_arg,\ \&interactionBufferPtr);}
\DoxyCodeLine{00957\ }
\DoxyCodeLine{00958\ \ \ \ \ \ \ \ \ currentCells.restoreDataUp(interactionBufferPtr-\/>cellsToExtract,}
\DoxyCodeLine{00959\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}*)STARPU\_VECTOR\_GET\_PTR(buffers[0]),}
\DoxyCodeLine{00960\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_VECTOR\_GET\_NX(buffers[0]));}
\DoxyCodeLine{00961\ \ \ \ \ \}}
\DoxyCodeLine{00962\ }
\DoxyCodeLine{00963\ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keywordtype}{void}\ InsertCellUpBis(\textcolor{keywordtype}{void}\ *buffers[],\ \textcolor{keywordtype}{void}\ *cl\_arg)\{}
\DoxyCodeLine{00964\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}*\ ptr1;}
\DoxyCodeLine{00965\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ size1;}
\DoxyCodeLine{00966\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}*\ ptr2;}
\DoxyCodeLine{00967\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ size2;}
\DoxyCodeLine{00968\ \ \ \ \ \ \ \ \ CellExtractedHandles*\ interactionBufferPtr;}
\DoxyCodeLine{00969\ \ \ \ \ \ \ \ \ starpu\_codelet\_unpack\_args(cl\_arg,\ \&interactionBufferPtr,\ \&ptr1,\ \&size1,\ \&ptr2,\ \&size2);}
\DoxyCodeLine{00970\ }
\DoxyCodeLine{00971\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespace_f_mem_utils_afba06a533855d38cf96cddbec48f155a}{memcpy}}((\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}*)STARPU\_VECTOR\_GET\_PTR(buffers[1]),\ ptr1,\ size1);}
\DoxyCodeLine{00972\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespace_f_mem_utils_afba06a533855d38cf96cddbec48f155a}{memcpy}}((\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}*)STARPU\_VECTOR\_GET\_PTR(buffers[2]),\ ptr2,\ size2);}
\DoxyCodeLine{00973\ }
\DoxyCodeLine{00974\ \ \ \ \ \ \ \ \ CellContainerClass\ currentCells((\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}*)STARPU\_VECTOR\_GET\_PTR(buffers[1]),}
\DoxyCodeLine{00975\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_VECTOR\_GET\_NX(buffers[1]),}
\DoxyCodeLine{00976\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}*)STARPU\_VECTOR\_GET\_PTR(buffers[2]),}
\DoxyCodeLine{00977\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{nullptr});}
\DoxyCodeLine{00978\ }
\DoxyCodeLine{00979\ }
\DoxyCodeLine{00980\ \ \ \ \ \ \ \ \ currentCells.restoreDataUp(interactionBufferPtr-\/>cellsToExtract,}
\DoxyCodeLine{00981\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}*)STARPU\_VECTOR\_GET\_PTR(buffers[0]),}
\DoxyCodeLine{00982\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_VECTOR\_GET\_NX(buffers[0]));}
\DoxyCodeLine{00983\ \ \ \ \ \}}
\DoxyCodeLine{00984\ }
\DoxyCodeLine{00985\ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keywordtype}{void}\ ExtractCellUp(\textcolor{keywordtype}{void}\ *buffers[],\ \textcolor{keywordtype}{void}\ *cl\_arg)\{}
\DoxyCodeLine{00986\ \ \ \ \ \ \ \ \ CellContainerClass\ currentCells((\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}*)STARPU\_VECTOR\_GET\_PTR(buffers[0]),}
\DoxyCodeLine{00987\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_VECTOR\_GET\_NX(buffers[0]),}
\DoxyCodeLine{00988\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}*)STARPU\_VECTOR\_GET\_PTR(buffers[1]),}
\DoxyCodeLine{00989\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{nullptr});}
\DoxyCodeLine{00990\ }
\DoxyCodeLine{00991\ \ \ \ \ \ \ \ \ CellExtractedHandles*\ interactionBufferPtr;}
\DoxyCodeLine{00992\ \ \ \ \ \ \ \ \ starpu\_codelet\_unpack\_args(cl\_arg,\ \&interactionBufferPtr);}
\DoxyCodeLine{00993\ }
\DoxyCodeLine{00994\ \ \ \ \ \ \ \ \ currentCells.extractDataUp(interactionBufferPtr-\/>cellsToExtract,}
\DoxyCodeLine{00995\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}*)STARPU\_VECTOR\_GET\_PTR(buffers[2]),}
\DoxyCodeLine{00996\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_VECTOR\_GET\_NX(buffers[2]));}
\DoxyCodeLine{00997\ \ \ \ \ \}}
\DoxyCodeLine{00998\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00999\ }
\DoxyCodeLine{01000\ \ \ \ \ \textcolor{keywordtype}{void}\ initCodeletMpi()\{}
\DoxyCodeLine{01001\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespace_f_mem_utils_a005b2bd1925d50a688606ed5877c5aec}{memset}}(\&p2p\_cl\_inout\_mpi,\ 0,\ \textcolor{keyword}{sizeof}(p2p\_cl\_inout\_mpi));}
\DoxyCodeLine{01002\ \textcolor{preprocessor}{\#ifdef\ STARPU\_USE\_CPU}}
\DoxyCodeLine{01003\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(originalCpuKernel-\/>supportP2PMpi(FSTARPU\_CPU\_IDX))\{}
\DoxyCodeLine{01004\ \ \ \ \ \ \ \ \ \ \ \ \ p2p\_cl\_inout\_mpi.where\ |=\ STARPU\_CPU;}
\DoxyCodeLine{01005\ \ \ \ \ \ \ \ \ \ \ \ \ p2p\_cl\_inout\_mpi.cpu\_funcs[0]\ =\ StarPUCpuWrapperClass::directInoutPassCallbackMpi;}
\DoxyCodeLine{01006\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01007\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{01008\ \textcolor{preprocessor}{\#ifdef\ SCALFMM\_ENABLE\_CUDA\_KERNEL}}
\DoxyCodeLine{01009\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(originalCpuKernel-\/>supportP2PMpi(FSTARPU\_CUDA\_IDX))\{}
\DoxyCodeLine{01010\ \ \ \ \ \ \ \ \ \ \ \ \ p2p\_cl\_inout\_mpi.where\ |=\ STARPU\_CUDA;}
\DoxyCodeLine{01011\ \ \ \ \ \ \ \ \ \ \ \ \ p2p\_cl\_inout\_mpi.cuda\_funcs[0]\ =\ StarPUCudaWrapperClass::directInoutPassCallbackMpi;}
\DoxyCodeLine{01012\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01013\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{01014\ \textcolor{preprocessor}{\#ifdef\ SCALFMM\_ENABLE\_OPENCL\_KERNEL}}
\DoxyCodeLine{01015\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(originalCpuKernel-\/>supportP2PMpi(FSTARPU\_OPENCL\_IDX))\{}
\DoxyCodeLine{01016\ \ \ \ \ \ \ \ \ \ \ \ \ p2p\_cl\_inout\_mpi.where\ |=\ STARPU\_OPENCL;}
\DoxyCodeLine{01017\ \ \ \ \ \ \ \ \ \ \ \ \ p2p\_cl\_inout\_mpi.opencl\_funcs[0]\ =\ StarPUOpenClWrapperClass::directInoutPassCallbackMpi;}
\DoxyCodeLine{01018\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01019\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{01020\ \ \ \ \ \ \ \ \ p2p\_cl\_inout\_mpi.nbuffers\ =\ 3;}
\DoxyCodeLine{01021\ \ \ \ \ \ \ \ \ p2p\_cl\_inout\_mpi.modes[0]\ =\ STARPU\_R;}
\DoxyCodeLine{01022\ \ \ \ \ \ \ \ \ p2p\_cl\_inout\_mpi.modes[1]\ =\ starpu\_data\_access\_mode(STARPU\_RW|STARPU\_COMMUTE\_IF\_SUPPORTED);}
\DoxyCodeLine{01023\ \ \ \ \ \ \ \ \ p2p\_cl\_inout\_mpi.modes[2]\ =\ STARPU\_R;}
\DoxyCodeLine{01024\ \ \ \ \ \ \ \ \ p2p\_cl\_inout\_mpi.name\ =\ \textcolor{stringliteral}{"{}p2p\_cl\_inout\_mpi"{}};}
\DoxyCodeLine{01025\ }
\DoxyCodeLine{01026\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespace_f_mem_utils_a005b2bd1925d50a688606ed5877c5aec}{memset}}(\&m2l\_cl\_inout\_mpi,\ 0,\ \textcolor{keyword}{sizeof}(m2l\_cl\_inout\_mpi));}
\DoxyCodeLine{01027\ \textcolor{preprocessor}{\#ifdef\ STARPU\_USE\_CPU}}
\DoxyCodeLine{01028\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(originalCpuKernel-\/>supportM2LMpi(FSTARPU\_CPU\_IDX))\{}
\DoxyCodeLine{01029\ \ \ \ \ \ \ \ \ \ \ \ \ m2l\_cl\_inout\_mpi.where\ |=\ STARPU\_CPU;}
\DoxyCodeLine{01030\ \ \ \ \ \ \ \ \ \ \ \ \ m2l\_cl\_inout\_mpi.cpu\_funcs[0]\ =\ StarPUCpuWrapperClass::transferInoutPassCallbackMpi;}
\DoxyCodeLine{01031\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01032\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{01033\ \textcolor{preprocessor}{\#ifdef\ SCALFMM\_ENABLE\_CUDA\_KERNEL}}
\DoxyCodeLine{01034\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(originalCpuKernel-\/>supportM2LMpi(FSTARPU\_CUDA\_IDX))\{}
\DoxyCodeLine{01035\ \ \ \ \ \ \ \ \ \ \ \ \ m2l\_cl\_inout\_mpi.where\ |=\ STARPU\_CUDA;}
\DoxyCodeLine{01036\ \ \ \ \ \ \ \ \ \ \ \ \ m2l\_cl\_inout\_mpi.cuda\_funcs[0]\ =\ StarPUCudaWrapperClass::transferInoutPassCallbackMpi;}
\DoxyCodeLine{01037\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01038\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{01039\ \textcolor{preprocessor}{\#ifdef\ SCALFMM\_ENABLE\_OPENCL\_KERNEL}}
\DoxyCodeLine{01040\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(originalCpuKernel-\/>supportM2LMpi(FSTARPU\_OPENCL\_IDX))\{}
\DoxyCodeLine{01041\ \ \ \ \ \ \ \ \ \ \ \ \ m2l\_cl\_inout\_mpi.where\ |=\ STARPU\_OPENCL;}
\DoxyCodeLine{01042\ \ \ \ \ \ \ \ \ \ \ \ \ m2l\_cl\_inout\_mpi.opencl\_funcs[0]\ =\ StarPUOpenClWrapperClass::transferInoutPassCallbackMpi;}
\DoxyCodeLine{01043\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01044\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{01045\ \ \ \ \ \ \ \ \ m2l\_cl\_inout\_mpi.nbuffers\ =\ 4;}
\DoxyCodeLine{01046\ \ \ \ \ \ \ \ \ m2l\_cl\_inout\_mpi.modes[0]\ =\ STARPU\_R;}
\DoxyCodeLine{01047\ \ \ \ \ \ \ \ \ m2l\_cl\_inout\_mpi.modes[1]\ =\ starpu\_data\_access\_mode(STARPU\_RW|STARPU\_COMMUTE\_IF\_SUPPORTED);}
\DoxyCodeLine{01048\ \ \ \ \ \ \ \ \ m2l\_cl\_inout\_mpi.modes[2]\ =\ STARPU\_R;}
\DoxyCodeLine{01049\ \ \ \ \ \ \ \ \ m2l\_cl\_inout\_mpi.modes[3]\ =\ STARPU\_R;}
\DoxyCodeLine{01050\ \ \ \ \ \ \ \ \ m2l\_cl\_inout\_mpi.name\ =\ \textcolor{stringliteral}{"{}m2l\_cl\_inout\_mpi"{}};}
\DoxyCodeLine{01051\ \ \ \ \ \}}
\DoxyCodeLine{01052\ }
\DoxyCodeLine{01054\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_f_group_task_star_p_u_implicit_algorithm_a224aa23fa3665a05ca679b926128806e}{cleanHandle}}()\{}
\DoxyCodeLine{01055\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ idxLevel\ =\ 0\ ;\ idxLevel\ <\ tree-\/>getHeight()\ ;\ ++idxLevel)\{}
\DoxyCodeLine{01056\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ idxHandle\ =\ 0\ ;\ idxHandle\ <\ int(cellHandles[idxLevel].size())\ ;\ ++idxHandle)\{}
\DoxyCodeLine{01057\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(isDataOwnedBerenger(tree-\/>getCellGroup(idxLevel,\ idxHandle)-\/>getStartingIndex(),\ idxLevel))\textcolor{comment}{//Clean\ only\ our\ data\ handle}}
\DoxyCodeLine{01058\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01059\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ starpu\_data\_unregister(cellHandles[idxLevel][idxHandle].symb);}
\DoxyCodeLine{01060\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ starpu\_data\_unregister(cellHandles[idxLevel][idxHandle].up);}
\DoxyCodeLine{01061\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ starpu\_data\_unregister(cellHandles[idxLevel][idxHandle].down);}
\DoxyCodeLine{01062\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01063\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01064\ \ \ \ \ \ \ \ \ \ \ \ \ cellHandles[idxLevel].clear();}
\DoxyCodeLine{01065\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01066\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01067\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ idxHandle\ =\ 0\ ;\ idxHandle\ <\ int(particleHandles.size())\ ;\ ++idxHandle)\{}
\DoxyCodeLine{01068\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(isDataOwnedBerenger(tree-\/>getCellGroup(tree-\/>getHeight()-\/1,\ idxHandle)-\/>getStartingIndex(),\ tree-\/>getHeight()-\/1))\textcolor{comment}{//Clean\ only\ our\ data\ handle}}
\DoxyCodeLine{01069\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01070\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ starpu\_data\_unregister(particleHandles[idxHandle].symb);}
\DoxyCodeLine{01071\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ starpu\_data\_unregister(particleHandles[idxHandle].down);}
\DoxyCodeLine{01072\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01073\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01074\ \ \ \ \ \ \ \ \ \ \ \ \ particleHandles.clear();}
\DoxyCodeLine{01075\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01076\ \textcolor{preprocessor}{\#ifdef\ SCALFMM\_USE\_STARPU\_EXTRACT}}
\DoxyCodeLine{01077\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keyword}{auto}\&\ iter\ :\ extractedParticlesBuffer)\{}
\DoxyCodeLine{01078\ \ \ \ \ \ \ \ \ \ \ \ \ starpu\_data\_unregister(iter.symb);}
\DoxyCodeLine{01079\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01080\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keyword}{auto}\&\ iter\ :\ duplicatedParticlesBuffer)\{}
\DoxyCodeLine{01081\ \ \ \ \ \ \ \ \ \ \ \ \ starpu\_data\_unregister(iter.symb);}
\DoxyCodeLine{01082\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01083\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keyword}{auto}\&\ iter\ :\ extractedCellBuffer)\{}
\DoxyCodeLine{01084\ \ \ \ \ \ \ \ \ \ \ \ \ starpu\_data\_unregister(iter.all);}
\DoxyCodeLine{01085\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01086\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keyword}{auto}\&\ iter\ :\ duplicatedCellBuffer)\{}
\DoxyCodeLine{01087\ \ \ \ \ \ \ \ \ \ \ \ \ starpu\_data\_unregister(iter.symb);}
\DoxyCodeLine{01088\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01089\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{01090\ \ \ \ \ \}}
\DoxyCodeLine{01091\ }
\DoxyCodeLine{01095\ \ \ \ \ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{class_f_group_task_star_p_u_implicit_algorithm_ae65a567a38fa5bc2b878cdb06aff7a47}{tag}};}
\DoxyCodeLine{01096\ \ \ \ \ \textcolor{keywordtype}{void}\ buildHandles()\{}
\DoxyCodeLine{01097\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_f_group_task_star_p_u_implicit_algorithm_a224aa23fa3665a05ca679b926128806e}{cleanHandle}}();}
\DoxyCodeLine{01098\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_f_group_task_star_p_u_implicit_algorithm_ae65a567a38fa5bc2b878cdb06aff7a47}{tag}}\ =\ 0;}
\DoxyCodeLine{01099\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ where;}
\DoxyCodeLine{01100\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ idxLevel\ =\ 2\ ;\ idxLevel\ <\ tree-\/>getHeight()\ ;\ ++idxLevel)\{}
\DoxyCodeLine{01101\ \ \ \ \ \ \ \ \ \ \ \ \ cellHandles[idxLevel].resize(tree-\/>getNbCellGroupAtLevel(idxLevel));}
\DoxyCodeLine{01102\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ idxGroup\ =\ 0\ ;\ idxGroup\ <\ tree-\/>getNbCellGroupAtLevel(idxLevel)\ ;\ ++idxGroup)\{}
\DoxyCodeLine{01103\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ CellContainerClass*\ currentCells\ =\ tree-\/>getCellGroup(idxLevel,\ idxGroup);}
\DoxyCodeLine{01104\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ registeringNode\ =\ dataMappingBerenger(currentCells-\/>getStartingIndex(),\ idxLevel);}
\DoxyCodeLine{01105\ }
\DoxyCodeLine{01106\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ where\ =\ (registeringNode\ ==\ mpi\_rank)\ ?\ STARPU\_MAIN\_RAM\ :\ -\/1;}
\DoxyCodeLine{01107\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ starpu\_variable\_data\_register(\&cellHandles[idxLevel][idxGroup].symb,\ where,}
\DoxyCodeLine{01108\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (uintptr\_t)currentCells-\/>getRawBuffer(),\ currentCells-\/>getBufferSizeInByte());}
\DoxyCodeLine{01109\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ starpu\_variable\_data\_register(\&cellHandles[idxLevel][idxGroup].up,\ where,}
\DoxyCodeLine{01110\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (uintptr\_t)currentCells-\/>getRawMultipoleBuffer(),\ currentCells-\/>getMultipoleBufferSizeInByte());}
\DoxyCodeLine{01111\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ starpu\_variable\_data\_register(\&cellHandles[idxLevel][idxGroup].down,\ where,}
\DoxyCodeLine{01112\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (uintptr\_t)currentCells-\/>getRawLocalBuffer(),\ currentCells-\/>getLocalBufferSizeInByte());}
\DoxyCodeLine{01113\ }
\DoxyCodeLine{01114\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ starpu\_mpi\_data\_register(cellHandles[idxLevel][idxGroup].symb,\ \mbox{\hyperlink{class_f_group_task_star_p_u_implicit_algorithm_ae65a567a38fa5bc2b878cdb06aff7a47}{tag}}++,\ registeringNode);}
\DoxyCodeLine{01115\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ starpu\_mpi\_data\_register(cellHandles[idxLevel][idxGroup].up,\ \mbox{\hyperlink{class_f_group_task_star_p_u_implicit_algorithm_ae65a567a38fa5bc2b878cdb06aff7a47}{tag}}++,\ registeringNode);}
\DoxyCodeLine{01116\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ starpu\_mpi\_data\_register(cellHandles[idxLevel][idxGroup].down,\ \mbox{\hyperlink{class_f_group_task_star_p_u_implicit_algorithm_ae65a567a38fa5bc2b878cdb06aff7a47}{tag}}++,\ registeringNode);}
\DoxyCodeLine{01117\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ cellHandles[idxLevel][idxGroup].intervalSize\ =\ int(currentCells-\/>getNumberOfCellsInBlock());}
\DoxyCodeLine{01118\ \textcolor{preprocessor}{\#ifdef\ STARPU\_SUPPORT\_ARBITER}}
\DoxyCodeLine{01119\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ starpu\_data\_assign\_arbiter(cellHandles[idxLevel][idxGroup].up,\ arbiterGlobal);}
\DoxyCodeLine{01120\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ starpu\_data\_assign\_arbiter(cellHandles[idxLevel][idxGroup].down,\ arbiterGlobal);}
\DoxyCodeLine{01121\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{01122\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01123\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01124\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01125\ \ \ \ \ \ \ \ \ \ \ \ \ particleHandles.resize(tree-\/>getNbParticleGroup());}
\DoxyCodeLine{01126\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ idxGroup\ =\ 0\ ;\ idxGroup\ <\ tree-\/>getNbParticleGroup()\ ;\ ++idxGroup)\{}
\DoxyCodeLine{01127\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ registeringNode\ =\ dataMappingBerenger(tree-\/>getCellGroup(tree-\/>getHeight()-\/1,\ idxGroup)-\/>getStartingIndex(),\ tree-\/>getHeight()-\/1);}
\DoxyCodeLine{01128\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ where\ =\ (registeringNode\ ==\ mpi\_rank)\ ?\ STARPU\_MAIN\_RAM\ :\ -\/1;}
\DoxyCodeLine{01129\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ParticleGroupClass*\ containers\ =\ tree-\/>getParticleGroup(idxGroup);}
\DoxyCodeLine{01130\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ starpu\_variable\_data\_register(\&particleHandles[idxGroup].symb,\ where,}
\DoxyCodeLine{01131\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (uintptr\_t)containers-\/>getRawBuffer(),\ containers-\/>getBufferSizeInByte());}
\DoxyCodeLine{01132\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ starpu\_variable\_data\_register(\&particleHandles[idxGroup].down,\ where,}
\DoxyCodeLine{01133\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (uintptr\_t)containers-\/>getRawAttributesBuffer(),\ containers-\/>getAttributesBufferSizeInByte());}
\DoxyCodeLine{01134\ }
\DoxyCodeLine{01135\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ starpu\_mpi\_data\_register(particleHandles[idxGroup].symb,\ \mbox{\hyperlink{class_f_group_task_star_p_u_implicit_algorithm_ae65a567a38fa5bc2b878cdb06aff7a47}{tag}}++,\ registeringNode);}
\DoxyCodeLine{01136\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ starpu\_mpi\_data\_register(particleHandles[idxGroup].down,\ \mbox{\hyperlink{class_f_group_task_star_p_u_implicit_algorithm_ae65a567a38fa5bc2b878cdb06aff7a47}{tag}}++,\ registeringNode);}
\DoxyCodeLine{01137\ \textcolor{preprocessor}{\#ifdef\ STARPU\_USE\_REDUX}}
\DoxyCodeLine{01138\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ starpu\_data\_set\_reduction\_methods(particleHandles[idxGroup].down,\ \&p2p\_redux\_perform,}
\DoxyCodeLine{01139\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \&p2p\_redux\_init);}
\DoxyCodeLine{01140\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{01141\ \textcolor{preprocessor}{\#ifdef\ STARPU\_SUPPORT\_ARBITER}}
\DoxyCodeLine{01142\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ starpu\_data\_assign\_arbiter(particleHandles[idxGroup].down,\ arbiterGlobal);}
\DoxyCodeLine{01143\ \textcolor{preprocessor}{\#endif\ }\textcolor{comment}{//\ STARPU\_SUPPORT\_ARBITER}}
\DoxyCodeLine{01144\ \textcolor{preprocessor}{\#endif\ }\textcolor{comment}{//\ STARPU\_USE\_REDUX}}
\DoxyCodeLine{01145\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ particleHandles[idxGroup].intervalSize\ =\ int(containers-\/>getNumberOfLeavesInBlock());}
\DoxyCodeLine{01146\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01147\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01148\ \ \ \ \ \}}
\DoxyCodeLine{01149\ \ \ \ \ \textcolor{keywordtype}{int}\ dataMappingBerenger(MortonIndex\ \textcolor{keyword}{const}\ idx,\ \textcolor{keywordtype}{int}\ \textcolor{keyword}{const}\ idxLevel)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{01150\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ nproc;\ ++i)}
\DoxyCodeLine{01151\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(nodeRepartition[idxLevel][i][0]\ <=\ nodeRepartition[idxLevel][i][1]\ \&\&\ idx\ >=\ nodeRepartition[idxLevel][i][0]\ \&\&\ idx\ <=\ nodeRepartition[idxLevel][i][1])}
\DoxyCodeLine{01152\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ i;}
\DoxyCodeLine{01153\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(mpi\_rank\ ==\ 0)}
\DoxyCodeLine{01154\ \ \ \ \ \ \ \ \ \ \ \ \ cout\ <<\ \textcolor{stringliteral}{"{}[scalfmm][map\ error]\ idx\ "{}}\ <<\ idx\ <<\ \textcolor{stringliteral}{"{}\ on\ level\ "{}}\ <<\ idxLevel\ <<\ \textcolor{stringliteral}{"{}\ isn't\ mapped\ on\ any\ proccess.\ (Default\ set\ to\ 0)."{}}\ <<\ endl;}
\DoxyCodeLine{01155\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ nproc-\/1;}
\DoxyCodeLine{01156\ \ \ \ \ \}}
\DoxyCodeLine{01163\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_f_group_task_star_p_u_implicit_algorithm_a2aee22c84ad5b40475f9abeae14b94d7}{buildExternalInteractionVecs}}()\{}
\DoxyCodeLine{01164\ \ \ \ \ \ \ \ \ FLOG(\ \mbox{\hyperlink{class_f_tic}{FTic}}\ timer;\ \mbox{\hyperlink{class_f_tic}{FTic}}\ leafTimer;\ \mbox{\hyperlink{class_f_tic}{FTic}}\ cellTimer;\ );}
\DoxyCodeLine{01165\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Reset\ interactions}}
\DoxyCodeLine{01166\ \ \ \ \ \ \ \ \ externalInteractionsAllLevel.clear();}
\DoxyCodeLine{01167\ \textcolor{preprocessor}{\#ifdef\ SCALFMM\_USE\_STARPU\_EXTRACT}}
\DoxyCodeLine{01168\ \ \ \ \ \ \ \ \ externalInteractionsAllLevelInnerIndexes.clear();}
\DoxyCodeLine{01169\ \ \ \ \ \ \ \ \ externalInteractionsAllLevelOuterIndexes.clear();}
\DoxyCodeLine{01170\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{01171\ \ \ \ \ \ \ \ \ externalInteractionsLeafLevel.clear();}
\DoxyCodeLine{01172\ \textcolor{preprocessor}{\#ifdef\ SCALFMM\_USE\_STARPU\_EXTRACT}}
\DoxyCodeLine{01173\ \ \ \ \ \ \ \ \ externalInteractionsLeafLevelOuter.clear();}
\DoxyCodeLine{01174\ \ \ \ \ \ \ \ \ externalInteractionsLeafLevelInner.clear();}
\DoxyCodeLine{01175\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{01176\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ One\ per\ level\ +\ leaf\ level}}
\DoxyCodeLine{01177\ \ \ \ \ \ \ \ \ externalInteractionsAllLevel.resize(tree-\/>getHeight());}
\DoxyCodeLine{01178\ \textcolor{preprocessor}{\#ifdef\ SCALFMM\_USE\_STARPU\_EXTRACT}}
\DoxyCodeLine{01179\ \ \ \ \ \ \ \ \ externalInteractionsAllLevelInnerIndexes.resize(tree-\/>getHeight());}
\DoxyCodeLine{01180\ \ \ \ \ \ \ \ \ externalInteractionsAllLevelOuterIndexes.resize(tree-\/>getHeight());}
\DoxyCodeLine{01181\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{01182\ }
\DoxyCodeLine{01183\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ First\ leaf\ level}}
\DoxyCodeLine{01184\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01185\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ We\ create\ one\ big\ vector\ per\ block}}
\DoxyCodeLine{01186\ \ \ \ \ \ \ \ \ \ \ \ \ externalInteractionsLeafLevel.resize(tree-\/>getNbParticleGroup());}
\DoxyCodeLine{01187\ \textcolor{preprocessor}{\#ifdef\ SCALFMM\_USE\_STARPU\_EXTRACT}}
\DoxyCodeLine{01188\ \ \ \ \ \ \ \ \ \ \ \ \ externalInteractionsLeafLevelOuter.resize(tree-\/>getNbParticleGroup());}
\DoxyCodeLine{01189\ \ \ \ \ \ \ \ \ \ \ \ \ externalInteractionsLeafLevelInner.resize(tree-\/>getNbParticleGroup());}
\DoxyCodeLine{01190\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{01191\ }
\DoxyCodeLine{01192\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ idxGroup\ =\ 0\ ;\ idxGroup\ <\ tree-\/>getNbParticleGroup()\ ;\ ++idxGroup)\{}
\DoxyCodeLine{01193\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Create\ the\ vector}}
\DoxyCodeLine{01194\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ParticleGroupClass*\ containers\ =\ tree-\/>getParticleGroup(idxGroup);}
\DoxyCodeLine{01195\ }
\DoxyCodeLine{01196\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ std::vector<BlockInteractions<ParticleGroupClass>>*\ externalInteractions\ =\ \&externalInteractionsLeafLevel[idxGroup];}
\DoxyCodeLine{01197\ \textcolor{preprocessor}{\#ifdef\ SCALFMM\_USE\_STARPU\_EXTRACT}}
\DoxyCodeLine{01198\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ std::vector<std::vector<int>>*\ externalInteractionsOuter\ =\ \&externalInteractionsLeafLevelOuter[idxGroup];}
\DoxyCodeLine{01199\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ std::vector<std::vector<int>>*\ externalInteractionsInner\ =\ \&externalInteractionsLeafLevelInner[idxGroup];}
\DoxyCodeLine{01200\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{01201\ }
\DoxyCodeLine{01202\ \textcolor{preprocessor}{\#ifdef\ SCALFMM\_USE\_STARPU\_EXTRACT}}
\DoxyCodeLine{01203\ \textcolor{preprocessor}{\#pragma\ omp\ task\ default(none)\ firstprivate(idxGroup,\ containers,\ externalInteractions,\ externalInteractionsOuter,\ externalInteractionsInner)}}
\DoxyCodeLine{01204\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{01205\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \#pragma\ omp\ task\ default(none)\ firstprivate(idxGroup,\ containers,\ externalInteractions)}}
\DoxyCodeLine{01206\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{01207\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{\ \textcolor{comment}{//\ Can\ be\ a\ task(inout:iterCells)}}
\DoxyCodeLine{01208\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ std::vector<OutOfBlockInteraction>\ outsideInteractions;}
\DoxyCodeLine{01209\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ MortonIndex\ blockStartIdx\ =\ containers-\/>getStartingIndex();}
\DoxyCodeLine{01210\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ MortonIndex\ blockEndIdx\ \ \ =\ containers-\/>getEndingIndex();}
\DoxyCodeLine{01211\ }
\DoxyCodeLine{01212\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ leafIdx\ =\ 0\ ;\ leafIdx\ <\ containers-\/>getNumberOfLeavesInBlock()\ ;\ ++leafIdx)\{}
\DoxyCodeLine{01213\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ MortonIndex\ mindex\ =\ containers-\/>getLeafMortonIndex(leafIdx);}
\DoxyCodeLine{01214\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ ParticleContainerClass\ particles\ =\ containers-\/>template\ getLeaf<ParticleContainerClass>(leafIdx);}}
\DoxyCodeLine{01215\ }
\DoxyCodeLine{01216\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ MortonIndex\ interactionsIndexes[26];}
\DoxyCodeLine{01217\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ interactionsPosition[26];}
\DoxyCodeLine{01218\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_f_tree_coordinate}{FTreeCoordinate}}\ coord(mindex);}
\DoxyCodeLine{01219\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ counter\ =\ coord.\mbox{\hyperlink{class_f_tree_coordinate_ac74ca299cacd624e1aca5b49e4b62709}{getNeighborsIndexes}}(tree-\/>getHeight(),interactionsIndexes,interactionsPosition);}
\DoxyCodeLine{01220\ }
\DoxyCodeLine{01221\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ idxInter\ =\ 0\ ;\ idxInter\ <\ counter\ ;\ ++idxInter)\{}
\DoxyCodeLine{01222\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\ blockStartIdx\ <=\ interactionsIndexes[idxInter]\ \&\&\ interactionsIndexes[idxInter]\ <\ blockEndIdx\ )\{}
\DoxyCodeLine{01223\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Inside\ block\ interaction,\ do\ nothing}}
\DoxyCodeLine{01224\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01225\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}(interactionsIndexes[idxInter]\ <\ mindex)\{}
\DoxyCodeLine{01226\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{struct_out_of_block_interaction}{OutOfBlockInteraction}}\ property;}
\DoxyCodeLine{01227\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{property}.insideIndex\ =\ mindex;}
\DoxyCodeLine{01228\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{property}.outIndex\ \ \ \ =\ interactionsIndexes[idxInter];}
\DoxyCodeLine{01229\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{property}.relativeOutPosition\ =\ interactionsPosition[idxInter];}
\DoxyCodeLine{01230\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{property}.insideIdxInBlock\ =\ leafIdx;}
\DoxyCodeLine{01231\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{property}.outsideIdxInBlock\ =\ -\/1;}
\DoxyCodeLine{01232\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ outsideInteractions.push\_back(property);}
\DoxyCodeLine{01233\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01234\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01235\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01236\ }
\DoxyCodeLine{01237\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Sort\ to\ match\ external\ order}}
\DoxyCodeLine{01238\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_f_quick_sort}{FQuickSort<OutOfBlockInteraction,\ int>::QsSequential}}(outsideInteractions.data(),\textcolor{keywordtype}{int}(outsideInteractions.size()));}
\DoxyCodeLine{01239\ }
\DoxyCodeLine{01240\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ currentOutInteraction\ =\ 0;}
\DoxyCodeLine{01241\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ idxLeftGroup\ =\ 0\ ;\ idxLeftGroup\ <\ idxGroup\ \&\&\ currentOutInteraction\ <\ int(outsideInteractions.size())\ ;\ ++idxLeftGroup)\{}
\DoxyCodeLine{01242\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ParticleGroupClass*\ leftContainers\ =\ tree-\/>getParticleGroup(idxLeftGroup);}
\DoxyCodeLine{01243\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ MortonIndex\ blockStartIdxOther\ \ \ \ =\ leftContainers-\/>getStartingIndex();}
\DoxyCodeLine{01244\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ MortonIndex\ blockEndIdxOther\ \ \ \ \ \ =\ leftContainers-\/>getEndingIndex();}
\DoxyCodeLine{01245\ }
\DoxyCodeLine{01246\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{while}(currentOutInteraction\ <\ \textcolor{keywordtype}{int}(outsideInteractions.size())}
\DoxyCodeLine{01247\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \&\&\ (outsideInteractions[currentOutInteraction].outIndex\ <\ blockStartIdxOther}
\DoxyCodeLine{01248\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ||\ leftContainers-\/>getLeafIndex(outsideInteractions[currentOutInteraction].outIndex)\ ==\ -\/1)}
\DoxyCodeLine{01249\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \&\&\ outsideInteractions[currentOutInteraction].outIndex\ <\ blockEndIdxOther)\{}
\DoxyCodeLine{01250\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ currentOutInteraction\ +=\ 1;}
\DoxyCodeLine{01251\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01252\ }
\DoxyCodeLine{01253\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ lastOutInteraction\ =\ currentOutInteraction;}
\DoxyCodeLine{01254\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ copyExistingInteraction\ =\ currentOutInteraction;}
\DoxyCodeLine{01255\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{while}(lastOutInteraction\ <\ \textcolor{keywordtype}{int}(outsideInteractions.size())\ \&\&\ outsideInteractions[lastOutInteraction].outIndex\ <\ blockEndIdxOther)\{}
\DoxyCodeLine{01256\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ leafPos\ =\ leftContainers-\/>getLeafIndex(outsideInteractions[lastOutInteraction].outIndex);}
\DoxyCodeLine{01257\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(leafPos\ !=\ -\/1)\{}
\DoxyCodeLine{01258\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(copyExistingInteraction\ !=\ lastOutInteraction)\{}
\DoxyCodeLine{01259\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ outsideInteractions[copyExistingInteraction]\ =\ outsideInteractions[lastOutInteraction];}
\DoxyCodeLine{01260\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01261\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ outsideInteractions[copyExistingInteraction].outsideIdxInBlock\ =\ leafPos;}
\DoxyCodeLine{01262\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ copyExistingInteraction\ +=\ 1;}
\DoxyCodeLine{01263\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01264\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ lastOutInteraction\ +=\ 1;}
\DoxyCodeLine{01265\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01266\ }
\DoxyCodeLine{01267\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ nbInteractionsBetweenBlocks\ =\ (copyExistingInteraction-\/currentOutInteraction);}
\DoxyCodeLine{01268\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(nbInteractionsBetweenBlocks)\{}
\DoxyCodeLine{01269\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ externalInteractions-\/>emplace\_back();}
\DoxyCodeLine{01270\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{struct_f_group_task_star_p_u_implicit_algorithm_1_1_block_interactions}{BlockInteractions<ParticleGroupClass>}}*\ interactions\ =\ \&externalInteractions-\/>back();}
\DoxyCodeLine{01271\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ interactions-\/>otherBlock\ =\ leftContainers;}
\DoxyCodeLine{01272\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ interactions-\/>otherBlockId\ =\ idxLeftGroup;}
\DoxyCodeLine{01273\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ interactions-\/>interactions.resize(nbInteractionsBetweenBlocks);}
\DoxyCodeLine{01274\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ std::copy(outsideInteractions.begin()\ +\ currentOutInteraction,}
\DoxyCodeLine{01275\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ outsideInteractions.begin()\ +\ copyExistingInteraction,}
\DoxyCodeLine{01276\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ interactions-\/>interactions.begin());}
\DoxyCodeLine{01277\ }
\DoxyCodeLine{01278\ \textcolor{preprocessor}{\#ifdef\ SCALFMM\_USE\_STARPU\_EXTRACT}}
\DoxyCodeLine{01279\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ externalInteractionsOuter-\/>emplace\_back();}
\DoxyCodeLine{01280\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ externalInteractionsInner-\/>emplace\_back();}
\DoxyCodeLine{01281\ }
\DoxyCodeLine{01282\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ std::vector<int>*\ interactionsOuter\ =\ \&externalInteractionsOuter-\/>back();}
\DoxyCodeLine{01283\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ std::vector<int>*\ interactionsInner\ =\ \&externalInteractionsInner-\/>back();}
\DoxyCodeLine{01284\ }
\DoxyCodeLine{01285\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ idxUnique\ =\ 0\ ;\ idxUnique\ <\ interactions-\/>interactions.size()\ ;\ ++idxUnique)\{}
\DoxyCodeLine{01286\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ interactionsOuter-\/>push\_back(interactions-\/>interactions[idxUnique].outsideIdxInBlock);}
\DoxyCodeLine{01287\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ interactionsInner-\/>push\_back(interactions-\/>interactions[idxUnique].insideIdxInBlock);}
\DoxyCodeLine{01288\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01289\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_f_quick_sort}{FQuickSort<int,\ int>::QsSequential}}(interactionsOuter-\/>data(),\textcolor{keywordtype}{int}(interactionsOuter-\/>size()));}
\DoxyCodeLine{01290\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_f_quick_sort}{FQuickSort<int,\ int>::QsSequential}}(interactionsInner-\/>data(),\textcolor{keywordtype}{int}(interactionsInner-\/>size()));}
\DoxyCodeLine{01291\ }
\DoxyCodeLine{01292\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ interactionsOuter-\/>erase(std::unique(interactionsOuter-\/>begin(),\ interactionsOuter-\/>end()),\ interactionsOuter-\/>end());}
\DoxyCodeLine{01293\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ interactionsInner-\/>erase(std::unique(interactionsInner-\/>begin(),\ interactionsInner-\/>end()),\ interactionsInner-\/>end());}
\DoxyCodeLine{01294\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{01295\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01296\ }
\DoxyCodeLine{01297\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ currentOutInteraction\ =\ lastOutInteraction;}
\DoxyCodeLine{01298\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01299\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01300\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01301\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01302\ \ \ \ \ \ \ \ \ FLOG(\ leafTimer.tac();\ );}
\DoxyCodeLine{01303\ \ \ \ \ \ \ \ \ FLOG(\ cellTimer.\mbox{\hyperlink{class_f_tic_ac0e070e65af128fbe5af711e51033b0a}{tic}}();\ );}
\DoxyCodeLine{01304\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01305\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ idxLevel\ =\ tree-\/>getHeight()-\/1\ ;\ idxLevel\ >=\ 2\ ;\ -\/-\/idxLevel)\{}
\DoxyCodeLine{01306\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ externalInteractionsAllLevel[idxLevel].resize(tree-\/>getNbCellGroupAtLevel(idxLevel));}
\DoxyCodeLine{01307\ \textcolor{preprocessor}{\#ifdef\ SCALFMM\_USE\_STARPU\_EXTRACT}}
\DoxyCodeLine{01308\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ externalInteractionsAllLevelInnerIndexes[idxLevel].resize(tree-\/>getNbCellGroupAtLevel(idxLevel));}
\DoxyCodeLine{01309\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ externalInteractionsAllLevelOuterIndexes[idxLevel].resize(tree-\/>getNbCellGroupAtLevel(idxLevel));}
\DoxyCodeLine{01310\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{01311\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ idxGroup\ =\ 0\ ;\ idxGroup\ <\ tree-\/>getNbCellGroupAtLevel(idxLevel)\ ;\ ++idxGroup)\{}
\DoxyCodeLine{01312\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ CellContainerClass*\ currentCells\ =\ tree-\/>getCellGroup(idxLevel,\ idxGroup);}
\DoxyCodeLine{01313\ }
\DoxyCodeLine{01314\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ std::vector<BlockInteractions<CellContainerClass>>*\ externalInteractions\ =\ \&externalInteractionsAllLevel[idxLevel][idxGroup];}
\DoxyCodeLine{01315\ \textcolor{preprocessor}{\#ifdef\ SCALFMM\_USE\_STARPU\_EXTRACT}}
\DoxyCodeLine{01316\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ std::vector<std::vector<int>>*\ externalInteractionsInner\ =\ \&externalInteractionsAllLevelInnerIndexes[idxLevel][idxGroup];}
\DoxyCodeLine{01317\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ std::vector<std::vector<int>>*\ externalInteractionsOuter\ =\ \&externalInteractionsAllLevelOuterIndexes[idxLevel][idxGroup];}
\DoxyCodeLine{01318\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{01319\ }
\DoxyCodeLine{01320\ \textcolor{preprocessor}{\#ifdef\ SCALFMM\_USE\_STARPU\_EXTRACT}}
\DoxyCodeLine{01321\ \textcolor{preprocessor}{\#pragma\ omp\ task\ default(none)\ firstprivate(idxGroup,\ currentCells,\ idxLevel,\ externalInteractions,\ externalInteractionsInner,\ externalInteractionsOuter)}}
\DoxyCodeLine{01322\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{01323\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \#pragma\ omp\ task\ default(none)\ firstprivate(idxGroup,\ currentCells,\ idxLevel,\ externalInteractions)}}
\DoxyCodeLine{01324\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{01325\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01326\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ std::vector<OutOfBlockInteraction>\ outsideInteractions;}
\DoxyCodeLine{01327\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ MortonIndex\ blockStartIdx\ =\ currentCells-\/>getStartingIndex();}
\DoxyCodeLine{01328\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ MortonIndex\ blockEndIdx\ \ \ =\ currentCells-\/>getEndingIndex();}
\DoxyCodeLine{01329\ }
\DoxyCodeLine{01330\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ cellIdx\ =\ 0\ ;\ cellIdx\ <\ currentCells-\/>getNumberOfCellsInBlock()\ ;\ ++cellIdx)\{}
\DoxyCodeLine{01331\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ MortonIndex\ mindex\ =\ currentCells-\/>getCellMortonIndex(cellIdx);}
\DoxyCodeLine{01332\ }
\DoxyCodeLine{01333\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ MortonIndex\ interactionsIndexes[189];}
\DoxyCodeLine{01334\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ interactionsPosition[189];}
\DoxyCodeLine{01335\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_f_tree_coordinate}{FTreeCoordinate}}\ coord(mindex);}
\DoxyCodeLine{01336\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ counter\ =\ coord.\mbox{\hyperlink{class_f_tree_coordinate_ad9a4eeadc6666916ebfb35fa9f794abd}{getInteractionNeighbors}}(idxLevel,interactionsIndexes,interactionsPosition);}
\DoxyCodeLine{01337\ }
\DoxyCodeLine{01338\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ idxInter\ =\ 0\ ;\ idxInter\ <\ counter\ ;\ ++idxInter)\{}
\DoxyCodeLine{01339\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\ blockStartIdx\ <=\ interactionsIndexes[idxInter]\ \&\&\ interactionsIndexes[idxInter]\ <\ blockEndIdx\ )\{}
\DoxyCodeLine{01340\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Nothing\ to\ do}}
\DoxyCodeLine{01341\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01342\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}(interactionsIndexes[idxInter]\ <\ mindex)\{}
\DoxyCodeLine{01343\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{struct_out_of_block_interaction}{OutOfBlockInteraction}}\ property;}
\DoxyCodeLine{01344\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{property}.insideIndex\ =\ mindex;}
\DoxyCodeLine{01345\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{property}.outIndex\ \ \ \ =\ interactionsIndexes[idxInter];}
\DoxyCodeLine{01346\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{property}.relativeOutPosition\ =\ interactionsPosition[idxInter];}
\DoxyCodeLine{01347\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{property}.insideIdxInBlock\ =\ cellIdx;}
\DoxyCodeLine{01348\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{property}.outsideIdxInBlock\ =\ -\/1;}
\DoxyCodeLine{01349\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ outsideInteractions.push\_back(property);}
\DoxyCodeLine{01350\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01351\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01352\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01353\ }
\DoxyCodeLine{01354\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Manage\ outofblock\ interaction}}
\DoxyCodeLine{01355\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_f_quick_sort}{FQuickSort<OutOfBlockInteraction,\ int>::QsSequential}}(outsideInteractions.data(),\textcolor{keywordtype}{int}(outsideInteractions.size()));}
\DoxyCodeLine{01356\ }
\DoxyCodeLine{01357\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ currentOutInteraction\ =\ 0;}
\DoxyCodeLine{01358\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ idxLeftGroup\ =\ 0\ ;\ idxLeftGroup\ <\ idxGroup\ \&\&\ currentOutInteraction\ <\ int(outsideInteractions.size())\ ;\ ++idxLeftGroup)\{}
\DoxyCodeLine{01359\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ CellContainerClass*\ leftCells\ \ \ =\ tree-\/>getCellGroup(idxLevel,\ idxLeftGroup);}
\DoxyCodeLine{01360\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ MortonIndex\ blockStartIdxOther\ =\ leftCells-\/>getStartingIndex();}
\DoxyCodeLine{01361\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ MortonIndex\ blockEndIdxOther\ \ \ =\ leftCells-\/>getEndingIndex();}
\DoxyCodeLine{01362\ }
\DoxyCodeLine{01363\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{while}(currentOutInteraction\ <\ \textcolor{keywordtype}{int}(outsideInteractions.size())}
\DoxyCodeLine{01364\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \&\&\ (outsideInteractions[currentOutInteraction].outIndex\ <\ blockStartIdxOther}
\DoxyCodeLine{01365\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ||\ leftCells-\/>getCellIndex(outsideInteractions[currentOutInteraction].outIndex)\ ==\ -\/1)}
\DoxyCodeLine{01366\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \&\&\ outsideInteractions[currentOutInteraction].outIndex\ <\ blockEndIdxOther)\{}
\DoxyCodeLine{01367\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ currentOutInteraction\ +=\ 1;}
\DoxyCodeLine{01368\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01369\ }
\DoxyCodeLine{01370\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ lastOutInteraction\ =\ currentOutInteraction;}
\DoxyCodeLine{01371\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ copyExistingInteraction\ =\ currentOutInteraction;}
\DoxyCodeLine{01372\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{while}(lastOutInteraction\ <\ \textcolor{keywordtype}{int}(outsideInteractions.size())\ \&\&\ outsideInteractions[lastOutInteraction].outIndex\ <\ blockEndIdxOther)\{}
\DoxyCodeLine{01373\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ cellPos\ =\ leftCells-\/>getCellIndex(outsideInteractions[lastOutInteraction].outIndex);}
\DoxyCodeLine{01374\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(cellPos\ !=\ -\/1)\{}
\DoxyCodeLine{01375\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(copyExistingInteraction\ !=\ lastOutInteraction)\{}
\DoxyCodeLine{01376\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ outsideInteractions[copyExistingInteraction]\ =\ outsideInteractions[lastOutInteraction];}
\DoxyCodeLine{01377\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01378\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ outsideInteractions[copyExistingInteraction].outsideIdxInBlock\ =\ cellPos;}
\DoxyCodeLine{01379\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ copyExistingInteraction\ +=\ 1;}
\DoxyCodeLine{01380\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01381\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ lastOutInteraction\ +=\ 1;}
\DoxyCodeLine{01382\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01383\ }
\DoxyCodeLine{01384\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Create\ interactions}}
\DoxyCodeLine{01385\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ nbInteractionsBetweenBlocks\ =\ (copyExistingInteraction-\/currentOutInteraction);}
\DoxyCodeLine{01386\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(nbInteractionsBetweenBlocks)\{}
\DoxyCodeLine{01387\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ externalInteractions-\/>emplace\_back();}
\DoxyCodeLine{01388\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{struct_f_group_task_star_p_u_implicit_algorithm_1_1_block_interactions}{BlockInteractions<CellContainerClass>}}*\ interactions\ =\ \&externalInteractions-\/>back();}
\DoxyCodeLine{01389\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ interactions-\/>otherBlock\ =\ leftCells;}
\DoxyCodeLine{01390\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ interactions-\/>otherBlockId\ =\ idxLeftGroup;}
\DoxyCodeLine{01391\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ interactions-\/>interactions.resize(nbInteractionsBetweenBlocks);}
\DoxyCodeLine{01392\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ std::copy(outsideInteractions.begin()\ +\ currentOutInteraction,}
\DoxyCodeLine{01393\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ outsideInteractions.begin()\ +\ copyExistingInteraction,}
\DoxyCodeLine{01394\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ interactions-\/>interactions.begin());}
\DoxyCodeLine{01395\ }
\DoxyCodeLine{01396\ \textcolor{preprocessor}{\#ifdef\ SCALFMM\_USE\_STARPU\_EXTRACT}}
\DoxyCodeLine{01397\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ externalInteractionsInner-\/>emplace\_back();}
\DoxyCodeLine{01398\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ std::vector<int>*\ interactionsInnerIndexes\ =\ \&externalInteractionsInner-\/>back();}
\DoxyCodeLine{01399\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ externalInteractionsOuter-\/>emplace\_back();}
\DoxyCodeLine{01400\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ std::vector<int>*\ interactionsOuterIndexes\ =\ \&externalInteractionsOuter-\/>back();}
\DoxyCodeLine{01401\ }
\DoxyCodeLine{01402\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ idxUnique\ =\ 0\ ;\ idxUnique\ <\ interactions-\/>interactions.size()\ ;\ ++idxUnique)\{}
\DoxyCodeLine{01403\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ interactionsOuterIndexes-\/>push\_back(interactions-\/>interactions[idxUnique].outsideIdxInBlock);}
\DoxyCodeLine{01404\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ interactionsInnerIndexes-\/>push\_back(interactions-\/>interactions[idxUnique].insideIdxInBlock);}
\DoxyCodeLine{01405\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01406\ }
\DoxyCodeLine{01407\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_f_quick_sort}{FQuickSort<int,\ int>::QsSequential}}(interactionsOuterIndexes-\/>data(),\textcolor{keywordtype}{int}(interactionsOuterIndexes-\/>size()));}
\DoxyCodeLine{01408\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ interactionsOuterIndexes-\/>erase(std::unique(interactionsOuterIndexes-\/>begin(),\ interactionsOuterIndexes-\/>end()),}
\DoxyCodeLine{01409\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ interactionsOuterIndexes-\/>end());}
\DoxyCodeLine{01410\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_f_quick_sort}{FQuickSort<int,\ int>::QsSequential}}(interactionsInnerIndexes-\/>data(),\textcolor{keywordtype}{int}(interactionsInnerIndexes-\/>size()));}
\DoxyCodeLine{01411\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ interactionsInnerIndexes-\/>erase(std::unique(interactionsInnerIndexes-\/>begin(),\ interactionsInnerIndexes-\/>end()),}
\DoxyCodeLine{01412\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ interactionsInnerIndexes-\/>end());}
\DoxyCodeLine{01413\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{01414\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01415\ }
\DoxyCodeLine{01416\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ currentOutInteraction\ =\ lastOutInteraction;}
\DoxyCodeLine{01417\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01418\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01419\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01420\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01421\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01422\ \ \ \ \ \ \ \ \ FLOG(\ cellTimer.\mbox{\hyperlink{class_f_tic_a3efff71f7c95acd38451bfab08fa4583}{tac}}();\ );}
\DoxyCodeLine{01423\ }
\DoxyCodeLine{01424\ \textcolor{preprocessor}{\#pragma\ omp\ taskwait}}
\DoxyCodeLine{01425\ }
\DoxyCodeLine{01426\ \ \ \ \ \ \ \ \ FLOG(\ FLog::Controller\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)t\(\backslash\)t\ Prepare\ in\ "{}}\ <<\ timer.tacAndElapsed()\ <<\ \textcolor{stringliteral}{"{}s\(\backslash\)n"{}}\ );}
\DoxyCodeLine{01427\ \ \ \ \ \ \ \ \ FLOG(\ FLog::Controller\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)t\(\backslash\)t\(\backslash\)t\ Prepare\ at\ leaf\ level\ in\ \ \ "{}}\ <<\ leafTimer.elapsed()\ <<\ \textcolor{stringliteral}{"{}s\(\backslash\)n"{}}\ );}
\DoxyCodeLine{01428\ \ \ \ \ \ \ \ \ FLOG(\ FLog::Controller\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)t\(\backslash\)t\(\backslash\)t\ Prepare\ at\ other\ levels\ in\ "{}}\ <<\ cellTimer.\mbox{\hyperlink{class_f_tic_a30b9f876fb7188f85b4c2b9d7fd7943e}{elapsed}}()\ <<\ \textcolor{stringliteral}{"{}s\(\backslash\)n"{}}\ );}
\DoxyCodeLine{01429\ \ \ \ \ \}}
\DoxyCodeLine{01430\ }
\DoxyCodeLine{01434\ }
\DoxyCodeLine{01435\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_f_group_task_star_p_u_implicit_algorithm_abb95c6fe9f716d92eedbdf0890a5a849}{bottomPass}}()\{}
\DoxyCodeLine{01436\ \ \ \ \ \ \ \ \ FLOG(\ \mbox{\hyperlink{class_f_tic}{FTic}}\ timer;\ );}
\DoxyCodeLine{01437\ }
\DoxyCodeLine{01438\ \ \ \ \ \ \ \ \ FAssertLF(cellHandles[tree-\/>getHeight()-\/1].size()\ ==\ particleHandles.size());}
\DoxyCodeLine{01439\ }
\DoxyCodeLine{01440\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ idxGroup\ =\ 0\ ;\ idxGroup\ <\ tree-\/>getNbParticleGroup()\ ;\ ++idxGroup)\{}
\DoxyCodeLine{01441\ \ \ \ \ \ \ \ \ \ \ \ \ starpu\_mpi\_insert\_task(MPI\_COMM\_WORLD,}
\DoxyCodeLine{01442\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \&p2m\_cl,}
\DoxyCodeLine{01443\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_VALUE,\ \&wrapperptr,\ \textcolor{keyword}{sizeof}(wrapperptr),}
\DoxyCodeLine{01444\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_VALUE,\ \&cellHandles[tree-\/>getHeight()-\/1][idxGroup].intervalSize,\ \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{int}),}
\DoxyCodeLine{01445\ \ \ \ \ \ \ \ \ \#ifdef\ SCALFMM\_STARPU\_USE\_PRIO}
\DoxyCodeLine{01446\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_PRIORITY,\ PrioClass::Controller().getInsertionPosP2M(),}
\DoxyCodeLine{01447\ \ \ \ \ \ \ \ \ \#endif}
\DoxyCodeLine{01448\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_R,\ cellHandles[tree-\/>getHeight()-\/1][idxGroup].symb,}
\DoxyCodeLine{01449\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_RW,\ cellHandles[tree-\/>getHeight()-\/1][idxGroup].up,}
\DoxyCodeLine{01450\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_R,\ particleHandles[idxGroup].symb,}
\DoxyCodeLine{01451\ \ \ \ \ \ \ \ \ \#ifdef\ STARPU\_USE\_TASK\_NAME}
\DoxyCodeLine{01452\ \ \ \ \ \ \ \ \ \#ifndef\ SCALFMM\_SIMGRID\_TASKNAMEPARAMS}
\DoxyCodeLine{01453\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_NAME,\ p2mTaskNames.get(),}
\DoxyCodeLine{01454\ \ \ \ \ \ \ \ \ \#\textcolor{keywordflow}{else}}
\DoxyCodeLine{01455\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//"{}P2M-\/nb\_i\_p"{}}}
\DoxyCodeLine{01456\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_NAME,\ taskNames-\/>print(\textcolor{stringliteral}{"{}P2M"{}},\ \textcolor{stringliteral}{"{}\%d,\ \%lld,\ \%lld,\ \%lld,\ \%lld,\ \%d\(\backslash\)n"{}},}
\DoxyCodeLine{01457\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tree-\/>getCellGroup(tree-\/>getHeight()-\/1,idxGroup)-\/>getNumberOfCellsInBlock(),}
\DoxyCodeLine{01458\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tree-\/>getCellGroup(tree-\/>getHeight()-\/1,idxGroup)-\/>getSizeOfInterval(),}
\DoxyCodeLine{01459\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tree-\/>getCellGroup(tree-\/>getHeight()-\/1,idxGroup)-\/>getNumberOfCellsInBlock(),}
\DoxyCodeLine{01460\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tree-\/>getParticleGroup(idxGroup)-\/>getStartingIndex(),}
\DoxyCodeLine{01461\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tree-\/>getParticleGroup(idxGroup)-\/>getEndingIndex(),}
\DoxyCodeLine{01462\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ starpu\_mpi\_data\_get\_rank(cellHandles[tree-\/>getHeight()-\/1][idxGroup].up)),}
\DoxyCodeLine{01463\ \ \ \ \ \ \ \ \ \#endif}
\DoxyCodeLine{01464\ \ \ \ \ \ \ \ \ \#endif}
\DoxyCodeLine{01465\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 0);}
\DoxyCodeLine{01466\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01467\ }
\DoxyCodeLine{01468\ \ \ \ \ \ \ \ \ FLOG(\ FLog::Controller\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)t\(\backslash\)t\ bottomPass\ in\ "{}}\ <<\ timer.tacAndElapsed()\ <<\ \textcolor{stringliteral}{"{}s\(\backslash\)n"{}}\ );}
\DoxyCodeLine{01469\ \ \ \ \ \}}
\DoxyCodeLine{01470\ }
\DoxyCodeLine{01474\ }
\DoxyCodeLine{01475\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_f_group_task_star_p_u_implicit_algorithm_aa546e6b9870f5f75a0b122c43c1338aa}{upwardPass}}()\{}
\DoxyCodeLine{01476\ \ \ \ \ \ \ \ \ FLOG(\ \mbox{\hyperlink{class_f_tic}{FTic}}\ timer;\ );}
\DoxyCodeLine{01477\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ idxLevel\ =\ \mbox{\hyperlink{struct_f_math_a43635af3d44bb1868015681ce994df7b}{FMath::Min}}(tree-\/>getHeight()\ -\/\ 2,\ \mbox{\hyperlink{class_f_abstract_algorithm_a694b8888186be58e38691ce08b177d46}{FAbstractAlgorithm::lowerWorkingLevel}}\ -\/\ 1)\ ;\ idxLevel\ >=\ \mbox{\hyperlink{class_f_abstract_algorithm_ade49cb5ede82d078261e576a9d809dc2}{FAbstractAlgorithm::upperWorkingLevel}}\ ;\ -\/-\/idxLevel)\{}
\DoxyCodeLine{01478\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ idxSubGroup\ =\ 0;}
\DoxyCodeLine{01479\ }
\DoxyCodeLine{01480\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ idxGroup\ =\ 0\ ;\ idxGroup\ <\ tree-\/>getNbCellGroupAtLevel(idxLevel)\ ;\ ++idxGroup)\{}
\DoxyCodeLine{01481\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ CellContainerClass*\textcolor{keyword}{const}\ currentCells\ =\ tree-\/>getCellGroup(idxLevel,\ idxGroup);}
\DoxyCodeLine{01482\ }
\DoxyCodeLine{01483\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Skip\ current\ group\ if\ needed}}
\DoxyCodeLine{01484\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\ tree-\/>getCellGroup(idxLevel+1,\ idxSubGroup)-\/>getEndingIndex()\ <=\ (currentCells-\/>getStartingIndex()<<3)\ )\{}
\DoxyCodeLine{01485\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ++idxSubGroup;}
\DoxyCodeLine{01486\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ FAssertLF(\ idxSubGroup\ !=\ tree-\/>getNbCellGroupAtLevel(idxLevel+1)\ );}
\DoxyCodeLine{01487\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ FAssertLF(\ (tree-\/>getCellGroup(idxLevel+1,\ idxSubGroup)-\/>getStartingIndex()>>3)\ ==\ currentCells-\/>getStartingIndex()\ );}
\DoxyCodeLine{01488\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01489\ }
\DoxyCodeLine{01490\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Copy\ at\ max\ 8\ groups}}
\DoxyCodeLine{01491\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01492\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ starpu\_mpi\_insert\_task(MPI\_COMM\_WORLD,}
\DoxyCodeLine{01493\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \&m2m\_cl,}
\DoxyCodeLine{01494\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_VALUE,\ \&wrapperptr,\ \textcolor{keyword}{sizeof}(wrapperptr),}
\DoxyCodeLine{01495\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_VALUE,\ \&idxLevel,\ \textcolor{keyword}{sizeof}(idxLevel),}
\DoxyCodeLine{01496\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_VALUE,\ \&cellHandles[idxLevel][idxGroup].intervalSize,\ \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{int}),}
\DoxyCodeLine{01497\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \#ifdef\ SCALFMM\_STARPU\_USE\_PRIO}
\DoxyCodeLine{01498\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_PRIORITY,\ PrioClass::Controller().getInsertionPosM2M(idxLevel),}
\DoxyCodeLine{01499\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \#endif}
\DoxyCodeLine{01500\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_R,\ cellHandles[idxLevel][idxGroup].symb,\ \textcolor{comment}{//symbolique,\ readonly}}
\DoxyCodeLine{01501\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (STARPU\_RW\ |\ STARPU\_COMMUTE\_IF\_SUPPORTED),\ cellHandles[idxLevel][idxGroup].up,\ \textcolor{comment}{//The\ remaining,\ read/write}}
\DoxyCodeLine{01502\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_R,\ cellHandles[idxLevel+1][idxSubGroup].symb,\ \textcolor{comment}{//symbolique,\ readonly}}
\DoxyCodeLine{01503\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_R,\ cellHandles[idxLevel+1][idxSubGroup].up,\ \textcolor{comment}{//level\ d'avant\ readonly}}
\DoxyCodeLine{01504\ \ \ \ \ \ \ \ \ \#ifdef\ STARPU\_USE\_TASK\_NAME}
\DoxyCodeLine{01505\ \ \ \ \ \ \ \ \ \#ifndef\ SCALFMM\_SIMGRID\_TASKNAMEPARAMS}
\DoxyCodeLine{01506\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_NAME,\ m2mTaskNames[idxLevel].get(),}
\DoxyCodeLine{01507\ \ \ \ \ \ \ \ \ \#\textcolor{keywordflow}{else}}
\DoxyCodeLine{01508\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//"{}M2M-\/l\_nb\_i\_nbc\_ic\_s"{}}}
\DoxyCodeLine{01509\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_NAME,\ taskNames-\/>print(\textcolor{stringliteral}{"{}M2M"{}},\ \textcolor{stringliteral}{"{}\%d,\ \%d,\ \%lld,\ \%d,\ \%lld,\ \%lld,\ \%lld,\ \%lld,\ \%lld,\ \%lld,\ \%d\(\backslash\)n"{}},}
\DoxyCodeLine{01510\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ idxLevel,}
\DoxyCodeLine{01511\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tree-\/>getCellGroup(idxLevel,idxGroup)-\/>getNumberOfCellsInBlock(),}
\DoxyCodeLine{01512\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tree-\/>getCellGroup(idxLevel,idxGroup)-\/>getSizeOfInterval(),}
\DoxyCodeLine{01513\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tree-\/>getCellGroup(idxLevel+1,idxSubGroup)-\/>getNumberOfCellsInBlock(),}
\DoxyCodeLine{01514\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tree-\/>getCellGroup(idxLevel+1,idxSubGroup)-\/>getSizeOfInterval(),}
\DoxyCodeLine{01515\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{struct_f_math_a43635af3d44bb1868015681ce994df7b}{FMath::Min}}(tree-\/>getCellGroup(idxLevel,idxGroup)-\/>getEndingIndex()-\/1,\ (tree-\/>getCellGroup(idxLevel+1,idxSubGroup)-\/>getEndingIndex()-\/1)>>3)-\/}
\DoxyCodeLine{01516\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{struct_f_math_ada359f2b021ce4b999c0fd7a6e9daae6}{FMath::Max}}(tree-\/>getCellGroup(idxLevel,idxGroup)-\/>getStartingIndex(),\ tree-\/>getCellGroup(idxLevel+1,idxSubGroup)-\/>getStartingIndex()>>3),}
\DoxyCodeLine{01517\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tree-\/>getCellGroup(idxLevel,\ idxGroup)-\/>getStartingIndex(),}
\DoxyCodeLine{01518\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tree-\/>getCellGroup(idxLevel,\ idxGroup)-\/>getEndingIndex(),}
\DoxyCodeLine{01519\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tree-\/>getCellGroup(idxLevel+1,\ idxSubGroup)-\/>getStartingIndex(),}
\DoxyCodeLine{01520\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tree-\/>getCellGroup(idxLevel+1,\ idxSubGroup)-\/>getEndingIndex(),}
\DoxyCodeLine{01521\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ starpu\_mpi\_data\_get\_rank(cellHandles[idxLevel][idxGroup].up)),}
\DoxyCodeLine{01522\ \ \ \ \ \ \ \ \ \#endif}
\DoxyCodeLine{01523\ \ \ \ \ \ \ \ \ \#endif}
\DoxyCodeLine{01524\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 0);}
\DoxyCodeLine{01525\ }
\DoxyCodeLine{01526\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01527\ }
\DoxyCodeLine{01528\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{while}(tree-\/>getCellGroup(idxLevel+1,\ idxSubGroup)-\/>getEndingIndex()\ <=\ (((currentCells-\/>getEndingIndex()-\/1)<<3)+7)}
\DoxyCodeLine{01529\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \&\&\ (idxSubGroup+1)\ !=\ tree-\/>getNbCellGroupAtLevel(idxLevel+1)}
\DoxyCodeLine{01530\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \&\&\ tree-\/>getCellGroup(idxLevel+1,\ idxSubGroup+1)-\/>getStartingIndex()\ <=\ ((currentCells-\/>getEndingIndex()-\/1)<<3)+7\ )\{}
\DoxyCodeLine{01531\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ idxSubGroup\ +=\ 1;}
\DoxyCodeLine{01532\ }
\DoxyCodeLine{01533\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ starpu\_mpi\_insert\_task(MPI\_COMM\_WORLD,}
\DoxyCodeLine{01534\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \&m2m\_cl,}
\DoxyCodeLine{01535\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_VALUE,\ \&wrapperptr,\ \textcolor{keyword}{sizeof}(wrapperptr),}
\DoxyCodeLine{01536\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_VALUE,\ \&idxLevel,\ \textcolor{keyword}{sizeof}(idxLevel),}
\DoxyCodeLine{01537\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_VALUE,\ \&cellHandles[idxLevel][idxGroup].intervalSize,\ \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{int}),}
\DoxyCodeLine{01538\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \#ifdef\ SCALFMM\_STARPU\_USE\_PRIO}
\DoxyCodeLine{01539\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_PRIORITY,\ PrioClass::Controller().getInsertionPosM2M(idxLevel),}
\DoxyCodeLine{01540\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \#endif}
\DoxyCodeLine{01541\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_R,\ cellHandles[idxLevel][idxGroup].symb,\ \textcolor{comment}{//symbolique,\ readonly}}
\DoxyCodeLine{01542\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (STARPU\_RW\ |\ STARPU\_COMMUTE\_IF\_SUPPORTED),\ cellHandles[idxLevel][idxGroup].up,\ \textcolor{comment}{//The\ remaining,\ read/write}}
\DoxyCodeLine{01543\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_R,\ cellHandles[idxLevel+1][idxSubGroup].symb,\ \textcolor{comment}{//symbolique,\ readonly}}
\DoxyCodeLine{01544\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_R,\ cellHandles[idxLevel+1][idxSubGroup].up,\ \textcolor{comment}{//level\ d'avant\ readonly}}
\DoxyCodeLine{01545\ \ \ \ \ \ \ \ \ \#ifdef\ STARPU\_USE\_TASK\_NAME}
\DoxyCodeLine{01546\ \ \ \ \ \ \ \ \ \#ifndef\ SCALFMM\_SIMGRID\_TASKNAMEPARAMS}
\DoxyCodeLine{01547\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_NAME,\ m2mTaskNames[idxLevel].get(),}
\DoxyCodeLine{01548\ \ \ \ \ \ \ \ \ \#\textcolor{keywordflow}{else}}
\DoxyCodeLine{01549\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//M2M-\/l\_nb\_i\_nbc\_ic\_s}}
\DoxyCodeLine{01550\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_NAME,\ taskNames-\/>print(\textcolor{stringliteral}{"{}M2M"{}},\ \textcolor{stringliteral}{"{}\%d,\ \%d,\ \%lld,\ \%d,\ \%lld,\ \%lld,\ \%lld,\ \%lld,\ \%lld,\ \%lld,\ \%d\(\backslash\)n"{}},}
\DoxyCodeLine{01551\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ idxLevel,}
\DoxyCodeLine{01552\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tree-\/>getCellGroup(idxLevel,idxGroup)-\/>getNumberOfCellsInBlock(),}
\DoxyCodeLine{01553\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tree-\/>getCellGroup(idxLevel,idxGroup)-\/>getSizeOfInterval(),}
\DoxyCodeLine{01554\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tree-\/>getCellGroup(idxLevel+1,idxSubGroup)-\/>getNumberOfCellsInBlock(),}
\DoxyCodeLine{01555\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tree-\/>getCellGroup(idxLevel+1,idxSubGroup)-\/>getSizeOfInterval(),}
\DoxyCodeLine{01556\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{struct_f_math_a43635af3d44bb1868015681ce994df7b}{FMath::Min}}(tree-\/>getCellGroup(idxLevel,idxGroup)-\/>getEndingIndex()-\/1,\ (tree-\/>getCellGroup(idxLevel+1,idxSubGroup)-\/>getEndingIndex()-\/1)>>3)-\/}
\DoxyCodeLine{01557\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{struct_f_math_ada359f2b021ce4b999c0fd7a6e9daae6}{FMath::Max}}(tree-\/>getCellGroup(idxLevel,idxGroup)-\/>getStartingIndex(),\ tree-\/>getCellGroup(idxLevel+1,idxSubGroup)-\/>getStartingIndex()>>3),}
\DoxyCodeLine{01558\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tree-\/>getCellGroup(idxLevel,\ idxGroup)-\/>getStartingIndex(),}
\DoxyCodeLine{01559\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tree-\/>getCellGroup(idxLevel,\ idxGroup)-\/>getEndingIndex(),}
\DoxyCodeLine{01560\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tree-\/>getCellGroup(idxLevel+1,\ idxSubGroup)-\/>getStartingIndex(),}
\DoxyCodeLine{01561\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tree-\/>getCellGroup(idxLevel+1,\ idxSubGroup)-\/>getEndingIndex(),}
\DoxyCodeLine{01562\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ starpu\_mpi\_data\_get\_rank(cellHandles[idxLevel][idxGroup].up)),}
\DoxyCodeLine{01563\ \ \ \ \ \ \ \ \ \#endif}
\DoxyCodeLine{01564\ \ \ \ \ \ \ \ \ \#endif}
\DoxyCodeLine{01565\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 0);}
\DoxyCodeLine{01566\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01567\ }
\DoxyCodeLine{01568\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01569\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01570\ \ \ \ \ \ \ \ \ FLOG(\ FLog::Controller\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)t\(\backslash\)t\ upwardPass\ in\ "{}}\ <<\ timer.tacAndElapsed()\ <<\ \textcolor{stringliteral}{"{}s\(\backslash\)n"{}}\ );}
\DoxyCodeLine{01571\ \ \ \ \ \}}
\DoxyCodeLine{01572\ }
\DoxyCodeLine{01576\ }
\DoxyCodeLine{01577\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_f_group_task_star_p_u_implicit_algorithm_a29f5963406d404f73a36d38091647ed3}{transferPass}}(\textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ fromLevel,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ toLevel,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{bool}\ inner,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{bool}\ outer)\{}
\DoxyCodeLine{01578\ \ \ \ \ \ \ \ \ FLOG(\ \mbox{\hyperlink{class_f_tic}{FTic}}\ timer;\ );}
\DoxyCodeLine{01579\ \ \ \ \ \ \ \ \ FLOG(\ \mbox{\hyperlink{class_f_tic}{FTic}}\ timerInBlock;\ \mbox{\hyperlink{class_f_tic}{FTic}}\ timerOutBlock;\ );}
\DoxyCodeLine{01580\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ idxLevel\ =\ fromLevel\ ;\ idxLevel\ <\ toLevel\ ;\ ++idxLevel)\{}
\DoxyCodeLine{01581\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(inner)\{}
\DoxyCodeLine{01582\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ FLOG(\ timerInBlock.tic()\ );}
\DoxyCodeLine{01583\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ idxGroup\ =\ 0\ ;\ idxGroup\ <\ tree-\/>getNbCellGroupAtLevel(idxLevel)\ ;\ ++idxGroup)\{}
\DoxyCodeLine{01584\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ starpu\_mpi\_insert\_task(MPI\_COMM\_WORLD,}
\DoxyCodeLine{01585\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \&m2l\_cl\_in,}
\DoxyCodeLine{01586\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_VALUE,\ \&wrapperptr,\ \textcolor{keyword}{sizeof}(wrapperptr),}
\DoxyCodeLine{01587\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_VALUE,\ \&idxLevel,\ \textcolor{keyword}{sizeof}(idxLevel),}
\DoxyCodeLine{01588\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_VALUE,\ \&cellHandles[idxLevel][idxGroup].intervalSize,\ \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{int}),}
\DoxyCodeLine{01589\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \#ifdef\ SCALFMM\_STARPU\_USE\_PRIO}
\DoxyCodeLine{01590\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_PRIORITY,\ PrioClass::Controller().getInsertionPosM2L(idxLevel),}
\DoxyCodeLine{01591\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \#endif}
\DoxyCodeLine{01592\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_R,\ cellHandles[idxLevel][idxGroup].symb,}
\DoxyCodeLine{01593\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_R,\ cellHandles[idxLevel][idxGroup].up,}
\DoxyCodeLine{01594\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (STARPU\_RW\ |\ STARPU\_COMMUTE\_IF\_SUPPORTED),\ cellHandles[idxLevel][idxGroup].down,}
\DoxyCodeLine{01595\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \#ifdef\ STARPU\_USE\_TASK\_NAME}
\DoxyCodeLine{01596\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \#ifndef\ SCALFMM\_SIMGRID\_TASKNAMEPARAMS}
\DoxyCodeLine{01597\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_NAME,\ m2lTaskNames[idxLevel].get(),}
\DoxyCodeLine{01598\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \#\textcolor{keywordflow}{else}}
\DoxyCodeLine{01599\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//"{}M2L-\/l\_nb\_i"{}}}
\DoxyCodeLine{01600\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_NAME,\ taskNames-\/>print(\textcolor{stringliteral}{"{}M2L"{}},\ \textcolor{stringliteral}{"{}\%d,\ \%d,\ \%lld,\ \%lld,\ \%lld,\ \%lld,\ \%lld,\ \%d\(\backslash\)n"{}},}
\DoxyCodeLine{01601\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ idxLevel,}
\DoxyCodeLine{01602\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tree-\/>getCellGroup(idxLevel,idxGroup)-\/>getNumberOfCellsInBlock(),}
\DoxyCodeLine{01603\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tree-\/>getCellGroup(idxLevel,idxGroup)-\/>getSizeOfInterval(),}
\DoxyCodeLine{01604\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tree-\/>getCellGroup(idxLevel,\ idxGroup)-\/>getStartingIndex(),}
\DoxyCodeLine{01605\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tree-\/>getCellGroup(idxLevel,\ idxGroup)-\/>getEndingIndex(),}
\DoxyCodeLine{01606\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tree-\/>getCellGroup(idxLevel,\ idxGroup)-\/>getStartingIndex(),}
\DoxyCodeLine{01607\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tree-\/>getCellGroup(idxLevel,\ idxGroup)-\/>getEndingIndex(),}
\DoxyCodeLine{01608\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ starpu\_mpi\_data\_get\_rank(cellHandles[idxLevel][idxGroup].down)),}
\DoxyCodeLine{01609\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \#endif}
\DoxyCodeLine{01610\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \#endif}
\DoxyCodeLine{01611\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 0);}
\DoxyCodeLine{01612\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01613\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ FLOG(\ timerInBlock.tac()\ );}
\DoxyCodeLine{01614\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01615\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(outer)\{}
\DoxyCodeLine{01616\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ FLOG(\ timerOutBlock.tic()\ );}
\DoxyCodeLine{01617\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ idxGroup\ =\ 0\ ;\ idxGroup\ <\ tree-\/>getNbCellGroupAtLevel(idxLevel)\ ;\ ++idxGroup)\{}
\DoxyCodeLine{01618\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ idxInteraction\ =\ 0;\ idxInteraction\ <\ int(externalInteractionsAllLevel[idxLevel][idxGroup].size())\ ;\ ++idxInteraction)\{}
\DoxyCodeLine{01619\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ interactionid\ =\ externalInteractionsAllLevel[idxLevel][idxGroup][idxInteraction].otherBlockId;}
\DoxyCodeLine{01620\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::vector<OutOfBlockInteraction>*\ outsideInteractions\ =\ \&externalInteractionsAllLevel[idxLevel][idxGroup][idxInteraction].interactions;}
\DoxyCodeLine{01621\ \textcolor{preprocessor}{\#ifdef\ SCALFMM\_USE\_STARPU\_EXTRACT}}
\DoxyCodeLine{01622\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ On\ the\ same\ node\ -\/-\/\ do\ as\ usual}}
\DoxyCodeLine{01623\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(starpu\_mpi\_data\_get\_rank(cellHandles[idxLevel][idxGroup].symb)\ ==\ starpu\_mpi\_data\_get\_rank(cellHandles[idxLevel][interactionid].symb))\{}
\DoxyCodeLine{01624\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{01625\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ mode\ =\ 1;}
\DoxyCodeLine{01626\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ starpu\_mpi\_insert\_task(MPI\_COMM\_WORLD,}
\DoxyCodeLine{01627\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \&m2l\_cl\_inout,}
\DoxyCodeLine{01628\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_VALUE,\ \&wrapperptr,\ \textcolor{keyword}{sizeof}(wrapperptr),}
\DoxyCodeLine{01629\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_VALUE,\ \&idxLevel,\ \textcolor{keyword}{sizeof}(idxLevel),}
\DoxyCodeLine{01630\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_VALUE,\ \&outsideInteractions,\ \textcolor{keyword}{sizeof}(outsideInteractions),}
\DoxyCodeLine{01631\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_VALUE,\ \&cellHandles[idxLevel][idxGroup].intervalSize,\ \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{int}),}
\DoxyCodeLine{01632\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_VALUE,\ \&mode,\ \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{int}),}
\DoxyCodeLine{01633\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \#ifdef\ SCALFMM\_STARPU\_USE\_PRIO}
\DoxyCodeLine{01634\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_PRIORITY,\ PrioClass::Controller().getInsertionPosM2LExtern(idxLevel),}
\DoxyCodeLine{01635\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \#endif}
\DoxyCodeLine{01636\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_R,\ cellHandles[idxLevel][idxGroup].symb,}
\DoxyCodeLine{01637\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (STARPU\_RW\ |\ STARPU\_COMMUTE\_IF\_SUPPORTED),\ cellHandles[idxLevel][idxGroup].down,}
\DoxyCodeLine{01638\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_R,\ cellHandles[idxLevel][interactionid].symb,}
\DoxyCodeLine{01639\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_R,\ cellHandles[idxLevel][interactionid].up,}
\DoxyCodeLine{01640\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \#ifdef\ STARPU\_USE\_TASK\_NAME}
\DoxyCodeLine{01641\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \#ifndef\ SCALFMM\_SIMGRID\_TASKNAMEPARAMS}
\DoxyCodeLine{01642\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_NAME,\ m2lOuterTaskNames[idxLevel].get(),}
\DoxyCodeLine{01643\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \#\textcolor{keywordflow}{else}}
\DoxyCodeLine{01644\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//"{}M2L\_out-\/l\_nb\_i\_nb\_i\_s}}
\DoxyCodeLine{01645\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_NAME,\ taskNames-\/>print(\textcolor{stringliteral}{"{}M2L\_out"{}},\ \textcolor{stringliteral}{"{}\%d,\ \%d,\ \%lld,\ \%d,\ \%lld,\ \%d,\ \%lld,\ \%lld,\ \%lld,\ \%lld,\ \%d\(\backslash\)n"{}},}
\DoxyCodeLine{01646\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ idxLevel,}
\DoxyCodeLine{01647\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tree-\/>getCellGroup(idxLevel,idxGroup)-\/>getNumberOfCellsInBlock(),}
\DoxyCodeLine{01648\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tree-\/>getCellGroup(idxLevel,idxGroup)-\/>getSizeOfInterval(),}
\DoxyCodeLine{01649\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tree-\/>getCellGroup(idxLevel,interactionid)-\/>getNumberOfCellsInBlock(),}
\DoxyCodeLine{01650\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tree-\/>getCellGroup(idxLevel,interactionid)-\/>getSizeOfInterval(),}
\DoxyCodeLine{01651\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ outsideInteractions-\/>size(),}
\DoxyCodeLine{01652\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tree-\/>getCellGroup(idxLevel,\ idxGroup)-\/>getStartingIndex(),}
\DoxyCodeLine{01653\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tree-\/>getCellGroup(idxLevel,\ idxGroup)-\/>getEndingIndex(),}
\DoxyCodeLine{01654\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tree-\/>getCellGroup(idxLevel,\ interactionid)-\/>getStartingIndex(),}
\DoxyCodeLine{01655\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tree-\/>getCellGroup(idxLevel,\ interactionid)-\/>getEndingIndex(),}
\DoxyCodeLine{01656\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ starpu\_mpi\_data\_get\_rank(cellHandles[idxLevel][idxGroup].down)),}
\DoxyCodeLine{01657\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \#endif}
\DoxyCodeLine{01658\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \#endif}
\DoxyCodeLine{01659\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 0);}
\DoxyCodeLine{01660\ }
\DoxyCodeLine{01661\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ mode\ =\ 2;}
\DoxyCodeLine{01662\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ starpu\_mpi\_insert\_task(MPI\_COMM\_WORLD,}
\DoxyCodeLine{01663\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \&m2l\_cl\_inout,}
\DoxyCodeLine{01664\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_VALUE,\ \&wrapperptr,\ \textcolor{keyword}{sizeof}(wrapperptr),}
\DoxyCodeLine{01665\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_VALUE,\ \&idxLevel,\ \textcolor{keyword}{sizeof}(idxLevel),}
\DoxyCodeLine{01666\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_VALUE,\ \&outsideInteractions,\ \textcolor{keyword}{sizeof}(outsideInteractions),}
\DoxyCodeLine{01667\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_VALUE,\ \&cellHandles[idxLevel][idxGroup].intervalSize,\ \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{int}),}
\DoxyCodeLine{01668\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_VALUE,\ \&mode,\ \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{int}),}
\DoxyCodeLine{01669\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \#ifdef\ SCALFMM\_STARPU\_USE\_PRIO}
\DoxyCodeLine{01670\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_PRIORITY,\ PrioClass::Controller().getInsertionPosM2LExtern(idxLevel),}
\DoxyCodeLine{01671\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \#endif}
\DoxyCodeLine{01672\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_R,\ cellHandles[idxLevel][interactionid].symb,}
\DoxyCodeLine{01673\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (STARPU\_RW\ |\ STARPU\_COMMUTE\_IF\_SUPPORTED),\ cellHandles[idxLevel][interactionid].down,}
\DoxyCodeLine{01674\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_R,\ cellHandles[idxLevel][idxGroup].symb,}
\DoxyCodeLine{01675\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_R,\ cellHandles[idxLevel][idxGroup].up,}
\DoxyCodeLine{01676\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \#ifdef\ STARPU\_USE\_TASK\_NAME}
\DoxyCodeLine{01677\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \#ifndef\ SCALFMM\_SIMGRID\_TASKNAMEPARAMS}
\DoxyCodeLine{01678\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_NAME,\ m2lOuterTaskNames[idxLevel].get(),}
\DoxyCodeLine{01679\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \#\textcolor{keywordflow}{else}}
\DoxyCodeLine{01680\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//"{}M2L\_out-\/l\_nb\_i\_nb\_i\_s"{}}}
\DoxyCodeLine{01681\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_NAME,\ taskNames-\/>print(\textcolor{stringliteral}{"{}M2L\_out"{}},\ \textcolor{stringliteral}{"{}\%d,\ \%d,\ \%lld,\ \%d,\ \%lld,\ \%d,\ \%lld,\ \%lld,\ \%lld,\ \%lld,\ \%d\(\backslash\)n"{}},}
\DoxyCodeLine{01682\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ idxLevel,}
\DoxyCodeLine{01683\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tree-\/>getCellGroup(idxLevel,idxGroup)-\/>getNumberOfCellsInBlock(),}
\DoxyCodeLine{01684\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tree-\/>getCellGroup(idxLevel,idxGroup)-\/>getSizeOfInterval(),}
\DoxyCodeLine{01685\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tree-\/>getCellGroup(idxLevel,interactionid)-\/>getNumberOfCellsInBlock(),}
\DoxyCodeLine{01686\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tree-\/>getCellGroup(idxLevel,interactionid)-\/>getSizeOfInterval(),}
\DoxyCodeLine{01687\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ outsideInteractions-\/>size(),}
\DoxyCodeLine{01688\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tree-\/>getCellGroup(idxLevel,\ interactionid)-\/>getStartingIndex(),}
\DoxyCodeLine{01689\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tree-\/>getCellGroup(idxLevel,\ interactionid)-\/>getEndingIndex(),}
\DoxyCodeLine{01690\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tree-\/>getCellGroup(idxLevel,\ idxGroup)-\/>getStartingIndex(),}
\DoxyCodeLine{01691\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tree-\/>getCellGroup(idxLevel,\ idxGroup)-\/>getEndingIndex(),}
\DoxyCodeLine{01692\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ starpu\_mpi\_data\_get\_rank(cellHandles[idxLevel][interactionid].down)),}
\DoxyCodeLine{01693\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \#endif}
\DoxyCodeLine{01694\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \#endif}
\DoxyCodeLine{01695\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 0);}
\DoxyCodeLine{01696\ }
\DoxyCodeLine{01697\ \textcolor{preprocessor}{\#ifdef\ SCALFMM\_USE\_STARPU\_EXTRACT}}
\DoxyCodeLine{01698\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01699\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\{}
\DoxyCodeLine{01700\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01701\ }
\DoxyCodeLine{01702\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Extract\ data\ from\ second\ group\ for\ the\ first\ one}}
\DoxyCodeLine{01703\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ That\ is\ copy\ B\ to\ B'}}
\DoxyCodeLine{01704\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ extractedCellBuffer.emplace\_back();}
\DoxyCodeLine{01705\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ CellExtractedHandles\&\ interactionBuffer\ =\ extractedCellBuffer.back();}
\DoxyCodeLine{01706\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ interactionBuffer.cellsToExtract\ =\ externalInteractionsAllLevelOuterIndexes[idxLevel][idxGroup][idxInteraction];}
\DoxyCodeLine{01707\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ interactionBuffer.size\ =\ tree-\/>getCellGroup(idxLevel,interactionid)-\/>extractGetSizeSymbUp(interactionBuffer.cellsToExtract);}
\DoxyCodeLine{01708\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ I\ allocate\ only\ if\ I\ will\ use\ it\ to\ extract}}
\DoxyCodeLine{01709\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(starpu\_mpi\_data\_get\_rank(cellHandles[idxLevel][interactionid].symb)\ ==\ mpi\_rank)\{}
\DoxyCodeLine{01710\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ interactionBuffer.data.reset(\textcolor{keyword}{new}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}[interactionBuffer.size]);}
\DoxyCodeLine{01711\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ FAssertLF(interactionBuffer.data);}
\DoxyCodeLine{01712\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01713\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\{}
\DoxyCodeLine{01714\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ interactionBuffer.data.reset(\textcolor{keyword}{nullptr});}
\DoxyCodeLine{01715\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01716\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ registeringNode\ =\ starpu\_mpi\_data\_get\_rank(cellHandles[idxLevel][interactionid].symb);}
\DoxyCodeLine{01717\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ where\ =\ (registeringNode\ ==\ mpi\_rank)\ ?\ STARPU\_MAIN\_RAM\ :\ -\/1;}
\DoxyCodeLine{01718\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ starpu\_variable\_data\_register(\&interactionBuffer.all,\ where,}
\DoxyCodeLine{01719\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (uintptr\_t)interactionBuffer.data.get(),\ interactionBuffer.size);}
\DoxyCodeLine{01720\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ starpu\_mpi\_data\_register(interactionBuffer.all,\ \mbox{\hyperlink{class_f_group_task_star_p_u_implicit_algorithm_ae65a567a38fa5bc2b878cdb06aff7a47}{tag}}++,\ registeringNode);}
\DoxyCodeLine{01721\ }
\DoxyCodeLine{01722\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ CellExtractedHandles*\ interactionBufferPtr\ =\ \&interactionBuffer;}
\DoxyCodeLine{01723\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ starpu\_mpi\_insert\_task(MPI\_COMM\_WORLD,}
\DoxyCodeLine{01724\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \&cell\_extract\_up,}
\DoxyCodeLine{01725\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_VALUE,\ \&interactionBufferPtr,\ \textcolor{keyword}{sizeof}(CellExtractedHandles*),}
\DoxyCodeLine{01726\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \#ifdef\ SCALFMM\_STARPU\_USE\_PRIO}
\DoxyCodeLine{01727\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_PRIORITY,\ PrioClass::Controller().getInsertionPosM2LExtern(idxLevel),}
\DoxyCodeLine{01728\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \#endif}
\DoxyCodeLine{01729\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_R,\ cellHandles[idxLevel][interactionid].symb,}
\DoxyCodeLine{01730\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_R,\ cellHandles[idxLevel][interactionid].up,}
\DoxyCodeLine{01731\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_RW,\ interactionBuffer.all,\ 0);}
\DoxyCodeLine{01732\ }
\DoxyCodeLine{01733\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Move\ to\ a\ new\ memory\ block\ that\ is\ on\ the\ same\ node\ as\ A}}
\DoxyCodeLine{01734\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ B'\ to\ B'''}}
\DoxyCodeLine{01735\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ duplicatedCellBuffer.emplace\_back();}
\DoxyCodeLine{01736\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ DuplicatedCellHandle\&\ duplicateB\ =\ duplicatedCellBuffer.back();}
\DoxyCodeLine{01737\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ duplicateB.sizeSymb\ =\ tree-\/>getCellGroup(idxLevel,interactionid)-\/>getBufferSizeInByte();}
\DoxyCodeLine{01738\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ duplicateB.sizeOther\ =\ tree-\/>getCellGroup(idxLevel,interactionid)-\/>getMultipoleBufferSizeInByte();}
\DoxyCodeLine{01739\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(starpu\_mpi\_data\_get\_rank(cellHandles[idxLevel][idxGroup].symb)\ ==\ mpi\_rank)\{}
\DoxyCodeLine{01740\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Reuse\ block\ but\ just\ to\ perform\ the\ send}}
\DoxyCodeLine{01741\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ duplicateB.dataSymbPtr.reset(\textcolor{keyword}{new}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}[duplicateB.sizeSymb]);\textcolor{comment}{//\ =\ const\_cast<unsigned\ char*>(tree-\/>getCellGroup(idxLevel,interactionid)-\/>getRawBuffer());}}
\DoxyCodeLine{01742\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ duplicateB.dataOtherPtr.reset(\textcolor{keyword}{new}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}[duplicateB.sizeOther]);\textcolor{comment}{//\ =\ reinterpret\_cast<unsigned\ char*>(tree-\/>getCellGroup(idxLevel,interactionid)-\/>getRawMultipoleBuffer());}}
\DoxyCodeLine{01743\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01744\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ duplicateB.dataSymb\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{01745\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ duplicateB.dataOther\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{01746\ }
\DoxyCodeLine{01747\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ registeringNode\ =\ starpu\_mpi\_data\_get\_rank(cellHandles[idxLevel][idxGroup].symb);}
\DoxyCodeLine{01748\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ where\ =\ (registeringNode\ ==\ mpi\_rank)\ ?\ STARPU\_MAIN\_RAM\ :\ -\/1;}
\DoxyCodeLine{01749\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ starpu\_variable\_data\_register(\&duplicateB.symb,\ where,}
\DoxyCodeLine{01750\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (uintptr\_t)duplicateB.dataSymbPtr.get(),\ duplicateB.sizeSymb);}
\DoxyCodeLine{01751\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ starpu\_mpi\_data\_register(duplicateB.symb,\ \mbox{\hyperlink{class_f_group_task_star_p_u_implicit_algorithm_ae65a567a38fa5bc2b878cdb06aff7a47}{tag}}++,\ registeringNode);}
\DoxyCodeLine{01752\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ starpu\_variable\_data\_register(\&duplicateB.other,\ where,}
\DoxyCodeLine{01753\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (uintptr\_t)duplicateB.dataOtherPtr.get(),\ duplicateB.sizeOther);}
\DoxyCodeLine{01754\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ starpu\_mpi\_data\_register(duplicateB.other,\ \mbox{\hyperlink{class_f_group_task_star_p_u_implicit_algorithm_ae65a567a38fa5bc2b878cdb06aff7a47}{tag}}++,\ registeringNode);}
\DoxyCodeLine{01755\ }
\DoxyCodeLine{01756\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}*\ ptr1\ =\ \textcolor{keyword}{const\_cast<}\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}*\textcolor{keyword}{>}(tree-\/>getCellGroup(idxLevel,interactionid)-\/>getRawBuffer());}
\DoxyCodeLine{01757\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ size1\ =\ duplicateB.sizeSymb;}
\DoxyCodeLine{01758\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}*\ ptr2\ =\ \textcolor{keyword}{reinterpret\_cast<}\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}*\textcolor{keyword}{>}(tree-\/>getCellGroup(idxLevel,interactionid)-\/>getRawMultipoleBuffer());}
\DoxyCodeLine{01759\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ size2\ =\ duplicateB.sizeOther;}
\DoxyCodeLine{01760\ }
\DoxyCodeLine{01761\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ starpu\_mpi\_insert\_task(MPI\_COMM\_WORLD,}
\DoxyCodeLine{01762\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \&cell\_insert\_up\_bis,}
\DoxyCodeLine{01763\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_VALUE,\ \&interactionBufferPtr,\ \textcolor{keyword}{sizeof}(CellExtractedHandles*),}
\DoxyCodeLine{01764\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_VALUE,\ \&ptr1,\ \textcolor{keyword}{sizeof}(ptr1),}
\DoxyCodeLine{01765\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_VALUE,\ \&size1,\ \textcolor{keyword}{sizeof}(size1),}
\DoxyCodeLine{01766\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_VALUE,\ \&ptr2,\ \textcolor{keyword}{sizeof}(ptr2),}
\DoxyCodeLine{01767\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_VALUE,\ \&size2,\ \textcolor{keyword}{sizeof}(size2),}
\DoxyCodeLine{01768\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \#ifdef\ SCALFMM\_STARPU\_USE\_PRIO}
\DoxyCodeLine{01769\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_PRIORITY,\ PrioClass::Controller().getInsertionPosM2LExtern(idxLevel),}
\DoxyCodeLine{01770\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \#endif}
\DoxyCodeLine{01771\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_R,\ interactionBuffer.all,}
\DoxyCodeLine{01772\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_RW,\ duplicateB.symb,}
\DoxyCodeLine{01773\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_RW,\ duplicateB.other,\ 0);}
\DoxyCodeLine{01774\ }
\DoxyCodeLine{01775\ }
\DoxyCodeLine{01776\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ mode\ =\ 1;}
\DoxyCodeLine{01777\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ starpu\_mpi\_insert\_task(MPI\_COMM\_WORLD,}
\DoxyCodeLine{01778\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \&m2l\_cl\_inout,}
\DoxyCodeLine{01779\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_VALUE,\ \&wrapperptr,\ \textcolor{keyword}{sizeof}(wrapperptr),}
\DoxyCodeLine{01780\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_VALUE,\ \&idxLevel,\ \textcolor{keyword}{sizeof}(idxLevel),}
\DoxyCodeLine{01781\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_VALUE,\ \&outsideInteractions,\ \textcolor{keyword}{sizeof}(outsideInteractions),}
\DoxyCodeLine{01782\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_VALUE,\ \&cellHandles[idxLevel][idxGroup].intervalSize,\ \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{int}),}
\DoxyCodeLine{01783\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_VALUE,\ \&mode,\ \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{int}),}
\DoxyCodeLine{01784\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \#ifdef\ SCALFMM\_STARPU\_USE\_PRIO}
\DoxyCodeLine{01785\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_PRIORITY,\ PrioClass::Controller().getInsertionPosM2LExtern(idxLevel),}
\DoxyCodeLine{01786\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \#endif}
\DoxyCodeLine{01787\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_R,\ cellHandles[idxLevel][idxGroup].symb,}
\DoxyCodeLine{01788\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (STARPU\_RW\ |\ STARPU\_COMMUTE\_IF\_SUPPORTED),\ cellHandles[idxLevel][idxGroup].down,}
\DoxyCodeLine{01789\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_R,\ duplicateB.symb,}
\DoxyCodeLine{01790\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_R,\ duplicateB.other,}
\DoxyCodeLine{01791\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \#ifdef\ STARPU\_USE\_TASK\_NAME}
\DoxyCodeLine{01792\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \#ifndef\ SCALFMM\_SIMGRID\_TASKNAMEPARAMS}
\DoxyCodeLine{01793\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_NAME,\ m2lOuterTaskNames[idxLevel].get(),}
\DoxyCodeLine{01794\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \#\textcolor{keywordflow}{else}}
\DoxyCodeLine{01795\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//"{}M2L\_out-\/l\_nb\_i\_nb\_i\_s}}
\DoxyCodeLine{01796\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_NAME,\ taskNames-\/>print(\textcolor{stringliteral}{"{}M2L\_out"{}},\ \textcolor{stringliteral}{"{}\%d,\ \%d,\ \%lld,\ \%d,\ \%lld,\ \%d,\ \%lld,\ \%lld,\ \%lld,\ \%lld,\ \%d\(\backslash\)n"{}},}
\DoxyCodeLine{01797\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ idxLevel,}
\DoxyCodeLine{01798\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tree-\/>getCellGroup(idxLevel,idxGroup)-\/>getNumberOfCellsInBlock(),}
\DoxyCodeLine{01799\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tree-\/>getCellGroup(idxLevel,idxGroup)-\/>getSizeOfInterval(),}
\DoxyCodeLine{01800\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tree-\/>getCellGroup(idxLevel,interactionid)-\/>getNumberOfCellsInBlock(),}
\DoxyCodeLine{01801\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tree-\/>getCellGroup(idxLevel,interactionid)-\/>getSizeOfInterval(),}
\DoxyCodeLine{01802\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ outsideInteractions-\/>size(),}
\DoxyCodeLine{01803\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tree-\/>getCellGroup(idxLevel,\ idxGroup)-\/>getStartingIndex(),}
\DoxyCodeLine{01804\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tree-\/>getCellGroup(idxLevel,\ idxGroup)-\/>getEndingIndex(),}
\DoxyCodeLine{01805\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tree-\/>getCellGroup(idxLevel,\ interactionid)-\/>getStartingIndex(),}
\DoxyCodeLine{01806\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tree-\/>getCellGroup(idxLevel,\ interactionid)-\/>getEndingIndex(),}
\DoxyCodeLine{01807\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ starpu\_mpi\_data\_get\_rank(cellHandles[idxLevel][idxGroup].down)),}
\DoxyCodeLine{01808\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \#endif}
\DoxyCodeLine{01809\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \#endif}
\DoxyCodeLine{01810\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 0);}
\DoxyCodeLine{01811\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01812\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01813\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Extract\ data\ from\ second\ group\ for\ the\ first\ one}}
\DoxyCodeLine{01814\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ That\ is\ copy\ A\ to\ A'}}
\DoxyCodeLine{01815\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ extractedCellBuffer.emplace\_back();}
\DoxyCodeLine{01816\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ CellExtractedHandles\&\ interactionBuffer\ =\ extractedCellBuffer.back();}
\DoxyCodeLine{01817\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ interactionBuffer.cellsToExtract\ =\ externalInteractionsAllLevelInnerIndexes[idxLevel][idxGroup][idxInteraction];}
\DoxyCodeLine{01818\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ interactionBuffer.size\ =\ tree-\/>getCellGroup(idxLevel,idxGroup)-\/>extractGetSizeSymbUp(interactionBuffer.cellsToExtract);}
\DoxyCodeLine{01819\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ I\ allocate\ only\ if\ I\ will\ use\ it\ to\ extract}}
\DoxyCodeLine{01820\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(starpu\_mpi\_data\_get\_rank(cellHandles[idxLevel][idxGroup].symb)\ ==\ mpi\_rank)\{}
\DoxyCodeLine{01821\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ interactionBuffer.data.reset(\textcolor{keyword}{new}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}[interactionBuffer.size]);}
\DoxyCodeLine{01822\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01823\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\{}
\DoxyCodeLine{01824\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ interactionBuffer.data.reset(\textcolor{keyword}{nullptr});}
\DoxyCodeLine{01825\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01826\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ registeringNode\ =\ starpu\_mpi\_data\_get\_rank(cellHandles[idxLevel][idxGroup].symb);}
\DoxyCodeLine{01827\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ where\ =\ (registeringNode\ ==\ mpi\_rank)\ ?\ STARPU\_MAIN\_RAM\ :\ -\/1;}
\DoxyCodeLine{01828\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ starpu\_variable\_data\_register(\&interactionBuffer.all,\ where,}
\DoxyCodeLine{01829\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (uintptr\_t)interactionBuffer.data.get(),\ interactionBuffer.size);}
\DoxyCodeLine{01830\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ starpu\_mpi\_data\_register(interactionBuffer.all,\ \mbox{\hyperlink{class_f_group_task_star_p_u_implicit_algorithm_ae65a567a38fa5bc2b878cdb06aff7a47}{tag}}++,\ registeringNode);}
\DoxyCodeLine{01831\ }
\DoxyCodeLine{01832\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ CellExtractedHandles*\ interactionBufferPtr\ =\ \&interactionBuffer;}
\DoxyCodeLine{01833\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ starpu\_mpi\_insert\_task(MPI\_COMM\_WORLD,}
\DoxyCodeLine{01834\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \&cell\_extract\_up,}
\DoxyCodeLine{01835\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_VALUE,\ \&interactionBufferPtr,\ \textcolor{keyword}{sizeof}(CellExtractedHandles*),}
\DoxyCodeLine{01836\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \#ifdef\ SCALFMM\_STARPU\_USE\_PRIO}
\DoxyCodeLine{01837\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_PRIORITY,\ PrioClass::Controller().getInsertionPosM2LExtern(idxLevel),}
\DoxyCodeLine{01838\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \#endif}
\DoxyCodeLine{01839\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_R,\ cellHandles[idxLevel][idxGroup].symb,}
\DoxyCodeLine{01840\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_R,\ cellHandles[idxLevel][idxGroup].up,}
\DoxyCodeLine{01841\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_RW,\ interactionBuffer.all,\ 0);}
\DoxyCodeLine{01842\ }
\DoxyCodeLine{01843\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Move\ to\ a\ new\ memory\ block\ that\ is\ on\ the\ same\ node\ as\ A}}
\DoxyCodeLine{01844\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ B'\ to\ B'''}}
\DoxyCodeLine{01845\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ duplicatedCellBuffer.emplace\_back();}
\DoxyCodeLine{01846\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ DuplicatedCellHandle\&\ duplicateB\ =\ duplicatedCellBuffer.back();}
\DoxyCodeLine{01847\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ duplicateB.sizeSymb\ =\ tree-\/>getCellGroup(idxLevel,idxGroup)-\/>getBufferSizeInByte();}
\DoxyCodeLine{01848\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ duplicateB.sizeOther\ =\ tree-\/>getCellGroup(idxLevel,idxGroup)-\/>getMultipoleBufferSizeInByte();}
\DoxyCodeLine{01849\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(starpu\_mpi\_data\_get\_rank(cellHandles[idxLevel][interactionid].symb)\ ==\ mpi\_rank)\{}
\DoxyCodeLine{01850\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Reuse\ block\ but\ just\ to\ perform\ the\ send}}
\DoxyCodeLine{01851\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ duplicateB.dataSymbPtr.reset(\textcolor{keyword}{new}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}[duplicateB.sizeSymb]);\textcolor{comment}{//const\_cast<unsigned\ char*>(tree-\/>getCellGroup(idxLevel,idxGroup)-\/>getRawBuffer());}}
\DoxyCodeLine{01852\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//memcpy(duplicateB.dataSymbPtr.get(),\ tree-\/>getCellGroup(idxLevel,idxGroup)-\/>getRawBuffer(),\ duplicateB.sizeSymb);}}
\DoxyCodeLine{01853\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ duplicateB.dataOtherPtr.reset(\textcolor{keyword}{new}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}[duplicateB.sizeOther]);\textcolor{comment}{//reinterpret\_cast<unsigned\ char*>(tree-\/>getCellGroup(idxLevel,idxGroup)-\/>getRawMultipoleBuffer());}}
\DoxyCodeLine{01854\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//memcpy(duplicateB.dataOtherPtr.get(),\ tree-\/>getCellGroup(idxLevel,idxGroup)-\/>getRawMultipoleBuffer(),\ duplicateB.sizeOther);}}
\DoxyCodeLine{01855\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01856\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ duplicateB.dataSymb\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{01857\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ duplicateB.dataOther\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{01858\ }
\DoxyCodeLine{01859\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ registeringNode\ =\ starpu\_mpi\_data\_get\_rank(cellHandles[idxLevel][interactionid].symb);}
\DoxyCodeLine{01860\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ where\ =\ (registeringNode\ ==\ mpi\_rank)\ ?\ STARPU\_MAIN\_RAM\ :\ -\/1;}
\DoxyCodeLine{01861\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ starpu\_variable\_data\_register(\&duplicateB.symb,\ where,}
\DoxyCodeLine{01862\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (uintptr\_t)duplicateB.dataSymbPtr.get(),\ duplicateB.sizeSymb);}
\DoxyCodeLine{01863\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ starpu\_mpi\_data\_register(duplicateB.symb,\ \mbox{\hyperlink{class_f_group_task_star_p_u_implicit_algorithm_ae65a567a38fa5bc2b878cdb06aff7a47}{tag}}++,\ registeringNode);}
\DoxyCodeLine{01864\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ starpu\_variable\_data\_register(\&duplicateB.other,\ where,}
\DoxyCodeLine{01865\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (uintptr\_t)duplicateB.dataOtherPtr.get(),\ duplicateB.sizeOther);}
\DoxyCodeLine{01866\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ starpu\_mpi\_data\_register(duplicateB.other,\ \mbox{\hyperlink{class_f_group_task_star_p_u_implicit_algorithm_ae65a567a38fa5bc2b878cdb06aff7a47}{tag}}++,\ registeringNode);}
\DoxyCodeLine{01867\ }
\DoxyCodeLine{01868\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}*\ ptr1\ =\ \textcolor{keyword}{const\_cast<}\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}*\textcolor{keyword}{>}(tree-\/>getCellGroup(idxLevel,idxGroup)-\/>getRawBuffer());}
\DoxyCodeLine{01869\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ size1\ =\ duplicateB.sizeSymb;}
\DoxyCodeLine{01870\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}*\ ptr2\ =\ \textcolor{keyword}{reinterpret\_cast<}\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}*\textcolor{keyword}{>}(tree-\/>getCellGroup(idxLevel,idxGroup)-\/>getRawMultipoleBuffer());}
\DoxyCodeLine{01871\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ size2\ =\ duplicateB.sizeOther;}
\DoxyCodeLine{01872\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ starpu\_mpi\_insert\_task(MPI\_COMM\_WORLD,}
\DoxyCodeLine{01873\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \&cell\_insert\_up\_bis,}
\DoxyCodeLine{01874\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_VALUE,\ \&interactionBufferPtr,\ \textcolor{keyword}{sizeof}(CellExtractedHandles*),}
\DoxyCodeLine{01875\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_VALUE,\ \&ptr1,\ \textcolor{keyword}{sizeof}(ptr1),}
\DoxyCodeLine{01876\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_VALUE,\ \&size1,\ \textcolor{keyword}{sizeof}(size1),}
\DoxyCodeLine{01877\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_VALUE,\ \&ptr2,\ \textcolor{keyword}{sizeof}(ptr2),}
\DoxyCodeLine{01878\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_VALUE,\ \&size2,\ \textcolor{keyword}{sizeof}(size2),}
\DoxyCodeLine{01879\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \#ifdef\ SCALFMM\_STARPU\_USE\_PRIO}
\DoxyCodeLine{01880\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_PRIORITY,\ PrioClass::Controller().getInsertionPosM2LExtern(idxLevel),}
\DoxyCodeLine{01881\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \#endif}
\DoxyCodeLine{01882\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_R,\ interactionBuffer.all,}
\DoxyCodeLine{01883\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_RW,\ duplicateB.symb,}
\DoxyCodeLine{01884\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_RW,\ duplicateB.other,\ 0);}
\DoxyCodeLine{01885\ }
\DoxyCodeLine{01886\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ mode\ =\ 2;}
\DoxyCodeLine{01887\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ starpu\_mpi\_insert\_task(MPI\_COMM\_WORLD,}
\DoxyCodeLine{01888\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \&m2l\_cl\_inout,}
\DoxyCodeLine{01889\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_VALUE,\ \&wrapperptr,\ \textcolor{keyword}{sizeof}(wrapperptr),}
\DoxyCodeLine{01890\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_VALUE,\ \&idxLevel,\ \textcolor{keyword}{sizeof}(idxLevel),}
\DoxyCodeLine{01891\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_VALUE,\ \&outsideInteractions,\ \textcolor{keyword}{sizeof}(outsideInteractions),}
\DoxyCodeLine{01892\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_VALUE,\ \&cellHandles[idxLevel][idxGroup].intervalSize,\ \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{int}),}
\DoxyCodeLine{01893\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_VALUE,\ \&mode,\ \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{int}),}
\DoxyCodeLine{01894\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \#ifdef\ SCALFMM\_STARPU\_USE\_PRIO}
\DoxyCodeLine{01895\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_PRIORITY,\ PrioClass::Controller().getInsertionPosM2LExtern(idxLevel),}
\DoxyCodeLine{01896\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \#endif}
\DoxyCodeLine{01897\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_R,\ cellHandles[idxLevel][interactionid].symb,}
\DoxyCodeLine{01898\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (STARPU\_RW\ |\ STARPU\_COMMUTE\_IF\_SUPPORTED),\ cellHandles[idxLevel][interactionid].down,}
\DoxyCodeLine{01899\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_R,\ duplicateB.symb,}
\DoxyCodeLine{01900\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_R,\ duplicateB.other,}
\DoxyCodeLine{01901\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \#ifdef\ STARPU\_USE\_TASK\_NAME}
\DoxyCodeLine{01902\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \#ifndef\ SCALFMM\_SIMGRID\_TASKNAMEPARAMS}
\DoxyCodeLine{01903\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_NAME,\ m2lOuterTaskNames[idxLevel].get(),}
\DoxyCodeLine{01904\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \#\textcolor{keywordflow}{else}}
\DoxyCodeLine{01905\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//"{}M2L\_out-\/l\_nb\_i\_nb\_i\_s"{}}}
\DoxyCodeLine{01906\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_NAME,\ taskNames-\/>print(\textcolor{stringliteral}{"{}M2L\_out"{}},\ \textcolor{stringliteral}{"{}\%d,\ \%d,\ \%lld,\ \%d,\ \%lld,\ \%d,\ \%lld,\ \%lld,\ \%lld,\ \%lld,\ \%d\(\backslash\)n"{}},}
\DoxyCodeLine{01907\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ idxLevel,}
\DoxyCodeLine{01908\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tree-\/>getCellGroup(idxLevel,idxGroup)-\/>getNumberOfCellsInBlock(),}
\DoxyCodeLine{01909\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tree-\/>getCellGroup(idxLevel,idxGroup)-\/>getSizeOfInterval(),}
\DoxyCodeLine{01910\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tree-\/>getCellGroup(idxLevel,interactionid)-\/>getNumberOfCellsInBlock(),}
\DoxyCodeLine{01911\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tree-\/>getCellGroup(idxLevel,interactionid)-\/>getSizeOfInterval(),}
\DoxyCodeLine{01912\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ outsideInteractions-\/>size(),}
\DoxyCodeLine{01913\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tree-\/>getCellGroup(idxLevel,\ interactionid)-\/>getStartingIndex(),}
\DoxyCodeLine{01914\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tree-\/>getCellGroup(idxLevel,\ interactionid)-\/>getEndingIndex(),}
\DoxyCodeLine{01915\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tree-\/>getCellGroup(idxLevel,\ idxGroup)-\/>getStartingIndex(),}
\DoxyCodeLine{01916\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tree-\/>getCellGroup(idxLevel,\ idxGroup)-\/>getEndingIndex(),}
\DoxyCodeLine{01917\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ starpu\_mpi\_data\_get\_rank(cellHandles[idxLevel][interactionid].down)),}
\DoxyCodeLine{01918\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \#endif}
\DoxyCodeLine{01919\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \#endif}
\DoxyCodeLine{01920\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 0);}
\DoxyCodeLine{01921\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01922\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01923\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{01924\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01925\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01926\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ FLOG(\ timerOutBlock.tac()\ );}
\DoxyCodeLine{01927\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01928\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01929\ \ \ \ \ \ \ \ \ FLOG(\ FLog::Controller\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)t\(\backslash\)t\ transferPass\ in\ "{}}\ <<\ timer.tacAndElapsed()\ <<\ \textcolor{stringliteral}{"{}s\(\backslash\)n"{}}\ );}
\DoxyCodeLine{01930\ \ \ \ \ \ \ \ \ FLOG(\ FLog::Controller\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)t\(\backslash\)t\(\backslash\)t\ inblock\ in\ \ "{}}\ <<\ timerInBlock.elapsed()\ <<\ \textcolor{stringliteral}{"{}s\(\backslash\)n"{}}\ );}
\DoxyCodeLine{01931\ \ \ \ \ \ \ \ \ FLOG(\ FLog::Controller\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)t\(\backslash\)t\(\backslash\)t\ outblock\ in\ "{}}\ <<\ timerOutBlock.elapsed()\ <<\ \textcolor{stringliteral}{"{}s\(\backslash\)n"{}}\ );}
\DoxyCodeLine{01932\ \ \ \ \ \}}
\DoxyCodeLine{01933\ }
\DoxyCodeLine{01937\ }
\DoxyCodeLine{01938\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_f_group_task_star_p_u_implicit_algorithm_a44c6a6655a4038a2b3223795b2227c2f}{downardPass}}()\{}
\DoxyCodeLine{01939\ \ \ \ \ \ \ \ \ FLOG(\ \mbox{\hyperlink{class_f_tic}{FTic}}\ timer;\ );}
\DoxyCodeLine{01940\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ idxLevel\ =\ \mbox{\hyperlink{class_f_abstract_algorithm_ade49cb5ede82d078261e576a9d809dc2}{FAbstractAlgorithm::upperWorkingLevel}}\ ;\ idxLevel\ <\ \mbox{\hyperlink{class_f_abstract_algorithm_a694b8888186be58e38691ce08b177d46}{FAbstractAlgorithm::lowerWorkingLevel}}\ -\/\ 1\ ;\ ++idxLevel)\{}
\DoxyCodeLine{01941\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ idxSubGroup\ =\ 0;}
\DoxyCodeLine{01942\ }
\DoxyCodeLine{01943\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ idxGroup\ =\ 0\ ;\ idxGroup\ <\ tree-\/>getNbCellGroupAtLevel(idxLevel)\ ;\ ++idxGroup)\{}
\DoxyCodeLine{01944\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ CellContainerClass*\textcolor{keyword}{const}\ currentCells\ =\ tree-\/>getCellGroup(idxLevel,\ idxGroup);}
\DoxyCodeLine{01945\ }
\DoxyCodeLine{01946\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Skip\ current\ group\ if\ needed}}
\DoxyCodeLine{01947\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\ tree-\/>getCellGroup(idxLevel+1,\ idxSubGroup)-\/>getEndingIndex()\ <=\ (currentCells-\/>getStartingIndex()<<3)\ )\{}
\DoxyCodeLine{01948\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ++idxSubGroup;}
\DoxyCodeLine{01949\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ FAssertLF(\ idxSubGroup\ !=\ tree-\/>getNbCellGroupAtLevel(idxLevel+1)\ );}
\DoxyCodeLine{01950\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ FAssertLF(\ (tree-\/>getCellGroup(idxLevel+1,\ idxSubGroup)-\/>getStartingIndex()>>3)\ ==\ currentCells-\/>getStartingIndex()\ );}
\DoxyCodeLine{01951\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01952\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Copy\ at\ max\ 8\ groups}}
\DoxyCodeLine{01953\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01954\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ put\ the\ right\ codelet}}
\DoxyCodeLine{01955\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}((noCommuteAtLastLevel\ \&\&\ (idxLevel\ ==\ \mbox{\hyperlink{class_f_abstract_algorithm_a694b8888186be58e38691ce08b177d46}{FAbstractAlgorithm::lowerWorkingLevel}}\ -\/\ 2))\ ||\ noCommuteBetweenLevel)\{}
\DoxyCodeLine{01956\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ starpu\_mpi\_insert\_task(MPI\_COMM\_WORLD,}
\DoxyCodeLine{01957\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \&l2l\_cl\_nocommute,}
\DoxyCodeLine{01958\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_VALUE,\ \&wrapperptr,\ \textcolor{keyword}{sizeof}(wrapperptr),}
\DoxyCodeLine{01959\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_VALUE,\ \&idxLevel,\ \textcolor{keyword}{sizeof}(idxLevel),}
\DoxyCodeLine{01960\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_VALUE,\ \&cellHandles[idxLevel][idxGroup].intervalSize,\ \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{int}),}
\DoxyCodeLine{01961\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \#ifdef\ SCALFMM\_STARPU\_USE\_PRIO}
\DoxyCodeLine{01962\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_PRIORITY,\ PrioClass::Controller().getInsertionPosL2L(idxLevel),}
\DoxyCodeLine{01963\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \#endif}
\DoxyCodeLine{01964\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_R,\ cellHandles[idxLevel][idxGroup].symb,\ \textcolor{comment}{//symbolique,\ readonly}}
\DoxyCodeLine{01965\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_R,\ cellHandles[idxLevel][idxGroup].down,\ \textcolor{comment}{//The\ remaining,\ read/write}}
\DoxyCodeLine{01966\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_R,\ cellHandles[idxLevel+1][idxSubGroup].symb,\ \textcolor{comment}{//symbolique,\ readonly}}
\DoxyCodeLine{01967\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_RW,\ cellHandles[idxLevel+1][idxSubGroup].down,\ \textcolor{comment}{//level\ d'avant\ readonly}}
\DoxyCodeLine{01968\ \ \ \ \ \ \ \ \ \#ifdef\ STARPU\_USE\_TASK\_NAME}
\DoxyCodeLine{01969\ \ \ \ \ \ \ \ \ \#ifndef\ SCALFMM\_SIMGRID\_TASKNAMEPARAMS}
\DoxyCodeLine{01970\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_NAME,\ l2lTaskNames[idxLevel].get(),}
\DoxyCodeLine{01971\ \ \ \ \ \ \ \ \ \#\textcolor{keywordflow}{else}}
\DoxyCodeLine{01972\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//"{}L2L-\/l\_nb\_i\_nbc\_ic\_s"{}}}
\DoxyCodeLine{01973\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_NAME,\ taskNames-\/>print(\textcolor{stringliteral}{"{}L2L"{}},\ \textcolor{stringliteral}{"{}\%d,\ \%d,\ \%lld,\ \%d,\ \%lld,\ \%lld,\ \%lld,\ \%lld,\ \%lld,\ \%lld,\ \%d\(\backslash\)n"{}},}
\DoxyCodeLine{01974\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ idxLevel,}
\DoxyCodeLine{01975\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tree-\/>getCellGroup(idxLevel,idxGroup)-\/>getNumberOfCellsInBlock(),}
\DoxyCodeLine{01976\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tree-\/>getCellGroup(idxLevel,idxGroup)-\/>getSizeOfInterval(),}
\DoxyCodeLine{01977\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tree-\/>getCellGroup(idxLevel+1,idxSubGroup)-\/>getNumberOfCellsInBlock(),}
\DoxyCodeLine{01978\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tree-\/>getCellGroup(idxLevel+1,idxSubGroup)-\/>getSizeOfInterval(),}
\DoxyCodeLine{01979\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{struct_f_math_a43635af3d44bb1868015681ce994df7b}{FMath::Min}}(tree-\/>getCellGroup(idxLevel,idxGroup)-\/>getEndingIndex()-\/1,\ (tree-\/>getCellGroup(idxLevel+1,idxSubGroup)-\/>getEndingIndex()-\/1)>>3)-\/}
\DoxyCodeLine{01980\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{struct_f_math_ada359f2b021ce4b999c0fd7a6e9daae6}{FMath::Max}}(tree-\/>getCellGroup(idxLevel,idxGroup)-\/>getStartingIndex(),\ tree-\/>getCellGroup(idxLevel+1,idxSubGroup)-\/>getStartingIndex()>>3),}
\DoxyCodeLine{01981\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tree-\/>getCellGroup(idxLevel,\ idxGroup)-\/>getStartingIndex(),}
\DoxyCodeLine{01982\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tree-\/>getCellGroup(idxLevel,\ idxGroup)-\/>getEndingIndex(),}
\DoxyCodeLine{01983\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tree-\/>getCellGroup(idxLevel+1,\ idxSubGroup)-\/>getStartingIndex(),}
\DoxyCodeLine{01984\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tree-\/>getCellGroup(idxLevel+1,\ idxSubGroup)-\/>getEndingIndex(),}
\DoxyCodeLine{01985\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ starpu\_mpi\_data\_get\_rank(cellHandles[idxLevel+1][idxSubGroup].down)),}
\DoxyCodeLine{01986\ \ \ \ \ \ \ \ \ \#endif}
\DoxyCodeLine{01987\ \ \ \ \ \ \ \ \ \#endif}
\DoxyCodeLine{01988\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 0);}
\DoxyCodeLine{01989\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01990\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\{}
\DoxyCodeLine{01991\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ starpu\_mpi\_insert\_task(MPI\_COMM\_WORLD,}
\DoxyCodeLine{01992\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \&l2l\_cl,}
\DoxyCodeLine{01993\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_VALUE,\ \&wrapperptr,\ \textcolor{keyword}{sizeof}(wrapperptr),}
\DoxyCodeLine{01994\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_VALUE,\ \&idxLevel,\ \textcolor{keyword}{sizeof}(idxLevel),}
\DoxyCodeLine{01995\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_VALUE,\ \&cellHandles[idxLevel][idxGroup].intervalSize,\ \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{int}),}
\DoxyCodeLine{01996\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \#ifdef\ SCALFMM\_STARPU\_USE\_PRIO}
\DoxyCodeLine{01997\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_PRIORITY,\ PrioClass::Controller().getInsertionPosL2L(idxLevel),}
\DoxyCodeLine{01998\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \#endif}
\DoxyCodeLine{01999\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_R,\ cellHandles[idxLevel][idxGroup].symb,\ \textcolor{comment}{//symbolique,\ readonly}}
\DoxyCodeLine{02000\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_R,\ cellHandles[idxLevel][idxGroup].down,\ \textcolor{comment}{//The\ remaining,\ read/write}}
\DoxyCodeLine{02001\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_R,\ cellHandles[idxLevel+1][idxSubGroup].symb,\ \textcolor{comment}{//symbolique,\ readonly}}
\DoxyCodeLine{02002\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (STARPU\_RW\ |\ STARPU\_COMMUTE\_IF\_SUPPORTED),\ cellHandles[idxLevel+1][idxSubGroup].down,\ \textcolor{comment}{//level\ d'avant\ readonly}}
\DoxyCodeLine{02003\ \ \ \ \ \ \ \ \ \#ifdef\ STARPU\_USE\_TASK\_NAME}
\DoxyCodeLine{02004\ \ \ \ \ \ \ \ \ \#ifndef\ SCALFMM\_SIMGRID\_TASKNAMEPARAMS}
\DoxyCodeLine{02005\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_NAME,\ l2lTaskNames[idxLevel].get(),}
\DoxyCodeLine{02006\ \ \ \ \ \ \ \ \ \#\textcolor{keywordflow}{else}}
\DoxyCodeLine{02007\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//"{}L2L-\/l\_nb\_i\_nbc\_ic\_s"{}}}
\DoxyCodeLine{02008\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_NAME,\ taskNames-\/>print(\textcolor{stringliteral}{"{}L2L"{}},\ \textcolor{stringliteral}{"{}\%d,\ \%d,\ \%lld,\ \%d,\ \%lld,\ \%lld,\ \%lld,\ \%lld,\ \%lld,\ \%lld,\ \%d\(\backslash\)n"{}},}
\DoxyCodeLine{02009\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ idxLevel,}
\DoxyCodeLine{02010\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tree-\/>getCellGroup(idxLevel,idxGroup)-\/>getNumberOfCellsInBlock(),}
\DoxyCodeLine{02011\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tree-\/>getCellGroup(idxLevel,idxGroup)-\/>getSizeOfInterval(),}
\DoxyCodeLine{02012\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tree-\/>getCellGroup(idxLevel+1,idxSubGroup)-\/>getNumberOfCellsInBlock(),}
\DoxyCodeLine{02013\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tree-\/>getCellGroup(idxLevel+1,idxSubGroup)-\/>getSizeOfInterval(),}
\DoxyCodeLine{02014\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{struct_f_math_a43635af3d44bb1868015681ce994df7b}{FMath::Min}}(tree-\/>getCellGroup(idxLevel,idxGroup)-\/>getEndingIndex()-\/1,\ (tree-\/>getCellGroup(idxLevel+1,idxSubGroup)-\/>getEndingIndex()-\/1)>>3)-\/}
\DoxyCodeLine{02015\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{struct_f_math_ada359f2b021ce4b999c0fd7a6e9daae6}{FMath::Max}}(tree-\/>getCellGroup(idxLevel,idxGroup)-\/>getStartingIndex(),\ tree-\/>getCellGroup(idxLevel+1,idxSubGroup)-\/>getStartingIndex()>>3),}
\DoxyCodeLine{02016\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tree-\/>getCellGroup(idxLevel,\ idxGroup)-\/>getStartingIndex(),}
\DoxyCodeLine{02017\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tree-\/>getCellGroup(idxLevel,\ idxGroup)-\/>getEndingIndex(),}
\DoxyCodeLine{02018\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tree-\/>getCellGroup(idxLevel+1,\ idxSubGroup)-\/>getStartingIndex(),}
\DoxyCodeLine{02019\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tree-\/>getCellGroup(idxLevel+1,\ idxSubGroup)-\/>getEndingIndex(),}
\DoxyCodeLine{02020\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ starpu\_mpi\_data\_get\_rank(cellHandles[idxLevel+1][idxSubGroup].down)),}
\DoxyCodeLine{02021\ \ \ \ \ \ \ \ \ \#endif}
\DoxyCodeLine{02022\ \ \ \ \ \ \ \ \ \#endif}
\DoxyCodeLine{02023\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 0);}
\DoxyCodeLine{02024\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02025\ }
\DoxyCodeLine{02026\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02027\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{while}(tree-\/>getCellGroup(idxLevel+1,\ idxSubGroup)-\/>getEndingIndex()\ <=\ (((currentCells-\/>getEndingIndex()-\/1)<<3)+7)}
\DoxyCodeLine{02028\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \&\&\ (idxSubGroup+1)\ !=\ tree-\/>getNbCellGroupAtLevel(idxLevel+1)}
\DoxyCodeLine{02029\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \&\&\ tree-\/>getCellGroup(idxLevel+1,\ idxSubGroup+1)-\/>getStartingIndex()\ <=\ ((currentCells-\/>getEndingIndex()-\/1)<<3)+7\ )\{}
\DoxyCodeLine{02030\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ idxSubGroup\ +=\ 1;}
\DoxyCodeLine{02031\ }
\DoxyCodeLine{02032\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ put\ the\ right\ codelet}}
\DoxyCodeLine{02033\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}((noCommuteAtLastLevel\ \&\&\ (idxLevel\ ==\ \mbox{\hyperlink{class_f_abstract_algorithm_a694b8888186be58e38691ce08b177d46}{FAbstractAlgorithm::lowerWorkingLevel}}\ -\/\ 2))\ ||\ noCommuteBetweenLevel)\{}
\DoxyCodeLine{02034\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ starpu\_mpi\_insert\_task(MPI\_COMM\_WORLD,}
\DoxyCodeLine{02035\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \&l2l\_cl\_nocommute,}
\DoxyCodeLine{02036\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_VALUE,\ \&wrapperptr,\ \textcolor{keyword}{sizeof}(wrapperptr),}
\DoxyCodeLine{02037\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_VALUE,\ \&idxLevel,\ \textcolor{keyword}{sizeof}(idxLevel),}
\DoxyCodeLine{02038\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_VALUE,\ \&cellHandles[idxLevel][idxGroup].intervalSize,\ \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{int}),}
\DoxyCodeLine{02039\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \#ifdef\ SCALFMM\_STARPU\_USE\_PRIO}
\DoxyCodeLine{02040\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_PRIORITY,\ PrioClass::Controller().getInsertionPosL2L(idxLevel),}
\DoxyCodeLine{02041\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \#endif}
\DoxyCodeLine{02042\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_R,\ cellHandles[idxLevel][idxGroup].symb,\ \textcolor{comment}{//symbolique,\ readonly}}
\DoxyCodeLine{02043\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_R,\ cellHandles[idxLevel][idxGroup].down,\ \textcolor{comment}{//The\ remaining,\ read/write}}
\DoxyCodeLine{02044\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_R,\ cellHandles[idxLevel+1][idxSubGroup].symb,\ \textcolor{comment}{//symbolique,\ readonly}}
\DoxyCodeLine{02045\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_RW,\ cellHandles[idxLevel+1][idxSubGroup].down,\ \textcolor{comment}{//level\ d'avant\ readonly}}
\DoxyCodeLine{02046\ \ \ \ \ \ \ \ \ \#ifdef\ STARPU\_USE\_TASK\_NAME}
\DoxyCodeLine{02047\ \ \ \ \ \ \ \ \ \#ifndef\ SCALFMM\_SIMGRID\_TASKNAMEPARAMS}
\DoxyCodeLine{02048\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_NAME,\ l2lTaskNames[idxLevel].get(),}
\DoxyCodeLine{02049\ \ \ \ \ \ \ \ \ \#\textcolor{keywordflow}{else}}
\DoxyCodeLine{02050\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//"{}L2L-\/l\_nb\_i\_nbc\_ic\_s"{}}}
\DoxyCodeLine{02051\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_NAME,\ taskNames-\/>print(\textcolor{stringliteral}{"{}L2L"{}},\ \textcolor{stringliteral}{"{}\%d,\ \%d,\ \%lld,\ \%d,\ \%lld,\ \%lld,\ \%lld,\ \%lld,\ \%lld,\ \%lld,\ \%d\(\backslash\)n"{}},}
\DoxyCodeLine{02052\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ idxLevel,}
\DoxyCodeLine{02053\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tree-\/>getCellGroup(idxLevel,idxGroup)-\/>getNumberOfCellsInBlock(),}
\DoxyCodeLine{02054\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tree-\/>getCellGroup(idxLevel,idxGroup)-\/>getSizeOfInterval(),}
\DoxyCodeLine{02055\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tree-\/>getCellGroup(idxLevel+1,idxSubGroup)-\/>getNumberOfCellsInBlock(),}
\DoxyCodeLine{02056\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tree-\/>getCellGroup(idxLevel+1,idxSubGroup)-\/>getSizeOfInterval(),}
\DoxyCodeLine{02057\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{struct_f_math_a43635af3d44bb1868015681ce994df7b}{FMath::Min}}(tree-\/>getCellGroup(idxLevel,idxGroup)-\/>getEndingIndex()-\/1,\ (tree-\/>getCellGroup(idxLevel+1,idxSubGroup)-\/>getEndingIndex()-\/1)>>3)-\/}
\DoxyCodeLine{02058\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{struct_f_math_ada359f2b021ce4b999c0fd7a6e9daae6}{FMath::Max}}(tree-\/>getCellGroup(idxLevel,idxGroup)-\/>getStartingIndex(),\ tree-\/>getCellGroup(idxLevel+1,idxSubGroup)-\/>getStartingIndex()>>3),}
\DoxyCodeLine{02059\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tree-\/>getCellGroup(idxLevel,\ idxGroup)-\/>getStartingIndex(),}
\DoxyCodeLine{02060\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tree-\/>getCellGroup(idxLevel,\ idxGroup)-\/>getEndingIndex(),}
\DoxyCodeLine{02061\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tree-\/>getCellGroup(idxLevel+1,\ idxSubGroup)-\/>getStartingIndex(),}
\DoxyCodeLine{02062\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tree-\/>getCellGroup(idxLevel+1,\ idxSubGroup)-\/>getEndingIndex(),}
\DoxyCodeLine{02063\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ starpu\_mpi\_data\_get\_rank(cellHandles[idxLevel+1][idxSubGroup].down)),}
\DoxyCodeLine{02064\ \ \ \ \ \ \ \ \ \#endif}
\DoxyCodeLine{02065\ \ \ \ \ \ \ \ \ \#endif}
\DoxyCodeLine{02066\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 0);}
\DoxyCodeLine{02067\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02068\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\{}
\DoxyCodeLine{02069\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ starpu\_mpi\_insert\_task(MPI\_COMM\_WORLD,}
\DoxyCodeLine{02070\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \&l2l\_cl,}
\DoxyCodeLine{02071\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_VALUE,\ \&wrapperptr,\ \textcolor{keyword}{sizeof}(wrapperptr),}
\DoxyCodeLine{02072\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_VALUE,\ \&idxLevel,\ \textcolor{keyword}{sizeof}(idxLevel),}
\DoxyCodeLine{02073\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_VALUE,\ \&cellHandles[idxLevel][idxGroup].intervalSize,\ \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{int}),}
\DoxyCodeLine{02074\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \#ifdef\ SCALFMM\_STARPU\_USE\_PRIO}
\DoxyCodeLine{02075\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_PRIORITY,\ PrioClass::Controller().getInsertionPosL2L(idxLevel),}
\DoxyCodeLine{02076\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \#endif}
\DoxyCodeLine{02077\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_R,\ cellHandles[idxLevel][idxGroup].symb,\ \textcolor{comment}{//symbolique,\ readonly}}
\DoxyCodeLine{02078\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_R,\ cellHandles[idxLevel][idxGroup].down,\ \textcolor{comment}{//The\ remaining,\ read/write}}
\DoxyCodeLine{02079\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_R,\ cellHandles[idxLevel+1][idxSubGroup].symb,\ \textcolor{comment}{//symbolique,\ readonly}}
\DoxyCodeLine{02080\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (STARPU\_RW\ |\ STARPU\_COMMUTE\_IF\_SUPPORTED),\ cellHandles[idxLevel+1][idxSubGroup].down,\ \textcolor{comment}{//level\ d'avant\ readonly}}
\DoxyCodeLine{02081\ \ \ \ \ \ \ \ \ \#ifdef\ STARPU\_USE\_TASK\_NAME}
\DoxyCodeLine{02082\ \ \ \ \ \ \ \ \ \#ifndef\ SCALFMM\_SIMGRID\_TASKNAMEPARAMS}
\DoxyCodeLine{02083\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_NAME,\ l2lTaskNames[idxLevel].get(),}
\DoxyCodeLine{02084\ \ \ \ \ \ \ \ \ \#\textcolor{keywordflow}{else}}
\DoxyCodeLine{02085\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//"{}L2L-\/l\_nb\_i\_nbc\_ic\_s"{}}}
\DoxyCodeLine{02086\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_NAME,\ taskNames-\/>print(\textcolor{stringliteral}{"{}L2L"{}},\ \textcolor{stringliteral}{"{}\%d,\ \%d,\ \%lld,\ \%d,\ \%lld,\ \%lld,\ \%lld,\ \%lld,\ \%lld,\ \%lld,\ \%d\(\backslash\)n"{}},}
\DoxyCodeLine{02087\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ idxLevel,}
\DoxyCodeLine{02088\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tree-\/>getCellGroup(idxLevel,idxGroup)-\/>getNumberOfCellsInBlock(),}
\DoxyCodeLine{02089\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tree-\/>getCellGroup(idxLevel,idxGroup)-\/>getSizeOfInterval(),}
\DoxyCodeLine{02090\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tree-\/>getCellGroup(idxLevel+1,idxSubGroup)-\/>getNumberOfCellsInBlock(),}
\DoxyCodeLine{02091\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tree-\/>getCellGroup(idxLevel+1,idxSubGroup)-\/>getSizeOfInterval(),}
\DoxyCodeLine{02092\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{struct_f_math_a43635af3d44bb1868015681ce994df7b}{FMath::Min}}(tree-\/>getCellGroup(idxLevel,idxGroup)-\/>getEndingIndex()-\/1,\ (tree-\/>getCellGroup(idxLevel+1,idxSubGroup)-\/>getEndingIndex()-\/1)>>3)-\/}
\DoxyCodeLine{02093\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{struct_f_math_ada359f2b021ce4b999c0fd7a6e9daae6}{FMath::Max}}(tree-\/>getCellGroup(idxLevel,idxGroup)-\/>getStartingIndex(),\ tree-\/>getCellGroup(idxLevel+1,idxSubGroup)-\/>getStartingIndex()>>3),}
\DoxyCodeLine{02094\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tree-\/>getCellGroup(idxLevel,\ idxGroup)-\/>getStartingIndex(),}
\DoxyCodeLine{02095\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tree-\/>getCellGroup(idxLevel,\ idxGroup)-\/>getEndingIndex(),}
\DoxyCodeLine{02096\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tree-\/>getCellGroup(idxLevel+1,\ idxSubGroup)-\/>getStartingIndex(),}
\DoxyCodeLine{02097\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tree-\/>getCellGroup(idxLevel+1,\ idxSubGroup)-\/>getEndingIndex(),}
\DoxyCodeLine{02098\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ starpu\_mpi\_data\_get\_rank(cellHandles[idxLevel+1][idxSubGroup].down)),}
\DoxyCodeLine{02099\ \ \ \ \ \ \ \ \ \#endif}
\DoxyCodeLine{02100\ \ \ \ \ \ \ \ \ \#endif}
\DoxyCodeLine{02101\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 0);}
\DoxyCodeLine{02102\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02103\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02104\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02105\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02106\ \ \ \ \ \ \ \ \ FLOG(\ FLog::Controller\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)t\(\backslash\)t\ downardPass\ in\ "{}}\ <<\ timer.tacAndElapsed()\ <<\ \textcolor{stringliteral}{"{}s\(\backslash\)n"{}}\ );}
\DoxyCodeLine{02107\ \ \ \ \ \}}
\DoxyCodeLine{02108\ }
\DoxyCodeLine{02112\ }
\DoxyCodeLine{02113\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_f_group_task_star_p_u_implicit_algorithm_a9678bd9990abfcda33d670294d3f1b6c}{directPass}}()\{}
\DoxyCodeLine{02114\ \ \ \ \ \ \ \ \ FLOG(\ \mbox{\hyperlink{class_f_tic}{FTic}}\ timer;\ );}
\DoxyCodeLine{02115\ \ \ \ \ \ \ \ \ FLOG(\ \mbox{\hyperlink{class_f_tic}{FTic}}\ timerInBlock;\ \mbox{\hyperlink{class_f_tic}{FTic}}\ timerOutBlock;\ );}
\DoxyCodeLine{02116\ }
\DoxyCodeLine{02117\ \ \ \ \ \ \ \ \ FLOG(\ timerOutBlock.tic()\ );}
\DoxyCodeLine{02118\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ idxGroup\ =\ 0\ ;\ idxGroup\ <\ tree-\/>getNbParticleGroup()\ ;\ ++idxGroup)\{}
\DoxyCodeLine{02119\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ idxInteraction\ =\ 0;\ idxInteraction\ <\ int(externalInteractionsLeafLevel[idxGroup].size())\ ;\ ++idxInteraction)\{}
\DoxyCodeLine{02120\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ interactionid\ =\ externalInteractionsLeafLevel[idxGroup][idxInteraction].otherBlockId;}
\DoxyCodeLine{02121\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::vector<OutOfBlockInteraction>*\ outsideInteractions\ =\ \&externalInteractionsLeafLevel[idxGroup][idxInteraction].interactions;}
\DoxyCodeLine{02122\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(starpu\_mpi\_data\_get\_rank(particleHandles[idxGroup].down)\ ==\ starpu\_mpi\_data\_get\_rank(particleHandles[interactionid].down))}
\DoxyCodeLine{02123\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02124\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ starpu\_mpi\_insert\_task(MPI\_COMM\_WORLD,}
\DoxyCodeLine{02125\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \&p2p\_cl\_inout,}
\DoxyCodeLine{02126\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_VALUE,\ \&wrapperptr,\ \textcolor{keyword}{sizeof}(wrapperptr),}
\DoxyCodeLine{02127\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_VALUE,\ \&outsideInteractions,\ \textcolor{keyword}{sizeof}(outsideInteractions),}
\DoxyCodeLine{02128\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_VALUE,\ \&particleHandles[idxGroup].intervalSize,\ \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{int}),}
\DoxyCodeLine{02129\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \#ifdef\ SCALFMM\_STARPU\_USE\_PRIO}
\DoxyCodeLine{02130\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_PRIORITY,\ PrioClass::Controller().getInsertionPosP2PExtern(),}
\DoxyCodeLine{02131\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \#endif}
\DoxyCodeLine{02132\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_R,\ particleHandles[idxGroup].symb,}
\DoxyCodeLine{02133\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \#ifdef\ STARPU\_USE\_REDUX}
\DoxyCodeLine{02134\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_REDUX,\ particleHandles[idxGroup].down,}
\DoxyCodeLine{02135\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \#\textcolor{keywordflow}{else}}
\DoxyCodeLine{02136\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (STARPU\_RW\ |\ STARPU\_COMMUTE\_IF\_SUPPORTED),\ particleHandles[idxGroup].down,}
\DoxyCodeLine{02137\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \#endif}
\DoxyCodeLine{02138\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_R,\ particleHandles[interactionid].symb,}
\DoxyCodeLine{02139\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \#ifdef\ STARPU\_USE\_REDUX}
\DoxyCodeLine{02140\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_REDUX,\ particleHandles[interactionid].down,}
\DoxyCodeLine{02141\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \#\textcolor{keywordflow}{else}}
\DoxyCodeLine{02142\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (STARPU\_RW\ |\ STARPU\_COMMUTE\_IF\_SUPPORTED),\ particleHandles[interactionid].down,}
\DoxyCodeLine{02143\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_EXECUTE\_ON\_DATA,\ particleHandles[interactionid].down,}
\DoxyCodeLine{02144\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \#endif}
\DoxyCodeLine{02145\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \#ifdef\ STARPU\_USE\_TASK\_NAME}
\DoxyCodeLine{02146\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \#ifndef\ SCALFMM\_SIMGRID\_TASKNAMEPARAMS}
\DoxyCodeLine{02147\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_NAME,\ p2pOuterTaskNames.get(),}
\DoxyCodeLine{02148\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \#\textcolor{keywordflow}{else}}
\DoxyCodeLine{02149\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//"{}P2P\_out-\/nb\_i\_p\_nb\_i\_p\_s"{}}}
\DoxyCodeLine{02150\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_NAME,\ taskNames-\/>print(\textcolor{stringliteral}{"{}P2P\_out"{}},\ \textcolor{stringliteral}{"{}\%d,\ \%lld,\ \%lld,\ \%d,\ \%lld,\ \%lld,\ \%d,\ \%lld,\ \%lld,\ \%lld,\ \%lld,\ \%d\(\backslash\)n"{}},}
\DoxyCodeLine{02151\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tree-\/>getParticleGroup(idxGroup)-\/>getNumberOfLeavesInBlock(),}
\DoxyCodeLine{02152\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tree-\/>getParticleGroup(idxGroup)-\/>getSizeOfInterval(),}
\DoxyCodeLine{02153\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tree-\/>getParticleGroup(idxGroup)-\/>getNbParticlesInGroup(),}
\DoxyCodeLine{02154\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tree-\/>getParticleGroup(interactionid)-\/>getNumberOfLeavesInBlock(),}
\DoxyCodeLine{02155\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tree-\/>getParticleGroup(interactionid)-\/>getSizeOfInterval(),}
\DoxyCodeLine{02156\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tree-\/>getParticleGroup(interactionid)-\/>getNbParticlesInGroup(),}
\DoxyCodeLine{02157\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ outsideInteractions-\/>size(),}
\DoxyCodeLine{02158\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tree-\/>getParticleGroup(idxGroup)-\/>getStartingIndex(),}
\DoxyCodeLine{02159\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tree-\/>getParticleGroup(idxGroup)-\/>getEndingIndex(),}
\DoxyCodeLine{02160\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tree-\/>getParticleGroup(interactionid)-\/>getStartingIndex(),}
\DoxyCodeLine{02161\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tree-\/>getParticleGroup(interactionid)-\/>getEndingIndex(),}
\DoxyCodeLine{02162\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ starpu\_mpi\_data\_get\_rank(particleHandles[interactionid].down)),}
\DoxyCodeLine{02163\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \#endif}
\DoxyCodeLine{02164\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \#endif}
\DoxyCodeLine{02165\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 0);}
\DoxyCodeLine{02166\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02167\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{02168\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02169\ }
\DoxyCodeLine{02170\ \textcolor{preprocessor}{\#ifdef\ SCALFMM\_USE\_STARPU\_EXTRACT}}
\DoxyCodeLine{02171\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02172\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Extract\ data\ from\ second\ group\ for\ the\ first\ one}}
\DoxyCodeLine{02173\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ That\ is\ copy\ B\ to\ B'}}
\DoxyCodeLine{02174\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ extractedParticlesBuffer.emplace\_back();}
\DoxyCodeLine{02175\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ParticleExtractedHandles\&\ interactionBuffer\ =\ extractedParticlesBuffer.back();}
\DoxyCodeLine{02176\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ interactionBuffer.leavesToExtract\ =\ externalInteractionsLeafLevelOuter[idxGroup][idxInteraction];}
\DoxyCodeLine{02177\ }
\DoxyCodeLine{02178\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ interactionBuffer.size\ =\ tree-\/>getParticleGroup(interactionid)-\/>getExtractBufferSize(interactionBuffer.leavesToExtract);}
\DoxyCodeLine{02179\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ I\ allocate\ only\ if\ I\ will\ use\ it\ to\ extract}}
\DoxyCodeLine{02180\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(starpu\_mpi\_data\_get\_rank(particleHandles[interactionid].symb)\ ==\ mpi\_rank)\{}
\DoxyCodeLine{02181\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ interactionBuffer.data.reset(\textcolor{keyword}{new}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}[interactionBuffer.size]);}
\DoxyCodeLine{02182\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02183\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\{}
\DoxyCodeLine{02184\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ interactionBuffer.data.reset(\textcolor{keyword}{nullptr});}
\DoxyCodeLine{02185\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02186\ }
\DoxyCodeLine{02187\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ registeringNode\ =\ starpu\_mpi\_data\_get\_rank(particleHandles[interactionid].symb);}
\DoxyCodeLine{02188\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ where\ =\ (registeringNode\ ==\ mpi\_rank)\ ?\ STARPU\_MAIN\_RAM\ :\ -\/1;}
\DoxyCodeLine{02189\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ starpu\_variable\_data\_register(\&interactionBuffer.symb,\ where,}
\DoxyCodeLine{02190\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (uintptr\_t)interactionBuffer.data.get(),\ interactionBuffer.size);}
\DoxyCodeLine{02191\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ starpu\_mpi\_data\_register(interactionBuffer.symb,\ \mbox{\hyperlink{class_f_group_task_star_p_u_implicit_algorithm_ae65a567a38fa5bc2b878cdb06aff7a47}{tag}}++,\ registeringNode);}
\DoxyCodeLine{02192\ }
\DoxyCodeLine{02193\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ParticleExtractedHandles*\ interactionBufferPtr\ =\ \&interactionBuffer;}
\DoxyCodeLine{02194\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ starpu\_mpi\_insert\_task(MPI\_COMM\_WORLD,}
\DoxyCodeLine{02195\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \&p2p\_extract,}
\DoxyCodeLine{02196\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_VALUE,\ \&interactionBufferPtr,\ \textcolor{keyword}{sizeof}(ParticleExtractedHandles*),}
\DoxyCodeLine{02197\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \#ifdef\ SCALFMM\_STARPU\_USE\_PRIO}
\DoxyCodeLine{02198\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_PRIORITY,\ PrioClass::Controller().getInsertionPosP2PExtern(),}
\DoxyCodeLine{02199\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \#endif}
\DoxyCodeLine{02200\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_R,\ particleHandles[interactionid].symb,}
\DoxyCodeLine{02201\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_RW,\ interactionBuffer.symb,\ 0);}
\DoxyCodeLine{02202\ }
\DoxyCodeLine{02203\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Move\ to\ a\ new\ memory\ block\ that\ is\ on\ the\ same\ node\ as\ A}}
\DoxyCodeLine{02204\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ B'\ to\ B'''}}
\DoxyCodeLine{02205\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ duplicatedParticlesBuffer.emplace\_back();}
\DoxyCodeLine{02206\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ DuplicatedParticlesHandle\&\ duplicateB\ =\ duplicatedParticlesBuffer.back();}
\DoxyCodeLine{02207\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ duplicateB.size\ =\ tree-\/>getParticleGroup(interactionid)-\/>getBufferSizeInByte();}
\DoxyCodeLine{02208\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(starpu\_mpi\_data\_get\_rank(particleHandles[idxGroup].symb)\ ==\ mpi\_rank)\{}
\DoxyCodeLine{02209\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Reuse\ block\ but\ just\ to\ perform\ the\ send}}
\DoxyCodeLine{02210\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ duplicateB.data\ =\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}*)\ FAlignedMemory::AllocateBytes<64>(duplicateB.size);\textcolor{comment}{//\ =\ const\_cast<unsigned\ char*>(tree-\/>getParticleGroup(interactionid)-\/>getRawBuffer());}}
\DoxyCodeLine{02211\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02212\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\{}
\DoxyCodeLine{02213\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ duplicateB.data\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{02214\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02215\ }
\DoxyCodeLine{02216\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ registeringNode\ =\ starpu\_mpi\_data\_get\_rank(particleHandles[idxGroup].symb);}
\DoxyCodeLine{02217\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ where\ =\ (registeringNode\ ==\ mpi\_rank)\ ?\ STARPU\_MAIN\_RAM\ :\ -\/1;}
\DoxyCodeLine{02218\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ starpu\_variable\_data\_register(\&duplicateB.symb,\ where,}
\DoxyCodeLine{02219\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (uintptr\_t)duplicateB.data,\ duplicateB.size);}
\DoxyCodeLine{02220\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ starpu\_mpi\_data\_register(duplicateB.symb,\ \mbox{\hyperlink{class_f_group_task_star_p_u_implicit_algorithm_ae65a567a38fa5bc2b878cdb06aff7a47}{tag}}++,\ registeringNode);}
\DoxyCodeLine{02221\ }
\DoxyCodeLine{02222\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}*\ dataPtr\ =\ \textcolor{keyword}{const\_cast<}\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}*\textcolor{keyword}{>}(tree-\/>getParticleGroup(interactionid)-\/>getRawBuffer());}
\DoxyCodeLine{02223\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ sizeData\ =\ duplicateB.size;}
\DoxyCodeLine{02224\ }
\DoxyCodeLine{02225\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ starpu\_mpi\_insert\_task(MPI\_COMM\_WORLD,}
\DoxyCodeLine{02226\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \&p2p\_insert\_bis,}
\DoxyCodeLine{02227\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_VALUE,\ \&interactionBufferPtr,\ \textcolor{keyword}{sizeof}(ParticleExtractedHandles*),}
\DoxyCodeLine{02228\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_VALUE,\ \&dataPtr,\ \textcolor{keyword}{sizeof}(dataPtr),}
\DoxyCodeLine{02229\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_VALUE,\ \&sizeData,\ \textcolor{keyword}{sizeof}(sizeData),}
\DoxyCodeLine{02230\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \#ifdef\ SCALFMM\_STARPU\_USE\_PRIO}
\DoxyCodeLine{02231\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_PRIORITY,\ PrioClass::Controller().getInsertionPosP2PExtern(),}
\DoxyCodeLine{02232\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \#endif}
\DoxyCodeLine{02233\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_R,\ interactionBuffer.symb,}
\DoxyCodeLine{02234\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_RW,\ duplicateB.symb,}
\DoxyCodeLine{02235\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 0);}
\DoxyCodeLine{02236\ }
\DoxyCodeLine{02237\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ starpu\_mpi\_insert\_task(MPI\_COMM\_WORLD,}
\DoxyCodeLine{02238\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \&p2p\_cl\_inout\_mpi,}
\DoxyCodeLine{02239\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_VALUE,\ \&wrapperptr,\ \textcolor{keyword}{sizeof}(wrapperptr),}
\DoxyCodeLine{02240\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_VALUE,\ \&outsideInteractions,\ \textcolor{keyword}{sizeof}(outsideInteractions),}
\DoxyCodeLine{02241\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_VALUE,\ \&particleHandles[idxGroup].intervalSize,\ \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{int}),}
\DoxyCodeLine{02242\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \#ifdef\ SCALFMM\_STARPU\_USE\_PRIO}
\DoxyCodeLine{02243\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_PRIORITY,\ PrioClass::Controller().getInsertionPosP2PExtern(),}
\DoxyCodeLine{02244\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \#endif}
\DoxyCodeLine{02245\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_R,\ particleHandles[idxGroup].symb,}
\DoxyCodeLine{02246\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (STARPU\_RW|STARPU\_COMMUTE\_IF\_SUPPORTED),\ particleHandles[idxGroup].down,}
\DoxyCodeLine{02247\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_R,\ duplicateB.symb,}
\DoxyCodeLine{02248\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \#ifdef\ STARPU\_USE\_TASK\_NAME}
\DoxyCodeLine{02249\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \#ifndef\ SCALFMM\_SIMGRID\_TASKNAMEPARAMS}
\DoxyCodeLine{02250\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_NAME,\ p2pOuterTaskNames.get(),}
\DoxyCodeLine{02251\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \#\textcolor{keywordflow}{else}}
\DoxyCodeLine{02252\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//"{}P2P\_out-\/nb\_i\_p\_nb\_i\_p\_s"{}}}
\DoxyCodeLine{02253\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_NAME,\ taskNames-\/>print(\textcolor{stringliteral}{"{}P2P\_out"{}},\ \textcolor{stringliteral}{"{}\%d,\ \%lld,\ \%lld,\ \%d,\ \%lld,\ \%lld,\ \%d,\ \%lld,\ \%lld,\ \%lld,\ \%lld,\ \%d\(\backslash\)n"{}},}
\DoxyCodeLine{02254\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tree-\/>getParticleGroup(idxGroup)-\/>getNumberOfLeavesInBlock(),}
\DoxyCodeLine{02255\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tree-\/>getParticleGroup(idxGroup)-\/>getSizeOfInterval(),}
\DoxyCodeLine{02256\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tree-\/>getParticleGroup(idxGroup)-\/>getNbParticlesInGroup(),}
\DoxyCodeLine{02257\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tree-\/>getParticleGroup(interactionid)-\/>getNumberOfLeavesInBlock(),}
\DoxyCodeLine{02258\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tree-\/>getParticleGroup(interactionid)-\/>getSizeOfInterval(),}
\DoxyCodeLine{02259\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tree-\/>getParticleGroup(interactionid)-\/>getNbParticlesInGroup(),}
\DoxyCodeLine{02260\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ outsideInteractions-\/>size(),}
\DoxyCodeLine{02261\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tree-\/>getParticleGroup(idxGroup)-\/>getStartingIndex(),}
\DoxyCodeLine{02262\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tree-\/>getParticleGroup(idxGroup)-\/>getEndingIndex(),}
\DoxyCodeLine{02263\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tree-\/>getParticleGroup(interactionid)-\/>getStartingIndex(),}
\DoxyCodeLine{02264\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tree-\/>getParticleGroup(interactionid)-\/>getEndingIndex(),}
\DoxyCodeLine{02265\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ starpu\_mpi\_data\_get\_rank(particleHandles[idxGroup].down)),}
\DoxyCodeLine{02266\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \#endif}
\DoxyCodeLine{02267\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \#endif}
\DoxyCodeLine{02268\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 0);}
\DoxyCodeLine{02269\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02270\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02271\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ std::vector<OutOfBlockInteraction>*\ outsideInteractionsOpposite\ =\ \textcolor{keyword}{new}\ std::vector<OutOfBlockInteraction>(externalInteractionsLeafLevel[idxGroup][idxInteraction].interactions);}
\DoxyCodeLine{02272\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ outsideInteractionsOpposite-\/>size();\ ++i)}
\DoxyCodeLine{02273\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02274\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ MortonIndex\ tmp\ =\ outsideInteractionsOpposite-\/>at(i).outIndex;}
\DoxyCodeLine{02275\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ outsideInteractionsOpposite-\/>at(i).outIndex\ =\ outsideInteractionsOpposite-\/>at(i).insideIndex;}
\DoxyCodeLine{02276\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ outsideInteractionsOpposite-\/>at(i).insideIndex\ =\ tmp;}
\DoxyCodeLine{02277\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ tmp2\ =\ outsideInteractionsOpposite-\/>at(i).insideIdxInBlock;}
\DoxyCodeLine{02278\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ outsideInteractionsOpposite-\/>at(i).insideIdxInBlock\ =\ outsideInteractionsOpposite-\/>at(i).outsideIdxInBlock;}
\DoxyCodeLine{02279\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ outsideInteractionsOpposite-\/>at(i).outsideIdxInBlock\ =\ tmp2;}
\DoxyCodeLine{02280\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ outsideInteractionsOpposite-\/>at(i).relativeOutPosition\ =\ getOppositeInterIndex(outsideInteractionsOpposite-\/>at(i).relativeOutPosition);}
\DoxyCodeLine{02281\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02282\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ externalInteractionsLeafLevelOpposite.push\_front(outsideInteractionsOpposite);}
\DoxyCodeLine{02283\ }
\DoxyCodeLine{02284\ }
\DoxyCodeLine{02285\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Extract\ data\ from\ second\ group\ for\ the\ first\ one}}
\DoxyCodeLine{02286\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ That\ is\ copy\ A\ to\ A'}}
\DoxyCodeLine{02287\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ extractedParticlesBuffer.emplace\_back();}
\DoxyCodeLine{02288\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ParticleExtractedHandles\&\ interactionBuffer\ =\ extractedParticlesBuffer.back();}
\DoxyCodeLine{02289\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ interactionBuffer.leavesToExtract\ =\ externalInteractionsLeafLevelInner[idxGroup][idxInteraction];}
\DoxyCodeLine{02290\ }
\DoxyCodeLine{02291\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ interactionBuffer.size\ =\ tree-\/>getParticleGroup(idxGroup)-\/>getExtractBufferSize(interactionBuffer.leavesToExtract);}
\DoxyCodeLine{02292\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ I\ allocate\ only\ if\ I\ will\ use\ it\ to\ extract}}
\DoxyCodeLine{02293\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(starpu\_mpi\_data\_get\_rank(particleHandles[idxGroup].down)\ ==\ mpi\_rank)\{}
\DoxyCodeLine{02294\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ interactionBuffer.data.reset(\textcolor{keyword}{new}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}[interactionBuffer.size]);}
\DoxyCodeLine{02295\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02296\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\{}
\DoxyCodeLine{02297\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ interactionBuffer.data.reset(\textcolor{keyword}{nullptr});}
\DoxyCodeLine{02298\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02299\ }
\DoxyCodeLine{02300\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ registeringNode\ =\ starpu\_mpi\_data\_get\_rank(particleHandles[idxGroup].down);}
\DoxyCodeLine{02301\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ where\ =\ (registeringNode\ ==\ mpi\_rank)\ ?\ STARPU\_MAIN\_RAM\ :\ -\/1;}
\DoxyCodeLine{02302\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ starpu\_variable\_data\_register(\&interactionBuffer.symb,\ where,}
\DoxyCodeLine{02303\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (uintptr\_t)interactionBuffer.data.get(),\ interactionBuffer.size);}
\DoxyCodeLine{02304\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ starpu\_mpi\_data\_register(interactionBuffer.symb,\ \mbox{\hyperlink{class_f_group_task_star_p_u_implicit_algorithm_ae65a567a38fa5bc2b878cdb06aff7a47}{tag}}++,\ registeringNode);}
\DoxyCodeLine{02305\ }
\DoxyCodeLine{02306\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ParticleExtractedHandles*\ interactionBufferPtr\ =\ \&interactionBuffer;}
\DoxyCodeLine{02307\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ starpu\_mpi\_insert\_task(MPI\_COMM\_WORLD,}
\DoxyCodeLine{02308\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \&p2p\_extract,}
\DoxyCodeLine{02309\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_VALUE,\ \&interactionBufferPtr,\ \textcolor{keyword}{sizeof}(ParticleExtractedHandles*),}
\DoxyCodeLine{02310\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \#ifdef\ SCALFMM\_STARPU\_USE\_PRIO}
\DoxyCodeLine{02311\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_PRIORITY,\ PrioClass::Controller().getInsertionPosP2PExtern(),}
\DoxyCodeLine{02312\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \#endif}
\DoxyCodeLine{02313\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_R,\ particleHandles[idxGroup].symb,}
\DoxyCodeLine{02314\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_RW,\ interactionBuffer.symb,\ 0);}
\DoxyCodeLine{02315\ }
\DoxyCodeLine{02316\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Move\ to\ a\ new\ memory\ block\ that\ is\ on\ the\ same\ node\ as\ A}}
\DoxyCodeLine{02317\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ B'\ to\ B'''}}
\DoxyCodeLine{02318\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ duplicatedParticlesBuffer.emplace\_back();}
\DoxyCodeLine{02319\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ DuplicatedParticlesHandle\&\ duplicateA\ =\ duplicatedParticlesBuffer.back();}
\DoxyCodeLine{02320\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ duplicateA.size\ =\ tree-\/>getParticleGroup(idxGroup)-\/>getBufferSizeInByte();}
\DoxyCodeLine{02321\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(starpu\_mpi\_data\_get\_rank(particleHandles[interactionid].down)\ ==\ mpi\_rank)\{}
\DoxyCodeLine{02322\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Reuse\ block\ but\ just\ to\ perform\ the\ send}}
\DoxyCodeLine{02323\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ duplicateA.data\ =\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}*)\ FAlignedMemory::AllocateBytes<64>(duplicateA.size);\textcolor{comment}{//\ =\ const\_cast<unsigned\ char*>(tree-\/>getParticleGroup(idxGroup)-\/>getRawBuffer());}}
\DoxyCodeLine{02324\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02325\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\{}
\DoxyCodeLine{02326\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ duplicateA.data\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{02327\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02328\ }
\DoxyCodeLine{02329\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ registeringNode\ =\ starpu\_mpi\_data\_get\_rank(particleHandles[interactionid].down);}
\DoxyCodeLine{02330\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ where\ =\ (registeringNode\ ==\ mpi\_rank)\ ?\ STARPU\_MAIN\_RAM\ :\ -\/1;}
\DoxyCodeLine{02331\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ starpu\_variable\_data\_register(\&duplicateA.symb,\ where,}
\DoxyCodeLine{02332\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (uintptr\_t)duplicateA.data,\ duplicateA.size);}
\DoxyCodeLine{02333\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ starpu\_mpi\_data\_register(duplicateA.symb,\ \mbox{\hyperlink{class_f_group_task_star_p_u_implicit_algorithm_ae65a567a38fa5bc2b878cdb06aff7a47}{tag}}++,\ registeringNode);}
\DoxyCodeLine{02334\ }
\DoxyCodeLine{02335\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}*\ dataPtr\ =\ \textcolor{keyword}{const\_cast<}\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}*\textcolor{keyword}{>}(tree-\/>getParticleGroup(idxGroup)-\/>getRawBuffer());}
\DoxyCodeLine{02336\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ sizeData\ =\ duplicateA.size;}
\DoxyCodeLine{02337\ }
\DoxyCodeLine{02338\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ starpu\_mpi\_insert\_task(MPI\_COMM\_WORLD,}
\DoxyCodeLine{02339\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \&p2p\_insert\_bis,}
\DoxyCodeLine{02340\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_VALUE,\ \&interactionBufferPtr,\ \textcolor{keyword}{sizeof}(ParticleExtractedHandles*),}
\DoxyCodeLine{02341\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_VALUE,\ \&dataPtr,\ \textcolor{keyword}{sizeof}(dataPtr),}
\DoxyCodeLine{02342\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_VALUE,\ \&sizeData,\ \textcolor{keyword}{sizeof}(sizeData),}
\DoxyCodeLine{02343\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \#ifdef\ SCALFMM\_STARPU\_USE\_PRIO}
\DoxyCodeLine{02344\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_PRIORITY,\ PrioClass::Controller().getInsertionPosP2PExtern(),}
\DoxyCodeLine{02345\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \#endif}
\DoxyCodeLine{02346\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_R,\ interactionBuffer.symb,}
\DoxyCodeLine{02347\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_RW,\ duplicateA.symb,\ 0);}
\DoxyCodeLine{02348\ }
\DoxyCodeLine{02349\ }
\DoxyCodeLine{02350\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ starpu\_mpi\_insert\_task(MPI\_COMM\_WORLD,}
\DoxyCodeLine{02351\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \&p2p\_cl\_inout\_mpi,}
\DoxyCodeLine{02352\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_VALUE,\ \&wrapperptr,\ \textcolor{keyword}{sizeof}(wrapperptr),}
\DoxyCodeLine{02353\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_VALUE,\ \&outsideInteractionsOpposite,\ \textcolor{keyword}{sizeof}(outsideInteractionsOpposite),}
\DoxyCodeLine{02354\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_VALUE,\ \&particleHandles[idxGroup].intervalSize,\ \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{int}),}
\DoxyCodeLine{02355\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \#ifdef\ SCALFMM\_STARPU\_USE\_PRIO}
\DoxyCodeLine{02356\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_PRIORITY,\ PrioClass::Controller().getInsertionPosP2PExtern(),}
\DoxyCodeLine{02357\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \#endif}
\DoxyCodeLine{02358\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_R,\ particleHandles[interactionid].symb,}
\DoxyCodeLine{02359\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (STARPU\_RW|STARPU\_COMMUTE\_IF\_SUPPORTED),\ particleHandles[interactionid].down,}
\DoxyCodeLine{02360\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_R,\ duplicateA.symb,}
\DoxyCodeLine{02361\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \#ifdef\ STARPU\_USE\_TASK\_NAME}
\DoxyCodeLine{02362\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \#ifndef\ SCALFMM\_SIMGRID\_TASKNAMEPARAMS}
\DoxyCodeLine{02363\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_NAME,\ p2pOuterTaskNames.get(),}
\DoxyCodeLine{02364\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \#\textcolor{keywordflow}{else}}
\DoxyCodeLine{02365\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//"{}P2P\_out-\/nb\_i\_p\_nb\_i\_p\_s"{}}}
\DoxyCodeLine{02366\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_NAME,\ taskNames-\/>print(\textcolor{stringliteral}{"{}P2P\_out"{}},\ \textcolor{stringliteral}{"{}\%d,\ \%lld,\ \%lld,\ \%d,\ \%lld,\ \%lld,\ \%d,\ \%lld,\ \%lld,\ \%lld,\ \%lld,\ \%d\(\backslash\)n"{}},}
\DoxyCodeLine{02367\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tree-\/>getParticleGroup(interactionid)-\/>getNumberOfLeavesInBlock(),}
\DoxyCodeLine{02368\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tree-\/>getParticleGroup(interactionid)-\/>getSizeOfInterval(),}
\DoxyCodeLine{02369\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tree-\/>getParticleGroup(interactionid)-\/>getNbParticlesInGroup(),}
\DoxyCodeLine{02370\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tree-\/>getParticleGroup(idxGroup)-\/>getNumberOfLeavesInBlock(),}
\DoxyCodeLine{02371\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tree-\/>getParticleGroup(idxGroup)-\/>getSizeOfInterval(),}
\DoxyCodeLine{02372\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tree-\/>getParticleGroup(idxGroup)-\/>getNbParticlesInGroup(),}
\DoxyCodeLine{02373\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ outsideInteractions-\/>size(),}
\DoxyCodeLine{02374\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tree-\/>getParticleGroup(interactionid)-\/>getStartingIndex(),}
\DoxyCodeLine{02375\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tree-\/>getParticleGroup(interactionid)-\/>getEndingIndex(),}
\DoxyCodeLine{02376\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tree-\/>getParticleGroup(idxGroup)-\/>getStartingIndex(),}
\DoxyCodeLine{02377\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tree-\/>getParticleGroup(idxGroup)-\/>getEndingIndex(),}
\DoxyCodeLine{02378\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ starpu\_mpi\_data\_get\_rank(particleHandles[interactionid].down)),}
\DoxyCodeLine{02379\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \#endif}
\DoxyCodeLine{02380\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \#endif}
\DoxyCodeLine{02381\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 0);}
\DoxyCodeLine{02382\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02383\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{02384\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02385\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ starpu\_mpi\_insert\_task(MPI\_COMM\_WORLD,}
\DoxyCodeLine{02386\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \&p2p\_cl\_inout\_mpi,}
\DoxyCodeLine{02387\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_VALUE,\ \&wrapperptr,\ \textcolor{keyword}{sizeof}(wrapperptr),}
\DoxyCodeLine{02388\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_VALUE,\ \&outsideInteractions,\ \textcolor{keyword}{sizeof}(outsideInteractions),}
\DoxyCodeLine{02389\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_VALUE,\ \&particleHandles[idxGroup].intervalSize,\ \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{int}),}
\DoxyCodeLine{02390\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \#ifdef\ SCALFMM\_STARPU\_USE\_PRIO}
\DoxyCodeLine{02391\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_PRIORITY,\ PrioClass::Controller().getInsertionPosP2PExtern(),}
\DoxyCodeLine{02392\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \#endif}
\DoxyCodeLine{02393\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_R,\ particleHandles[idxGroup].symb,}
\DoxyCodeLine{02394\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (STARPU\_RW|STARPU\_COMMUTE\_IF\_SUPPORTED),\ particleHandles[idxGroup].down,}
\DoxyCodeLine{02395\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_R,\ particleHandles[interactionid].symb,}
\DoxyCodeLine{02396\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \#ifdef\ STARPU\_USE\_TASK\_NAME}
\DoxyCodeLine{02397\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \#ifndef\ SCALFMM\_SIMGRID\_TASKNAMEPARAMS}
\DoxyCodeLine{02398\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_NAME,\ p2pOuterTaskNames.get(),}
\DoxyCodeLine{02399\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \#\textcolor{keywordflow}{else}}
\DoxyCodeLine{02400\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//"{}P2P\_out-\/nb\_i\_p\_nb\_i\_p\_s"{}}}
\DoxyCodeLine{02401\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_NAME,\ taskNames-\/>print(\textcolor{stringliteral}{"{}P2P\_out"{}},\ \textcolor{stringliteral}{"{}\%d,\ \%lld,\ \%lld,\ \%d,\ \%lld,\ \%lld,\ \%d,\ \%lld,\ \%lld,\ \%lld,\ \%lld,\ \%d\(\backslash\)n"{}},}
\DoxyCodeLine{02402\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tree-\/>getParticleGroup(idxGroup)-\/>getNumberOfLeavesInBlock(),}
\DoxyCodeLine{02403\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tree-\/>getParticleGroup(idxGroup)-\/>getSizeOfInterval(),}
\DoxyCodeLine{02404\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tree-\/>getParticleGroup(idxGroup)-\/>getNbParticlesInGroup(),}
\DoxyCodeLine{02405\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tree-\/>getParticleGroup(interactionid)-\/>getNumberOfLeavesInBlock(),}
\DoxyCodeLine{02406\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tree-\/>getParticleGroup(interactionid)-\/>getSizeOfInterval(),}
\DoxyCodeLine{02407\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tree-\/>getParticleGroup(interactionid)-\/>getNbParticlesInGroup(),}
\DoxyCodeLine{02408\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ outsideInteractions-\/>size(),}
\DoxyCodeLine{02409\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tree-\/>getParticleGroup(idxGroup)-\/>getStartingIndex(),}
\DoxyCodeLine{02410\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tree-\/>getParticleGroup(idxGroup)-\/>getEndingIndex(),}
\DoxyCodeLine{02411\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tree-\/>getParticleGroup(interactionid)-\/>getStartingIndex(),}
\DoxyCodeLine{02412\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tree-\/>getParticleGroup(interactionid)-\/>getEndingIndex(),}
\DoxyCodeLine{02413\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ starpu\_mpi\_data\_get\_rank(particleHandles[idxGroup].down)),}
\DoxyCodeLine{02414\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \#endif}
\DoxyCodeLine{02415\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \#endif}
\DoxyCodeLine{02416\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 0);}
\DoxyCodeLine{02417\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ std::vector<OutOfBlockInteraction>*\ outsideInteractionsOpposite\ =\ \textcolor{keyword}{new}\ std::vector<OutOfBlockInteraction>(externalInteractionsLeafLevel[idxGroup][idxInteraction].interactions);}
\DoxyCodeLine{02418\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ outsideInteractionsOpposite-\/>size();\ ++i)}
\DoxyCodeLine{02419\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02420\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ MortonIndex\ tmp\ =\ outsideInteractionsOpposite-\/>at(i).outIndex;}
\DoxyCodeLine{02421\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ outsideInteractionsOpposite-\/>at(i).outIndex\ =\ outsideInteractionsOpposite-\/>at(i).insideIndex;}
\DoxyCodeLine{02422\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ outsideInteractionsOpposite-\/>at(i).insideIndex\ =\ tmp;}
\DoxyCodeLine{02423\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ tmp2\ =\ outsideInteractionsOpposite-\/>at(i).insideIdxInBlock;}
\DoxyCodeLine{02424\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ outsideInteractionsOpposite-\/>at(i).insideIdxInBlock\ =\ outsideInteractionsOpposite-\/>at(i).outsideIdxInBlock;}
\DoxyCodeLine{02425\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ outsideInteractionsOpposite-\/>at(i).outsideIdxInBlock\ =\ tmp2;}
\DoxyCodeLine{02426\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ outsideInteractionsOpposite-\/>at(i).relativeOutPosition\ =\ getOppositeInterIndex(outsideInteractionsOpposite-\/>at(i).relativeOutPosition);}
\DoxyCodeLine{02427\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02428\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ externalInteractionsLeafLevelOpposite.push\_front(outsideInteractionsOpposite);}
\DoxyCodeLine{02429\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ starpu\_mpi\_insert\_task(MPI\_COMM\_WORLD,}
\DoxyCodeLine{02430\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \&p2p\_cl\_inout\_mpi,}
\DoxyCodeLine{02431\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_VALUE,\ \&wrapperptr,\ \textcolor{keyword}{sizeof}(wrapperptr),}
\DoxyCodeLine{02432\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_VALUE,\ \&outsideInteractionsOpposite,\ \textcolor{keyword}{sizeof}(outsideInteractionsOpposite),}
\DoxyCodeLine{02433\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_VALUE,\ \&particleHandles[idxGroup].intervalSize,\ \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{int}),}
\DoxyCodeLine{02434\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \#ifdef\ SCALFMM\_STARPU\_USE\_PRIO}
\DoxyCodeLine{02435\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_PRIORITY,\ PrioClass::Controller().getInsertionPosP2PExtern(),}
\DoxyCodeLine{02436\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \#endif}
\DoxyCodeLine{02437\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_R,\ particleHandles[interactionid].symb,}
\DoxyCodeLine{02438\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (STARPU\_RW|STARPU\_COMMUTE\_IF\_SUPPORTED),\ particleHandles[interactionid].down,}
\DoxyCodeLine{02439\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_R,\ particleHandles[idxGroup].symb,}
\DoxyCodeLine{02440\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \#ifdef\ STARPU\_USE\_TASK\_NAME}
\DoxyCodeLine{02441\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \#ifndef\ SCALFMM\_SIMGRID\_TASKNAMEPARAMS}
\DoxyCodeLine{02442\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_NAME,\ p2pOuterTaskNames.get(),}
\DoxyCodeLine{02443\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \#\textcolor{keywordflow}{else}}
\DoxyCodeLine{02444\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//"{}P2P\_out-\/nb\_i\_p\_nb\_i\_p\_s"{}}}
\DoxyCodeLine{02445\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_NAME,\ taskNames-\/>print(\textcolor{stringliteral}{"{}P2P\_out"{}},\ \textcolor{stringliteral}{"{}\%d,\ \%lld,\ \%lld,\ \%d,\ \%lld,\ \%lld,\ \%d,\ \%lld,\ \%lld,\ \%lld,\ \%lld,\ \%d\(\backslash\)n"{}},}
\DoxyCodeLine{02446\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tree-\/>getParticleGroup(interactionid)-\/>getNumberOfLeavesInBlock(),}
\DoxyCodeLine{02447\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tree-\/>getParticleGroup(interactionid)-\/>getSizeOfInterval(),}
\DoxyCodeLine{02448\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tree-\/>getParticleGroup(interactionid)-\/>getNbParticlesInGroup(),}
\DoxyCodeLine{02449\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tree-\/>getParticleGroup(idxGroup)-\/>getNumberOfLeavesInBlock(),}
\DoxyCodeLine{02450\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tree-\/>getParticleGroup(idxGroup)-\/>getSizeOfInterval(),}
\DoxyCodeLine{02451\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tree-\/>getParticleGroup(idxGroup)-\/>getNbParticlesInGroup(),}
\DoxyCodeLine{02452\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ outsideInteractions-\/>size(),}
\DoxyCodeLine{02453\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tree-\/>getParticleGroup(interactionid)-\/>getStartingIndex(),}
\DoxyCodeLine{02454\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tree-\/>getParticleGroup(interactionid)-\/>getEndingIndex(),}
\DoxyCodeLine{02455\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tree-\/>getParticleGroup(idxGroup)-\/>getStartingIndex(),}
\DoxyCodeLine{02456\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tree-\/>getParticleGroup(idxGroup)-\/>getEndingIndex(),}
\DoxyCodeLine{02457\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ starpu\_mpi\_data\_get\_rank(particleHandles[interactionid].down)),}
\DoxyCodeLine{02458\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \#endif}
\DoxyCodeLine{02459\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \#endif}
\DoxyCodeLine{02460\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 0);}
\DoxyCodeLine{02461\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02462\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{02463\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02464\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02465\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02466\ \ \ \ \ \ \ \ \ FLOG(\ timerOutBlock.tac()\ );}
\DoxyCodeLine{02467\ \ \ \ \ \ \ \ \ FLOG(\ timerInBlock.tic()\ );}
\DoxyCodeLine{02468\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ idxGroup\ =\ 0\ ;\ idxGroup\ <\ tree-\/>getNbParticleGroup()\ ;\ ++idxGroup)\{}
\DoxyCodeLine{02469\ \ \ \ \ \ \ \ \ \ \ \ \ starpu\_mpi\_insert\_task(MPI\_COMM\_WORLD,}
\DoxyCodeLine{02470\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \&p2p\_cl\_in,}
\DoxyCodeLine{02471\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_VALUE,\ \&wrapperptr,\ \textcolor{keyword}{sizeof}(wrapperptr),}
\DoxyCodeLine{02472\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_VALUE,\ \&particleHandles[idxGroup].intervalSize,\ \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{int}),}
\DoxyCodeLine{02473\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \#ifdef\ SCALFMM\_STARPU\_USE\_PRIO}
\DoxyCodeLine{02474\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_PRIORITY,\ PrioClass::Controller().getInsertionPosP2P(),}
\DoxyCodeLine{02475\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \#endif}
\DoxyCodeLine{02476\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_R,\ particleHandles[idxGroup].symb,}
\DoxyCodeLine{02477\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \#ifdef\ STARPU\_USE\_REDUX}
\DoxyCodeLine{02478\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_REDUX,\ particleHandles[idxGroup].down,}
\DoxyCodeLine{02479\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \#\textcolor{keywordflow}{else}}
\DoxyCodeLine{02480\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (STARPU\_RW\ |\ STARPU\_COMMUTE\_IF\_SUPPORTED),\ particleHandles[idxGroup].down,}
\DoxyCodeLine{02481\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \#endif}
\DoxyCodeLine{02482\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \#ifdef\ STARPU\_USE\_TASK\_NAME}
\DoxyCodeLine{02483\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \#ifndef\ SCALFMM\_SIMGRID\_TASKNAMEPARAMS}
\DoxyCodeLine{02484\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_NAME,\ p2pTaskNames.get(),}
\DoxyCodeLine{02485\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \#\textcolor{keywordflow}{else}}
\DoxyCodeLine{02486\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//"{}P2P-\/nb\_i\_p"{}}}
\DoxyCodeLine{02487\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_NAME,\ taskNames-\/>print(\textcolor{stringliteral}{"{}P2P"{}},\ \textcolor{stringliteral}{"{}\%d,\ \%lld,\ \%lld,\ \%lld,\ \%lld,\ \%lld,\ \%lld,\ \%d\(\backslash\)n"{}},}
\DoxyCodeLine{02488\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tree-\/>getParticleGroup(idxGroup)-\/>getNumberOfLeavesInBlock(),}
\DoxyCodeLine{02489\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tree-\/>getParticleGroup(idxGroup)-\/>getSizeOfInterval(),}
\DoxyCodeLine{02490\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tree-\/>getParticleGroup(idxGroup)-\/>getNbParticlesInGroup(),}
\DoxyCodeLine{02491\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tree-\/>getParticleGroup(idxGroup)-\/>getStartingIndex(),}
\DoxyCodeLine{02492\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tree-\/>getParticleGroup(idxGroup)-\/>getEndingIndex(),}
\DoxyCodeLine{02493\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tree-\/>getParticleGroup(idxGroup)-\/>getStartingIndex(),}
\DoxyCodeLine{02494\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tree-\/>getParticleGroup(idxGroup)-\/>getEndingIndex(),}
\DoxyCodeLine{02495\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ starpu\_mpi\_data\_get\_rank(particleHandles[idxGroup].down)),}
\DoxyCodeLine{02496\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \#endif}
\DoxyCodeLine{02497\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \#endif}
\DoxyCodeLine{02498\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 0);}
\DoxyCodeLine{02499\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02500\ \ \ \ \ \ \ \ \ FLOG(\ timerInBlock.tac()\ );}
\DoxyCodeLine{02501\ }
\DoxyCodeLine{02502\ \ \ \ \ \ \ \ \ FLOG(\ FLog::Controller\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)t\(\backslash\)t\ directPass\ in\ "{}}\ <<\ timer.tacAndElapsed()\ <<\ \textcolor{stringliteral}{"{}s\(\backslash\)n"{}}\ );}
\DoxyCodeLine{02503\ \ \ \ \ \ \ \ \ FLOG(\ FLog::Controller\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)t\(\backslash\)t\(\backslash\)t\ inblock\ \ in\ "{}}\ <<\ timerInBlock.elapsed()\ <<\ \textcolor{stringliteral}{"{}s\(\backslash\)n"{}}\ );}
\DoxyCodeLine{02504\ \ \ \ \ \ \ \ \ FLOG(\ FLog::Controller\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)t\(\backslash\)t\(\backslash\)t\ outblock\ in\ "{}}\ <<\ timerOutBlock.elapsed()\ <<\ \textcolor{stringliteral}{"{}s\(\backslash\)n"{}}\ );}
\DoxyCodeLine{02505\ \ \ \ \ \}}
\DoxyCodeLine{02509\ }
\DoxyCodeLine{02510\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_f_group_task_star_p_u_implicit_algorithm_a0d0498a1039d763e8360b9ef8bc27125}{mergePass}}()\{}
\DoxyCodeLine{02511\ \ \ \ \ \ \ \ \ FLOG(\ \mbox{\hyperlink{class_f_tic}{FTic}}\ timer;\ );}
\DoxyCodeLine{02512\ }
\DoxyCodeLine{02513\ \ \ \ \ \ \ \ \ FAssertLF(cellHandles[tree-\/>getHeight()-\/1].size()\ ==\ particleHandles.size());}
\DoxyCodeLine{02514\ }
\DoxyCodeLine{02515\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ idxGroup\ =\ 0\ ;\ idxGroup\ <\ tree-\/>getNbParticleGroup()\ ;\ ++idxGroup)\{}
\DoxyCodeLine{02516\ \ \ \ \ \ \ \ \ \ \ \ \ starpu\_mpi\_insert\_task(MPI\_COMM\_WORLD,}
\DoxyCodeLine{02517\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \&l2p\_cl,}
\DoxyCodeLine{02518\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_VALUE,\ \&wrapperptr,\ \textcolor{keyword}{sizeof}(wrapperptr),}
\DoxyCodeLine{02519\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_VALUE,\ \&cellHandles[tree-\/>getHeight()-\/1][idxGroup].intervalSize,\ \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{int}),}
\DoxyCodeLine{02520\ \ \ \ \ \ \ \ \ \#ifdef\ SCALFMM\_STARPU\_USE\_PRIO}
\DoxyCodeLine{02521\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_PRIORITY,\ PrioClass::Controller().getInsertionPosL2P(),}
\DoxyCodeLine{02522\ \ \ \ \ \ \ \ \ \#endif}
\DoxyCodeLine{02523\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_R,\ cellHandles[tree-\/>getHeight()-\/1][idxGroup].symb,}
\DoxyCodeLine{02524\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_R,\ cellHandles[tree-\/>getHeight()-\/1][idxGroup].down,}
\DoxyCodeLine{02525\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_R,\ particleHandles[idxGroup].symb,}
\DoxyCodeLine{02526\ \ \ \ \ \ \ \ \ \#ifdef\ STARPU\_USE\_REDUX}
\DoxyCodeLine{02527\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_REDUX,\ particleHandles[idxGroup].down,}
\DoxyCodeLine{02528\ \ \ \ \ \ \ \ \ \#else}
\DoxyCodeLine{02529\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (STARPU\_RW\ |\ STARPU\_COMMUTE\_IF\_SUPPORTED),\ particleHandles[idxGroup].down,}
\DoxyCodeLine{02530\ \ \ \ \ \ \ \ \ \#endif}
\DoxyCodeLine{02531\ \ \ \ \ \ \ \ \ \#ifdef\ STARPU\_USE\_TASK\_NAME}
\DoxyCodeLine{02532\ \ \ \ \ \ \ \ \ \#ifndef\ SCALFMM\_SIMGRID\_TASKNAMEPARAMS}
\DoxyCodeLine{02533\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_NAME,\ l2pTaskNames.get(),}
\DoxyCodeLine{02534\ \ \ \ \ \ \ \ \ \#\textcolor{keywordflow}{else}}
\DoxyCodeLine{02535\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//"{}L2P-\/nb\_i\_p"{}}}
\DoxyCodeLine{02536\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_NAME,\ taskNames-\/>print(\textcolor{stringliteral}{"{}L2P"{}},\ \textcolor{stringliteral}{"{}\%d,\ \%lld,\ \%lld,\ \%lld,\ \%lld,\ \%d\(\backslash\)n"{}},}
\DoxyCodeLine{02537\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tree-\/>getCellGroup(tree-\/>getHeight()-\/1,idxGroup)-\/>getNumberOfCellsInBlock(),}
\DoxyCodeLine{02538\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tree-\/>getCellGroup(tree-\/>getHeight()-\/1,idxGroup)-\/>getSizeOfInterval(),}
\DoxyCodeLine{02539\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tree-\/>getCellGroup(tree-\/>getHeight()-\/1,idxGroup)-\/>getNumberOfCellsInBlock(),}
\DoxyCodeLine{02540\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tree-\/>getParticleGroup(idxGroup)-\/>getStartingIndex(),}
\DoxyCodeLine{02541\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tree-\/>getParticleGroup(idxGroup)-\/>getEndingIndex(),}
\DoxyCodeLine{02542\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ starpu\_mpi\_data\_get\_rank(particleHandles[idxGroup].down)),}
\DoxyCodeLine{02543\ \ \ \ \ \ \ \ \ \#endif}
\DoxyCodeLine{02544\ \ \ \ \ \ \ \ \ \#endif}
\DoxyCodeLine{02545\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 0);}
\DoxyCodeLine{02546\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02547\ }
\DoxyCodeLine{02548\ \ \ \ \ \ \ \ \ FLOG(\ FLog::Controller\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)t\(\backslash\)t\ L2P\ in\ "{}}\ <<\ timer.tacAndElapsed()\ <<\ \textcolor{stringliteral}{"{}s\(\backslash\)n"{}}\ );}
\DoxyCodeLine{02549\ \ \ \ \ \}}
\DoxyCodeLine{02550\ }
\DoxyCodeLine{02551\ }
\DoxyCodeLine{02552\ \textcolor{preprocessor}{\#ifdef\ STARPU\_USE\_REDUX}}
\DoxyCodeLine{02553\ \ \ \ \ \textcolor{keywordtype}{void}\ readParticle()\{}
\DoxyCodeLine{02554\ \ \ \ \ \ \ \ \ FLOG(\ \mbox{\hyperlink{class_f_tic}{FTic}}\ timer;\ );}
\DoxyCodeLine{02555\ }
\DoxyCodeLine{02556\ \ \ \ \ \ \ \ \ FAssertLF(cellHandles[tree-\/>getHeight()-\/1].size()\ ==\ particleHandles.size());}
\DoxyCodeLine{02557\ }
\DoxyCodeLine{02558\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ idxGroup\ =\ 0\ ;\ idxGroup\ <\ tree-\/>getNbParticleGroup()\ ;\ ++idxGroup)\{}
\DoxyCodeLine{02559\ \ \ \ \ \ \ \ \ \ \ \ \ starpu\_mpi\_insert\_task(MPI\_COMM\_WORLD,}
\DoxyCodeLine{02560\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \&p2p\_redux\_read,}
\DoxyCodeLine{02561\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \#ifdef\ SCALFMM\_STARPU\_USE\_PRIO}
\DoxyCodeLine{02562\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_PRIORITY,\ PrioClass::Controller().getInsertionPosL2P(),}
\DoxyCodeLine{02563\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \#endif}
\DoxyCodeLine{02564\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_R,\ particleHandles[idxGroup].down,}
\DoxyCodeLine{02565\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \#ifdef\ STARPU\_USE\_TASK\_NAME}
\DoxyCodeLine{02566\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STARPU\_NAME,\ \textcolor{stringliteral}{"{}read-\/particle"{}},}
\DoxyCodeLine{02567\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \#endif}
\DoxyCodeLine{02568\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 0);}
\DoxyCodeLine{02569\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02570\ \ \ \ \ \}}
\DoxyCodeLine{02571\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{02572\ \};}
\DoxyCodeLine{02573\ }
\DoxyCodeLine{02574\ \textcolor{preprocessor}{\#endif\ }\textcolor{comment}{//\ FGROUPTASKSTARPUALGORITHM\_HPP}}

\end{DoxyCode}
