\doxysection{FMem\+Stats.\+h}
\hypertarget{_f_mem_stats_8h_source}{}\label{_f_mem_stats_8h_source}\index{third\_party/ScalFMM/include/ScalFMM/Utils/FMemStats.h@{third\_party/ScalFMM/include/ScalFMM/Utils/FMemStats.h}}

\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{comment}{//\ See\ LICENCE\ file\ at\ project\ root}}
\DoxyCodeLine{00002\ \textcolor{preprocessor}{\#ifndef\ FMEMSTATS\_H}}
\DoxyCodeLine{00003\ \textcolor{preprocessor}{\#define\ FMEMSTATS\_H}}
\DoxyCodeLine{00004\ }
\DoxyCodeLine{00005\ \textcolor{preprocessor}{\#include\ "{}FGlobal.hpp"{}}}
\DoxyCodeLine{00006\ }
\DoxyCodeLine{00007\ \textcolor{preprocessor}{\#include\ <cstdlib>}}
\DoxyCodeLine{00008\ \textcolor{preprocessor}{\#include\ <cstring>}}
\DoxyCodeLine{00009\ \textcolor{preprocessor}{\#include\ <cstdio>}}
\DoxyCodeLine{00010\ }
\DoxyCodeLine{00016\ \textcolor{preprocessor}{\#ifdef\ SCALFMM\_USE\_MEM\_STATS}}
\DoxyCodeLine{00017\ \textcolor{preprocessor}{\#include\ <new>}}
\DoxyCodeLine{00018\ \textcolor{preprocessor}{\#include\ <stdexcept>}}
\DoxyCodeLine{00019\ \textcolor{preprocessor}{\#warning\ You\ are\ using\ mem\ stats}}
\DoxyCodeLine{00020\ \textcolor{keywordtype}{void}*\ \textcolor{keyword}{operator}\ \textcolor{keyword}{new}(std::size\_t\ n);}
\DoxyCodeLine{00021\ \textcolor{keywordtype}{void}*\ \textcolor{keyword}{operator}\ \textcolor{keyword}{new}[](\ std::size\_t\ n\ );}
\DoxyCodeLine{00022\ }
\DoxyCodeLine{00023\ \textcolor{keywordtype}{void}*\ \textcolor{keyword}{operator}\ \textcolor{keyword}{new}\ \ (\ std::size\_t\ n,\ \textcolor{keyword}{const}\ std::nothrow\_t\&\ tag);}
\DoxyCodeLine{00024\ \textcolor{keywordtype}{void}*\ \textcolor{keyword}{operator}\ \textcolor{keyword}{new}[](\ std::size\_t\ n,\ \textcolor{keyword}{const}\ std::nothrow\_t\&\ tag);}
\DoxyCodeLine{00025\ }
\DoxyCodeLine{00026\ \textcolor{keywordtype}{void}\ \textcolor{keyword}{operator}\ \textcolor{keyword}{delete}(\textcolor{keywordtype}{void}*\ p)\ \textcolor{keyword}{noexcept};}
\DoxyCodeLine{00027\ \textcolor{keywordtype}{void}\ \textcolor{keyword}{operator}\ \textcolor{keyword}{delete}[](\textcolor{keywordtype}{void}*\ p)\ \textcolor{keyword}{noexcept};}
\DoxyCodeLine{00028\ \textcolor{keywordtype}{void}\ \textcolor{keyword}{operator}\ \textcolor{keyword}{delete}\ \ (\ \textcolor{keywordtype}{void}*\ ptr,\ \textcolor{keyword}{const}\ std::nothrow\_t\&\ tag);}
\DoxyCodeLine{00029\ \textcolor{keywordtype}{void}\ \textcolor{keyword}{operator}\ \textcolor{keyword}{delete}[](\ \textcolor{keywordtype}{void}*\ ptr,\ \textcolor{keyword}{const}\ std::nothrow\_t\&\ tag);}
\DoxyCodeLine{00030\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00031\ }
\DoxyCodeLine{00035\ \textcolor{keyword}{class\ }\mbox{\hyperlink{class_f_mem_stats}{FMemStats}}\ \{}
\DoxyCodeLine{00036\ \textcolor{keyword}{private}:}
\DoxyCodeLine{00037\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{long}\ \textcolor{keywordtype}{long}\ numberOfAllocations;}
\DoxyCodeLine{00038\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{long}\ \textcolor{keywordtype}{long}\ maxAllocated;}
\DoxyCodeLine{00039\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{long}\ \textcolor{keywordtype}{long}\ totalAllocated;}
\DoxyCodeLine{00040\ \ \ \ \ std::size\_t\ currentAllocated;}
\DoxyCodeLine{00041\ }
\DoxyCodeLine{00042\ \ \ \ \ \mbox{\hyperlink{class_f_mem_stats}{FMemStats}}()}
\DoxyCodeLine{00043\ \ \ \ \ \ \ \ \ :\ numberOfAllocations(0),\ maxAllocated(0),\ totalAllocated(0),\ currentAllocated(0)\ \{}
\DoxyCodeLine{00044\ \ \ \ \ \}}
\DoxyCodeLine{00045\ }
\DoxyCodeLine{00046\ \textcolor{preprocessor}{\#ifdef\ SCALFMM\_USE\_MEM\_STATS}}
\DoxyCodeLine{00047\ \ \ \ \ \mbox{\hyperlink{class_f_mem_stats}{\string~FMemStats}}()\{}
\DoxyCodeLine{00048\ \ \ \ \ \ \ \ \ plotState();}
\DoxyCodeLine{00049\ \ \ \ \ \}}
\DoxyCodeLine{00050\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00051\ }
\DoxyCodeLine{00052\ \ \ \ \ \textcolor{keywordtype}{void}\ plotState()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00053\ \textcolor{preprocessor}{\#ifdef\ SCALFMM\_USE\_MEM\_STATS}}
\DoxyCodeLine{00054\ \ \ \ \ \ \ \ \ printf(\textcolor{stringliteral}{"{}[SCALFMM-\/MEMSTAT]\ Total\ number\ of\ allocations\ \%lld\ \(\backslash\)n"{}},\ numberOfAllocations);}
\DoxyCodeLine{00055\ \ \ \ \ \ \ \ \ printf(\textcolor{stringliteral}{"{}[SCALFMM-\/MEMSTAT]\ Memory\ used\ at\ the\ end\ \%lu\ Bytes\ (\%f\ MB)\(\backslash\)n"{}},\ \mbox{\hyperlink{class_f_mem_stats_a9c59f050975273bc3c47ebc09fc846eb}{FMemStats::controler}}.\mbox{\hyperlink{class_f_mem_stats_ac2ff2ae5eb5e65f4b8b49e18fca89492}{getCurrentAllocated}}(),\ \mbox{\hyperlink{class_f_mem_stats_a9c59f050975273bc3c47ebc09fc846eb}{FMemStats::controler}}.\mbox{\hyperlink{class_f_mem_stats_afcb08e710c3ca7210596d800e4baaa80}{getCurrentAllocatedMB}}());}
\DoxyCodeLine{00056\ \ \ \ \ \ \ \ \ printf(\textcolor{stringliteral}{"{}[SCALFMM-\/MEMSTAT]\ Max\ memory\ used\ \%lld\ Bytes\ (\%f\ MB)\(\backslash\)n"{}},\ \mbox{\hyperlink{class_f_mem_stats_a9c59f050975273bc3c47ebc09fc846eb}{FMemStats::controler}}.\mbox{\hyperlink{class_f_mem_stats_aaa0d2c88a7d552d354d237cee04c960f}{getMaxAllocated}}(),\ \mbox{\hyperlink{class_f_mem_stats_a9c59f050975273bc3c47ebc09fc846eb}{FMemStats::controler}}.\mbox{\hyperlink{class_f_mem_stats_a4dd3bb43cc30fd8c707794762b3ad19c}{getMaxAllocatedMB}}());}
\DoxyCodeLine{00057\ \ \ \ \ \ \ \ \ printf(\textcolor{stringliteral}{"{}[SCALFMM-\/MEMSTAT]\ Total\ memory\ used\ \%lld\ Bytes\ (\%f\ MB)\(\backslash\)n"{}},\ \mbox{\hyperlink{class_f_mem_stats_a9c59f050975273bc3c47ebc09fc846eb}{FMemStats::controler}}.\mbox{\hyperlink{class_f_mem_stats_a967a4bf7625f04ee2cd118003acefac3}{getTotalAllocated}}(),\ \mbox{\hyperlink{class_f_mem_stats_a9c59f050975273bc3c47ebc09fc846eb}{FMemStats::controler}}.\mbox{\hyperlink{class_f_mem_stats_ade8724bc60082276b5ac9468c79680cf}{getTotalAllocatedMB}}());}
\DoxyCodeLine{00058\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{00059\ \ \ \ \ \ \ \ \ printf(\textcolor{stringliteral}{"{}[SCALFMM-\/MEMSTAT]\ unused\(\backslash\)n"{}});}
\DoxyCodeLine{00060\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00061\ \ \ \ \ \}}
\DoxyCodeLine{00062\ }
\DoxyCodeLine{00063\ \ \ \ \ \textcolor{keywordtype}{void}\ allocate(\textcolor{keyword}{const}\ std::size\_t\ size)\{}
\DoxyCodeLine{00064\ \ \ \ \ \ \ \ \ numberOfAllocations\ +=\ 1;}
\DoxyCodeLine{00065\ \ \ \ \ \ \ \ \ currentAllocated\ +=\ size;}
\DoxyCodeLine{00066\ \ \ \ \ \ \ \ \ totalAllocated\ \ \ +=\ size;}
\DoxyCodeLine{00067\ }
\DoxyCodeLine{00068\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(maxAllocated\ <\ currentAllocated)\{}
\DoxyCodeLine{00069\ \ \ \ \ \ \ \ \ \ \ \ \ maxAllocated\ =\ currentAllocated;}
\DoxyCodeLine{00070\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00071\ \ \ \ \ \}}
\DoxyCodeLine{00072\ }
\DoxyCodeLine{00073\ \ \ \ \ \textcolor{keywordtype}{void}\ deallocate(\textcolor{keyword}{const}\ std::size\_t\ size)\{}
\DoxyCodeLine{00074\ \ \ \ \ \ \ \ \ currentAllocated\ -\/=\ size;}
\DoxyCodeLine{00075\ \ \ \ \ \}}
\DoxyCodeLine{00076\ }
\DoxyCodeLine{00077\ \textcolor{preprocessor}{\#ifdef\ SCALFMM\_USE\_MEM\_STATS}}
\DoxyCodeLine{00078\ \ \ \ \ \textcolor{keyword}{friend}\ \textcolor{keywordtype}{void}*\ \textcolor{keyword}{operator}\ \textcolor{keyword}{new}(std::size\_t\ n);}
\DoxyCodeLine{00079\ \ \ \ \ \textcolor{keyword}{friend}\ \textcolor{keywordtype}{void}*\ \textcolor{keyword}{operator}\ \textcolor{keyword}{new}[](\ std::size\_t\ n\ );}
\DoxyCodeLine{00080\ \ \ \ \ \textcolor{keyword}{friend}\ \textcolor{keywordtype}{void}*\ \textcolor{keyword}{operator}\ \textcolor{keyword}{new}\ \ (\ std::size\_t\ n,\ \textcolor{keyword}{const}\ std::nothrow\_t\&\ tag);}
\DoxyCodeLine{00081\ \ \ \ \ \textcolor{keyword}{friend}\ \textcolor{keywordtype}{void}*\ \textcolor{keyword}{operator}\ \textcolor{keyword}{new}[](\ std::size\_t\ n,\ \textcolor{keyword}{const}\ std::nothrow\_t\&\ tag);}
\DoxyCodeLine{00082\ \ \ \ \ \textcolor{keyword}{friend}\ \textcolor{keywordtype}{void}\ \textcolor{keyword}{operator}\ \textcolor{keyword}{delete}(\textcolor{keywordtype}{void}*\ p)\ \textcolor{keyword}{noexcept};}
\DoxyCodeLine{00083\ \ \ \ \ \textcolor{keyword}{friend}\ \textcolor{keywordtype}{void}\ \textcolor{keyword}{operator}\ \textcolor{keyword}{delete}[](\textcolor{keywordtype}{void}*\ p)\ \textcolor{keyword}{noexcept};}
\DoxyCodeLine{00084\ \ \ \ \ \textcolor{keyword}{friend}\ \textcolor{keywordtype}{void}\ \textcolor{keyword}{operator}\ \textcolor{keyword}{delete}\ \ (\ \textcolor{keywordtype}{void}*\ ptr,\ \textcolor{keyword}{const}\ std::nothrow\_t\&\ tag);}
\DoxyCodeLine{00085\ \ \ \ \ \textcolor{keyword}{friend}\ \textcolor{keywordtype}{void}\ \textcolor{keyword}{operator}\ \textcolor{keyword}{delete}[](\ \textcolor{keywordtype}{void}*\ ptr,\ \textcolor{keyword}{const}\ std::nothrow\_t\&\ tag);}
\DoxyCodeLine{00086\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00087\ }
\DoxyCodeLine{00088\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00090\ \ \ \ \ \textcolor{keyword}{static}\ \mbox{\hyperlink{class_f_mem_stats}{FMemStats}}\ \mbox{\hyperlink{class_f_mem_stats_a9c59f050975273bc3c47ebc09fc846eb}{controler}};}
\DoxyCodeLine{00091\ }
\DoxyCodeLine{00093\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{long}\ \textcolor{keywordtype}{long}\ \mbox{\hyperlink{class_f_mem_stats_a30b2ad77ae3ffb5087aeff8e5e308324}{getNumberOfAllocations}}()\textcolor{keyword}{\ const}\{}
\DoxyCodeLine{00094\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ numberOfAllocations;}
\DoxyCodeLine{00095\ \ \ \ \ \}}
\DoxyCodeLine{00096\ }
\DoxyCodeLine{00098\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{long}\ \textcolor{keywordtype}{long}\ \mbox{\hyperlink{class_f_mem_stats_aaa0d2c88a7d552d354d237cee04c960f}{getMaxAllocated}}()\textcolor{keyword}{\ const}\{}
\DoxyCodeLine{00099\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ maxAllocated;}
\DoxyCodeLine{00100\ \ \ \ \ \}}
\DoxyCodeLine{00101\ }
\DoxyCodeLine{00103\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{long}\ \textcolor{keywordtype}{long}\ \mbox{\hyperlink{class_f_mem_stats_a967a4bf7625f04ee2cd118003acefac3}{getTotalAllocated}}()\textcolor{keyword}{\ const}\{}
\DoxyCodeLine{00104\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ totalAllocated;}
\DoxyCodeLine{00105\ \ \ \ \ \}}
\DoxyCodeLine{00106\ }
\DoxyCodeLine{00108\ \ \ \ \ std::size\_t\ \mbox{\hyperlink{class_f_mem_stats_ac2ff2ae5eb5e65f4b8b49e18fca89492}{getCurrentAllocated}}()\textcolor{keyword}{\ const}\{}
\DoxyCodeLine{00109\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ currentAllocated;}
\DoxyCodeLine{00110\ \ \ \ \ \}}
\DoxyCodeLine{00111\ }
\DoxyCodeLine{00113\ \ \ \ \ \textcolor{keywordtype}{float}\ \mbox{\hyperlink{class_f_mem_stats_a4dd3bb43cc30fd8c707794762b3ad19c}{getMaxAllocatedMB}}()\textcolor{keyword}{\ const}\{}
\DoxyCodeLine{00114\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ float(\mbox{\hyperlink{class_f_mem_stats_aaa0d2c88a7d552d354d237cee04c960f}{getMaxAllocated}}())\ /\ 1024\ /\ 1024;}
\DoxyCodeLine{00115\ \ \ \ \ \}}
\DoxyCodeLine{00116\ }
\DoxyCodeLine{00118\ \ \ \ \ \textcolor{keywordtype}{float}\ \mbox{\hyperlink{class_f_mem_stats_ade8724bc60082276b5ac9468c79680cf}{getTotalAllocatedMB}}()\textcolor{keyword}{\ const}\{}
\DoxyCodeLine{00119\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ float(\mbox{\hyperlink{class_f_mem_stats_a967a4bf7625f04ee2cd118003acefac3}{getTotalAllocated}}())\ /\ 1024\ /\ 1024;}
\DoxyCodeLine{00120\ \ \ \ \ \}}
\DoxyCodeLine{00121\ }
\DoxyCodeLine{00123\ \ \ \ \ \textcolor{keywordtype}{float}\ \mbox{\hyperlink{class_f_mem_stats_afcb08e710c3ca7210596d800e4baaa80}{getCurrentAllocatedMB}}()\textcolor{keyword}{\ const}\{}
\DoxyCodeLine{00124\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ float(\mbox{\hyperlink{class_f_mem_stats_ac2ff2ae5eb5e65f4b8b49e18fca89492}{getCurrentAllocated}}())\ /\ 1024\ /\ 1024;}
\DoxyCodeLine{00125\ \ \ \ \ \}}
\DoxyCodeLine{00126\ }
\DoxyCodeLine{00128\ \ \ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{class_f_mem_stats_aaba027a2f8402312aa45427d24a01593}{isUsed}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00129\ \textcolor{preprocessor}{\#ifdef\ SCALFMM\_USE\_MEM\_STATS}}
\DoxyCodeLine{00130\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00131\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{00132\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00133\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00134\ \ \ \ \ \}}
\DoxyCodeLine{00135\ \};}
\DoxyCodeLine{00136\ }
\DoxyCodeLine{00137\ }
\DoxyCodeLine{00138\ \textcolor{preprocessor}{\#endif\ }\textcolor{comment}{//\ FMEMSTATS\_H}}

\end{DoxyCode}
