\doxysection{FSpherical\+Kernel.\+hpp}
\hypertarget{_f_spherical_kernel_8hpp_source}{}\label{_f_spherical_kernel_8hpp_source}\index{third\_party/ScalFMM/include/ScalFMM/Kernels/Spherical/FSphericalKernel.hpp@{third\_party/ScalFMM/include/ScalFMM/Kernels/Spherical/FSphericalKernel.hpp}}

\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{comment}{//\ See\ LICENCE\ file\ at\ project\ root}}
\DoxyCodeLine{00002\ \textcolor{preprocessor}{\#ifndef\ FSPHERICALKERNEL\_HPP}}
\DoxyCodeLine{00003\ \textcolor{preprocessor}{\#define\ FSPHERICALKERNEL\_HPP}}
\DoxyCodeLine{00004\ }
\DoxyCodeLine{00005\ \textcolor{preprocessor}{\#include\ "{}FAbstractSphericalKernel.hpp"{}}}
\DoxyCodeLine{00006\ \textcolor{preprocessor}{\#include\ "{}../../Utils/FMemUtils.hpp"{}}}
\DoxyCodeLine{00007\ }
\DoxyCodeLine{00012\ \textcolor{keyword}{template}<\ \textcolor{keyword}{class}\ FReal,\ \textcolor{keyword}{class}\ CellClass,\ \textcolor{keyword}{class}\ ContainerClass>}
\DoxyCodeLine{00013\ \textcolor{keyword}{class\ }\mbox{\hyperlink{class_f_spherical_kernel}{FSphericalKernel}}\ :\ \textcolor{keyword}{public}\ \mbox{\hyperlink{class_f_abstract_spherical_kernel}{FAbstractSphericalKernel}}<FReal,\ CellClass,ContainerClass>\ \{}
\DoxyCodeLine{00014\ \textcolor{keyword}{protected}:}
\DoxyCodeLine{00015\ \ \ \ \ \textcolor{keyword}{typedef}\ \mbox{\hyperlink{class_f_abstract_spherical_kernel}{FAbstractSphericalKernel<FReal,\ CellClass,ContainerClass>}}\ \mbox{\hyperlink{class_f_abstract_spherical_kernel}{Parent}};}
\DoxyCodeLine{00016\ }
\DoxyCodeLine{00017\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ devM2lP;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//<\ A\ secondary\ P}}
\DoxyCodeLine{00018\ }
\DoxyCodeLine{00019\ \ \ \ \ \mbox{\hyperlink{class_f_smart_pointer}{FSmartPointer<FComplex<FReal>}}*>\ preM2LTransitions;\ \ \ \textcolor{comment}{//<\ The\ pre-\/computation\ for\ the\ M2L\ based\ on\ the\ level\ and\ the\ 189\ possibilities}}
\DoxyCodeLine{00020\ }
\DoxyCodeLine{00022\ \ \ \ \ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{class_f_spherical_kernel_a5b923bf4f64d30d7b441a096d547d53b}{indexM2LTransition}}(\textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ idxX,\textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ idxY,\textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ idxZ)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00023\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ (((((idxX+3)\ *\ 7)\ +\ (idxY+3))\ *\ 7\ )\ +\ (idxZ+3))\ *\ devM2lP;}
\DoxyCodeLine{00024\ \ \ \ \ \}}
\DoxyCodeLine{00025\ }
\DoxyCodeLine{00027\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_f_spherical_kernel_ad58cefc1c7a3e217b9765a67286c3211}{allocAndInit}}()\{}
\DoxyCodeLine{00028\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ M2L\ transfer,\ there\ is\ a\ maximum\ of\ 3\ neighbors\ in\ each\ direction,}}
\DoxyCodeLine{00029\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ so\ 6\ in\ each\ dimension}}
\DoxyCodeLine{00030\ \ \ \ \ \ \ \ \ preM2LTransitions\ =\ \textcolor{keyword}{new}\ \mbox{\hyperlink{class_f_complex}{FComplex<FReal>}}*[Parent::treeHeight];}
\DoxyCodeLine{00031\ \ \ \ \ \ \ \ \ memset(preM2LTransitions.\mbox{\hyperlink{class_f_smart_pointer_a82a013f34ea6809b1d72da35daff374c}{getPtr}}(),\ 0,\ \textcolor{keyword}{sizeof}(\mbox{\hyperlink{class_f_complex}{FComplex<FReal>}}*)\ *\ (Parent::treeHeight));}
\DoxyCodeLine{00032\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ We\ start\ from\ the\ higher\ level}}
\DoxyCodeLine{00033\ \ \ \ \ \ \ \ \ FReal\ treeWidthAtLevel\ =\ Parent::boxWidth;}
\DoxyCodeLine{00034\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ idxLevel\ =\ 0\ ;\ idxLevel\ <\ Parent::treeHeight\ ;\ ++idxLevel\ )\{}
\DoxyCodeLine{00035\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Allocate\ data\ for\ this\ level}}
\DoxyCodeLine{00036\ \ \ \ \ \ \ \ \ \ \ \ \ preM2LTransitions[idxLevel]\ =\ \textcolor{keyword}{new}\ \mbox{\hyperlink{class_f_complex}{FComplex<FReal>}}[(7\ *\ 7\ *\ 7)\ *\ devM2lP];}
\DoxyCodeLine{00037\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Precompute\ transfer\ vector}}
\DoxyCodeLine{00038\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ idxX\ =\ -\/3\ ;\ idxX\ <=\ 3\ ;\ ++idxX\ )\{}
\DoxyCodeLine{00039\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ idxY\ =\ -\/3\ ;\ idxY\ <=\ 3\ ;\ ++idxY\ )\{}
\DoxyCodeLine{00040\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ idxZ\ =\ -\/3\ ;\ idxZ\ <=\ 3\ ;\ ++idxZ\ )\{}
\DoxyCodeLine{00041\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{struct_f_math_ac005cd270abc850853ba71d1e38a2f28}{FMath::Abs}}(idxX)\ >\ 1\ ||\ \mbox{\hyperlink{struct_f_math_ac005cd270abc850853ba71d1e38a2f28}{FMath::Abs}}(idxY)\ >\ 1\ ||\ \mbox{\hyperlink{struct_f_math_ac005cd270abc850853ba71d1e38a2f28}{FMath::Abs}}(idxZ)\ >\ 1)\{}
\DoxyCodeLine{00042\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_f_point}{FPoint<FReal>}}\ relativePos(\ FReal(-\/idxX)\ *\ treeWidthAtLevel\ ,\ FReal(-\/idxY)\ *\ treeWidthAtLevel\ ,\ FReal(-\/idxZ)\ *\ treeWidthAtLevel\ );}
\DoxyCodeLine{00043\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Parent::harmonic.computeOuter(\mbox{\hyperlink{class_f_spherical}{FSpherical<FReal>}}(relativePos));}
\DoxyCodeLine{00044\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ FMemUtils::copyall<FComplex<FReal>>(\&preM2LTransitions[idxLevel][\mbox{\hyperlink{class_f_spherical_kernel_a5b923bf4f64d30d7b441a096d547d53b}{indexM2LTransition}}(idxX,idxY,idxZ)],\ Parent::harmonic.result(),\ Parent::harmonic.getExpSize());}
\DoxyCodeLine{00045\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00046\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00047\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00048\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00049\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ We\ divide\ the\ bow\ per\ 2\ when\ we\ go\ down}}
\DoxyCodeLine{00050\ \ \ \ \ \ \ \ \ \ \ \ \ treeWidthAtLevel\ /=\ 2;}
\DoxyCodeLine{00051\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00052\ \ \ \ \ \}}
\DoxyCodeLine{00053\ }
\DoxyCodeLine{00054\ }
\DoxyCodeLine{00055\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00062\ \ \ \ \ \mbox{\hyperlink{class_f_spherical_kernel_affae1de0fed3062c2f2458d73bc46c4b}{FSphericalKernel}}(\textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ inDevP,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ inTreeHeight,\ \textcolor{keyword}{const}\ FReal\ inBoxWidth,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_f_point}{FPoint<FReal>}}\&\ inBoxCenter)}
\DoxyCodeLine{00063\ \ \ \ \ \ \ \ \ :\ \mbox{\hyperlink{class_f_abstract_spherical_kernel}{Parent}}(inDevP,\ inTreeHeight,\ inBoxWidth,\ inBoxCenter),}
\DoxyCodeLine{00064\ \ \ \ \ \ \ \ \ \ \ devM2lP(int(((inDevP*2)+1)\ *\ ((inDevP*2)+2)\ *\ 0.5)),}
\DoxyCodeLine{00065\ \ \ \ \ \ \ \ \ \ \ preM2LTransitions(nullptr)\ \{}
\DoxyCodeLine{00066\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_f_spherical_kernel_ad58cefc1c7a3e217b9765a67286c3211}{allocAndInit}}();}
\DoxyCodeLine{00067\ \ \ \ \ \}}
\DoxyCodeLine{00068\ }
\DoxyCodeLine{00070\ \ \ \ \ \mbox{\hyperlink{class_f_spherical_kernel_a49708f02ed472278d75d0dd7930ae9d9}{FSphericalKernel}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{class_f_spherical_kernel}{FSphericalKernel}}\&\ other)}
\DoxyCodeLine{00071\ \ \ \ \ \ \ \ \ :\ \mbox{\hyperlink{class_f_abstract_spherical_kernel}{Parent}}(other),\ devM2lP(other.devM2lP),}
\DoxyCodeLine{00072\ \ \ \ \ \ \ \ \ \ \ preM2LTransitions(other.preM2LTransitions)\ \{}
\DoxyCodeLine{00073\ }
\DoxyCodeLine{00074\ \ \ \ \ \}}
\DoxyCodeLine{00075\ }
\DoxyCodeLine{00077\ \ \ \ \ \mbox{\hyperlink{class_f_spherical_kernel_a0272c708d06033960292d2bf4abe926e}{\string~FSphericalKernel}}()\{}
\DoxyCodeLine{00078\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\ preM2LTransitions.\mbox{\hyperlink{class_f_smart_pointer_a459476d73cfce7884ad33e3ddd879876}{isLast}}()\ )\{}
\DoxyCodeLine{00079\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespace_f_mem_utils_a17fae6253fc1995fc0aeb7b1bc2bef7c}{FMemUtils::DeleteAllArray}}(preM2LTransitions.\mbox{\hyperlink{class_f_smart_pointer_a82a013f34ea6809b1d72da35daff374c}{getPtr}}(),\ Parent::treeHeight);}
\DoxyCodeLine{00080\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00081\ \ \ \ \ \}}
\DoxyCodeLine{00082\ }
\DoxyCodeLine{00084\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_f_spherical_kernel_a9e29490bc444004ad93de06dbae9ab98}{M2L}}(CellClass*\ \textcolor{keyword}{const}\ FRestrict\ inLocal,\ \textcolor{keyword}{const}\ CellClass*\ distantNeighbors[],}
\DoxyCodeLine{00085\ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ neighborPositions[],\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ inSize,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ inLevel)\textcolor{keyword}{\ \ override\ }\{}
\DoxyCodeLine{00086\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ For\ all\ neighbors\ compute\ M2L}}
\DoxyCodeLine{00087\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ idxExistingNeigh\ =\ 0\ ;\ idxExistingNeigh\ <\ inSize\ ;\ ++idxExistingNeigh)\{}
\DoxyCodeLine{00088\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ idxNeigh\ =\ neighborPositions[idxExistingNeigh];}
\DoxyCodeLine{00089\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_f_complex}{FComplex<FReal>}}*\ \textcolor{keyword}{const}\ transitionVector\ =\ \&preM2LTransitions[inLevel][idxNeigh\ *\ devM2lP];}
\DoxyCodeLine{00090\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_f_spherical_kernel_a4b1979a3ad6de9e56239767be6281ede}{multipoleToLocal}}(inLocal-\/>getLocal(),\ distantNeighbors[idxExistingNeigh]-\/>getMultipole(),\ transitionVector);}
\DoxyCodeLine{00091\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00092\ \ \ \ \ \}}
\DoxyCodeLine{00093\ }
\DoxyCodeLine{00094\ }
\DoxyCodeLine{00113\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_f_spherical_kernel_a4b1979a3ad6de9e56239767be6281ede}{multipoleToLocal}}(\mbox{\hyperlink{class_f_complex}{FComplex<FReal>}}*\textcolor{keyword}{const}\ FRestrict\ local\_exp,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_f_complex}{FComplex<FReal>}}*\ \textcolor{keyword}{const}\ FRestrict\ multipole\_exp\_src,}
\DoxyCodeLine{00114\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_f_complex}{FComplex<FReal>}}*\ \textcolor{keyword}{const}\ FRestrict\ M2L\_Outer\_transfer)\{}
\DoxyCodeLine{00115\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ index\_j\_k\ =\ 0;}
\DoxyCodeLine{00116\ }
\DoxyCodeLine{00117\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ L\_j\string^k}}
\DoxyCodeLine{00118\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ HPMSTART(51,\ "{}M2L\ computation\ (loops)"{});}}
\DoxyCodeLine{00119\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ j\ from\ 0\ to\ P}}
\DoxyCodeLine{00120\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0\ ;\ j\ <=\ Parent::devP\ ;\ ++j)\{}
\DoxyCodeLine{00121\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ (-\/1)\string^k}}
\DoxyCodeLine{00122\ \ \ \ \ \ \ \ \ \ \ \ \ FReal\ pow\_of\_minus\_1\_for\_k\ =\ 1.0;}
\DoxyCodeLine{00123\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//k\ from\ 0\ to\ j}}
\DoxyCodeLine{00124\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ k\ =\ 0\ ;\ k\ <=\ j\ ;\ ++k,\ ++index\_j\_k)\{}
\DoxyCodeLine{00125\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ (-\/1)\string^n}}
\DoxyCodeLine{00126\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ FReal\ pow\_of\_minus\_1\_for\_n\ =\ 1.0;}
\DoxyCodeLine{00127\ }
\DoxyCodeLine{00128\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ work\ with\ a\ local\ variable}}
\DoxyCodeLine{00129\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_f_complex}{FComplex<FReal>}}\ L\_j\_k\ =\ local\_exp[index\_j\_k];}
\DoxyCodeLine{00130\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ n\ from\ 0\ to\ P\ or\ do\ P-\/j}}
\DoxyCodeLine{00131\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//for\ (int\ n\ =\ 0\ ;\ n\ <=\ Parent::devP\ /*or*/\ /*Parent::devP-\/j*/\ ;\ ++n)\{}}
\DoxyCodeLine{00132\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ n\ =\ 0\ ;\ n\ <=\ Parent::devP-\/j\ ;\ ++n)\{\ \ \textcolor{comment}{//\ faster\ than\ double\ height\ Parent::devP}}
\DoxyCodeLine{00133\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ O\_n\string^l\ :\ here\ points\ on\ the\ source\ multipole\ expansion\ term\ of\ degree\ n\ and\ order\ |l|}}
\DoxyCodeLine{00134\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ index\_n\ =\ Parent::harmonic.getPreExpRedirJ(n);}
\DoxyCodeLine{00135\ }
\DoxyCodeLine{00136\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Outer\_\{j+n\}\string^\{-\/k-\/l\}\ :\ here\ points\ on\ the\ M2L\ transfer\ function/expansion\ term\ of\ degree\ j+n\ and\ order\ |-\/k-\/l|}}
\DoxyCodeLine{00137\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ index\_n\_j\ =\ Parent::harmonic.getPreExpRedirJ(n+j);}
\DoxyCodeLine{00138\ }
\DoxyCodeLine{00139\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ FReal\ pow\_of\_minus\_1\_for\_l\ =\ pow\_of\_minus\_1\_for\_n;\ \textcolor{comment}{//\ (-\/1)\string^l}}
\DoxyCodeLine{00140\ }
\DoxyCodeLine{00141\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ We\ start\ with\ l=n\ (and\ not\ l=-\/n)\ so\ that\ we\ always\ set\ p\_Outer\_term\ to\ a\ correct\ value\ in\ the\ first\ loop.}}
\DoxyCodeLine{00142\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ l\ =\ n;}
\DoxyCodeLine{00143\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{comment}{/*\ l\ =\ n\ */}\ ;\ l\ >\ 0\ ;\ -\/-\/l)\{\ \textcolor{comment}{//\ we\ have\ -\/k-\/l<0\ and\ l>0}}
\DoxyCodeLine{00144\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_f_complex}{FComplex<FReal>}}\ M\_n\_l\ =\ multipole\_exp\_src[index\_n\ +\ l];}
\DoxyCodeLine{00145\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_f_complex}{FComplex<FReal>}}\ O\_n\_j\_\_k\_l\ =\ M2L\_Outer\_transfer[index\_n\_j\ +\ k\ +\ l];}
\DoxyCodeLine{00146\ }
\DoxyCodeLine{00147\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ L\_j\_k.\mbox{\hyperlink{class_f_complex_a239af6b36a7a875cf409af96ed286bf8}{incReal}}(\ pow\_of\_minus\_1\_for\_l\ *\ pow\_of\_minus\_1\_for\_k\ *}
\DoxyCodeLine{00148\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ((M\_n\_l.\mbox{\hyperlink{class_f_complex_a33ec217df0f06432eec174977e0c87ff}{getReal}}()\ *\ O\_n\_j\_\_k\_l.\mbox{\hyperlink{class_f_complex_a33ec217df0f06432eec174977e0c87ff}{getReal}}())\ +}
\DoxyCodeLine{00149\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (M\_n\_l.\mbox{\hyperlink{class_f_complex_ab4db8e82d8c014c17b06089163a3c204}{getImag}}()\ *\ O\_n\_j\_\_k\_l.\mbox{\hyperlink{class_f_complex_ab4db8e82d8c014c17b06089163a3c204}{getImag}}())));}
\DoxyCodeLine{00150\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ L\_j\_k.\mbox{\hyperlink{class_f_complex_a5da751a7b9af375136091cad0bc8e1d9}{incImag}}(\ pow\_of\_minus\_1\_for\_l\ *\ pow\_of\_minus\_1\_for\_k\ *}
\DoxyCodeLine{00151\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ((M\_n\_l.\mbox{\hyperlink{class_f_complex_ab4db8e82d8c014c17b06089163a3c204}{getImag}}()\ *\ O\_n\_j\_\_k\_l.\mbox{\hyperlink{class_f_complex_a33ec217df0f06432eec174977e0c87ff}{getReal}}())\ -\/}
\DoxyCodeLine{00152\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (M\_n\_l.\mbox{\hyperlink{class_f_complex_a33ec217df0f06432eec174977e0c87ff}{getReal}}()\ *\ O\_n\_j\_\_k\_l.\mbox{\hyperlink{class_f_complex_ab4db8e82d8c014c17b06089163a3c204}{getImag}}())));}
\DoxyCodeLine{00153\ }
\DoxyCodeLine{00154\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ pow\_of\_minus\_1\_for\_l\ =\ -\/pow\_of\_minus\_1\_for\_l;}
\DoxyCodeLine{00155\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00156\ }
\DoxyCodeLine{00157\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{comment}{/*\ l\ =\ 0\ */};\ l\ >=\ -\/n\ \&\&\ \ (-\/k-\/l)\ <\ 0\ ;\ -\/-\/l)\{\ \textcolor{comment}{//\ we\ have\ -\/k-\/l<0\ and\ l<=0}}
\DoxyCodeLine{00158\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_f_complex}{FComplex<FReal>}}\ M\_n\_l\ =\ multipole\_exp\_src[index\_n\ -\/\ l];}
\DoxyCodeLine{00159\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_f_complex}{FComplex<FReal>}}\ O\_n\_j\_\_k\_l\ =\ M2L\_Outer\_transfer[index\_n\_j\ +\ k\ +\ l];}
\DoxyCodeLine{00160\ }
\DoxyCodeLine{00161\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ L\_j\_k.\mbox{\hyperlink{class_f_complex_a239af6b36a7a875cf409af96ed286bf8}{incReal}}(\ pow\_of\_minus\_1\_for\_k\ *}
\DoxyCodeLine{00162\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ((M\_n\_l.\mbox{\hyperlink{class_f_complex_a33ec217df0f06432eec174977e0c87ff}{getReal}}()\ *\ O\_n\_j\_\_k\_l.\mbox{\hyperlink{class_f_complex_a33ec217df0f06432eec174977e0c87ff}{getReal}}())\ -\/}
\DoxyCodeLine{00163\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (M\_n\_l.\mbox{\hyperlink{class_f_complex_ab4db8e82d8c014c17b06089163a3c204}{getImag}}()\ *\ O\_n\_j\_\_k\_l.\mbox{\hyperlink{class_f_complex_ab4db8e82d8c014c17b06089163a3c204}{getImag}}())));}
\DoxyCodeLine{00164\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ L\_j\_k.\mbox{\hyperlink{class_f_complex_a221e2f008a120858089b7fda8eeb8984}{decImag}}(\ \ pow\_of\_minus\_1\_for\_k\ *}
\DoxyCodeLine{00165\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ((M\_n\_l.\mbox{\hyperlink{class_f_complex_ab4db8e82d8c014c17b06089163a3c204}{getImag}}()\ *\ O\_n\_j\_\_k\_l.\mbox{\hyperlink{class_f_complex_a33ec217df0f06432eec174977e0c87ff}{getReal}}())\ +}
\DoxyCodeLine{00166\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (M\_n\_l.\mbox{\hyperlink{class_f_complex_a33ec217df0f06432eec174977e0c87ff}{getReal}}()\ *\ O\_n\_j\_\_k\_l.\mbox{\hyperlink{class_f_complex_ab4db8e82d8c014c17b06089163a3c204}{getImag}}())));}
\DoxyCodeLine{00167\ }
\DoxyCodeLine{00168\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ pow\_of\_minus\_1\_for\_l\ =\ -\/pow\_of\_minus\_1\_for\_l;}
\DoxyCodeLine{00169\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00170\ }
\DoxyCodeLine{00171\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{comment}{/*l\ =\ -\/n-\/1\ or\ l\ =\ -\/k-\/1\ */};\ l\ >=\ -\/n\ ;\ -\/-\/l)\{\ \textcolor{comment}{//\ we\ have\ -\/k-\/l>=0\ and\ l<=0}}
\DoxyCodeLine{00172\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_f_complex}{FComplex<FReal>}}\ M\_n\_l\ =\ multipole\_exp\_src[index\_n\ -\/\ l];}
\DoxyCodeLine{00173\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_f_complex}{FComplex<FReal>}}\ O\_n\_j\_\_k\_l\ =\ M2L\_Outer\_transfer[index\_n\_j\ -\/\ (k\ +\ l)];}
\DoxyCodeLine{00174\ }
\DoxyCodeLine{00175\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ L\_j\_k.\mbox{\hyperlink{class_f_complex_a239af6b36a7a875cf409af96ed286bf8}{incReal}}(\ pow\_of\_minus\_1\_for\_l\ *}
\DoxyCodeLine{00176\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ((M\_n\_l.\mbox{\hyperlink{class_f_complex_a33ec217df0f06432eec174977e0c87ff}{getReal}}()\ *\ O\_n\_j\_\_k\_l.\mbox{\hyperlink{class_f_complex_a33ec217df0f06432eec174977e0c87ff}{getReal}}())\ +}
\DoxyCodeLine{00177\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (M\_n\_l.\mbox{\hyperlink{class_f_complex_ab4db8e82d8c014c17b06089163a3c204}{getImag}}()\ *\ O\_n\_j\_\_k\_l.\mbox{\hyperlink{class_f_complex_ab4db8e82d8c014c17b06089163a3c204}{getImag}}())));}
\DoxyCodeLine{00178\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ L\_j\_k.\mbox{\hyperlink{class_f_complex_a5da751a7b9af375136091cad0bc8e1d9}{incImag}}(\ pow\_of\_minus\_1\_for\_l\ *}
\DoxyCodeLine{00179\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ((M\_n\_l.\mbox{\hyperlink{class_f_complex_a33ec217df0f06432eec174977e0c87ff}{getReal}}()\ *\ O\_n\_j\_\_k\_l.\mbox{\hyperlink{class_f_complex_ab4db8e82d8c014c17b06089163a3c204}{getImag}}())\ -\/}
\DoxyCodeLine{00180\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (M\_n\_l.\mbox{\hyperlink{class_f_complex_ab4db8e82d8c014c17b06089163a3c204}{getImag}}()\ *\ O\_n\_j\_\_k\_l.\mbox{\hyperlink{class_f_complex_a33ec217df0f06432eec174977e0c87ff}{getReal}}())));}
\DoxyCodeLine{00181\ }
\DoxyCodeLine{00182\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ pow\_of\_minus\_1\_for\_l\ =\ -\/pow\_of\_minus\_1\_for\_l;}
\DoxyCodeLine{00183\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00184\ }
\DoxyCodeLine{00185\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ pow\_of\_minus\_1\_for\_n\ =\ -\/pow\_of\_minus\_1\_for\_n;}
\DoxyCodeLine{00186\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}\textcolor{comment}{//n}}
\DoxyCodeLine{00187\ }
\DoxyCodeLine{00188\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ put\ in\ the\ local\ vector}}
\DoxyCodeLine{00189\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ local\_exp[index\_j\_k]\ =\ L\_j\_k;}
\DoxyCodeLine{00190\ }
\DoxyCodeLine{00191\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ pow\_of\_minus\_1\_for\_k\ =\ -\/pow\_of\_minus\_1\_for\_k;}
\DoxyCodeLine{00192\ \ \ \ \ \ \ \ \ \ \ \ \ \}\textcolor{comment}{//k}}
\DoxyCodeLine{00193\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00194\ \ \ \ \ \}}
\DoxyCodeLine{00195\ \};}
\DoxyCodeLine{00196\ }
\DoxyCodeLine{00197\ \textcolor{preprocessor}{\#endif\ }\textcolor{comment}{//\ FSPHERICALKERNEL\_HPP}}

\end{DoxyCode}
