\doxysection{FTaylor\+Kernel.\+hpp}
\hypertarget{_f_taylor_kernel_8hpp_source}{}\label{_f_taylor_kernel_8hpp_source}\index{third\_party/ScalFMM/include/ScalFMM/Kernels/Taylor/FTaylorKernel.hpp@{third\_party/ScalFMM/include/ScalFMM/Kernels/Taylor/FTaylorKernel.hpp}}

\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{comment}{//\ See\ LICENCE\ file\ at\ project\ root}}
\DoxyCodeLine{00002\ \textcolor{preprocessor}{\#ifndef\ FTAYLORKERNEL\_HPP}}
\DoxyCodeLine{00003\ \textcolor{preprocessor}{\#define\ FTAYLORKERNEL\_HPP}}
\DoxyCodeLine{00004\ }
\DoxyCodeLine{00005\ \textcolor{preprocessor}{\#include\ "{}../../Components/FAbstractKernels.hpp"{}}}
\DoxyCodeLine{00006\ \textcolor{preprocessor}{\#include\ "{}../../Utils/FMemUtils.hpp"{}}}
\DoxyCodeLine{00007\ \textcolor{preprocessor}{\#include\ "{}../../Utils/FLog.hpp"{}}}
\DoxyCodeLine{00008\ \textcolor{preprocessor}{\#include\ "{}../../Utils/FSmartPointer.hpp"{}}}
\DoxyCodeLine{00009\ \textcolor{preprocessor}{\#include\ "{}../P2P/FP2PR.hpp"{}}}
\DoxyCodeLine{00010\ }
\DoxyCodeLine{00021\ \textcolor{comment}{//TODO\ sp√©cifier\ les\ arguments.}}
\DoxyCodeLine{00022\ \textcolor{keyword}{template}<\ \ \textcolor{keyword}{class}\ FReal,\ \textcolor{keyword}{class}\ CellClass,\ \textcolor{keyword}{class}\ ContainerClass,\ \textcolor{keywordtype}{int}\ P,\ \textcolor{keywordtype}{int}\ order>}
\DoxyCodeLine{00023\ \textcolor{keyword}{class\ }\mbox{\hyperlink{class_f_taylor_kernel}{FTaylorKernel}}\ :\ \textcolor{keyword}{public}\ \mbox{\hyperlink{class_f_abstract_kernels}{FAbstractKernels}}<CellClass,ContainerClass>\ \{}
\DoxyCodeLine{00024\ }
\DoxyCodeLine{00025\ \textcolor{keyword}{private}:}
\DoxyCodeLine{00026\ \ \ \ \ \textcolor{comment}{//Size\ of\ the\ multipole\ and\ local\ vectors}}
\DoxyCodeLine{00027\ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ SizeVector\ =\ ((P+1)*(P+2)*(P+3))*order/6;}
\DoxyCodeLine{00028\ }
\DoxyCodeLine{00029\ }
\DoxyCodeLine{00031\ \ \ \ \ \textcolor{comment}{//\ Object\ Attributes}}
\DoxyCodeLine{00033\ \ \ \ \ \textcolor{keyword}{const}\ FReal\ boxWidth;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//<\ the\ box\ width\ at\ leaf\ level}}
\DoxyCodeLine{00034\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ \ \ treeHeight;\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//<\ The\ height\ of\ the\ tree}}
\DoxyCodeLine{00035\ \ \ \ \ \textcolor{keyword}{const}\ FReal\ widthAtLeafLevel;\ \ \ \ \ \ \ \textcolor{comment}{//<\ width\ of\ box\ at\ leaf\ level}}
\DoxyCodeLine{00036\ \ \ \ \ \textcolor{keyword}{const}\ FReal\ widthAtLeafLevelDiv2;\ \ \ \textcolor{comment}{//<\ width\ of\ box\ at\ leaf\ leve\ div\ 2}}
\DoxyCodeLine{00037\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_f_point}{FPoint<FReal>}}\ boxCorner;\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//<\ position\ of\ the\ box\ corner}}
\DoxyCodeLine{00038\ }
\DoxyCodeLine{00040\ \ \ \ \ \textcolor{comment}{//\ PreComputed\ values}}
\DoxyCodeLine{00042\ \ \ \ \ FReal\ factorials[2*P+1];\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//<\ This\ contains\ the\ factorial\ until\ P}}
\DoxyCodeLine{00043\ \ \ \ \ FReal\ arrayDX[P+2],arrayDY[P+2],arrayDZ[P+2]\ ;\ \textcolor{comment}{//<\ Working\ arrays}}
\DoxyCodeLine{00044\ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ \ sizeDerivative\ =\ (2*P+1)*(P+1)*(2*P+3)/3;}
\DoxyCodeLine{00045\ \ \ \ \ FReal\ \_PsiVector[sizeDerivative];}
\DoxyCodeLine{00046\ \ \ \ \ \mbox{\hyperlink{class_f_smart_pointer}{FSmartPointer<\ FReal[343][sizeDerivative]\ >}}\ M2LpreComputedDerivatives;}
\DoxyCodeLine{00047\ \ \ \ \ \mbox{\hyperlink{class_f_smart_pointer}{FSmartPointer<\ int[SizeVector]\ >}}\ preComputedIndirections;}
\DoxyCodeLine{00048\ }
\DoxyCodeLine{00049\ \ \ \ \ FReal\ \_coeffPoly[SizeVector];}
\DoxyCodeLine{00050\ }
\DoxyCodeLine{00051\ }
\DoxyCodeLine{00053\ \ \ \ \ \textcolor{comment}{//\ Private\ method}}
\DoxyCodeLine{00055\ }
\DoxyCodeLine{00057\ \ \ \ \ \textcolor{comment}{//\ Precomputation}}
\DoxyCodeLine{00059\ }
\DoxyCodeLine{00064\ \ \ \ \ \textcolor{keywordtype}{void}\ precomputeFactorials()\{}
\DoxyCodeLine{00065\ \ \ \ \ \ \ \ \ factorials[0]\ =\ 1.0;}
\DoxyCodeLine{00066\ \ \ \ \ \ \ \ \ FReal\ fidx\ =\ 1.0;}
\DoxyCodeLine{00067\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ idx\ =\ 1\ ;\ idx\ <=\ 2*P\ ;\ ++idx,\ ++fidx)\{}
\DoxyCodeLine{00068\ \ \ \ \ \ \ \ \ \ \ \ \ factorials[idx]\ =\ fidx\ *\ factorials[idx-\/1];}
\DoxyCodeLine{00069\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00070\ \ \ \ \ \}}
\DoxyCodeLine{00071\ }
\DoxyCodeLine{00072\ }
\DoxyCodeLine{00074\ \ \ \ \ \mbox{\hyperlink{class_f_point}{FPoint<FReal>}}\ getLeafCenter(\textcolor{keyword}{const}\ \mbox{\hyperlink{class_f_tree_coordinate}{FTreeCoordinate}}\ coordinate)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00075\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{class_f_point}{FPoint<FReal>}}(}
\DoxyCodeLine{00076\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ FReal(coordinate.\mbox{\hyperlink{class_f_point_a58d3859160347552d6a4a94fbdf883c3}{getX}}())\ *\ widthAtLeafLevel\ +\ widthAtLeafLevelDiv2\ +\ boxCorner.\mbox{\hyperlink{class_f_point_a58d3859160347552d6a4a94fbdf883c3}{getX}}(),}
\DoxyCodeLine{00077\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ FReal(coordinate.\mbox{\hyperlink{class_f_point_ae4383512b9b8d216775b3fb92325cfc9}{getY}}())\ *\ widthAtLeafLevel\ +\ widthAtLeafLevelDiv2\ +\ boxCorner.\mbox{\hyperlink{class_f_point_ae4383512b9b8d216775b3fb92325cfc9}{getY}}(),}
\DoxyCodeLine{00078\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ FReal(coordinate.\mbox{\hyperlink{class_f_point_a02208d4db50cbafe597adcbfb152b536}{getZ}}())\ *\ widthAtLeafLevel\ +\ widthAtLeafLevelDiv2\ +\ boxCorner.\mbox{\hyperlink{class_f_point_a02208d4db50cbafe597adcbfb152b536}{getZ}}());}
\DoxyCodeLine{00079\ \ \ \ \ \}}
\DoxyCodeLine{00080\ }
\DoxyCodeLine{00087\ \ \ \ \ \mbox{\hyperlink{class_f_point}{FPoint<FReal>}}\ getCellCenter(\textcolor{keyword}{const}\ \mbox{\hyperlink{class_f_tree_coordinate}{FTreeCoordinate}}\ coordinate,\ \textcolor{keywordtype}{int}\ inLevel)}
\DoxyCodeLine{00088\ \ \ \ \ \{}
\DoxyCodeLine{00089\ \ \ \ \ \ \ \ \ \textcolor{comment}{//Set\ the\ boxes\ width\ needed}}
\DoxyCodeLine{00090\ \ \ \ \ \ \ \ \ FReal\ widthAtCurrentLevel\ =\ widthAtLeafLevel*FReal(1\ <<\ (treeHeight-\/(inLevel+1)));}
\DoxyCodeLine{00091\ \ \ \ \ \ \ \ \ FReal\ widthAtCurrentLevelDiv2\ =\ widthAtCurrentLevel/FReal(2);}
\DoxyCodeLine{00092\ }
\DoxyCodeLine{00093\ \ \ \ \ \ \ \ \ \textcolor{comment}{//Get\ the\ coordinate}}
\DoxyCodeLine{00094\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ a\ =\ coordinate.\mbox{\hyperlink{class_f_point_a58d3859160347552d6a4a94fbdf883c3}{getX}}();}
\DoxyCodeLine{00095\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ b\ =\ coordinate.\mbox{\hyperlink{class_f_point_ae4383512b9b8d216775b3fb92325cfc9}{getY}}();}
\DoxyCodeLine{00096\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ c\ =\ coordinate.\mbox{\hyperlink{class_f_point_a02208d4db50cbafe597adcbfb152b536}{getZ}}();}
\DoxyCodeLine{00097\ }
\DoxyCodeLine{00098\ \ \ \ \ \ \ \ \ \textcolor{comment}{//Set\ the\ center\ real\ coordinates\ from\ box\ corner\ and\ widths.}}
\DoxyCodeLine{00099\ \ \ \ \ \ \ \ \ FReal\ X\ =\ boxCorner.\mbox{\hyperlink{class_f_point_a58d3859160347552d6a4a94fbdf883c3}{getX}}()\ +\ FReal(a)*widthAtCurrentLevel\ +\ widthAtCurrentLevelDiv2;}
\DoxyCodeLine{00100\ \ \ \ \ \ \ \ \ FReal\ Y\ =\ boxCorner.\mbox{\hyperlink{class_f_point_ae4383512b9b8d216775b3fb92325cfc9}{getY}}()\ +\ FReal(b)*widthAtCurrentLevel\ +\ widthAtCurrentLevelDiv2;}
\DoxyCodeLine{00101\ \ \ \ \ \ \ \ \ FReal\ Z\ =\ boxCorner.\mbox{\hyperlink{class_f_point_a02208d4db50cbafe597adcbfb152b536}{getZ}}()\ +\ FReal(c)*widthAtCurrentLevel\ +\ widthAtCurrentLevelDiv2;}
\DoxyCodeLine{00102\ }
\DoxyCodeLine{00103\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_f_point}{FPoint<FReal>}}\ cCenter\ =\ \mbox{\hyperlink{class_f_point}{FPoint<FReal>}}(X,Y,Z);}
\DoxyCodeLine{00104\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ cCenter;}
\DoxyCodeLine{00105\ \ \ \ \ \}}
\DoxyCodeLine{00106\ }
\DoxyCodeLine{00107\ }
\DoxyCodeLine{00113\ \ \ \ \ \textcolor{keywordtype}{void}\ incPowers(\textcolor{keywordtype}{int}\ *\ \textcolor{keyword}{const}\ FRestrict\ a,\ \textcolor{keywordtype}{int}\ *\textcolor{keyword}{const}\ FRestrict\ b,\ \textcolor{keywordtype}{int}\ *\textcolor{keyword}{const}\ FRestrict\ c)}
\DoxyCodeLine{00114\ \ \ \ \ \{}
\DoxyCodeLine{00115\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ t\ =\ (*a)+(*b)+(*c);}
\DoxyCodeLine{00116\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(t==0)}
\DoxyCodeLine{00117\ \ \ \ \ \ \ \ \ \{a[0]=1;\}}
\DoxyCodeLine{00118\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\{\ \textcolor{keywordflow}{if}(t==a[0])}
\DoxyCodeLine{00119\ \ \ \ \ \ \ \ \ \ \ \ \ \{a[0]-\/-\/;\ \ b[0]++;\}}
\DoxyCodeLine{00120\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\{\ \textcolor{keywordflow}{if}(t==c[0])}
\DoxyCodeLine{00121\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{a[0]=t+1;\ \ c[0]=0;\}}
\DoxyCodeLine{00122\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\{\ \textcolor{keywordflow}{if}(b[0]!=0)}
\DoxyCodeLine{00123\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{b[0]-\/-\/;\ c[0]++;\}}
\DoxyCodeLine{00124\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\{}
\DoxyCodeLine{00125\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ b[0]=c[0]+1;}
\DoxyCodeLine{00126\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ a[0]-\/-\/;}
\DoxyCodeLine{00127\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ c[0]=0;}
\DoxyCodeLine{00128\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00129\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00130\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00131\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00132\ \ \ \ \ \}}
\DoxyCodeLine{00133\ }
\DoxyCodeLine{00138\ \ \ \ \ \textcolor{keywordtype}{int}\ powerToIdx(\textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ a,\textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ b,\textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ c)}
\DoxyCodeLine{00139\ \ \ \ \ \{}
\DoxyCodeLine{00140\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ t,res,p\ =\ a+b+c;}
\DoxyCodeLine{00141\ \ \ \ \ \ \ \ \ res\ \ =\ p*(p+1)*(p+2)/6;}
\DoxyCodeLine{00142\ \ \ \ \ \ \ \ \ t\ \ \ \ =\ p\ -\/\ a;}
\DoxyCodeLine{00143\ \ \ \ \ \ \ \ \ res\ +=\ t*(t+1)/2+c;}
\DoxyCodeLine{00144\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ res;}
\DoxyCodeLine{00145\ \ \ \ \ \}}
\DoxyCodeLine{00146\ }
\DoxyCodeLine{00147\ \ \ \ \ \textcolor{comment}{/*\ Return\ the\ factorial\ of\ a\ number}}
\DoxyCodeLine{00148\ \textcolor{comment}{\ \ \ */}}
\DoxyCodeLine{00149\ \ \ \ \ FReal\ fact(\textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ a)\{}
\DoxyCodeLine{00150\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(a<0)\ \{}
\DoxyCodeLine{00151\ \ \ \ \ \ \ \ \ \ \ \ \ printf(\textcolor{stringliteral}{"{}fact\ ::\ Error\ factorial\ negative!!\ a=\%d\(\backslash\)n"{}},a);}
\DoxyCodeLine{00152\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ FReal(0);}
\DoxyCodeLine{00153\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00154\ \ \ \ \ \ \ \ \ FReal\ result\ =\ 1;}
\DoxyCodeLine{00155\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ i\ =\ 1\ ;\ i\ <=\ a\ ;\ ++i)\{}
\DoxyCodeLine{00156\ \ \ \ \ \ \ \ \ \ \ \ \ result\ *=\ FReal(i);}
\DoxyCodeLine{00157\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00158\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ result;}
\DoxyCodeLine{00159\ \ \ \ \ \}}
\DoxyCodeLine{00160\ }
\DoxyCodeLine{00161\ \ \ \ \ \textcolor{comment}{/*\ Return\ the\ product\ of\ factorial\ of\ 3\ numbers}}
\DoxyCodeLine{00162\ \textcolor{comment}{\ \ \ */}}
\DoxyCodeLine{00163\ \ \ \ \ FReal\ fact3int(\textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ a,\textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ b,\textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ c)}
\DoxyCodeLine{00164\ \ \ \ \ \{}
\DoxyCodeLine{00165\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ (\ factorials[a]*factorials[b]*\ factorials[c])\ ;}
\DoxyCodeLine{00166\ \ \ \ \ \}}
\DoxyCodeLine{00167\ }
\DoxyCodeLine{00168\ \ \ \ \ \textcolor{comment}{/*\ Return\ the\ combine\ of\ a\ paire\ of\ number}}
\DoxyCodeLine{00169\ \textcolor{comment}{\ \ \ *\ \(\backslash\)f[\ C\string^\{b\}\_\{a\}\ \(\backslash\)f]}}
\DoxyCodeLine{00170\ \textcolor{comment}{\ \ \ */}}
\DoxyCodeLine{00171\ \ \ \ \ FReal\ combin(\textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\&\ a,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\&\ b)\{}
\DoxyCodeLine{00172\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(a<b)\ \ \{printf(\textcolor{stringliteral}{"{}combin\ ::\ Error\ combin\ negative!!\ a=\%d\ b=\%d\(\backslash\)n"{}},a,b);\ exit(-\/1)\ ;\ \ \}}
\DoxyCodeLine{00173\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \ factorials[a]/\ \ (factorials[b]*\ factorials[a-\/b])\ ;}
\DoxyCodeLine{00174\ \ \ \ \ \}}
\DoxyCodeLine{00175\ }
\DoxyCodeLine{00176\ \ \ \ \ \textcolor{comment}{/*\ PreCompute\ indirection\ for\ M2L\ translations\ :}}
\DoxyCodeLine{00177\ \textcolor{comment}{\ \ \ *}}
\DoxyCodeLine{00178\ \textcolor{comment}{\ \ \ *\ During\ the\ M2L,\ derivative\ vector\ isn't\ accessed\ in\ an\ adjacent}}
\DoxyCodeLine{00179\ \textcolor{comment}{\ \ \ *\ way,\ so\ this\ function\ aimed\ at\ storing\ all\ the\ indirections\ in}}
\DoxyCodeLine{00180\ \textcolor{comment}{\ \ \ *\ the\ reading\ of\ Derivatives\ vector.}}
\DoxyCodeLine{00181\ \textcolor{comment}{\ \ \ *}}
\DoxyCodeLine{00182\ \textcolor{comment}{\ \ \ */}}
\DoxyCodeLine{00183\ \ \ \ \ \textcolor{keywordtype}{void}\ preComputeIndirection()}
\DoxyCodeLine{00184\ \ \ \ \ \{}
\DoxyCodeLine{00185\ \ \ \ \ \ \ \ \ this-\/>preComputedIndirections\ =\ \textcolor{keyword}{new}\ \textcolor{keywordtype}{int}[SizeVector][SizeVector];}
\DoxyCodeLine{00186\ }
\DoxyCodeLine{00187\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ al=0,bl=0,cl=0;}
\DoxyCodeLine{00188\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ alpha;}
\DoxyCodeLine{00189\ \ \ \ \ \ \ \ \ \textcolor{comment}{//Loop\ over\ first\ index}}
\DoxyCodeLine{00190\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ k=0;\ k<SizeVector\ ;\ ++k)}
\DoxyCodeLine{00191\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00192\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Loop\ over\ multipole\ expansion\ coefficients\ :\ am,\ bm,\ cm.}}
\DoxyCodeLine{00193\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\ \textcolor{keywordtype}{int}\ ord=0,\ j=\ 0\ ;\ ord\ <=\ P\ ;\ ++ord)}
\DoxyCodeLine{00194\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00195\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ am=ord\ ;\ am\ >=\ 0\ ;\ -\/-\/am)}
\DoxyCodeLine{00196\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00197\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ alpha\ =\ ord-\/am;}
\DoxyCodeLine{00198\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\ alpha\ ==1\ )\ \ \{}
\DoxyCodeLine{00199\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\ \textcolor{keywordtype}{int}\ i=0\ ;\ i\ <=1\ \ ;\ (++i,\ ++j)\ )}
\DoxyCodeLine{00200\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00201\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ preComputedIndirections[k][j]\ =\ powerToIdx(al+am,bl+1-\/i,cl+i);}
\DoxyCodeLine{00202\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00203\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00204\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00205\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\ \textcolor{keywordtype}{int}\ bm=ord-\/am\ ;\ bm\ >=\ 0\ ;\ -\/-\/bm,\ ++j)}
\DoxyCodeLine{00206\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00207\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ preComputedIndirections[k][j]\ =\ powerToIdx(al+am,bl+bm,cl+(ord-\/am-\/bm));}
\DoxyCodeLine{00208\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00209\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00210\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00211\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00212\ \ \ \ \ \ \ \ \ \ \ \ \ incPowers(\&al,\&bl,\&cl);}
\DoxyCodeLine{00213\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00214\ \ \ \ \ \}}
\DoxyCodeLine{00215\ }
\DoxyCodeLine{00216\ \ \ \ \ \textcolor{comment}{/*\ Precomputation\ of\ all\ the\ derivatives\ that\ will\ be\ needed\ for\ the}}
\DoxyCodeLine{00217\ \textcolor{comment}{\ \ \ *\ computation\ of\ M2L\ translations\ :}}
\DoxyCodeLine{00218\ \textcolor{comment}{\ \ \ *}}
\DoxyCodeLine{00219\ \textcolor{comment}{\ \ \ *\ Derivatives\ depends\ only\ on\ the\ distance\ between\ cells,\ so\ for}}
\DoxyCodeLine{00220\ \textcolor{comment}{\ \ \ *\ each\ level,\ and\ each\ possible\ relative\ positions\ (343),\ we}}
\DoxyCodeLine{00221\ \textcolor{comment}{\ \ \ *\ compute\ all\ the\ values\ needed.}}
\DoxyCodeLine{00222\ \textcolor{comment}{\ \ \ */}}
\DoxyCodeLine{00223\ \ \ \ \ \textcolor{keywordtype}{void}\ preComputeDerivative()}
\DoxyCodeLine{00224\ \ \ \ \ \{}
\DoxyCodeLine{00225\ \ \ \ \ \ \ \ \ \textcolor{comment}{//Allocation\ of\ the\ memory\ needed}}
\DoxyCodeLine{00226\ \ \ \ \ \ \ \ \ M2LpreComputedDerivatives\ =\ \textcolor{keyword}{new}\ FReal[treeHeight][343][sizeDerivative];}
\DoxyCodeLine{00227\ \ \ \ \ \ \ \ \ \textcolor{comment}{//This\ is\ the\ width\ of\ a\ box\ at\ each\ level}}
\DoxyCodeLine{00228\ \ \ \ \ \ \ \ \ FReal\ boxWidthAtLevel\ =\ widthAtLeafLevel;}
\DoxyCodeLine{00229\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ from\ leaf\ level\ to\ the\ root}}
\DoxyCodeLine{00230\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ idxLevel\ =\ treeHeight-\/1\ ;\ idxLevel\ >\ 0\ ;\ -\/-\/idxLevel)\{}
\DoxyCodeLine{00231\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ we\ compute\ all\ possibilities}}
\DoxyCodeLine{00232\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ idxX\ =\ -\/3\ ;\ idxX\ <=\ 3\ ;\ ++idxX\ )\{}
\DoxyCodeLine{00233\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ idxY\ =\ -\/3\ ;\ idxY\ <=\ 3\ ;\ ++idxY\ )\{}
\DoxyCodeLine{00234\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ idxZ\ =\ -\/3\ ;\ idxZ\ <=\ 3\ ;\ ++idxZ\ )\{}
\DoxyCodeLine{00235\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ if\ this\ is\ not\ a\ neighbour}}
\DoxyCodeLine{00236\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\ idxX\ <\ -\/1\ ||\ 1\ <\ idxX\ ||\ idxY\ <\ -\/1\ ||\ 1\ <\ idxY\ ||\ idxZ\ <\ -\/1\ ||\ 1\ <\ idxZ\ )\{}
\DoxyCodeLine{00237\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Compute\ the\ relative\ position}}
\DoxyCodeLine{00238\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_f_point}{FPoint<FReal>}}\ relativePosition(\ -\/FReal(idxX)*boxWidthAtLevel,}
\DoxyCodeLine{00239\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ -\/FReal(idxY)*boxWidthAtLevel,}
\DoxyCodeLine{00240\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ -\/FReal(idxZ)*boxWidthAtLevel);}
\DoxyCodeLine{00241\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ this\ is\ the\ position\ in\ the\ index\ system\ from\ 0\ to\ 343}}
\DoxyCodeLine{00242\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ position\ =\ (((\ (idxX+3)\ *\ 7)\ +\ (idxY+3)))\ *\ 7\ +\ idxZ\ +\ 3;}
\DoxyCodeLine{00243\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ initDerivative(relativePosition.\mbox{\hyperlink{class_f_point_a58d3859160347552d6a4a94fbdf883c3}{getX}}(),relativePosition.\mbox{\hyperlink{class_f_point_ae4383512b9b8d216775b3fb92325cfc9}{getY}}(),relativePosition.\mbox{\hyperlink{class_f_point_a02208d4db50cbafe597adcbfb152b536}{getZ}}(),M2LpreComputedDerivatives[idxLevel][position]);}
\DoxyCodeLine{00244\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ computeFullDerivative(relativePosition.\mbox{\hyperlink{class_f_point_a58d3859160347552d6a4a94fbdf883c3}{getX}}(),relativePosition.\mbox{\hyperlink{class_f_point_ae4383512b9b8d216775b3fb92325cfc9}{getY}}(),relativePosition.\mbox{\hyperlink{class_f_point_a02208d4db50cbafe597adcbfb152b536}{getZ}}(),M2LpreComputedDerivatives[idxLevel][position]);}
\DoxyCodeLine{00245\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00246\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00247\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00248\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00249\ \ \ \ \ \ \ \ \ \ \ \ \ boxWidthAtLevel\ *=\ FReal(2);}
\DoxyCodeLine{00250\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00251\ \ \ \ \ \}}
\DoxyCodeLine{00252\ }
\DoxyCodeLine{00260\ \ \ \ \ \textcolor{keywordtype}{void}\ initDerivative(\textcolor{keyword}{const}\ FReal\ \&\ dx\ ,\textcolor{keyword}{const}\ FReal\ \&\ dy\ ,\textcolor{keyword}{const}\ FReal\ \&\ dz\ \ ,\ \ \ FReal\ *\ tab)}
\DoxyCodeLine{00261\ \ \ \ \ \{}
\DoxyCodeLine{00262\ \ \ \ \ \ \ \ \ FReal\ R2\ =\ dx*dx+dy*dy+dz*dz;}
\DoxyCodeLine{00263\ \ \ \ \ \ \ \ \ tab[0]=FReal(1)/\mbox{\hyperlink{struct_f_math_a2494d4d6618d79e61324a0dfa372855f}{FMath::Sqrt}}(R2);}
\DoxyCodeLine{00264\ \ \ \ \ \ \ \ \ FReal\ R3\ =\ tab[0]/(R2);}
\DoxyCodeLine{00265\ \ \ \ \ \ \ \ \ tab[1]=\ -\/dx*R3;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Derivative\ in\ (1,0,0)}}
\DoxyCodeLine{00266\ \ \ \ \ \ \ \ \ tab[2]=\ -\/dy*R3;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Derivative\ in\ (0,1,0)}}
\DoxyCodeLine{00267\ \ \ \ \ \ \ \ \ tab[3]=\ -\/dz*R3;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Derivative\ in\ (0,0,1)}}
\DoxyCodeLine{00268\ \ \ \ \ \ \ \ \ FReal\ R5\ =\ R3/R2;}
\DoxyCodeLine{00269\ \ \ \ \ \ \ \ \ tab[4]\ =\ FReal(3)*dx*dx*R5-\/R3;\ \ \textcolor{comment}{//Derivative\ in\ (2,0,0)}}
\DoxyCodeLine{00270\ \ \ \ \ \ \ \ \ tab[5]\ =\ FReal(3)*dx*dy*R5;\ \ \ \ \ \textcolor{comment}{//Derivative\ in\ (1,1,0)}}
\DoxyCodeLine{00271\ \ \ \ \ \ \ \ \ tab[6]\ =\ FReal(3)*dx*dz*R5;\ \ \ \ \ \textcolor{comment}{//Derivative\ in\ (1,0,1)}}
\DoxyCodeLine{00272\ \ \ \ \ \ \ \ \ tab[7]\ =\ FReal(3)*dy*dy*R5-\/R3;\ \ \textcolor{comment}{//Derivative\ in\ (0,2,0)}}
\DoxyCodeLine{00273\ \ \ \ \ \ \ \ \ tab[8]\ =\ FReal(3)*dy*dz*R5;\ \ \ \ \ \textcolor{comment}{//Derivative\ in\ (0,1,1)}}
\DoxyCodeLine{00274\ \ \ \ \ \ \ \ \ tab[9]\ =\ FReal(3)*dz*dz*R5-\/R3;\ \ \textcolor{comment}{//Derivative\ in\ (0,0,2)}}
\DoxyCodeLine{00275\ \ \ \ \ \}}
\DoxyCodeLine{00276\ }
\DoxyCodeLine{00291\ \ \ \ \ \textcolor{keywordtype}{void}\ computeFullDerivative(\ FReal\ \ dx,\ \ FReal\ \ dy,\ \ FReal\ \ dz,\ \textcolor{comment}{//\ Distance\ from\ distant\ center\ to\ local\ center}}
\DoxyCodeLine{00292\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ FReal\ *\ yetComputed)}
\DoxyCodeLine{00293\ \ \ \ \ \{}
\DoxyCodeLine{00294\ \ \ \ \ \ \ \ \ initDerivative(dx,dy,dz,yetComputed);}
\DoxyCodeLine{00295\ \ \ \ \ \ \ \ \ FReal\ dist2\ =\ \ dx*dx+dy*dy+dz*dz;}
\DoxyCodeLine{00296\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ idxTarget;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Index\ of\ current\ yetComputed\ entry}}
\DoxyCodeLine{00297\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ idxSrc1,\ idxSrc2,\ idxSrc3,\ \ \ \ \ \ \textcolor{comment}{//Indexes\ of\ needed\ yetComputed\ entries}}
\DoxyCodeLine{00298\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ idxSrc4,\ idxSrc5,\ idxSrc6;}
\DoxyCodeLine{00299\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ a=0,b=0,c=0;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Powers\ of\ expansions}}
\DoxyCodeLine{00300\ }
\DoxyCodeLine{00301\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(c=3\ ;\ c<=2*P\ ;\ ++c)\{}
\DoxyCodeLine{00302\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Computation\ of\ derivatives\ Psi\_\{0,0,c\}}}
\DoxyCodeLine{00303\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ |x-\/y|\string^2\ *\ Psi\_\{0,0,c\}\ +\ (2*c-\/1)\ *\ dz\ *Psi\_\{0,0,c-\/1\}\ +\ (c-\/1)\string^2\ *\ Psi\_\{0,0,c-\/2\}\ =\ 0}}
\DoxyCodeLine{00304\ \ \ \ \ \ \ \ \ \ \ \ \ idxTarget\ =\ powerToIdx(0,0,c);}
\DoxyCodeLine{00305\ \ \ \ \ \ \ \ \ \ \ \ \ idxSrc1\ =\ powerToIdx(0,0,c-\/1);}
\DoxyCodeLine{00306\ \ \ \ \ \ \ \ \ \ \ \ \ idxSrc2\ =\ powerToIdx(0,0,c-\/2);}
\DoxyCodeLine{00307\ \ \ \ \ \ \ \ \ \ \ \ \ yetComputed[idxTarget]\ =\ -\/(FReal(2*c-\/1)*dz*yetComputed[idxSrc1]\ +\ FReal((c-\/1)*(c-\/1))*yetComputed[idxSrc2])/dist2;}
\DoxyCodeLine{00308\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00309\ \ \ \ \ \ \ \ \ b=1;}
\DoxyCodeLine{00310\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(c=2\ ;\ c<=2*P-\/1\ ;\ ++c)\{}
\DoxyCodeLine{00311\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Computation\ of\ derivatives\ Psi\_\{0,1,c\}}}
\DoxyCodeLine{00312\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ |x-\/y|\string^2\ *\ Psi\_\{0,1,c\}\ +\ (2*c)\ *\ dz\ *Psi\_\{0,1,c-\/1\}\ +\ c*(c-\/1)\ *\ Psi\_\{0,1,c-\/2\}\ +\ dy*Psi\_\{0,0,c\}\ =\ 0}}
\DoxyCodeLine{00313\ \ \ \ \ \ \ \ \ \ \ \ \ idxTarget\ =\ powerToIdx(0,1,c);}
\DoxyCodeLine{00314\ \ \ \ \ \ \ \ \ \ \ \ \ idxSrc1\ =\ powerToIdx(0,1,c-\/1);}
\DoxyCodeLine{00315\ \ \ \ \ \ \ \ \ \ \ \ \ idxSrc2\ =\ powerToIdx(0,1,c-\/2);}
\DoxyCodeLine{00316\ \ \ \ \ \ \ \ \ \ \ \ \ idxSrc3\ =\ powerToIdx(0,0,c);}
\DoxyCodeLine{00317\ \ \ \ \ \ \ \ \ \ \ \ \ yetComputed[idxTarget]\ =\ -\/(FReal(2*c)*dz*yetComputed[idxSrc1]\ +\ FReal(c*(c-\/1))*yetComputed[idxSrc2]+\ dy*yetComputed[idxSrc3])/dist2;}
\DoxyCodeLine{00318\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00319\ \ \ \ \ \ \ \ \ b=2;}
\DoxyCodeLine{00320\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(c=1\ ;\ c<=\ 2*P-\/b\ ;\ ++c)\{}
\DoxyCodeLine{00321\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Computation\ of\ derivatives\ Psi\_\{0,2,c\}}}
\DoxyCodeLine{00322\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//|x-\/y|\string^2\ *\ Psi\_\{0,2,c\}\ +\ (2*c)\ *\ dz\ *Psi\_\{0,2,c-\/1\}\ +\ (c*(c-\/1))\ *\ Psi\_\{0,2,c-\/2\}\ +\ 3*dy\ *\ Psi\_\{0,1,c\}\ +\ Psi\_\{0,0,c\}\ \ =\ 0}}
\DoxyCodeLine{00323\ \ \ \ \ \ \ \ \ \ \ \ \ idxTarget\ =\ powerToIdx(0,2,c);}
\DoxyCodeLine{00324\ \ \ \ \ \ \ \ \ \ \ \ \ idxSrc1\ =\ powerToIdx(0,2,c-\/1);}
\DoxyCodeLine{00325\ \ \ \ \ \ \ \ \ \ \ \ \ idxSrc2\ =\ powerToIdx(0,2,c-\/2);}
\DoxyCodeLine{00326\ \ \ \ \ \ \ \ \ \ \ \ \ idxSrc3\ =\ powerToIdx(0,1,c);}
\DoxyCodeLine{00327\ \ \ \ \ \ \ \ \ \ \ \ \ idxSrc4\ =\ powerToIdx(0,0,c);}
\DoxyCodeLine{00328\ \ \ \ \ \ \ \ \ \ \ \ \ yetComputed[idxTarget]\ =\ -\/(FReal(2*c)*dz*yetComputed[idxSrc1]\ +\ FReal(c*(c-\/1))*yetComputed[idxSrc2]}
\DoxyCodeLine{00329\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ +\ FReal(3)*dy*yetComputed[idxSrc3]\ +\ yetComputed[idxSrc4])/dist2;}
\DoxyCodeLine{00330\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00331\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(b=3\ ;\ b<=\ 2*P\ ;\ ++b)\{}
\DoxyCodeLine{00332\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Computation\ of\ derivatives\ Psi\_\{0,b,0\}}}
\DoxyCodeLine{00333\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ |x-\/y|\string^2\ *\ Psi\_\{0,b,0\}\ +\ (2*b-\/1)\ *\ dy\ *Psi\_\{0,b-\/1,0\}\ +\ (b-\/1)\string^2\ *\ Psi\_\{0,b-\/2,c\}\ =\ 0}}
\DoxyCodeLine{00334\ \ \ \ \ \ \ \ \ \ \ \ \ idxTarget\ =\ powerToIdx(0,b,0);}
\DoxyCodeLine{00335\ \ \ \ \ \ \ \ \ \ \ \ \ idxSrc1\ =\ powerToIdx(0,b-\/1,0);}
\DoxyCodeLine{00336\ \ \ \ \ \ \ \ \ \ \ \ \ idxSrc2\ =\ powerToIdx(0,b-\/2,0);}
\DoxyCodeLine{00337\ \ \ \ \ \ \ \ \ \ \ \ \ yetComputed[idxTarget]\ =\ -\/(FReal(2*b-\/1)*dy*yetComputed[idxSrc1]\ +\ FReal((b-\/1)*(b-\/1))*yetComputed[idxSrc2])/dist2;}
\DoxyCodeLine{00338\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(c=1\ ;\ c<=\ 2*P-\/b\ ;\ ++c)\ \{}
\DoxyCodeLine{00339\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Computation\ of\ derivatives\ Psi\_\{0,b,c\}}}
\DoxyCodeLine{00340\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//|x-\/y|\string^2*Psi\_\{0,b,c\}\ +\ (2*c)*dz*Psi\_\{0,b,c-\/1\}\ +\ (c*(c-\/1))*Psi\_\{0,b,c-\/2\}\ +\ (2*b-\/1)*dy*Psi\_\{0,b-\/1,c\}\ +\ (b-\/1)\string^2\ *\ Psi\_\{0,b-\/2,c\}\ \ =\ 0}}
\DoxyCodeLine{00341\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ idxTarget\ =\ powerToIdx(0,b,c);}
\DoxyCodeLine{00342\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ idxSrc1\ =\ powerToIdx(0,b,c-\/1);}
\DoxyCodeLine{00343\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ idxSrc2\ =\ powerToIdx(0,b,c-\/2);}
\DoxyCodeLine{00344\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ idxSrc3\ =\ powerToIdx(0,b-\/1,c);}
\DoxyCodeLine{00345\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ idxSrc4\ =\ powerToIdx(0,b-\/2,c);}
\DoxyCodeLine{00346\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ yetComputed[idxTarget]\ =\ -\/(FReal(2*c)*dz*yetComputed[idxSrc1]\ +\ FReal(c*(c-\/1))*yetComputed[idxSrc2]}
\DoxyCodeLine{00347\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ +\ FReal(2*b-\/1)*dy*yetComputed[idxSrc3]\ +\ FReal((b-\/1)*(b-\/1))*yetComputed[idxSrc4])/dist2;}
\DoxyCodeLine{00348\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00349\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00350\ \ \ \ \ \ \ \ \ a=1;}
\DoxyCodeLine{00351\ \ \ \ \ \ \ \ \ b=0;}
\DoxyCodeLine{00352\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(c=2\ ;\ c<=\ 2*P-\/1\ ;\ ++c)\{}
\DoxyCodeLine{00353\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Computation\ of\ derivatives\ Psi\_\{1,0,c\}}}
\DoxyCodeLine{00354\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//|x-\/y|\string^2\ *\ Psi\_\{1,0,c\}\ +\ (2*c)*dz*Psi\_\{1,0,c-\/1\}\ +\ c*(c-\/1)*Psi\_\{1,0,c-\/2\}\ +\ dx*Psi\_\{0,0,c\}}}
\DoxyCodeLine{00355\ \ \ \ \ \ \ \ \ \ \ \ \ idxTarget\ =\ powerToIdx(1,0,c);}
\DoxyCodeLine{00356\ \ \ \ \ \ \ \ \ \ \ \ \ idxSrc1\ =\ powerToIdx(1,0,c-\/1);}
\DoxyCodeLine{00357\ \ \ \ \ \ \ \ \ \ \ \ \ idxSrc2\ =\ powerToIdx(1,0,c-\/2);}
\DoxyCodeLine{00358\ \ \ \ \ \ \ \ \ \ \ \ \ idxSrc3\ =\ powerToIdx(0,0,c);}
\DoxyCodeLine{00359\ \ \ \ \ \ \ \ \ \ \ \ \ yetComputed[idxTarget]\ =\ -\/(FReal(2*c)*dz*yetComputed[idxSrc1]\ +\ FReal(c*(c-\/1))*yetComputed[idxSrc2]\ +\ dx*yetComputed[idxSrc3])/dist2;}
\DoxyCodeLine{00360\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00361\ \ \ \ \ \ \ \ \ b=1;}
\DoxyCodeLine{00362\ \ \ \ \ \ \ \ \ \textcolor{comment}{//Computation\ of\ derivatives\ Psi\_\{1,1,1\}}}
\DoxyCodeLine{00363\ \ \ \ \ \ \ \ \ \textcolor{comment}{//|x-\/y|\string^2\ *\ Psi\_\{1,1,1\}\ +\ 2*dz*Psi\_\{1,1,0\}\ +\ 2*dy*Psi\_\{1,0,1\}\ +\ dx*Psi\_\{0,1,1\}}}
\DoxyCodeLine{00364\ \ \ \ \ \ \ \ \ idxTarget\ =\ powerToIdx(1,1,1);}
\DoxyCodeLine{00365\ \ \ \ \ \ \ \ \ idxSrc1\ =\ powerToIdx(1,1,0);}
\DoxyCodeLine{00366\ \ \ \ \ \ \ \ \ idxSrc2\ =\ powerToIdx(1,0,1);}
\DoxyCodeLine{00367\ \ \ \ \ \ \ \ \ idxSrc3\ =\ powerToIdx(0,1,1);}
\DoxyCodeLine{00368\ \ \ \ \ \ \ \ \ yetComputed[idxTarget]\ =\ -\/(FReal(2)*dz*yetComputed[idxSrc1]\ +\ FReal(2)*dy*yetComputed[idxSrc2]\ +\ dx*yetComputed[idxSrc3])/dist2;}
\DoxyCodeLine{00369\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(c=2\ ;\ c<=\ 2*P-\/2\ ;\ ++c)\{}
\DoxyCodeLine{00370\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Computation\ of\ derivatives\ Psi\_\{1,1,c\}}}
\DoxyCodeLine{00371\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//|x-\/y|\string^2\ *\ Psi\_\{1,1,c\}\ +\ (2*c)*dz*Psi\_\{1,1,c-\/1\}\ +\ c*(c-\/1)*Psi\_\{1,1,c-\/2\}\ +\ 2*dy*Psi\_\{1,0,c\}\ +\ dx*Psi\_\{0,1,c\}}}
\DoxyCodeLine{00372\ \ \ \ \ \ \ \ \ \ \ \ \ idxTarget\ =\ powerToIdx(1,1,c);}
\DoxyCodeLine{00373\ \ \ \ \ \ \ \ \ \ \ \ \ idxSrc1\ =\ powerToIdx(1,1,c-\/1);}
\DoxyCodeLine{00374\ \ \ \ \ \ \ \ \ \ \ \ \ idxSrc2\ =\ powerToIdx(1,1,c-\/2);}
\DoxyCodeLine{00375\ \ \ \ \ \ \ \ \ \ \ \ \ idxSrc3\ =\ powerToIdx(1,0,c);}
\DoxyCodeLine{00376\ \ \ \ \ \ \ \ \ \ \ \ \ idxSrc4\ =\ powerToIdx(0,1,c);}
\DoxyCodeLine{00377\ \ \ \ \ \ \ \ \ \ \ \ \ yetComputed[idxTarget]\ =\ -\/(FReal(2*c)*dz*yetComputed[idxSrc1]\ +\ FReal(c*(c-\/1))*yetComputed[idxSrc2]}
\DoxyCodeLine{00378\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ +\ FReal(2)*dy*yetComputed[idxSrc3]+\ dx*yetComputed[idxSrc4])/dist2;}
\DoxyCodeLine{00379\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00380\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(b=2\ ;\ b<=\ 2*P-\/a\ ;\ ++b)\{}
\DoxyCodeLine{00381\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(c=0\ ;\ c<=\ 2*P-\/b-\/1\ ;\ ++c)\{}
\DoxyCodeLine{00382\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Computation\ of\ derivatives\ Psi\_\{1,b,c\}}}
\DoxyCodeLine{00383\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//|x-\/y|\string^2\ *\ Psi\_\{1,b,c\}\ +\ (2*b)*dy*Psi\_\{1,b-\/1,c\}\ +\ b*(b-\/1)*Psi\_\{1,b-\/2,c\}\ +\ (2*c)*dz*Psi\_\{1,b,c-\/1\}\ +\ c*(c-\/1)*Psi\_\{1,b,c-\/2\}\ +\ dx*Psi\_\{0,b,c\}}}
\DoxyCodeLine{00384\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ idxTarget\ =\ powerToIdx(1,b,c);}
\DoxyCodeLine{00385\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ idxSrc1\ =\ powerToIdx(1,b-\/1,c);}
\DoxyCodeLine{00386\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ idxSrc2\ =\ powerToIdx(1,b-\/2,c);}
\DoxyCodeLine{00387\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ idxSrc3\ =\ powerToIdx(1,b,c-\/1);}
\DoxyCodeLine{00388\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ idxSrc4\ =\ powerToIdx(1,b,c-\/2);}
\DoxyCodeLine{00389\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ idxSrc5\ =\ powerToIdx(0,b,c);}
\DoxyCodeLine{00390\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ yetComputed[idxTarget]\ =\ -\/(FReal(2*b)*dy*yetComputed[idxSrc1]\ +\ FReal(b*(b-\/1))*yetComputed[idxSrc2]}
\DoxyCodeLine{00391\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ +\ FReal(2*c)*dz*yetComputed[idxSrc3]+\ FReal(c*(c-\/1))*yetComputed[idxSrc4]}
\DoxyCodeLine{00392\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ +\ dx*yetComputed[idxSrc5])/dist2;}
\DoxyCodeLine{00393\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00394\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00395\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(a=2\ ;\ a<=2*P\ ;\ ++a)\{}
\DoxyCodeLine{00396\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Computation\ of\ derivatives\ Psi\_\{a,0,0\}}}
\DoxyCodeLine{00397\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ |x-\/y|\string^2\ *\ Psi\_\{a,0,0\}\ +\ (2*a-\/1)\ *\ dx\ *Psi\_\{a-\/1,0,0\}\ +\ (a-\/1)\string^2\ *\ Psi\_\{a-\/2,0,0\}\ =\ 0}}
\DoxyCodeLine{00398\ \ \ \ \ \ \ \ \ \ \ \ \ idxTarget\ =\ powerToIdx(a,0,0);}
\DoxyCodeLine{00399\ \ \ \ \ \ \ \ \ \ \ \ \ idxSrc1\ =\ powerToIdx(a-\/1,0,0);}
\DoxyCodeLine{00400\ \ \ \ \ \ \ \ \ \ \ \ \ idxSrc2\ =\ powerToIdx(a-\/2,0,0);}
\DoxyCodeLine{00401\ \ \ \ \ \ \ \ \ \ \ \ \ yetComputed[idxTarget]\ =\ -\/(FReal(2*a-\/1)*dx*yetComputed[idxSrc1]\ +\ FReal((a-\/1)*(a-\/1))*yetComputed[idxSrc2])/dist2;}
\DoxyCodeLine{00402\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(a\ <=\ 2*P-\/1)\{}
\DoxyCodeLine{00403\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Computation\ of\ derivatives\ Psi\_\{a,0,1\}}}
\DoxyCodeLine{00404\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ |x-\/y|\string^2\ *\ Psi\_\{a,0,1\}\ +\ 2*dz*Psi\_\{a,0,0\}\ +\ (2*a-\/1)*dx*Psi\_\{a-\/1,0,1\}\ +\ (a-\/1)\string^2*Psi\_\{a-\/2,0,1\}\ =\ 0}}
\DoxyCodeLine{00405\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ idxSrc1\ =\ idxTarget;}
\DoxyCodeLine{00406\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ idxTarget\ =\ powerToIdx(a,0,1);}
\DoxyCodeLine{00407\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ idxSrc2\ =\ powerToIdx(a-\/1,0,1);}
\DoxyCodeLine{00408\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ idxSrc3\ =\ powerToIdx(a-\/2,0,1);}
\DoxyCodeLine{00409\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ yetComputed[idxTarget]\ =\ -\/(FReal(2)*dz*yetComputed[idxSrc1]\ +\ FReal(2*a-\/1)*dx*yetComputed[idxSrc2]\ +\ FReal((a-\/1)*(a-\/1))*yetComputed[idxSrc3])/dist2;}
\DoxyCodeLine{00410\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Computation\ of\ derivatives\ Psi\_\{a,1,0\}}}
\DoxyCodeLine{00411\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ |x-\/y|\string^2\ *\ Psi\_\{a,1,0\}\ +\ 2*dy*Psi\_\{a,0,0\}\ +\ (2*a-\/1)*dx*Psi\_\{a-\/1,1,0\}\ +\ (a-\/1)\string^2*Psi\_\{a-\/2,1,0\}\ =\ 0}}
\DoxyCodeLine{00412\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ idxTarget\ =\ powerToIdx(a,1,0);}
\DoxyCodeLine{00413\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ idxSrc2\ =\ powerToIdx(a-\/1,1,0);}
\DoxyCodeLine{00414\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ idxSrc3\ =\ powerToIdx(a-\/2,1,0);}
\DoxyCodeLine{00415\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ yetComputed[idxTarget]\ =\ -\/(FReal(2)*dy*yetComputed[idxSrc1]\ +\ FReal(2*a-\/1)*dx*yetComputed[idxSrc2]\ +\ FReal((a-\/1)*(a-\/1))*yetComputed[idxSrc3])/dist2;}
\DoxyCodeLine{00416\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(a\ <=\ 2*P-\/2)\{}
\DoxyCodeLine{00417\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ b=0;}
\DoxyCodeLine{00418\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(c=2\ ;\ c\ <=\ 2*P-\/a\ ;\ ++c)\{}
\DoxyCodeLine{00419\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Computation\ of\ derivatives\ Psi\_\{a,0,c\}}}
\DoxyCodeLine{00420\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ |x-\/y|\string^2\ *\ Psi\_\{a,0,c\}\ +\ 2*c*dz*Psi\_\{a,0,c-\/1\}\ +\ c*(c-\/1)*Psi\_\{a,0,c-\/2\}\ +\ (2*a-\/1)*dx*Psi\_\{a-\/1,0,c\}\ +\ (a-\/1)\string^2*Psi\_\{a-\/2,0,c\}\ =\ 0}}
\DoxyCodeLine{00421\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ idxTarget\ =\ powerToIdx(a,0,c);}
\DoxyCodeLine{00422\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ idxSrc1\ =\ powerToIdx(a,0,c-\/1);}
\DoxyCodeLine{00423\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ idxSrc2\ =\ powerToIdx(a,0,c-\/2);}
\DoxyCodeLine{00424\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ idxSrc3\ =\ powerToIdx(a-\/1,0,c);}
\DoxyCodeLine{00425\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ idxSrc4\ =\ powerToIdx(a-\/2,0,c);}
\DoxyCodeLine{00426\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ yetComputed[idxTarget]\ =\ -\/(FReal(2*c)*dz*yetComputed[idxSrc1]\ +\ FReal(c*(c-\/1))*yetComputed[idxSrc2]}
\DoxyCodeLine{00427\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ +\ FReal(2*a-\/1)*dx*yetComputed[idxSrc3]\ +\ FReal((a-\/1)*(a-\/1))*yetComputed[idxSrc4])/dist2;}
\DoxyCodeLine{00428\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00429\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ b=1;}
\DoxyCodeLine{00430\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(c=1\ ;\ c\ <=\ 2*P-\/a-\/1\ ;\ ++c)\{}
\DoxyCodeLine{00431\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Computation\ of\ derivatives\ Psi\_\{a,1,c\}}}
\DoxyCodeLine{00432\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ |x-\/y|\string^2\ *\ Psi\_\{a,1,c\}\ +\ 2*c*dz*Psi\_\{a,1,c-\/1\}\ +\ c*(c-\/1)*Psi\_\{a,1,c-\/2\}\ +\ 2*a*dx*Psi\_\{a-\/1,1,c\}\ +\ a*(a-\/1)*Psi\_\{a-\/2,1,c\}\ +\ dy*Psi\_\{a,0,c\}=\ 0}}
\DoxyCodeLine{00433\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ idxTarget\ =\ powerToIdx(a,1,c);}
\DoxyCodeLine{00434\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ idxSrc1\ =\ powerToIdx(a,1,c-\/1);}
\DoxyCodeLine{00435\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ idxSrc2\ =\ powerToIdx(a,1,c-\/2);}
\DoxyCodeLine{00436\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ idxSrc3\ =\ powerToIdx(a-\/1,1,c);}
\DoxyCodeLine{00437\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ idxSrc4\ =\ powerToIdx(a-\/2,1,c);}
\DoxyCodeLine{00438\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ idxSrc5\ =\ powerToIdx(a,0,c);}
\DoxyCodeLine{00439\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ yetComputed[idxTarget]\ =\ -\/(FReal(2*c)*dz*yetComputed[idxSrc1]\ +\ FReal(c*(c-\/1))*yetComputed[idxSrc2]}
\DoxyCodeLine{00440\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ +\ FReal(2*a)*dx*yetComputed[idxSrc3]\ +\ FReal(a*(a-\/1))*yetComputed[idxSrc4]}
\DoxyCodeLine{00441\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ +\ dy*yetComputed[idxSrc5])/dist2;}
\DoxyCodeLine{00442\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00443\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(b=2\ ;\ b\ <=\ 2*P-\/a\ ;\ ++b)\{}
\DoxyCodeLine{00444\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Computation\ of\ derivatives\ Psi\_\{a,b,0\}}}
\DoxyCodeLine{00445\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ |x-\/y|\string^2\ *\ Psi\_\{a,b,0\}\ +\ 2*b*dy*Psi\_\{a,b-\/1,0\}\ +\ b*(b-\/1)*Psi\_\{a,b-\/2,0\}\ +\ (2*a-\/1)*dx*Psi\_\{a-\/1,b,0\}\ +\ (a-\/1)\string^2*Psi\_\{a-\/2,b,0\}\ =\ 0}}
\DoxyCodeLine{00446\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ idxTarget\ =\ powerToIdx(a,b,0);}
\DoxyCodeLine{00447\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ idxSrc1\ =\ powerToIdx(a,b-\/1,0);}
\DoxyCodeLine{00448\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ idxSrc2\ =\ powerToIdx(a,b-\/2,0);}
\DoxyCodeLine{00449\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ idxSrc3\ =\ powerToIdx(a-\/1,b,0);}
\DoxyCodeLine{00450\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ idxSrc4\ =\ powerToIdx(a-\/2,b,0);}
\DoxyCodeLine{00451\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ yetComputed[idxTarget]\ =\ -\/(FReal(2*b)*dy*yetComputed[idxSrc1]\ +\ FReal(b*(b-\/1))*yetComputed[idxSrc2]}
\DoxyCodeLine{00452\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ +\ FReal(2*a-\/1)*dx*yetComputed[idxSrc3]\ +\ FReal((a-\/1)*(a-\/1))*yetComputed[idxSrc4])/dist2;}
\DoxyCodeLine{00453\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(a+b\ <\ 2*P)\{}
\DoxyCodeLine{00454\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Computation\ of\ derivatives\ Psi\_\{a,b,1\}}}
\DoxyCodeLine{00455\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ |x-\/y|\string^2\ *\ Psi\_\{a,b,1\}\ +\ 2*b*dy*Psi\_\{a,b-\/1,1\}\ +\ b*(b-\/1)*Psi\_\{a,b-\/2,1\}\ +\ 2*a*dx*Psi\_\{a-\/1,b,1\}\ +\ a*(a-\/1)*Psi\_\{a-\/2,b,1\}\ +\ dz*Psi\_\{a,b,0\}=\ 0}}
\DoxyCodeLine{00456\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ idxTarget\ =\ powerToIdx(a,b,1);}
\DoxyCodeLine{00457\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ idxSrc1\ =\ powerToIdx(a,b-\/1,1);}
\DoxyCodeLine{00458\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ idxSrc2\ =\ powerToIdx(a,b-\/2,1);}
\DoxyCodeLine{00459\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ idxSrc3\ =\ powerToIdx(a-\/1,b,1);}
\DoxyCodeLine{00460\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ idxSrc4\ =\ powerToIdx(a-\/2,b,1);}
\DoxyCodeLine{00461\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ idxSrc5\ =\ powerToIdx(a,b,0);}
\DoxyCodeLine{00462\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ yetComputed[idxTarget]\ =\ -\/(FReal(2*b)*dy*yetComputed[idxSrc1]\ +\ FReal(b*(b-\/1))*yetComputed[idxSrc2]}
\DoxyCodeLine{00463\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ +\ FReal(2*a)*dx*yetComputed[idxSrc3]\ +\ FReal(a*(a-\/1))*yetComputed[idxSrc4]}
\DoxyCodeLine{00464\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ +\ dz*yetComputed[idxSrc5])/dist2;}
\DoxyCodeLine{00465\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00466\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(c=2\ ;\ c\ <=\ 2*P-\/b-\/a\ ;\ ++c)\{}
\DoxyCodeLine{00467\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Computation\ of\ derivatives\ Psi\_\{a,b,c\}\ with\ a\ >=\ 2}}
\DoxyCodeLine{00468\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ |x-\/y|\string^2*Psi\_\{a,b,c\}\ +\ (2*a-\/1)*dx*Psi\_\{a-\/1,b,c\}\ +\ a*(a-\/2)*Psi\_\{a-\/2,b,c\}\ +\ 2*b*dy*Psi\_\{a,b-\/1,c\}\ +\ b*(b-\/1)*Psi\_\{a,b-\/2,c\}}}
\DoxyCodeLine{00469\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ +\ 2*c*dz*Psi\_\{a,b,c-\/1\}\}\ =\ 0}}
\DoxyCodeLine{00470\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ idxTarget\ =\ powerToIdx(a,b,c);}
\DoxyCodeLine{00471\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ idxSrc1\ =\ powerToIdx(a-\/1,b,c);}
\DoxyCodeLine{00472\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ idxSrc2\ =\ powerToIdx(a,b-\/1,c);}
\DoxyCodeLine{00473\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ idxSrc3\ =\ powerToIdx(a,b,c-\/1);}
\DoxyCodeLine{00474\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ idxSrc4\ =\ powerToIdx(a-\/2,b,c);}
\DoxyCodeLine{00475\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ idxSrc5\ =\ powerToIdx(a,b-\/2,c);}
\DoxyCodeLine{00476\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ idxSrc6\ =\ powerToIdx(a,b,c-\/2);}
\DoxyCodeLine{00477\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ yetComputed[idxTarget]\ =\ -\/(FReal(2*a-\/1)*dx*yetComputed[idxSrc1]\ +\ FReal((a-\/1)*(a-\/1))*yetComputed[idxSrc4]}
\DoxyCodeLine{00478\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ +\ FReal(2*b)*dy*yetComputed[idxSrc2]\ +\ FReal(b*(b-\/1))*yetComputed[idxSrc5]}
\DoxyCodeLine{00479\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ +\ FReal(2*c)*dz*yetComputed[idxSrc3]\ +\ FReal(c*(c-\/1))*yetComputed[idxSrc6])/dist2;}
\DoxyCodeLine{00480\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00481\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00482\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00483\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00484\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00485\ \ \ \ \ \}}
\DoxyCodeLine{00486\ }
\DoxyCodeLine{00487\ }
\DoxyCodeLine{00491\ }
\DoxyCodeLine{00492\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00493\ }
\DoxyCodeLine{00494\ \ \ \ \ \textcolor{comment}{/*Constructor,\ need\ system\ information*/}}
\DoxyCodeLine{00495\ \ \ \ \ \mbox{\hyperlink{class_f_taylor_kernel}{FTaylorKernel}}(\textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ inTreeHeight,\ \textcolor{keyword}{const}\ FReal\ inBoxWidth,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_f_point}{FPoint<FReal>}}\&\ inBoxCenter)\ :}
\DoxyCodeLine{00496\ \ \ \ \ \ \ \ \ boxWidth(inBoxWidth),}
\DoxyCodeLine{00497\ \ \ \ \ \ \ \ \ treeHeight(inTreeHeight),}
\DoxyCodeLine{00498\ \ \ \ \ \ \ \ \ widthAtLeafLevel(inBoxWidth/FReal(1\ <<\ (inTreeHeight-\/1))),}
\DoxyCodeLine{00499\ \ \ \ \ \ \ \ \ widthAtLeafLevelDiv2(widthAtLeafLevel/2),}
\DoxyCodeLine{00500\ \ \ \ \ \ \ \ \ boxCorner(inBoxCenter.\mbox{\hyperlink{class_f_point_a58d3859160347552d6a4a94fbdf883c3}{getX}}()-\/(inBoxWidth/2),inBoxCenter.\mbox{\hyperlink{class_f_point_ae4383512b9b8d216775b3fb92325cfc9}{getY}}()-\/(inBoxWidth/2),inBoxCenter.\mbox{\hyperlink{class_f_point_a02208d4db50cbafe597adcbfb152b536}{getZ}}()-\/(inBoxWidth/2))}
\DoxyCodeLine{00501\ \ \ \ \ \{}
\DoxyCodeLine{00502\ \ \ \ \ \ \ \ \ FReal\ facto;}
\DoxyCodeLine{00503\ \ \ \ \ \ \ \ \ this-\/>precomputeFactorials()\ ;}
\DoxyCodeLine{00504\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ \ \ \ int\ a\ =\ 0,\ b\ =\ 0,\ c\ =\ 0;}}
\DoxyCodeLine{00505\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ i=0\ ,\ \ a\ =\ 0,\ b\ =\ 0,\ c\ =\ 0;\ i<SizeVector\ ;\ ++i)}
\DoxyCodeLine{00506\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00507\ \ \ \ \ \ \ \ \ \ \ \ \ facto\ =\ \textcolor{keyword}{static\_cast<}FReal\textcolor{keyword}{>}(fact3int(a,b,c));}
\DoxyCodeLine{00508\ \ \ \ \ \ \ \ \ \ \ \ \ \_coeffPoly[i]\ =\ FReal(1.0)/(facto);}
\DoxyCodeLine{00509\ \ \ \ \ \ \ \ \ \ \ \ \ this-\/>incPowers(\&a,\&b,\&c);\ \textcolor{comment}{//inc\ powers\ of\ expansion}}
\DoxyCodeLine{00510\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00511\ \ \ \ \ \ \ \ \ this-\/>preComputeDerivative();}
\DoxyCodeLine{00512\ \ \ \ \ \ \ \ \ this-\/>preComputeIndirection();}
\DoxyCodeLine{00513\ \ \ \ \ \}}
\DoxyCodeLine{00514\ }
\DoxyCodeLine{00515\ \ \ \ \ \textcolor{comment}{/*\ Default\ destructor}}
\DoxyCodeLine{00516\ \textcolor{comment}{\ \ \ */}}
\DoxyCodeLine{00517\ \ \ \ \ \textcolor{keyword}{virtual}\ \mbox{\hyperlink{class_f_taylor_kernel}{\string~FTaylorKernel}}()\{}
\DoxyCodeLine{00518\ }
\DoxyCodeLine{00519\ \ \ \ \ \}}
\DoxyCodeLine{00520\ }
\DoxyCodeLine{00531\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_f_taylor_kernel_ad504e923e718ebd25dd83f11d7a99b33}{P2M}}(CellClass*\ \textcolor{keyword}{const}\ pole,}
\DoxyCodeLine{00532\ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ ContainerClass*\ \textcolor{keyword}{const}\ particles)\textcolor{keyword}{\ override}}
\DoxyCodeLine{00533\ \textcolor{keyword}{\ \ \ \ }\{}
\DoxyCodeLine{00534\ \ \ \ \ \ \ \ \ \textcolor{comment}{//Copying\ cell\ center\ position\ once\ and\ for\ all}}
\DoxyCodeLine{00535\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_f_point}{FPoint<FReal>}}\&\ cellCenter\ =\ getLeafCenter(pole-\/>getCoordinate());}
\DoxyCodeLine{00536\ }
\DoxyCodeLine{00537\ \ \ \ \ \ \ \ \ FReal\ *\ FRestrict\ multipole\ =\ pole-\/>getMultipole();}
\DoxyCodeLine{00538\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespace_f_mem_utils_a005b2bd1925d50a688606ed5877c5aec}{FMemUtils::memset}}(multipole,0,SizeVector*\textcolor{keyword}{sizeof}(FReal(0.0)));}
\DoxyCodeLine{00539\ }
\DoxyCodeLine{00540\ \ \ \ \ \ \ \ \ FReal\ multipole2[SizeVector]\ ;}
\DoxyCodeLine{00541\ }
\DoxyCodeLine{00542\ \ \ \ \ \ \ \ \ FSize\ nbPart\ =\ particles-\/>getNbParticles(),\ i;}
\DoxyCodeLine{00543\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ FReal*\ \textcolor{keyword}{const}\ *\ positions\ =\ particles-\/>getPositions();}
\DoxyCodeLine{00544\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ FReal*\ posX\ =\ positions[0];}
\DoxyCodeLine{00545\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ FReal*\ posY\ =\ positions[1];}
\DoxyCodeLine{00546\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ FReal*\ posZ\ =\ positions[2];}
\DoxyCodeLine{00547\ }
\DoxyCodeLine{00548\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ FReal*\ phyValue\ =\ particles-\/>getPhysicalValues();}
\DoxyCodeLine{00549\ }
\DoxyCodeLine{00550\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Iterating\ over\ Particles}}
\DoxyCodeLine{00551\ \ \ \ \ \ \ \ \ FReal\ xc\ =\ cellCenter.\mbox{\hyperlink{class_f_point_a58d3859160347552d6a4a94fbdf883c3}{getX}}(),\ yc\ =\ cellCenter.\mbox{\hyperlink{class_f_point_ae4383512b9b8d216775b3fb92325cfc9}{getY}}(),\ zc\ =\ cellCenter.\mbox{\hyperlink{class_f_point_a02208d4db50cbafe597adcbfb152b536}{getZ}}()\ ;}
\DoxyCodeLine{00552\ \ \ \ \ \ \ \ \ FReal\ dx[3]\ ;}
\DoxyCodeLine{00553\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(FSize\ idPart=0\ ;\ idPart<nbPart\ ;\ ++idPart)\{}
\DoxyCodeLine{00554\ }
\DoxyCodeLine{00555\ \ \ \ \ \ \ \ \ \ \ \ \ dx[0]\ \ \ \ \ \ \ \ \ =\ xc\ -\/\ posX[idPart]\ ;}
\DoxyCodeLine{00556\ \ \ \ \ \ \ \ \ \ \ \ \ dx[1]\ \ \ \ \ \ \ \ \ =\ yc\ -\/\ posY[idPart]\ ;}
\DoxyCodeLine{00557\ \ \ \ \ \ \ \ \ \ \ \ \ dx[2]\ \ \ \ \ \ \ \ \ =\ zc\ -\/\ posZ[idPart]\ ;}
\DoxyCodeLine{00558\ }
\DoxyCodeLine{00559\ \ \ \ \ \ \ \ \ \ \ \ \ multipole2[0]\ =\ phyValue[idPart]\ \ ;}
\DoxyCodeLine{00560\ }
\DoxyCodeLine{00561\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ leading[3]\ =\ \{0,0,0\ \}\ ;}
\DoxyCodeLine{00562\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ k=1,\ t=1,\ tail=1;\ k\ <=\ P;\ ++k,\ tail=t)}
\DoxyCodeLine{00563\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00564\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (i\ =\ 0;\ i\ <\ 3;\ ++i)\ \textcolor{comment}{//\ d√©rouler\ la\ boucle\ en\ I\ ??}}
\DoxyCodeLine{00565\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00566\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ head\ =\ leading[i];}
\DoxyCodeLine{00567\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ leading[i]\ =\ t;}
\DoxyCodeLine{00568\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\ \textcolor{keywordtype}{int}\ j\ =\ head;\ j\ <\ tail;\ ++j,\ ++t)}
\DoxyCodeLine{00569\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00570\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ multipole2[t]\ =\ multipole2[j]\ *dx[i]\ ;}
\DoxyCodeLine{00571\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00572\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}\ \textcolor{comment}{//\ for\ i}}
\DoxyCodeLine{00573\ \ \ \ \ \ \ \ \ \ \ \ \ \}\textcolor{comment}{//\ for\ k}}
\DoxyCodeLine{00574\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{00575\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Does\ a\ saxpy\ be\ usefull\ here\ ?}}
\DoxyCodeLine{00576\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\ i=0\ ;\ i\ <\ SizeVector\ ;\ ++i)}
\DoxyCodeLine{00577\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00578\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ multipole[i]\ +=\ \ multipole2[i]\ ;}
\DoxyCodeLine{00579\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ multipole2[i]\ =\ 0.0;}
\DoxyCodeLine{00580\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00581\ \ \ \ \ \ \ \ \ \}\ \ \textcolor{comment}{//\ end\ loop\ on\ particles}}
\DoxyCodeLine{00582\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Multiply\ by\ the\ coefficient}}
\DoxyCodeLine{00583\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\ i=0\ ;\ i\ <\ SizeVector\ ;\ ++i)}
\DoxyCodeLine{00584\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00585\ \ \ \ \ \ \ \ \ \ \ \ \ multipole[i]\ *=\_coeffPoly[i]\ ;}
\DoxyCodeLine{00586\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00587\ \ \ \ \ \}}
\DoxyCodeLine{00588\ }
\DoxyCodeLine{00589\ }
\DoxyCodeLine{00595\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_f_taylor_kernel_ac9974eee68de43cd44f5c229fc6f8c11}{M2M}}(CellClass*\ \textcolor{keyword}{const}\ FRestrict\ pole,}
\DoxyCodeLine{00596\ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ CellClass*\textcolor{keyword}{const}\ FRestrict\ *\textcolor{keyword}{const}\ FRestrict\ child,}
\DoxyCodeLine{00597\ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ inLevel)\textcolor{keyword}{override}}
\DoxyCodeLine{00598\ \textcolor{keyword}{\ \ \ \ }\{}
\DoxyCodeLine{00599\ \ \ \ \ \ \ \ \ \textcolor{comment}{//Powers\ of\ expansions}}
\DoxyCodeLine{00600\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ a=0,b=0,c=0;}
\DoxyCodeLine{00601\ \ \ \ \ \ \ \ \ \textcolor{comment}{//Indexes\ of\ powers}}
\DoxyCodeLine{00602\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ idx\_a,idx\_b,idx\_c;}
\DoxyCodeLine{00603\ \ \ \ \ \ \ \ \ \textcolor{comment}{//Distance\ from\ current\ child\ to\ parent}}
\DoxyCodeLine{00604\ \ \ \ \ \ \ \ \ FReal\ dx\ =\ 0.0;}
\DoxyCodeLine{00605\ \ \ \ \ \ \ \ \ FReal\ dy\ =\ 0.0;}
\DoxyCodeLine{00606\ \ \ \ \ \ \ \ \ FReal\ dz\ =\ 0.0;}
\DoxyCodeLine{00607\ \ \ \ \ \ \ \ \ \textcolor{comment}{//Center\ point\ of\ parent\ cell}}
\DoxyCodeLine{00608\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_f_point}{FPoint<FReal>}}\&\ cellCenter\ =\ getCellCenter(pole-\/>getCoordinate(),inLevel);}
\DoxyCodeLine{00609\ \ \ \ \ \ \ \ \ FReal\ *\ FRestrict\ mult\ =\ pole-\/>getMultipole();}
\DoxyCodeLine{00610\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00611\ \ \ \ \ \ \ \ \ \textcolor{comment}{//Iteration\ over\ the\ eight\ children}}
\DoxyCodeLine{00612\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ idxChild;}
\DoxyCodeLine{00613\ \ \ \ \ \ \ \ \ FReal\ coeff;}
\DoxyCodeLine{00614\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(idxChild=0\ ;\ idxChild<8\ ;\ ++idxChild)}
\DoxyCodeLine{00615\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00616\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(child[idxChild])\{}
\DoxyCodeLine{00617\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_f_point}{FPoint<FReal>}}\&\ childCenter\ =\ getCellCenter(child[idxChild]-\/>getCoordinate(),inLevel+1);}
\DoxyCodeLine{00618\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ FReal\ *\ FRestrict\ multChild\ =\ child[idxChild]-\/>getMultipole();}
\DoxyCodeLine{00619\ }
\DoxyCodeLine{00620\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Set\ the\ distance\ between\ centers\ of\ cells}}
\DoxyCodeLine{00621\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ dx\ =\ cellCenter.\mbox{\hyperlink{class_f_point_a58d3859160347552d6a4a94fbdf883c3}{getX}}()\ -\/\ childCenter.\mbox{\hyperlink{class_f_point_a58d3859160347552d6a4a94fbdf883c3}{getX}}();}
\DoxyCodeLine{00622\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ dy\ =\ cellCenter.\mbox{\hyperlink{class_f_point_ae4383512b9b8d216775b3fb92325cfc9}{getY}}()\ -\/\ childCenter.\mbox{\hyperlink{class_f_point_ae4383512b9b8d216775b3fb92325cfc9}{getY}}();}
\DoxyCodeLine{00623\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ dz\ =\ cellCenter.\mbox{\hyperlink{class_f_point_a02208d4db50cbafe597adcbfb152b536}{getZ}}()\ -\/\ childCenter.\mbox{\hyperlink{class_f_point_a02208d4db50cbafe597adcbfb152b536}{getZ}}();}
\DoxyCodeLine{00624\ }
\DoxyCodeLine{00625\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Precompute\ the\ \ arrays\ of\ dx\string^i}}
\DoxyCodeLine{00626\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ arrayDX[0]\ =\ 1.0\ ;}
\DoxyCodeLine{00627\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ arrayDY[0]\ =\ 1.0\ ;}
\DoxyCodeLine{00628\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ arrayDZ[0]\ =\ 1.0\ ;}
\DoxyCodeLine{00629\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 1\ ;\ i\ <=\ P\ ;\ ++i)\ \ \{}
\DoxyCodeLine{00630\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ arrayDX[i]\ =\ dx\ *\ arrayDX[i-\/1]\ ;}
\DoxyCodeLine{00631\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ arrayDY[i]\ =\ dy\ *\ arrayDY[i-\/1]\ ;}
\DoxyCodeLine{00632\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ arrayDZ[i]\ =\ dz\ *\ arrayDZ[i-\/1]\ ;}
\DoxyCodeLine{00633\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00634\ }
\DoxyCodeLine{00635\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ a=0;}
\DoxyCodeLine{00636\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ b=0;}
\DoxyCodeLine{00637\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ c=0;}
\DoxyCodeLine{00638\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//FReal\ value\ ;}}
\DoxyCodeLine{00639\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ FReal\ value;}
\DoxyCodeLine{00640\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Iteration\ over\ parent\ multipole\ array}}
\DoxyCodeLine{00641\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ ordMult\ =\ 0,idxMult=0\ ;\ ordMult\ <=\ P\ ;\ ++ordMult)}
\DoxyCodeLine{00642\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00643\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(a=ordMult\ ;\ a>=0\ ;\ -\/-\/a)}
\DoxyCodeLine{00644\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00645\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}((ordMult-\/a)\ ==\ 1)\{}
\DoxyCodeLine{00646\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ i\ =0\ ;\ i<=\ 1\ ;\ ++i,++idxMult)}
\DoxyCodeLine{00647\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00648\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ value\ =\ 0.0;}
\DoxyCodeLine{00649\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ idMultiChild;}
\DoxyCodeLine{00650\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ b\ =\ 1-\/i;}
\DoxyCodeLine{00651\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ c\ =\ i;}
\DoxyCodeLine{00652\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Iteration\ over\ the\ powers\ to\ find\ the\ cell\ multipole}}
\DoxyCodeLine{00653\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//involved\ in\ the\ computation\ of\ the\ parent\ multipole}}
\DoxyCodeLine{00654\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(idx\_a=0\ ;\ idx\_a\ <=\ a\ ;\ ++idx\_a)\{}
\DoxyCodeLine{00655\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(idx\_b=0\ ;\ idx\_b\ <=\ b\ ;\ ++idx\_b)\{}
\DoxyCodeLine{00656\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(idx\_c=0\ ;\ idx\_c\ <=\ c\ ;\ ++idx\_c)\{}
\DoxyCodeLine{00657\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Computation}}
\DoxyCodeLine{00658\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Child\ multipole\ involved}}
\DoxyCodeLine{00659\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ idMultiChild\ =\ powerToIdx(a-\/idx\_a,b-\/idx\_b,c-\/idx\_c);}
\DoxyCodeLine{00660\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ coeff\ =\ FReal(1.0)/fact3int(idx\_a,idx\_b,idx\_c);}
\DoxyCodeLine{00661\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ value\ +=\ multChild[idMultiChild]*coeff*arrayDX[idx\_a]*arrayDY[idx\_b]*arrayDZ[idx\_c];}
\DoxyCodeLine{00662\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00663\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00664\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00665\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ mult[idxMult]\ +=\ value;}
\DoxyCodeLine{00666\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00667\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00668\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\{}
\DoxyCodeLine{00669\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(b=ordMult-\/a\ ;\ b>=0\ ;\ -\/-\/b,\ ++idxMult)}
\DoxyCodeLine{00670\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00671\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ value\ =\ 0.0;}
\DoxyCodeLine{00672\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ idMultiChild;}
\DoxyCodeLine{00673\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ c\ =\ ordMult-\/a-\/b;}
\DoxyCodeLine{00674\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Iteration\ over\ the\ powers\ to\ find\ the\ cell\ multipole}}
\DoxyCodeLine{00675\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//involved\ in\ the\ computation\ of\ the\ parent\ multipole}}
\DoxyCodeLine{00676\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(idx\_a=0\ ;\ idx\_a\ <=\ a\ ;\ ++idx\_a)\{}
\DoxyCodeLine{00677\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(idx\_b=0\ ;\ idx\_b\ <=\ b\ ;\ ++idx\_b)\{}
\DoxyCodeLine{00678\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(idx\_c=0\ ;\ idx\_c\ <=\ c\ ;\ ++idx\_c)\{}
\DoxyCodeLine{00679\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Computation}}
\DoxyCodeLine{00680\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Child\ multipole\ involved}}
\DoxyCodeLine{00681\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ idMultiChild\ =\ powerToIdx(a-\/idx\_a,b-\/idx\_b,c-\/idx\_c);}
\DoxyCodeLine{00682\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ coeff\ =\ FReal(1.0)/fact3int(idx\_a,idx\_b,idx\_c);}
\DoxyCodeLine{00683\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ value\ +=\ multChild[idMultiChild]*coeff*arrayDX[idx\_a]*arrayDY[idx\_b]*arrayDZ[idx\_c];}
\DoxyCodeLine{00684\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00685\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00686\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00687\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ mult[idxMult]\ +=\ value;}
\DoxyCodeLine{00688\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00689\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00690\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00691\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00692\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00693\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00694\ \ \ \ \ \}}
\DoxyCodeLine{00695\ }
\DoxyCodeLine{00711\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_f_taylor_kernel_a517b6fcc317f2ce9e2a37690cc7c6c3c}{M2L}}(CellClass*\ \textcolor{keyword}{const}\ FRestrict\ inLocal,\ \textcolor{keyword}{const}\ CellClass*\ distantNeighbors[],}
\DoxyCodeLine{00712\ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ neighborPositions[],\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ inSize,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ inLevel)\textcolor{keyword}{\ \ override\ }\{}
\DoxyCodeLine{00713\ \ \ \ \ \ \ \ \ \textcolor{comment}{//Local\ expansion\ to\ be\ filled}}
\DoxyCodeLine{00714\ \ \ \ \ \ \ \ \ FReal\ *\ FRestrict\ iterLocal\ =\ inLocal-\/>getLocal();}
\DoxyCodeLine{00715\ \ \ \ \ \ \ \ \ \textcolor{comment}{//index\ for\ distant\ neighbors}}
\DoxyCodeLine{00716\ \ \ \ \ \ \ \ \ FReal\ tmp1;}
\DoxyCodeLine{00717\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ *\ ind;}
\DoxyCodeLine{00718\ \ \ \ \ \ \ \ \ FReal\ *\ psiVector;}
\DoxyCodeLine{00719\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ FReal\ *\ multipole;}
\DoxyCodeLine{00720\ \ \ \ \ \ \ \ \ \textcolor{comment}{//Loop\ over\ all\ the\ possible\ neighbors}}
\DoxyCodeLine{00721\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ idxExistingNeigh\ =\ 0\ ;\ idxExistingNeigh\ <\ inSize\ ;\ ++idxExistingNeigh)\{}
\DoxyCodeLine{00722\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ idxNeigh\ =\ neighborPositions[idxExistingNeigh];}
\DoxyCodeLine{00723\ }
\DoxyCodeLine{00724\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Get\ the\ preComputed\ values\ for\ the\ derivative}}
\DoxyCodeLine{00725\ \ \ \ \ \ \ \ \ \ \ \ \ psiVector\ =\ M2LpreComputedDerivatives[inLevel][idxNeigh];}
\DoxyCodeLine{00726\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Multipole\ to\ be\ read}}
\DoxyCodeLine{00727\ \ \ \ \ \ \ \ \ \ \ \ \ multipole\ =\ distantNeighbors[idxExistingNeigh]-\/>getMultipole();}
\DoxyCodeLine{00728\ }
\DoxyCodeLine{00729\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Iterating\ over\ local\ array\ :\ n}}
\DoxyCodeLine{00730\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ i=0\ ;\ i<SizeVector\ ;\ ++i)}
\DoxyCodeLine{00731\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00732\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Get\ the\ right\ indexes\ set}}
\DoxyCodeLine{00733\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ind\ =\ this-\/>preComputedIndirections[i];}
\DoxyCodeLine{00734\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tmp1\ =\ FReal(0);}
\DoxyCodeLine{00735\ }
\DoxyCodeLine{00736\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Iterating\ over\ multipole\ array}}
\DoxyCodeLine{00737\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j=0\ ;\ j<SizeVector\ ;\ ++j)}
\DoxyCodeLine{00738\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00739\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tmp1\ +=\ psiVector[ind[j]]*multipole[j];}
\DoxyCodeLine{00740\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00741\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ iterLocal[i]\ +=\ tmp1*\_coeffPoly[i];}
\DoxyCodeLine{00742\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00743\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00744\ \ \ \ \ \}}
\DoxyCodeLine{00745\ }
\DoxyCodeLine{00746\ }
\DoxyCodeLine{00747\ }
\DoxyCodeLine{00762\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_f_taylor_kernel_a248a840c8d2064e252e90e1eb0d2e007}{L2L}}(\textcolor{keyword}{const}\ CellClass*\ \textcolor{keyword}{const}\ FRestrict\ fatherCell,}
\DoxyCodeLine{00763\ \ \ \ \ \ \ \ \ \ \ \ \ \ CellClass*\ FRestrict\ *\ \textcolor{keyword}{const}\ FRestrict\ childCell,}
\DoxyCodeLine{00764\ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ inLevel)\textcolor{keyword}{\ override}}
\DoxyCodeLine{00765\ \textcolor{keyword}{\ \ \ \ }\{}
\DoxyCodeLine{00766\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_f_point}{FPoint<FReal>}}\ locCenter\ =\ getCellCenter(fatherCell-\/>getCoordinate(),inLevel);}
\DoxyCodeLine{00767\ }
\DoxyCodeLine{00768\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Get\ father\ local\ expansion}}
\DoxyCodeLine{00769\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ FReal*\ FRestrict\ fatherExpansion\ =\ fatherCell-\/>getLocal()\ \ ;}
\DoxyCodeLine{00770\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ idxFatherLoc;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//index\ of\ Father\ local\ expansion\ to\ be\ read.}}
\DoxyCodeLine{00771\ \ \ \ \ \ \ \ \ FReal\ dx,\ \ dy,\ \ dz,\ coeff;}
\DoxyCodeLine{00772\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ ap,\ bp,\ cp,\ af,\ bf,\ cf;\ \ \ \ \ \textcolor{comment}{//Indexes\ of\ expansion\ for\ father\ and\ child.}}
\DoxyCodeLine{00773\ }
\DoxyCodeLine{00774\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ For\ all\ children}}
\DoxyCodeLine{00775\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ idxChild\ =\ 0\ ;\ idxChild\ <\ 8\ ;\ ++idxChild)\{}
\DoxyCodeLine{00776\ }
\DoxyCodeLine{00777\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(childCell[idxChild])\{\ \textcolor{comment}{//\ if\ child\ exists}}
\DoxyCodeLine{00778\ }
\DoxyCodeLine{00779\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ FReal*\ FRestrict\ childExpansion\ =\ childCell[idxChild]-\/>getLocal()\ ;}
\DoxyCodeLine{00780\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_f_point}{FPoint<FReal>}}\&\ childCenter\ =\ getCellCenter(childCell[idxChild]-\/>getCoordinate(),inLevel+1);}
\DoxyCodeLine{00781\ }
\DoxyCodeLine{00782\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Set\ the\ distance\ between\ centers\ of\ cells}}
\DoxyCodeLine{00783\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Child\ -\/\ father}}
\DoxyCodeLine{00784\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ dx\ =\ childCenter.\mbox{\hyperlink{class_f_point_a58d3859160347552d6a4a94fbdf883c3}{getX}}()-\/locCenter.\mbox{\hyperlink{class_f_point_a58d3859160347552d6a4a94fbdf883c3}{getX}}();}
\DoxyCodeLine{00785\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ dy\ =\ childCenter.\mbox{\hyperlink{class_f_point_ae4383512b9b8d216775b3fb92325cfc9}{getY}}()-\/locCenter.\mbox{\hyperlink{class_f_point_ae4383512b9b8d216775b3fb92325cfc9}{getY}}();}
\DoxyCodeLine{00786\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ dz\ =\ childCenter.\mbox{\hyperlink{class_f_point_a02208d4db50cbafe597adcbfb152b536}{getZ}}()-\/locCenter.\mbox{\hyperlink{class_f_point_a02208d4db50cbafe597adcbfb152b536}{getZ}}();}
\DoxyCodeLine{00787\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Precompute\ the\ \ arrays\ of\ dx\string^i}}
\DoxyCodeLine{00788\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ arrayDX[0]\ =\ 1.0\ ;}
\DoxyCodeLine{00789\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ arrayDY[0]\ =\ 1.0\ ;}
\DoxyCodeLine{00790\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ arrayDZ[0]\ =\ 1.0\ ;}
\DoxyCodeLine{00791\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 1\ ;\ i\ <=\ P\ ;\ ++i)\ \ \{}
\DoxyCodeLine{00792\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ arrayDX[i]\ =\ dx\ *\ arrayDX[i-\/1]\ ;}
\DoxyCodeLine{00793\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ arrayDY[i]\ =\ dy\ *\ arrayDY[i-\/1]\ ;}
\DoxyCodeLine{00794\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ arrayDZ[i]\ =\ dz\ *\ arrayDZ[i-\/1]\ ;}
\DoxyCodeLine{00795\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00796\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//iterator\ over\ child's\ local\ expansion\ (to\ be\ filled)}}
\DoxyCodeLine{00797\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ af=0;\ \ \ bf=0;\ \ \ cf=0;}
\DoxyCodeLine{00798\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ ordChild=0,\ idxChEx=0\ ;\ ordChild\ <=\ P\ ;\ ++ordChild)\ \{}
\DoxyCodeLine{00799\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(af=ordChild\ ;\ af>=0\ ;\ -\/-\/af)}
\DoxyCodeLine{00800\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00801\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}((ordChild-\/af)\ ==\ 1)\{}
\DoxyCodeLine{00802\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ i=0\ ;\ i\ <=\ 1\ ;\ ++i,++idxChEx)}
\DoxyCodeLine{00803\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00804\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ bf\ =\ 1-\/i;}
\DoxyCodeLine{00805\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ cf\ =\ i;}
\DoxyCodeLine{00806\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Iterator\ over\ parent's\ local\ array}}
\DoxyCodeLine{00807\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(ap=af\ ;\ ap<=P\ ;\ ++ap)\{}
\DoxyCodeLine{00808\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(bp=bf\ ;\ bp<=P\ ;\ ++bp)\{}
\DoxyCodeLine{00809\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(cp=cf\ ;\ ((cp<=P)\ \&\&\ (ap+bp+cp)\ <=\ P)\ ;\ ++cp)\{}
\DoxyCodeLine{00810\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ idxFatherLoc\ =\ powerToIdx(ap,bp,cp);}
\DoxyCodeLine{00811\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ coeff\ =\ combin(ap,af)\ *\ combin(bp,bf)\ *\ combin(cp,cf);}
\DoxyCodeLine{00812\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ childExpansion[idxChEx]\ +=\ coeff*fatherExpansion[idxFatherLoc]*arrayDX[ap-\/af]*arrayDY[bp-\/bf]*arrayDZ[cp-\/cf]\ ;}
\DoxyCodeLine{00813\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00814\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00815\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00816\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00817\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00818\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\{}
\DoxyCodeLine{00819\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(bf=ordChild-\/af\ ;\ bf>=0\ ;\ -\/-\/bf,\ ++idxChEx)}
\DoxyCodeLine{00820\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00821\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ cf\ =\ ordChild-\/af-\/bf;}
\DoxyCodeLine{00822\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Iterator\ over\ parent's\ local\ array}}
\DoxyCodeLine{00823\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(ap=af\ ;\ ap<=P\ ;\ ++ap)\{}
\DoxyCodeLine{00824\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(bp=bf\ ;\ bp<=P\ ;\ ++bp)\{}
\DoxyCodeLine{00825\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(cp=cf\ ;\ ((cp<=P)\ \&\&\ (ap+bp+cp)\ <=\ P)\ ;\ ++cp)\{}
\DoxyCodeLine{00826\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ idxFatherLoc\ =\ powerToIdx(ap,bp,cp);}
\DoxyCodeLine{00827\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ coeff\ =\ combin(ap,af)\ *\ combin(bp,bf)\ *\ combin(cp,cf);}
\DoxyCodeLine{00828\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ childExpansion[idxChEx]\ +=\ coeff*fatherExpansion[idxFatherLoc]*arrayDX[ap-\/af]*arrayDY[bp-\/bf]*arrayDZ[cp-\/cf]\ ;}
\DoxyCodeLine{00829\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00830\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00831\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00832\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00833\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00834\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00835\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00836\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00837\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00838\ \ \ \ \ \}}
\DoxyCodeLine{00839\ }
\DoxyCodeLine{00840\ }
\DoxyCodeLine{00841\ }
\DoxyCodeLine{00842\ }
\DoxyCodeLine{00855\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_f_taylor_kernel_a68f51a6ab1ff33cff3cfe2790735ff2a}{L2P}}(\textcolor{keyword}{const}\ CellClass*\ \textcolor{keyword}{const}\ local,}
\DoxyCodeLine{00856\ \ \ \ \ \ \ \ \ \ \ \ \ \ ContainerClass*\ \textcolor{keyword}{const}\ particles)\textcolor{keyword}{\ override}}
\DoxyCodeLine{00857\ \textcolor{keyword}{\ \ \ \ }\{}
\DoxyCodeLine{00858\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_f_point}{FPoint<FReal>}}\ locCenter\ =\ getLeafCenter(local-\/>getCoordinate());}
\DoxyCodeLine{00859\ \ \ \ \ \ \ \ \ \textcolor{comment}{//Iterator\ over\ particles}}
\DoxyCodeLine{00860\ \ \ \ \ \ \ \ \ FSize\ nbPart\ =\ particles-\/>getNbParticles();}
\DoxyCodeLine{00861\ }
\DoxyCodeLine{00862\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ FReal\ *\ iterLocal\ =\ local-\/>getLocal();}
\DoxyCodeLine{00863\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ FReal\ *\ \textcolor{keyword}{const}\ *\ positions\ =\ particles-\/>getPositions();}
\DoxyCodeLine{00864\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ FReal\ *\ posX\ =\ positions[0];}
\DoxyCodeLine{00865\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ FReal\ *\ posY\ =\ positions[1];}
\DoxyCodeLine{00866\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ FReal\ *\ posZ\ =\ positions[2];}
\DoxyCodeLine{00867\ }
\DoxyCodeLine{00868\ \ \ \ \ \ \ \ \ FReal\ *\ forceX\ =\ particles-\/>getForcesX();}
\DoxyCodeLine{00869\ \ \ \ \ \ \ \ \ FReal\ *\ forceY\ =\ particles-\/>getForcesY();}
\DoxyCodeLine{00870\ \ \ \ \ \ \ \ \ FReal\ *\ forceZ\ =\ particles-\/>getForcesZ();}
\DoxyCodeLine{00871\ }
\DoxyCodeLine{00872\ \ \ \ \ \ \ \ \ FReal\ *\ targetsPotentials\ =\ particles-\/>getPotentials();}
\DoxyCodeLine{00873\ }
\DoxyCodeLine{00874\ \ \ \ \ \ \ \ \ FReal\ *\ phyValues\ =\ particles-\/>getPhysicalValues();}
\DoxyCodeLine{00875\ }
\DoxyCodeLine{00876\ \ \ \ \ \ \ \ \ \textcolor{comment}{//Iteration\ over\ particles}}
\DoxyCodeLine{00877\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(FSize\ i=0\ ;\ i<nbPart\ ;\ ++i)\{}
\DoxyCodeLine{00878\ }
\DoxyCodeLine{00879\ \ \ \ \ \ \ \ \ \ \ \ \ FReal\ dx\ =\ \ posX[i]\ -\/\ locCenter.\mbox{\hyperlink{class_f_point_a58d3859160347552d6a4a94fbdf883c3}{getX}}();}
\DoxyCodeLine{00880\ \ \ \ \ \ \ \ \ \ \ \ \ FReal\ dy\ =\ \ posY[i]\ -\/\ locCenter.\mbox{\hyperlink{class_f_point_ae4383512b9b8d216775b3fb92325cfc9}{getY}}();}
\DoxyCodeLine{00881\ \ \ \ \ \ \ \ \ \ \ \ \ FReal\ dz\ =\ \ posZ[i]\ -\/\ locCenter.\mbox{\hyperlink{class_f_point_a02208d4db50cbafe597adcbfb152b536}{getZ}}();}
\DoxyCodeLine{00882\ }
\DoxyCodeLine{00883\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Precompute\ an\ arrays\ of\ Array[i]\ =\ dx\string^(i-\/1)}}
\DoxyCodeLine{00884\ \ \ \ \ \ \ \ \ \ \ \ \ arrayDX[0]\ =\ 0.0\ ;}
\DoxyCodeLine{00885\ \ \ \ \ \ \ \ \ \ \ \ \ arrayDY[0]\ =\ 0.0\ ;}
\DoxyCodeLine{00886\ \ \ \ \ \ \ \ \ \ \ \ \ arrayDZ[0]\ =\ 0.0\ ;}
\DoxyCodeLine{00887\ }
\DoxyCodeLine{00888\ \ \ \ \ \ \ \ \ \ \ \ \ arrayDX[1]\ =\ 1.0\ ;}
\DoxyCodeLine{00889\ \ \ \ \ \ \ \ \ \ \ \ \ arrayDY[1]\ =\ 1.0\ ;}
\DoxyCodeLine{00890\ \ \ \ \ \ \ \ \ \ \ \ \ arrayDZ[1]\ =\ 1.0\ ;}
\DoxyCodeLine{00891\ }
\DoxyCodeLine{00892\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ d\ =\ 2\ ;\ d\ <=\ P+1\ ;\ ++d)\{\ \textcolor{comment}{//Array\ is\ staggered\ :\ Array[i]\ =\ dx\string^(i-\/1)}}
\DoxyCodeLine{00893\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ arrayDX[d]\ =\ dx\ *\ arrayDX[d-\/1]\ ;}
\DoxyCodeLine{00894\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ arrayDY[d]\ =\ dy\ *\ arrayDY[d-\/1]\ ;}
\DoxyCodeLine{00895\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ arrayDZ[d]\ =\ dz\ *\ arrayDZ[d-\/1]\ ;}
\DoxyCodeLine{00896\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00897\ \ \ \ \ \ \ \ \ \ \ \ \ FReal\ partPhyValue\ =\ phyValues[i];}
\DoxyCodeLine{00898\ \ \ \ \ \ \ \ \ \ \ \ \ FReal\ \ locPot\ =\ 0.0,\ locForceX\ =\ 0.0,\ locForceY\ =\ 0.0,\ locForceZ\ =\ 0.0\ ;}
\DoxyCodeLine{00899\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ a=0,b=0,c=0;}
\DoxyCodeLine{00900\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ j=0,ord=0\ ;\ ord\ <=\ P\ ;\ ++ord)}
\DoxyCodeLine{00901\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00902\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(a=ord\ ;\ a>=0\ ;\ -\/-\/a)}
\DoxyCodeLine{00903\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00904\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\ (ord-\/a)\ ==\ 1)\{}
\DoxyCodeLine{00905\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ t=0\ ;\ t<=1\ ;\ ++t,++j)}
\DoxyCodeLine{00906\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00907\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ b\ =\ 1-\/t;}
\DoxyCodeLine{00908\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ c\ =\ t;}
\DoxyCodeLine{00909\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ FReal\ locForce\ \ \ \ \ =\ iterLocal[j];}
\DoxyCodeLine{00910\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ compute\ the\ potential}}
\DoxyCodeLine{00911\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ locPot\ +=\ iterLocal[j]*arrayDX[a+1]*arrayDY[b+1]*arrayDZ[c+1];}
\DoxyCodeLine{00912\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Application\ of\ forces}}
\DoxyCodeLine{00913\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ locForceX\ +=\ FReal(a)*locForce*arrayDX[a]*arrayDY[b+1]*arrayDZ[c+1];}
\DoxyCodeLine{00914\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ locForceY\ +=\ FReal(b)*locForce*arrayDX[a+1]*arrayDY[b]*arrayDZ[c+1];}
\DoxyCodeLine{00915\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ locForceZ\ +=\ FReal(c)*locForce*arrayDX[a+1]*arrayDY[b+1]*arrayDZ[c];}
\DoxyCodeLine{00916\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00917\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00918\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\{}
\DoxyCodeLine{00919\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(b=ord-\/a\ ;\ b>=0\ ;\ -\/-\/b,++j)}
\DoxyCodeLine{00920\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00921\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ c\ =\ ord-\/a-\/b;}
\DoxyCodeLine{00922\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ FReal\ locForce\ \ \ \ \ =\ iterLocal[j];}
\DoxyCodeLine{00923\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ compute\ the\ potential}}
\DoxyCodeLine{00924\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ locPot\ +=\ iterLocal[j]*arrayDX[a+1]*arrayDY[b+1]*arrayDZ[c+1];}
\DoxyCodeLine{00925\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Application\ of\ forces}}
\DoxyCodeLine{00926\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ locForceX\ +=\ FReal(a)*locForce*arrayDX[a]*arrayDY[b+1]*arrayDZ[c+1];}
\DoxyCodeLine{00927\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ locForceY\ +=\ FReal(b)*locForce*arrayDX[a+1]*arrayDY[b]*arrayDZ[c+1];}
\DoxyCodeLine{00928\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ locForceZ\ +=\ FReal(c)*locForce*arrayDX[a+1]*arrayDY[b+1]*arrayDZ[c];}
\DoxyCodeLine{00929\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00930\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00931\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00932\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00933\ \ \ \ \ \ \ \ \ \ \ \ \ targetsPotentials[i]\ \ +=\textcolor{comment}{/*\ partPhyValue*/}locPot\ ;}
\DoxyCodeLine{00934\ \ \ \ \ \ \ \ \ \ \ \ \ forceX[i]\ \ \ \ \ \ \ \ \ \ \ \ \ +=\ partPhyValue*locForceX\ ;}
\DoxyCodeLine{00935\ \ \ \ \ \ \ \ \ \ \ \ \ forceY[i]\ \ \ \ \ \ \ \ \ \ \ \ \ +=\ partPhyValue*locForceY\ ;}
\DoxyCodeLine{00936\ \ \ \ \ \ \ \ \ \ \ \ \ forceZ[i]\ \ \ \ \ \ \ \ \ \ \ \ \ +=\ partPhyValue*locForceZ\ ;}
\DoxyCodeLine{00937\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00938\ \ \ \ \ \}}
\DoxyCodeLine{00939\ }
\DoxyCodeLine{00946\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_f_taylor_kernel_a92ae46dae23395eabc0af1118309ab87}{P2P}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{class_f_tree_coordinate}{FTreeCoordinate}}\&\ inPosition,}
\DoxyCodeLine{00947\ \ \ \ \ \ \ \ \ \ \ \ \ \ ContainerClass*\ \textcolor{keyword}{const}\ FRestrict\ inTargets,\ \textcolor{keyword}{const}\ ContainerClass*\ \textcolor{keyword}{const}\ FRestrict\ inSources,}
\DoxyCodeLine{00948\ \ \ \ \ \ \ \ \ \ \ \ \ \ ContainerClass*\ \textcolor{keyword}{const}\ inNeighbors[],\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ neighborPositions[],}
\DoxyCodeLine{00949\ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ inSize)\textcolor{keyword}{\ override\ }\{}
\DoxyCodeLine{00950\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(inTargets\ ==\ inSources)\{}
\DoxyCodeLine{00951\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{struct_f_p2_p_r_t}{FP2PRT<FReal>::template}}\ Inner<ContainerClass>(inTargets);}
\DoxyCodeLine{00952\ \ \ \ \ \ \ \ \ \ \ \ \ P2POuter(inPosition,\ inTargets,\ inNeighbors,\ neighborPositions,\ inSize);}
\DoxyCodeLine{00953\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00954\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\{}
\DoxyCodeLine{00955\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ ContainerClass*\ \textcolor{keyword}{const}\ srcPtr[1]\ =\ \{inSources\};}
\DoxyCodeLine{00956\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{struct_f_p2_p_r_t}{FP2PRT<FReal>::template}}\ FullRemote<ContainerClass>(inTargets,srcPtr,1);}
\DoxyCodeLine{00957\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{struct_f_p2_p_r_t}{FP2PRT<FReal>::template}}\ FullRemote<ContainerClass>(inTargets,inNeighbors,inSize);}
\DoxyCodeLine{00958\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00959\ \ \ \ \ \}}
\DoxyCodeLine{00960\ }
\DoxyCodeLine{00961\ \ \ \ \ \textcolor{keywordtype}{void}\ P2POuter(\textcolor{keyword}{const}\ \mbox{\hyperlink{class_f_tree_coordinate}{FTreeCoordinate}}\&\ \textcolor{comment}{/*inLeafPosition*/},}
\DoxyCodeLine{00962\ \ \ \ \ \ \ \ \ \ \ \ \ \ ContainerClass*\ \textcolor{keyword}{const}\ FRestrict\ inTargets,}
\DoxyCodeLine{00963\ \ \ \ \ \ \ \ \ \ \ \ \ \ ContainerClass*\ \textcolor{keyword}{const}\ inNeighbors[],\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ neighborPositions[],}
\DoxyCodeLine{00964\ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ inSize)\textcolor{keyword}{\ override\ }\{}
\DoxyCodeLine{00965\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ nbNeighborsToCompute\ =\ 0;}
\DoxyCodeLine{00966\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{while}(nbNeighborsToCompute\ <\ inSize}
\DoxyCodeLine{00967\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \&\&\ neighborPositions[nbNeighborsToCompute]\ <\ 14)\{}
\DoxyCodeLine{00968\ \ \ \ \ \ \ \ \ \ \ \ \ nbNeighborsToCompute\ +=\ 1;}
\DoxyCodeLine{00969\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00970\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{struct_f_p2_p_r_t}{FP2PRT<FReal>::template}}\ FullMutual<ContainerClass>(inTargets,inNeighbors,nbNeighborsToCompute);}
\DoxyCodeLine{00971\ \ \ \ \ \}}
\DoxyCodeLine{00972\ }
\DoxyCodeLine{00973\ }
\DoxyCodeLine{00975\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_f_taylor_kernel_a4e4d6f0cec1b72903f1a2d2dc6dd7325}{P2PRemote}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{class_f_tree_coordinate}{FTreeCoordinate}}\&\ \textcolor{comment}{/*inPosition*/},}
\DoxyCodeLine{00976\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ContainerClass*\ \textcolor{keyword}{const}\ FRestrict\ inTargets,\ \textcolor{keyword}{const}\ ContainerClass*\ \textcolor{keyword}{const}\ FRestrict\ \textcolor{comment}{/*inSources*/},}
\DoxyCodeLine{00977\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ ContainerClass*\ \textcolor{keyword}{const}\ inNeighbors[],\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ neighborPositions[],}
\DoxyCodeLine{00978\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ inSize)\textcolor{keyword}{\ override\ }\{}
\DoxyCodeLine{00979\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{struct_f_p2_p_r_t}{FP2PRT<FReal>::template}}\ FullRemote<ContainerClass>(inTargets,inNeighbors,inSize);}
\DoxyCodeLine{00980\ \ \ \ \ \}}
\DoxyCodeLine{00981\ }
\DoxyCodeLine{00982\ \};}
\DoxyCodeLine{00983\ }
\DoxyCodeLine{00984\ \textcolor{preprocessor}{\#endif}}

\end{DoxyCode}
