\doxysection{FTaylor\+Kernel\+Simple.\+hpp}
\hypertarget{_f_taylor_kernel_simple_8hpp_source}{}\label{_f_taylor_kernel_simple_8hpp_source}\index{third\_party/ScalFMM/include/ScalFMM/Kernels/Taylor/FTaylorKernelSimple.hpp@{third\_party/ScalFMM/include/ScalFMM/Kernels/Taylor/FTaylorKernelSimple.hpp}}

\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{comment}{//\ See\ LICENCE\ file\ at\ project\ root}}
\DoxyCodeLine{00002\ \textcolor{preprocessor}{\#ifndef\ FTAYLORKERNEL\_HPP}}
\DoxyCodeLine{00003\ \textcolor{preprocessor}{\#define\ FTAYLORKERNEL\_HPP}}
\DoxyCodeLine{00004\ }
\DoxyCodeLine{00005\ \textcolor{preprocessor}{\#include\ "{}../../Components/FAbstractKernels.hpp"{}}}
\DoxyCodeLine{00006\ \textcolor{preprocessor}{\#include\ "{}../../Utils/FMemUtils.hpp"{}}}
\DoxyCodeLine{00007\ \textcolor{preprocessor}{\#include\ "{}../../Utils/FLog.hpp"{}}}
\DoxyCodeLine{00008\ }
\DoxyCodeLine{00009\ \textcolor{preprocessor}{\#include\ "{}../P2P/FP2PR.hpp"{}}}
\DoxyCodeLine{00010\ }
\DoxyCodeLine{00021\ \textcolor{comment}{//TODO\ sp√©cifier\ les\ arguments.}}
\DoxyCodeLine{00022\ \textcolor{keyword}{template}<\ \textcolor{keyword}{class}\ FReal,\ \textcolor{keyword}{class}\ CellClass,\ \textcolor{keyword}{class}\ ContainerClass,\ \textcolor{keywordtype}{int}\ P,\ \textcolor{keywordtype}{int}\ order>}
\DoxyCodeLine{00023\ \textcolor{keyword}{class\ }\mbox{\hyperlink{class_f_taylor_kernel}{FTaylorKernel}}\ :\ \textcolor{keyword}{public}\ \mbox{\hyperlink{class_f_abstract_kernels}{FAbstractKernels}}<CellClass,ContainerClass>\ \{}
\DoxyCodeLine{00024\ }
\DoxyCodeLine{00025\ \textcolor{keyword}{private}:}
\DoxyCodeLine{00026\ \ \ \ \ \textcolor{comment}{//Size\ of\ the\ multipole\ and\ local\ vectors}}
\DoxyCodeLine{00027\ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ SizeVector\ =\ ((P+1)*(P+2)*(P+3))*order/6;}
\DoxyCodeLine{00028\ }
\DoxyCodeLine{00029\ }
\DoxyCodeLine{00031\ \ \ \ \ \textcolor{comment}{//\ Object\ Attributes}}
\DoxyCodeLine{00033\ \ \ \ \ \textcolor{keyword}{const}\ FReal\ boxWidth;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//<\ the\ box\ width\ at\ leaf\ level}}
\DoxyCodeLine{00034\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ \ \ treeHeight;\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//<\ The\ height\ of\ the\ tree}}
\DoxyCodeLine{00035\ \ \ \ \ \textcolor{keyword}{const}\ FReal\ widthAtLeafLevel;\ \ \ \ \ \ \ \textcolor{comment}{//<\ width\ of\ box\ at\ leaf\ level}}
\DoxyCodeLine{00036\ \ \ \ \ \textcolor{keyword}{const}\ FReal\ widthAtLeafLevelDiv2;\ \ \ \textcolor{comment}{//<\ width\ of\ box\ at\ leaf\ leve\ div\ 2}}
\DoxyCodeLine{00037\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_f_point}{FPoint<FReal>}}\ boxCorner;\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//<\ position\ of\ the\ box\ corner}}
\DoxyCodeLine{00038\ }
\DoxyCodeLine{00039\ \ \ \ \ FReal\ factorials[2*P+1];\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//<\ This\ contains\ the\ factorial\ until\ P}}
\DoxyCodeLine{00040\ \ \ \ \ FReal\ arrayDX[P+2],arrayDY[P+2],arrayDZ[P+2]\ ;\ \textcolor{comment}{//<\ Working\ arrays}}
\DoxyCodeLine{00041\ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ \ sizeDerivative\ =\ (2*P+1)*(P+1)*(2*P+3)/3;}
\DoxyCodeLine{00042\ \ \ \ \ FReal\ \_PsiVector[sizeDerivative];}
\DoxyCodeLine{00043\ \ \ \ \ FReal\ \_coeffPoly[SizeVector];}
\DoxyCodeLine{00044\ }
\DoxyCodeLine{00046\ \ \ \ \ \textcolor{comment}{//\ Private\ method}}
\DoxyCodeLine{00048\ }
\DoxyCodeLine{00050\ \ \ \ \ \textcolor{comment}{//\ Precomputation}}
\DoxyCodeLine{00052\ }
\DoxyCodeLine{00057\ \ \ \ \ \textcolor{keywordtype}{void}\ precomputeFactorials()\{}
\DoxyCodeLine{00058\ \ \ \ \ \ \ \ \ factorials[0]\ =\ 1.0;}
\DoxyCodeLine{00059\ \ \ \ \ \ \ \ \ FReal\ fidx\ =\ 1.0;}
\DoxyCodeLine{00060\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ idx\ =\ 1\ ;\ idx\ <=\ 2*P\ ;\ ++idx,\ ++fidx)\{}
\DoxyCodeLine{00061\ \ \ \ \ \ \ \ \ \ \ \ \ factorials[idx]\ =\ fidx\ *\ factorials[idx-\/1];}
\DoxyCodeLine{00062\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00063\ \ \ \ \ \}}
\DoxyCodeLine{00064\ }
\DoxyCodeLine{00065\ }
\DoxyCodeLine{00067\ \ \ \ \ \mbox{\hyperlink{class_f_point}{FPoint<FReal>}}\ getLeafCenter(\textcolor{keyword}{const}\ \mbox{\hyperlink{class_f_tree_coordinate}{FTreeCoordinate}}\ coordinate)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00068\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{class_f_point}{FPoint<FReal>}}(}
\DoxyCodeLine{00069\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ FReal(coordinate.\mbox{\hyperlink{class_f_point_a58d3859160347552d6a4a94fbdf883c3}{getX}}())\ *\ widthAtLeafLevel\ +\ widthAtLeafLevelDiv2\ +\ boxCorner.\mbox{\hyperlink{class_f_point_a58d3859160347552d6a4a94fbdf883c3}{getX}}(),}
\DoxyCodeLine{00070\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ FReal(coordinate.\mbox{\hyperlink{class_f_point_ae4383512b9b8d216775b3fb92325cfc9}{getY}}())\ *\ widthAtLeafLevel\ +\ widthAtLeafLevelDiv2\ +\ boxCorner.\mbox{\hyperlink{class_f_point_ae4383512b9b8d216775b3fb92325cfc9}{getY}}(),}
\DoxyCodeLine{00071\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ FReal(coordinate.\mbox{\hyperlink{class_f_point_a02208d4db50cbafe597adcbfb152b536}{getZ}}())\ *\ widthAtLeafLevel\ +\ widthAtLeafLevelDiv2\ +\ boxCorner.\mbox{\hyperlink{class_f_point_a02208d4db50cbafe597adcbfb152b536}{getZ}}());}
\DoxyCodeLine{00072\ \ \ \ \ \}}
\DoxyCodeLine{00073\ }
\DoxyCodeLine{00080\ \ \ \ \ \mbox{\hyperlink{class_f_point}{FPoint<FReal>}}\ getCellCenter(\textcolor{keyword}{const}\ \mbox{\hyperlink{class_f_tree_coordinate}{FTreeCoordinate}}\ coordinate,\ \textcolor{keywordtype}{int}\ inLevel)}
\DoxyCodeLine{00081\ \ \ \ \ \{}
\DoxyCodeLine{00082\ }
\DoxyCodeLine{00083\ \ \ \ \ \ \ \ \ \textcolor{comment}{//Set\ the\ boxes\ width\ needed}}
\DoxyCodeLine{00084\ \ \ \ \ \ \ \ \ FReal\ widthAtCurrentLevel\ =\ widthAtLeafLevel*FReal(1\ <<\ (treeHeight-\/(inLevel+1)));}
\DoxyCodeLine{00085\ \ \ \ \ \ \ \ \ FReal\ widthAtCurrentLevelDiv2\ =\ widthAtCurrentLevel/FReal(2);}
\DoxyCodeLine{00086\ }
\DoxyCodeLine{00087\ \ \ \ \ \ \ \ \ \textcolor{comment}{//Get\ the\ coordinate}}
\DoxyCodeLine{00088\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ a\ =\ coordinate.\mbox{\hyperlink{class_f_point_a58d3859160347552d6a4a94fbdf883c3}{getX}}();}
\DoxyCodeLine{00089\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ b\ =\ coordinate.\mbox{\hyperlink{class_f_point_ae4383512b9b8d216775b3fb92325cfc9}{getY}}();}
\DoxyCodeLine{00090\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ c\ =\ coordinate.\mbox{\hyperlink{class_f_point_a02208d4db50cbafe597adcbfb152b536}{getZ}}();}
\DoxyCodeLine{00091\ }
\DoxyCodeLine{00092\ \ \ \ \ \ \ \ \ \textcolor{comment}{//Set\ the\ center\ real\ coordinates\ from\ box\ corner\ and\ widths.}}
\DoxyCodeLine{00093\ \ \ \ \ \ \ \ \ FReal\ X\ =\ boxCorner.\mbox{\hyperlink{class_f_point_a58d3859160347552d6a4a94fbdf883c3}{getX}}()\ +\ FReal(a)*widthAtCurrentLevel\ +\ widthAtCurrentLevelDiv2;}
\DoxyCodeLine{00094\ \ \ \ \ \ \ \ \ FReal\ Y\ =\ boxCorner.\mbox{\hyperlink{class_f_point_ae4383512b9b8d216775b3fb92325cfc9}{getY}}()\ +\ FReal(b)*widthAtCurrentLevel\ +\ widthAtCurrentLevelDiv2;}
\DoxyCodeLine{00095\ \ \ \ \ \ \ \ \ FReal\ Z\ =\ boxCorner.\mbox{\hyperlink{class_f_point_a02208d4db50cbafe597adcbfb152b536}{getZ}}()\ +\ FReal(c)*widthAtCurrentLevel\ +\ widthAtCurrentLevelDiv2;}
\DoxyCodeLine{00096\ }
\DoxyCodeLine{00097\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_f_point}{FPoint<FReal>}}\ cCenter\ =\ \mbox{\hyperlink{class_f_point}{FPoint<FReal>}}(X,Y,Z);}
\DoxyCodeLine{00098\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ cCenter;}
\DoxyCodeLine{00099\ \ \ \ \ \}}
\DoxyCodeLine{00100\ }
\DoxyCodeLine{00101\ }
\DoxyCodeLine{00107\ \ \ \ \ \textcolor{keywordtype}{void}\ incPowers(\textcolor{keywordtype}{int}\ *\ \textcolor{keyword}{const}\ FRestrict\ a,\ \textcolor{keywordtype}{int}\ *\textcolor{keyword}{const}\ FRestrict\ b,\ \textcolor{keywordtype}{int}\ *\textcolor{keyword}{const}\ FRestrict\ c)}
\DoxyCodeLine{00108\ \ \ \ \ \{}
\DoxyCodeLine{00109\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ t\ =\ (*a)+(*b)+(*c);}
\DoxyCodeLine{00110\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(t==0)}
\DoxyCodeLine{00111\ \ \ \ \ \ \ \ \ \{a[0]=1;\}}
\DoxyCodeLine{00112\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\{\ \textcolor{keywordflow}{if}(t==a[0])}
\DoxyCodeLine{00113\ \ \ \ \ \ \ \ \ \ \ \ \ \{a[0]-\/-\/;\ \ b[0]++;\}}
\DoxyCodeLine{00114\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\{\ \textcolor{keywordflow}{if}(t==c[0])}
\DoxyCodeLine{00115\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{a[0]=t+1;\ \ c[0]=0;\}}
\DoxyCodeLine{00116\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\{\ \textcolor{keywordflow}{if}(b[0]!=0)}
\DoxyCodeLine{00117\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{b[0]-\/-\/;\ c[0]++;\}}
\DoxyCodeLine{00118\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\{}
\DoxyCodeLine{00119\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ b[0]=c[0]+1;}
\DoxyCodeLine{00120\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ a[0]-\/-\/;}
\DoxyCodeLine{00121\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ c[0]=0;}
\DoxyCodeLine{00122\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00123\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00124\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00125\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00126\ \ \ \ \ \}}
\DoxyCodeLine{00127\ }
\DoxyCodeLine{00132\ \ \ \ \ \textcolor{keywordtype}{int}\ powerToIdx(\textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ a,\textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ b,\textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ c)}
\DoxyCodeLine{00133\ \ \ \ \ \{}
\DoxyCodeLine{00134\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ t,res,p\ =\ a+b+c;}
\DoxyCodeLine{00135\ \ \ \ \ \ \ \ \ res\ \ =\ p*(p+1)*(p+2)/6;}
\DoxyCodeLine{00136\ \ \ \ \ \ \ \ \ t\ \ \ \ =\ p\ -\/\ a;}
\DoxyCodeLine{00137\ \ \ \ \ \ \ \ \ res\ +=\ t*(t+1)/2+c;}
\DoxyCodeLine{00138\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ res;}
\DoxyCodeLine{00139\ \ \ \ \ \}}
\DoxyCodeLine{00140\ }
\DoxyCodeLine{00141\ \ \ \ \ \textcolor{comment}{/*\ Return\ the\ factorial\ of\ a\ number}}
\DoxyCodeLine{00142\ \textcolor{comment}{\ \ \ */}}
\DoxyCodeLine{00143\ \ \ \ \ FReal\ fact(\textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ a)\{}
\DoxyCodeLine{00144\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(a<0)\ \{}
\DoxyCodeLine{00145\ \ \ \ \ \ \ \ \ \ \ \ \ printf(\textcolor{stringliteral}{"{}fact\ ::\ Error\ factorial\ negative!!\ a=\%d\(\backslash\)n"{}},a);}
\DoxyCodeLine{00146\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ FReal(0);}
\DoxyCodeLine{00147\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00148\ \ \ \ \ \ \ \ \ FReal\ result\ =\ 1;}
\DoxyCodeLine{00149\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ i\ =\ 1\ ;\ i\ <=\ a\ ;\ ++i)\{}
\DoxyCodeLine{00150\ \ \ \ \ \ \ \ \ \ \ \ \ result\ *=\ FReal(i);}
\DoxyCodeLine{00151\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00152\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ result;}
\DoxyCodeLine{00153\ \ \ \ \ \}}
\DoxyCodeLine{00154\ }
\DoxyCodeLine{00155\ \ \ \ \ \textcolor{comment}{/*\ Return\ the\ product\ of\ factorial\ of\ 3\ numbers}}
\DoxyCodeLine{00156\ \textcolor{comment}{\ \ \ */}}
\DoxyCodeLine{00157\ \ \ \ \ FReal\ fact3int(\textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ a,\textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ b,\textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ c)}
\DoxyCodeLine{00158\ \ \ \ \ \{}
\DoxyCodeLine{00159\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ (\ factorials[a]*factorials[b]*\ factorials[c])\ ;}
\DoxyCodeLine{00160\ \ \ \ \ \}}
\DoxyCodeLine{00161\ }
\DoxyCodeLine{00162\ \ \ \ \ \textcolor{comment}{/*\ Return\ the\ combine\ of\ a\ paire\ of\ number}}
\DoxyCodeLine{00163\ \textcolor{comment}{\ \ \ *\ \(\backslash\)f[\ C\string^\{b\}\_\{a\}\ \(\backslash\)f]}}
\DoxyCodeLine{00164\ \textcolor{comment}{\ \ \ */}}
\DoxyCodeLine{00165\ \ \ \ \ FReal\ combin(\textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\&\ a,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\&\ b)\{}
\DoxyCodeLine{00166\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(a<b)\ \ \{printf(\textcolor{stringliteral}{"{}combin\ ::\ Error\ combin\ negative!!\ a=\%d\ b=\%d\(\backslash\)n"{}},a,b);\ exit(-\/1)\ ;\ \ \}}
\DoxyCodeLine{00167\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \ factorials[a]/\ \ (factorials[b]*\ factorials[a-\/b])\ ;}
\DoxyCodeLine{00168\ \ \ \ \ \}}
\DoxyCodeLine{00169\ }
\DoxyCodeLine{00170\ }
\DoxyCodeLine{00178\ \ \ \ \ \textcolor{keywordtype}{void}\ initDerivative(\textcolor{keyword}{const}\ FReal\ \&\ dx\ ,\textcolor{keyword}{const}\ FReal\ \&\ dy\ ,\textcolor{keyword}{const}\ FReal\ \&\ dz\ \ ,\ \ \ FReal\ *\ tab)}
\DoxyCodeLine{00179\ \ \ \ \ \{}
\DoxyCodeLine{00180\ \ \ \ \ \ \ \ \ FReal\ R2\ =\ dx*dx+dy*dy+dz*dz;}
\DoxyCodeLine{00181\ \ \ \ \ \ \ \ \ tab[0]=FReal(1)/\mbox{\hyperlink{struct_f_math_a2494d4d6618d79e61324a0dfa372855f}{FMath::Sqrt}}(R2);}
\DoxyCodeLine{00182\ \ \ \ \ \ \ \ \ FReal\ R3\ =\ tab[0]/(R2);}
\DoxyCodeLine{00183\ \ \ \ \ \ \ \ \ tab[1]=\ -\/dx*R3;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Derivative\ in\ (1,0,0)}}
\DoxyCodeLine{00184\ \ \ \ \ \ \ \ \ tab[2]=\ -\/dy*R3;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Derivative\ in\ (0,1,0)}}
\DoxyCodeLine{00185\ \ \ \ \ \ \ \ \ tab[3]=\ -\/dz*R3;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Derivative\ in\ (0,0,1)}}
\DoxyCodeLine{00186\ \ \ \ \ \ \ \ \ FReal\ R5\ =\ R3/R2;}
\DoxyCodeLine{00187\ \ \ \ \ \ \ \ \ tab[4]\ =\ FReal(3)*dx*dx*R5-\/R3;\ \ \textcolor{comment}{//Derivative\ in\ (2,0,0)}}
\DoxyCodeLine{00188\ \ \ \ \ \ \ \ \ tab[5]\ =\ FReal(3)*dx*dy*R5;\ \ \ \ \ \textcolor{comment}{//Derivative\ in\ (1,1,0)}}
\DoxyCodeLine{00189\ \ \ \ \ \ \ \ \ tab[6]\ =\ FReal(3)*dx*dz*R5;\ \ \ \ \ \textcolor{comment}{//Derivative\ in\ (1,0,1)}}
\DoxyCodeLine{00190\ \ \ \ \ \ \ \ \ tab[7]\ =\ FReal(3)*dy*dy*R5-\/R3;\ \ \textcolor{comment}{//Derivative\ in\ (0,2,0)}}
\DoxyCodeLine{00191\ \ \ \ \ \ \ \ \ tab[8]\ =\ FReal(3)*dy*dz*R5;\ \ \ \ \ \textcolor{comment}{//Derivative\ in\ (0,1,1)}}
\DoxyCodeLine{00192\ \ \ \ \ \ \ \ \ tab[9]\ =\ FReal(3)*dz*dz*R5-\/R3;\ \ \textcolor{comment}{//Derivative\ in\ (0,0,2)}}
\DoxyCodeLine{00193\ \ \ \ \ \}}
\DoxyCodeLine{00194\ }
\DoxyCodeLine{00209\ \ \ \ \ \textcolor{keywordtype}{void}\ computeFullDerivative(\ FReal\ \ dx,\ \ FReal\ \ dy,\ \ FReal\ \ dz,\ \textcolor{comment}{//\ Distance\ from\ distant\ center\ to\ local\ center}}
\DoxyCodeLine{00210\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ FReal\ *\ yetComputed)}
\DoxyCodeLine{00211\ \ \ \ \ \{}
\DoxyCodeLine{00212\ }
\DoxyCodeLine{00213\ \ \ \ \ \ \ \ \ initDerivative(dx,dy,dz,yetComputed);}
\DoxyCodeLine{00214\ \ \ \ \ \ \ \ \ FReal\ dist2\ =\ \ dx*dx+dy*dy+dz*dz;}
\DoxyCodeLine{00215\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ idxTarget;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Index\ of\ current\ yetComputed\ entry}}
\DoxyCodeLine{00216\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ idxSrc1,\ idxSrc2,\ idxSrc3,\ \ \ \ \ \ \textcolor{comment}{//Indexes\ of\ needed\ yetComputed\ entries}}
\DoxyCodeLine{00217\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ idxSrc4,\ idxSrc5,\ idxSrc6;}
\DoxyCodeLine{00218\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ a=0,b=0,c=0;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Powers\ of\ expansions}}
\DoxyCodeLine{00219\ }
\DoxyCodeLine{00220\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(c=3\ ;\ c<=2*P\ ;\ ++c)\{}
\DoxyCodeLine{00221\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Computation\ of\ derivatives\ Psi\_\{0,0,c\}}}
\DoxyCodeLine{00222\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ |x-\/y|\string^2\ *\ Psi\_\{0,0,c\}\ +\ (2*c-\/1)\ *\ dz\ *Psi\_\{0,0,c-\/1\}\ +\ (c-\/1)\string^2\ *\ Psi\_\{0,0,c-\/2\}\ =\ 0}}
\DoxyCodeLine{00223\ \ \ \ \ \ \ \ \ \ \ \ \ idxTarget\ =\ powerToIdx(0,0,c);}
\DoxyCodeLine{00224\ \ \ \ \ \ \ \ \ \ \ \ \ idxSrc1\ =\ powerToIdx(0,0,c-\/1);}
\DoxyCodeLine{00225\ \ \ \ \ \ \ \ \ \ \ \ \ idxSrc2\ =\ powerToIdx(0,0,c-\/2);}
\DoxyCodeLine{00226\ \ \ \ \ \ \ \ \ \ \ \ \ yetComputed[idxTarget]\ =\ -\/(FReal(2*c-\/1)*dz*yetComputed[idxSrc1]\ +\ FReal((c-\/1)*(c-\/1))*yetComputed[idxSrc2])/dist2;}
\DoxyCodeLine{00227\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00228\ \ \ \ \ \ \ \ \ b=1;}
\DoxyCodeLine{00229\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(c=2\ ;\ c<=2*P-\/1\ ;\ ++c)\{}
\DoxyCodeLine{00230\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Computation\ of\ derivatives\ Psi\_\{0,1,c\}}}
\DoxyCodeLine{00231\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ |x-\/y|\string^2\ *\ Psi\_\{0,1,c\}\ +\ (2*c)\ *\ dz\ *Psi\_\{0,1,c-\/1\}\ +\ c*(c-\/1)\ *\ Psi\_\{0,1,c-\/2\}\ +\ dy*Psi\_\{0,0,c\}\ =\ 0}}
\DoxyCodeLine{00232\ \ \ \ \ \ \ \ \ \ \ \ \ idxTarget\ =\ powerToIdx(0,1,c);}
\DoxyCodeLine{00233\ \ \ \ \ \ \ \ \ \ \ \ \ idxSrc1\ =\ powerToIdx(0,1,c-\/1);}
\DoxyCodeLine{00234\ \ \ \ \ \ \ \ \ \ \ \ \ idxSrc2\ =\ powerToIdx(0,1,c-\/2);}
\DoxyCodeLine{00235\ \ \ \ \ \ \ \ \ \ \ \ \ idxSrc3\ =\ powerToIdx(0,0,c);}
\DoxyCodeLine{00236\ \ \ \ \ \ \ \ \ \ \ \ \ yetComputed[idxTarget]\ =\ -\/(FReal(2*c)*dz*yetComputed[idxSrc1]\ +\ FReal(c*(c-\/1))*yetComputed[idxSrc2]+\ dy*yetComputed[idxSrc3])/dist2;}
\DoxyCodeLine{00237\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00238\ \ \ \ \ \ \ \ \ b=2;}
\DoxyCodeLine{00239\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(c=1\ ;\ c<=\ 2*P-\/b\ ;\ ++c)\{}
\DoxyCodeLine{00240\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Computation\ of\ derivatives\ Psi\_\{0,2,c\}}}
\DoxyCodeLine{00241\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//|x-\/y|\string^2\ *\ Psi\_\{0,2,c\}\ +\ (2*c)\ *\ dz\ *Psi\_\{0,2,c-\/1\}\ +\ (c*(c-\/1))\ *\ Psi\_\{0,2,c-\/2\}\ +\ 3*dy\ *\ Psi\_\{0,1,c\}\ +\ Psi\_\{0,0,c\}\ \ =\ 0}}
\DoxyCodeLine{00242\ \ \ \ \ \ \ \ \ \ \ \ \ idxTarget\ =\ powerToIdx(0,2,c);}
\DoxyCodeLine{00243\ \ \ \ \ \ \ \ \ \ \ \ \ idxSrc1\ =\ powerToIdx(0,2,c-\/1);}
\DoxyCodeLine{00244\ \ \ \ \ \ \ \ \ \ \ \ \ idxSrc2\ =\ powerToIdx(0,2,c-\/2);}
\DoxyCodeLine{00245\ \ \ \ \ \ \ \ \ \ \ \ \ idxSrc3\ =\ powerToIdx(0,1,c);}
\DoxyCodeLine{00246\ \ \ \ \ \ \ \ \ \ \ \ \ idxSrc4\ =\ powerToIdx(0,0,c);}
\DoxyCodeLine{00247\ \ \ \ \ \ \ \ \ \ \ \ \ yetComputed[idxTarget]\ =\ -\/(FReal(2*c)*dz*yetComputed[idxSrc1]\ +\ FReal(c*(c-\/1))*yetComputed[idxSrc2]}
\DoxyCodeLine{00248\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ +\ FReal(3)*dy*yetComputed[idxSrc3]\ +\ yetComputed[idxSrc4])/dist2;}
\DoxyCodeLine{00249\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00250\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(b=3\ ;\ b<=\ 2*P\ ;\ ++b)\{}
\DoxyCodeLine{00251\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Computation\ of\ derivatives\ Psi\_\{0,b,0\}}}
\DoxyCodeLine{00252\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ |x-\/y|\string^2\ *\ Psi\_\{0,b,0\}\ +\ (2*b-\/1)\ *\ dy\ *Psi\_\{0,b-\/1,0\}\ +\ (b-\/1)\string^2\ *\ Psi\_\{0,b-\/2,c\}\ =\ 0}}
\DoxyCodeLine{00253\ \ \ \ \ \ \ \ \ \ \ \ \ idxTarget\ =\ powerToIdx(0,b,0);}
\DoxyCodeLine{00254\ \ \ \ \ \ \ \ \ \ \ \ \ idxSrc1\ =\ powerToIdx(0,b-\/1,0);}
\DoxyCodeLine{00255\ \ \ \ \ \ \ \ \ \ \ \ \ idxSrc2\ =\ powerToIdx(0,b-\/2,0);}
\DoxyCodeLine{00256\ \ \ \ \ \ \ \ \ \ \ \ \ yetComputed[idxTarget]\ =\ -\/(FReal(2*b-\/1)*dy*yetComputed[idxSrc1]\ +\ FReal((b-\/1)*(b-\/1))*yetComputed[idxSrc2])/dist2;}
\DoxyCodeLine{00257\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(c=1\ ;\ c<=\ 2*P-\/b\ ;\ ++c)\ \{}
\DoxyCodeLine{00258\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Computation\ of\ derivatives\ Psi\_\{0,b,c\}}}
\DoxyCodeLine{00259\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//|x-\/y|\string^2*Psi\_\{0,b,c\}\ +\ (2*c)*dz*Psi\_\{0,b,c-\/1\}\ +\ (c*(c-\/1))*Psi\_\{0,b,c-\/2\}\ +\ (2*b-\/1)*dy*Psi\_\{0,b-\/1,c\}\ +\ (b-\/1)\string^2\ *\ Psi\_\{0,b-\/2,c\}\ \ =\ 0}}
\DoxyCodeLine{00260\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ idxTarget\ =\ powerToIdx(0,b,c);}
\DoxyCodeLine{00261\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ idxSrc1\ =\ powerToIdx(0,b,c-\/1);}
\DoxyCodeLine{00262\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ idxSrc2\ =\ powerToIdx(0,b,c-\/2);}
\DoxyCodeLine{00263\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ idxSrc3\ =\ powerToIdx(0,b-\/1,c);}
\DoxyCodeLine{00264\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ idxSrc4\ =\ powerToIdx(0,b-\/2,c);}
\DoxyCodeLine{00265\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ yetComputed[idxTarget]\ =\ -\/(FReal(2*c)*dz*yetComputed[idxSrc1]\ +\ FReal(c*(c-\/1))*yetComputed[idxSrc2]}
\DoxyCodeLine{00266\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ +\ FReal(2*b-\/1)*dy*yetComputed[idxSrc3]\ +\ FReal((b-\/1)*(b-\/1))*yetComputed[idxSrc4])/dist2;}
\DoxyCodeLine{00267\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00268\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00269\ \ \ \ \ \ \ \ \ a=1;}
\DoxyCodeLine{00270\ \ \ \ \ \ \ \ \ b=0;}
\DoxyCodeLine{00271\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(c=2\ ;\ c<=\ 2*P-\/1\ ;\ ++c)\{}
\DoxyCodeLine{00272\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Computation\ of\ derivatives\ Psi\_\{1,0,c\}}}
\DoxyCodeLine{00273\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//|x-\/y|\string^2\ *\ Psi\_\{1,0,c\}\ +\ (2*c)*dz*Psi\_\{1,0,c-\/1\}\ +\ c*(c-\/1)*Psi\_\{1,0,c-\/2\}\ +\ dx*Psi\_\{0,0,c\}}}
\DoxyCodeLine{00274\ \ \ \ \ \ \ \ \ \ \ \ \ idxTarget\ =\ powerToIdx(1,0,c);}
\DoxyCodeLine{00275\ \ \ \ \ \ \ \ \ \ \ \ \ idxSrc1\ =\ powerToIdx(1,0,c-\/1);}
\DoxyCodeLine{00276\ \ \ \ \ \ \ \ \ \ \ \ \ idxSrc2\ =\ powerToIdx(1,0,c-\/2);}
\DoxyCodeLine{00277\ \ \ \ \ \ \ \ \ \ \ \ \ idxSrc3\ =\ powerToIdx(0,0,c);}
\DoxyCodeLine{00278\ \ \ \ \ \ \ \ \ \ \ \ \ yetComputed[idxTarget]\ =\ -\/(FReal(2*c)*dz*yetComputed[idxSrc1]\ +\ FReal(c*(c-\/1))*yetComputed[idxSrc2]\ +\ dx*yetComputed[idxSrc3])/dist2;}
\DoxyCodeLine{00279\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00280\ \ \ \ \ \ \ \ \ b=1;}
\DoxyCodeLine{00281\ \ \ \ \ \ \ \ \ \textcolor{comment}{//Computation\ of\ derivatives\ Psi\_\{1,1,1\}}}
\DoxyCodeLine{00282\ \ \ \ \ \ \ \ \ \textcolor{comment}{//|x-\/y|\string^2\ *\ Psi\_\{1,1,1\}\ +\ 2*dz*Psi\_\{1,1,0\}\ +\ 2*dy*Psi\_\{1,0,1\}\ +\ dx*Psi\_\{0,1,1\}}}
\DoxyCodeLine{00283\ \ \ \ \ \ \ \ \ idxTarget\ =\ powerToIdx(1,1,1);}
\DoxyCodeLine{00284\ \ \ \ \ \ \ \ \ idxSrc1\ =\ powerToIdx(1,1,0);}
\DoxyCodeLine{00285\ \ \ \ \ \ \ \ \ idxSrc2\ =\ powerToIdx(1,0,1);}
\DoxyCodeLine{00286\ \ \ \ \ \ \ \ \ idxSrc3\ =\ powerToIdx(0,1,1);}
\DoxyCodeLine{00287\ \ \ \ \ \ \ \ \ yetComputed[idxTarget]\ =\ -\/(FReal(2)*dz*yetComputed[idxSrc1]\ +\ FReal(2)*dy*yetComputed[idxSrc2]\ +\ dx*yetComputed[idxSrc3])/dist2;}
\DoxyCodeLine{00288\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(c=2\ ;\ c<=\ 2*P-\/2\ ;\ ++c)\{}
\DoxyCodeLine{00289\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Computation\ of\ derivatives\ Psi\_\{1,1,c\}}}
\DoxyCodeLine{00290\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//|x-\/y|\string^2\ *\ Psi\_\{1,1,c\}\ +\ (2*c)*dz*Psi\_\{1,1,c-\/1\}\ +\ c*(c-\/1)*Psi\_\{1,1,c-\/2\}\ +\ 2*dy*Psi\_\{1,0,c\}\ +\ dx*Psi\_\{0,1,c\}}}
\DoxyCodeLine{00291\ \ \ \ \ \ \ \ \ \ \ \ \ idxTarget\ =\ powerToIdx(1,1,c);}
\DoxyCodeLine{00292\ \ \ \ \ \ \ \ \ \ \ \ \ idxSrc1\ =\ powerToIdx(1,1,c-\/1);}
\DoxyCodeLine{00293\ \ \ \ \ \ \ \ \ \ \ \ \ idxSrc2\ =\ powerToIdx(1,1,c-\/2);}
\DoxyCodeLine{00294\ \ \ \ \ \ \ \ \ \ \ \ \ idxSrc3\ =\ powerToIdx(1,0,c);}
\DoxyCodeLine{00295\ \ \ \ \ \ \ \ \ \ \ \ \ idxSrc4\ =\ powerToIdx(0,1,c);}
\DoxyCodeLine{00296\ \ \ \ \ \ \ \ \ \ \ \ \ yetComputed[idxTarget]\ =\ -\/(FReal(2*c)*dz*yetComputed[idxSrc1]\ +\ FReal(c*(c-\/1))*yetComputed[idxSrc2]}
\DoxyCodeLine{00297\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ +\ FReal(2)*dy*yetComputed[idxSrc3]+\ dx*yetComputed[idxSrc4])/dist2;}
\DoxyCodeLine{00298\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00299\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(b=2\ ;\ b<=\ 2*P-\/a\ ;\ ++b)\{}
\DoxyCodeLine{00300\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(c=0\ ;\ c<=\ 2*P-\/b-\/1\ ;\ ++c)\{}
\DoxyCodeLine{00301\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Computation\ of\ derivatives\ Psi\_\{1,b,c\}}}
\DoxyCodeLine{00302\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//|x-\/y|\string^2\ *\ Psi\_\{1,b,c\}\ +\ (2*b)*dy*Psi\_\{1,b-\/1,c\}\ +\ b*(b-\/1)*Psi\_\{1,b-\/2,c\}\ +\ (2*c)*dz*Psi\_\{1,b,c-\/1\}\ +\ c*(c-\/1)*Psi\_\{1,b,c-\/2\}\ +\ dx*Psi\_\{0,b,c\}}}
\DoxyCodeLine{00303\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ idxTarget\ =\ powerToIdx(1,b,c);}
\DoxyCodeLine{00304\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ idxSrc1\ =\ powerToIdx(1,b-\/1,c);}
\DoxyCodeLine{00305\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ idxSrc2\ =\ powerToIdx(1,b-\/2,c);}
\DoxyCodeLine{00306\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ idxSrc3\ =\ powerToIdx(1,b,c-\/1);}
\DoxyCodeLine{00307\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ idxSrc4\ =\ powerToIdx(1,b,c-\/2);}
\DoxyCodeLine{00308\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ idxSrc5\ =\ powerToIdx(0,b,c);}
\DoxyCodeLine{00309\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ yetComputed[idxTarget]\ =\ -\/(FReal(2*b)*dy*yetComputed[idxSrc1]\ +\ FReal(b*(b-\/1))*yetComputed[idxSrc2]}
\DoxyCodeLine{00310\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ +\ FReal(2*c)*dz*yetComputed[idxSrc3]+\ FReal(c*(c-\/1))*yetComputed[idxSrc4]}
\DoxyCodeLine{00311\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ +\ dx*yetComputed[idxSrc5])/dist2;}
\DoxyCodeLine{00312\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00313\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00314\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(a=2\ ;\ a<=2*P\ ;\ ++a)\{}
\DoxyCodeLine{00315\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Computation\ of\ derivatives\ Psi\_\{a,0,0\}}}
\DoxyCodeLine{00316\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ |x-\/y|\string^2\ *\ Psi\_\{a,0,0\}\ +\ (2*a-\/1)\ *\ dx\ *Psi\_\{a-\/1,0,0\}\ +\ (a-\/1)\string^2\ *\ Psi\_\{a-\/2,0,0\}\ =\ 0}}
\DoxyCodeLine{00317\ \ \ \ \ \ \ \ \ \ \ \ \ idxTarget\ =\ powerToIdx(a,0,0);}
\DoxyCodeLine{00318\ \ \ \ \ \ \ \ \ \ \ \ \ idxSrc1\ =\ powerToIdx(a-\/1,0,0);}
\DoxyCodeLine{00319\ \ \ \ \ \ \ \ \ \ \ \ \ idxSrc2\ =\ powerToIdx(a-\/2,0,0);}
\DoxyCodeLine{00320\ \ \ \ \ \ \ \ \ \ \ \ \ yetComputed[idxTarget]\ =\ -\/(FReal(2*a-\/1)*dx*yetComputed[idxSrc1]\ +\ FReal((a-\/1)*(a-\/1))*yetComputed[idxSrc2])/dist2;}
\DoxyCodeLine{00321\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(a\ <=\ 2*P-\/1)\{}
\DoxyCodeLine{00322\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Computation\ of\ derivatives\ Psi\_\{a,0,1\}}}
\DoxyCodeLine{00323\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ |x-\/y|\string^2\ *\ Psi\_\{a,0,1\}\ +\ 2*dz*Psi\_\{a,0,0\}\ +\ (2*a-\/1)*dx*Psi\_\{a-\/1,0,1\}\ +\ (a-\/1)\string^2*Psi\_\{a-\/2,0,1\}\ =\ 0}}
\DoxyCodeLine{00324\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ idxSrc1\ =\ idxTarget;}
\DoxyCodeLine{00325\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ idxTarget\ =\ powerToIdx(a,0,1);}
\DoxyCodeLine{00326\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ idxSrc2\ =\ powerToIdx(a-\/1,0,1);}
\DoxyCodeLine{00327\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ idxSrc3\ =\ powerToIdx(a-\/2,0,1);}
\DoxyCodeLine{00328\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ yetComputed[idxTarget]\ =\ -\/(FReal(2)*dz*yetComputed[idxSrc1]\ +\ FReal(2*a-\/1)*dx*yetComputed[idxSrc2]\ +\ FReal((a-\/1)*(a-\/1))*yetComputed[idxSrc3])/dist2;}
\DoxyCodeLine{00329\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Computation\ of\ derivatives\ Psi\_\{a,1,0\}}}
\DoxyCodeLine{00330\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ |x-\/y|\string^2\ *\ Psi\_\{a,1,0\}\ +\ 2*dy*Psi\_\{a,0,0\}\ +\ (2*a-\/1)*dx*Psi\_\{a-\/1,1,0\}\ +\ (a-\/1)\string^2*Psi\_\{a-\/2,1,0\}\ =\ 0}}
\DoxyCodeLine{00331\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ idxTarget\ =\ powerToIdx(a,1,0);}
\DoxyCodeLine{00332\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ idxSrc2\ =\ powerToIdx(a-\/1,1,0);}
\DoxyCodeLine{00333\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ idxSrc3\ =\ powerToIdx(a-\/2,1,0);}
\DoxyCodeLine{00334\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ yetComputed[idxTarget]\ =\ -\/(FReal(2)*dy*yetComputed[idxSrc1]\ +\ FReal(2*a-\/1)*dx*yetComputed[idxSrc2]\ +\ FReal((a-\/1)*(a-\/1))*yetComputed[idxSrc3])/dist2;}
\DoxyCodeLine{00335\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(a\ <=\ 2*P-\/2)\{}
\DoxyCodeLine{00336\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ b=0;}
\DoxyCodeLine{00337\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(c=2\ ;\ c\ <=\ 2*P-\/a\ ;\ ++c)\{}
\DoxyCodeLine{00338\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Computation\ of\ derivatives\ Psi\_\{a,0,c\}}}
\DoxyCodeLine{00339\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ |x-\/y|\string^2\ *\ Psi\_\{a,0,c\}\ +\ 2*c*dz*Psi\_\{a,0,c-\/1\}\ +\ c*(c-\/1)*Psi\_\{a,0,c-\/2\}\ +\ (2*a-\/1)*dx*Psi\_\{a-\/1,0,c\}\ +\ (a-\/1)\string^2*Psi\_\{a-\/2,0,c\}\ =\ 0}}
\DoxyCodeLine{00340\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ idxTarget\ =\ powerToIdx(a,0,c);}
\DoxyCodeLine{00341\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ idxSrc1\ =\ powerToIdx(a,0,c-\/1);}
\DoxyCodeLine{00342\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ idxSrc2\ =\ powerToIdx(a,0,c-\/2);}
\DoxyCodeLine{00343\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ idxSrc3\ =\ powerToIdx(a-\/1,0,c);}
\DoxyCodeLine{00344\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ idxSrc4\ =\ powerToIdx(a-\/2,0,c);}
\DoxyCodeLine{00345\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ yetComputed[idxTarget]\ =\ -\/(FReal(2*c)*dz*yetComputed[idxSrc1]\ +\ FReal(c*(c-\/1))*yetComputed[idxSrc2]}
\DoxyCodeLine{00346\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ +\ FReal(2*a-\/1)*dx*yetComputed[idxSrc3]\ +\ FReal((a-\/1)*(a-\/1))*yetComputed[idxSrc4])/dist2;}
\DoxyCodeLine{00347\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00348\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ b=1;}
\DoxyCodeLine{00349\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(c=1\ ;\ c\ <=\ 2*P-\/a-\/1\ ;\ ++c)\{}
\DoxyCodeLine{00350\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Computation\ of\ derivatives\ Psi\_\{a,1,c\}}}
\DoxyCodeLine{00351\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ |x-\/y|\string^2\ *\ Psi\_\{a,1,c\}\ +\ 2*c*dz*Psi\_\{a,1,c-\/1\}\ +\ c*(c-\/1)*Psi\_\{a,1,c-\/2\}\ +\ 2*a*dx*Psi\_\{a-\/1,1,c\}\ +\ a*(a-\/1)*Psi\_\{a-\/2,1,c\}\ +\ dy*Psi\_\{a,0,c\}=\ 0}}
\DoxyCodeLine{00352\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ idxTarget\ =\ powerToIdx(a,1,c);}
\DoxyCodeLine{00353\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ idxSrc1\ =\ powerToIdx(a,1,c-\/1);}
\DoxyCodeLine{00354\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ idxSrc2\ =\ powerToIdx(a,1,c-\/2);}
\DoxyCodeLine{00355\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ idxSrc3\ =\ powerToIdx(a-\/1,1,c);}
\DoxyCodeLine{00356\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ idxSrc4\ =\ powerToIdx(a-\/2,1,c);}
\DoxyCodeLine{00357\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ idxSrc5\ =\ powerToIdx(a,0,c);}
\DoxyCodeLine{00358\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ yetComputed[idxTarget]\ =\ -\/(FReal(2*c)*dz*yetComputed[idxSrc1]\ +\ FReal(c*(c-\/1))*yetComputed[idxSrc2]}
\DoxyCodeLine{00359\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ +\ FReal(2*a)*dx*yetComputed[idxSrc3]\ +\ FReal(a*(a-\/1))*yetComputed[idxSrc4]}
\DoxyCodeLine{00360\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ +\ dy*yetComputed[idxSrc5])/dist2;}
\DoxyCodeLine{00361\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00362\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(b=2\ ;\ b\ <=\ 2*P-\/a\ ;\ ++b)\{}
\DoxyCodeLine{00363\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Computation\ of\ derivatives\ Psi\_\{a,b,0\}}}
\DoxyCodeLine{00364\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ |x-\/y|\string^2\ *\ Psi\_\{a,b,0\}\ +\ 2*b*dy*Psi\_\{a,b-\/1,0\}\ +\ b*(b-\/1)*Psi\_\{a,b-\/2,0\}\ +\ (2*a-\/1)*dx*Psi\_\{a-\/1,b,0\}\ +\ (a-\/1)\string^2*Psi\_\{a-\/2,b,0\}\ =\ 0}}
\DoxyCodeLine{00365\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ idxTarget\ =\ powerToIdx(a,b,0);}
\DoxyCodeLine{00366\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ idxSrc1\ =\ powerToIdx(a,b-\/1,0);}
\DoxyCodeLine{00367\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ idxSrc2\ =\ powerToIdx(a,b-\/2,0);}
\DoxyCodeLine{00368\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ idxSrc3\ =\ powerToIdx(a-\/1,b,0);}
\DoxyCodeLine{00369\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ idxSrc4\ =\ powerToIdx(a-\/2,b,0);}
\DoxyCodeLine{00370\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ yetComputed[idxTarget]\ =\ -\/(FReal(2*b)*dy*yetComputed[idxSrc1]\ +\ FReal(b*(b-\/1))*yetComputed[idxSrc2]}
\DoxyCodeLine{00371\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ +\ FReal(2*a-\/1)*dx*yetComputed[idxSrc3]\ +\ FReal((a-\/1)*(a-\/1))*yetComputed[idxSrc4])/dist2;}
\DoxyCodeLine{00372\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(a+b\ <\ 2*P)\{}
\DoxyCodeLine{00373\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Computation\ of\ derivatives\ Psi\_\{a,b,1\}}}
\DoxyCodeLine{00374\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ |x-\/y|\string^2\ *\ Psi\_\{a,b,1\}\ +\ 2*b*dy*Psi\_\{a,b-\/1,1\}\ +\ b*(b-\/1)*Psi\_\{a,b-\/2,1\}\ +\ 2*a*dx*Psi\_\{a-\/1,b,1\}\ +\ a*(a-\/1)*Psi\_\{a-\/2,b,1\}\ +\ dz*Psi\_\{a,b,0\}=\ 0}}
\DoxyCodeLine{00375\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ idxTarget\ =\ powerToIdx(a,b,1);}
\DoxyCodeLine{00376\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ idxSrc1\ =\ powerToIdx(a,b-\/1,1);}
\DoxyCodeLine{00377\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ idxSrc2\ =\ powerToIdx(a,b-\/2,1);}
\DoxyCodeLine{00378\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ idxSrc3\ =\ powerToIdx(a-\/1,b,1);}
\DoxyCodeLine{00379\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ idxSrc4\ =\ powerToIdx(a-\/2,b,1);}
\DoxyCodeLine{00380\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ idxSrc5\ =\ powerToIdx(a,b,0);}
\DoxyCodeLine{00381\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ yetComputed[idxTarget]\ =\ -\/(FReal(2*b)*dy*yetComputed[idxSrc1]\ +\ FReal(b*(b-\/1))*yetComputed[idxSrc2]}
\DoxyCodeLine{00382\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ +\ FReal(2*a)*dx*yetComputed[idxSrc3]\ +\ FReal(a*(a-\/1))*yetComputed[idxSrc4]}
\DoxyCodeLine{00383\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ +\ dz*yetComputed[idxSrc5])/dist2;}
\DoxyCodeLine{00384\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00385\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(c=2\ ;\ c\ <=\ 2*P-\/b-\/a\ ;\ ++c)\{}
\DoxyCodeLine{00386\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Computation\ of\ derivatives\ Psi\_\{a,b,c\}\ with\ a\ >=\ 2}}
\DoxyCodeLine{00387\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ |x-\/y|\string^2*Psi\_\{a,b,c\}\ +\ (2*a-\/1)*dx*Psi\_\{a-\/1,b,c\}\ +\ a*(a-\/2)*Psi\_\{a-\/2,b,c\}\ +\ 2*b*dy*Psi\_\{a,b-\/1,c\}\ +\ b*(b-\/1)*Psi\_\{a,b-\/2,c\}}}
\DoxyCodeLine{00388\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ +\ 2*c*dz*Psi\_\{a,b,c-\/1\}\}\ =\ 0}}
\DoxyCodeLine{00389\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ idxTarget\ =\ powerToIdx(a,b,c);}
\DoxyCodeLine{00390\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ idxSrc1\ =\ powerToIdx(a-\/1,b,c);}
\DoxyCodeLine{00391\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ idxSrc2\ =\ powerToIdx(a,b-\/1,c);}
\DoxyCodeLine{00392\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ idxSrc3\ =\ powerToIdx(a,b,c-\/1);}
\DoxyCodeLine{00393\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ idxSrc4\ =\ powerToIdx(a-\/2,b,c);}
\DoxyCodeLine{00394\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ idxSrc5\ =\ powerToIdx(a,b-\/2,c);}
\DoxyCodeLine{00395\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ idxSrc6\ =\ powerToIdx(a,b,c-\/2);}
\DoxyCodeLine{00396\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ yetComputed[idxTarget]\ =\ -\/(FReal(2*a-\/1)*dx*yetComputed[idxSrc1]\ +\ FReal((a-\/1)*(a-\/1))*yetComputed[idxSrc4]}
\DoxyCodeLine{00397\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ +\ FReal(2*b)*dy*yetComputed[idxSrc2]\ +\ FReal(b*(b-\/1))*yetComputed[idxSrc5]}
\DoxyCodeLine{00398\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ +\ FReal(2*c)*dz*yetComputed[idxSrc3]\ +\ FReal(c*(c-\/1))*yetComputed[idxSrc6])/dist2;}
\DoxyCodeLine{00399\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00400\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00401\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00402\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00403\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00404\ \ \ \ \ \}}
\DoxyCodeLine{00405\ }
\DoxyCodeLine{00406\ }
\DoxyCodeLine{00410\ }
\DoxyCodeLine{00411\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00412\ }
\DoxyCodeLine{00413\ \ \ \ \ \textcolor{comment}{/*Constructor,\ need\ system\ information*/}}
\DoxyCodeLine{00414\ \ \ \ \ \mbox{\hyperlink{class_f_taylor_kernel}{FTaylorKernel}}(\textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ inTreeHeight,\ \textcolor{keyword}{const}\ FReal\ inBoxWidth,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_f_point}{FPoint<FReal>}}\&\ inBoxCenter)\ :}
\DoxyCodeLine{00415\ \ \ \ \ \ \ \ \ boxWidth(inBoxWidth),}
\DoxyCodeLine{00416\ \ \ \ \ \ \ \ \ treeHeight(inTreeHeight),}
\DoxyCodeLine{00417\ \ \ \ \ \ \ \ \ widthAtLeafLevel(inBoxWidth/FReal(1\ <<\ (inTreeHeight-\/1))),}
\DoxyCodeLine{00418\ \ \ \ \ \ \ \ \ widthAtLeafLevelDiv2(widthAtLeafLevel/2),}
\DoxyCodeLine{00419\ \ \ \ \ \ \ \ \ boxCorner(inBoxCenter.getX()-\/(inBoxWidth/2),inBoxCenter.getY()-\/(inBoxWidth/2),inBoxCenter.getZ()-\/(inBoxWidth/2))}
\DoxyCodeLine{00420\ \ \ \ \ \{}
\DoxyCodeLine{00421\ \ \ \ \ \ \ \ \ FReal\ facto;}
\DoxyCodeLine{00422\ \ \ \ \ \ \ \ \ this-\/>precomputeFactorials()\ ;}
\DoxyCodeLine{00423\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ i=0,\ a\ =\ 0,\ b\ =\ 0,\ c\ =\ 0;\ i<SizeVector\ ;\ ++i)}
\DoxyCodeLine{00424\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00425\ \ \ \ \ \ \ \ \ \ \ \ \ facto\ =\ \textcolor{keyword}{static\_cast<}FReal\textcolor{keyword}{>}(fact3int(a,b,c));}
\DoxyCodeLine{00426\ \ \ \ \ \ \ \ \ \ \ \ \ \_coeffPoly[i]\ =\ FReal(1.0)/(facto);}
\DoxyCodeLine{00427\ \textcolor{preprocessor}{\#ifdef\ OC}}
\DoxyCodeLine{00428\ \ \ \ \ \ \ \ \ \ \ \ \ \_coeffPoly[i]\ =\ \textcolor{keyword}{static\_cast<}FReal\textcolor{keyword}{>}(factorials[a+b+c])/(facto*facto);}
\DoxyCodeLine{00429\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00430\ \ \ \ \ \ \ \ \ \ \ \ \ this-\/>incPowers(\&a,\&b,\&c);\ \ \ \ \ \ \ \textcolor{comment}{//inc\ powers\ of\ expansion}}
\DoxyCodeLine{00431\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00432\ \ \ \ \ \}}
\DoxyCodeLine{00433\ }
\DoxyCodeLine{00434\ \ \ \ \ \textcolor{comment}{/*\ Default\ destructor}}
\DoxyCodeLine{00435\ \textcolor{comment}{\ \ \ */}}
\DoxyCodeLine{00436\ \ \ \ \ \textcolor{keyword}{virtual}\ \mbox{\hyperlink{class_f_taylor_kernel}{\string~FTaylorKernel}}()\{}
\DoxyCodeLine{00437\ }
\DoxyCodeLine{00438\ \ \ \ \ \}}
\DoxyCodeLine{00439\ }
\DoxyCodeLine{00450\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_f_taylor_kernel_ad504e923e718ebd25dd83f11d7a99b33}{P2M}}(CellClass*\ \textcolor{keyword}{const}\ pole,}
\DoxyCodeLine{00451\ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ ContainerClass*\ \textcolor{keyword}{const}\ particles)\textcolor{keyword}{\ override}}
\DoxyCodeLine{00452\ \textcolor{keyword}{\ \ \ \ }\{}
\DoxyCodeLine{00453\ \ \ \ \ \ \ \ \ \textcolor{comment}{//Copying\ cell\ center\ position\ once\ and\ for\ all}}
\DoxyCodeLine{00454\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_f_point}{FPoint<FReal>}}\&\ cellCenter\ =\ getLeafCenter(pole-\/>getCoordinate());}
\DoxyCodeLine{00455\ \ \ \ \ \ \ \ \ FReal\ *\ FRestrict\ multipole\ =\ pole-\/>getMultipole();}
\DoxyCodeLine{00456\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespace_f_mem_utils_a005b2bd1925d50a688606ed5877c5aec}{FMemUtils::memset}}(multipole,0,SizeVector*\textcolor{keyword}{sizeof}(FReal(0.0)));}
\DoxyCodeLine{00457\ \ \ \ \ \ \ \ \ FReal\ multipole2[SizeVector]\ ;}
\DoxyCodeLine{00458\ }
\DoxyCodeLine{00459\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Iterator\ over\ Particles}}
\DoxyCodeLine{00460\ \ \ \ \ \ \ \ \ FSize\ nbPart\ =\ particles-\/>getNbParticles(),\ i;}
\DoxyCodeLine{00461\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ FReal*\ \textcolor{keyword}{const}\ *\ positions\ =\ particles-\/>getPositions();}
\DoxyCodeLine{00462\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ FReal*\ posX\ =\ positions[0];}
\DoxyCodeLine{00463\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ FReal*\ posY\ =\ positions[1];}
\DoxyCodeLine{00464\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ FReal*\ posZ\ =\ positions[2];}
\DoxyCodeLine{00465\ }
\DoxyCodeLine{00466\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ FReal*\ phyValue\ =\ particles-\/>getPhysicalValues();}
\DoxyCodeLine{00467\ }
\DoxyCodeLine{00468\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Iterating\ over\ Particles}}
\DoxyCodeLine{00469\ \ \ \ \ \ \ \ \ FReal\ xc\ =\ cellCenter.\mbox{\hyperlink{class_f_point_a58d3859160347552d6a4a94fbdf883c3}{getX}}(),\ yc\ =\ cellCenter.\mbox{\hyperlink{class_f_point_ae4383512b9b8d216775b3fb92325cfc9}{getY}}(),\ zc\ =\ cellCenter.\mbox{\hyperlink{class_f_point_a02208d4db50cbafe597adcbfb152b536}{getZ}}()\ ;}
\DoxyCodeLine{00470\ \ \ \ \ \ \ \ \ FReal\ dx[3]\ ;}
\DoxyCodeLine{00471\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(FSize\ idPart=0\ ;\ idPart<nbPart\ ;\ ++idPart)\{}
\DoxyCodeLine{00472\ \ \ \ \ \ \ \ \ \ \ \ \ dx[0]\ \ \ \ \ \ \ \ \ =\ xc\ -\/\ posX[idPart]\ ;}
\DoxyCodeLine{00473\ \ \ \ \ \ \ \ \ \ \ \ \ dx[1]\ \ \ \ \ \ \ \ \ =\ yc\ -\/\ posY[idPart]\ ;}
\DoxyCodeLine{00474\ \ \ \ \ \ \ \ \ \ \ \ \ dx[2]\ \ \ \ \ \ \ \ \ =\ zc\ -\/\ posZ[idPart]\ ;}
\DoxyCodeLine{00475\ \ \ \ \ \ \ \ \ \ \ \ \ multipole2[0]\ =\ phyValue[idPart]\ \ ;}
\DoxyCodeLine{00476\ }
\DoxyCodeLine{00477\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ leading[3]\ =\ \{0,0,0\ \}\ ;}
\DoxyCodeLine{00478\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ k=1,\ t=1,\ tail=1;\ k\ <=\ P;\ ++k,\ tail=t)}
\DoxyCodeLine{00479\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00480\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (i\ =\ 0;\ i\ <\ 3;\ ++i)}
\DoxyCodeLine{00481\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00482\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ head\ =\ leading[i];}
\DoxyCodeLine{00483\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ leading[i]\ =\ t;}
\DoxyCodeLine{00484\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\ \textcolor{keywordtype}{int}\ j\ =\ head;\ j\ <\ tail;\ ++j,\ ++t)}
\DoxyCodeLine{00485\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00486\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ multipole2[t]\ =\ multipole2[j]\ *dx[i]\ ;}
\DoxyCodeLine{00487\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00488\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}\ \textcolor{comment}{//\ for\ i}}
\DoxyCodeLine{00489\ \ \ \ \ \ \ \ \ \ \ \ \ \}\textcolor{comment}{//\ for\ k}}
\DoxyCodeLine{00490\ }
\DoxyCodeLine{00491\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//is\ that\ a\ possible\ saxpy\ ?}}
\DoxyCodeLine{00492\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\ i=0\ ;\ i\ <\ SizeVector\ ;\ ++i)}
\DoxyCodeLine{00493\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00494\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ multipole[i]\ +=\ \ multipole2[i]\ ;}
\DoxyCodeLine{00495\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ multipole2[i]\ =\ 0.0;}
\DoxyCodeLine{00496\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00497\ \ \ \ \ \ \ \ \ \}\ \ \textcolor{comment}{//\ end\ loop\ on\ particles}}
\DoxyCodeLine{00498\ }
\DoxyCodeLine{00499\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Multiply\ by\ the\ coefficient}}
\DoxyCodeLine{00500\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\ i=0\ ;\ i\ <\ SizeVector\ ;\ ++i)}
\DoxyCodeLine{00501\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00502\ \ \ \ \ \ \ \ \ \ \ \ \ multipole[i]\ *=\_coeffPoly[i]\ ;}
\DoxyCodeLine{00503\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00504\ \ \ \ \ \}}
\DoxyCodeLine{00505\ }
\DoxyCodeLine{00506\ }
\DoxyCodeLine{00512\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_f_taylor_kernel_ac9974eee68de43cd44f5c229fc6f8c11}{M2M}}(CellClass*\ \textcolor{keyword}{const}\ FRestrict\ pole,}
\DoxyCodeLine{00513\ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ CellClass*\textcolor{keyword}{const}\ FRestrict\ *\textcolor{keyword}{const}\ FRestrict\ child,}
\DoxyCodeLine{00514\ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ inLevel)\textcolor{keyword}{\ override}}
\DoxyCodeLine{00515\ \textcolor{keyword}{\ \ \ \ }\{}
\DoxyCodeLine{00516\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ a=0,b=0,c=0;}
\DoxyCodeLine{00517\ }
\DoxyCodeLine{00518\ \ \ \ \ \ \ \ \ \textcolor{comment}{//Indexes\ of\ powers}}
\DoxyCodeLine{00519\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ idx\_a,idx\_b,idx\_c;}
\DoxyCodeLine{00520\ }
\DoxyCodeLine{00521\ \ \ \ \ \ \ \ \ \textcolor{comment}{//Distance\ from\ current\ child\ to\ parent}}
\DoxyCodeLine{00522\ \ \ \ \ \ \ \ \ FReal\ dx\ =\ 0.0;}
\DoxyCodeLine{00523\ \ \ \ \ \ \ \ \ FReal\ dy\ =\ 0.0;}
\DoxyCodeLine{00524\ \ \ \ \ \ \ \ \ FReal\ dz\ =\ 0.0;}
\DoxyCodeLine{00525\ \ \ \ \ \ \ \ \ \textcolor{comment}{//Center\ point\ of\ parent\ cell}}
\DoxyCodeLine{00526\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_f_point}{FPoint<FReal>}}\&\ cellCenter\ =\ getCellCenter(pole-\/>getCoordinate(),inLevel);}
\DoxyCodeLine{00527\ \ \ \ \ \ \ \ \ FReal\ *\ FRestrict\ mult\ =\ pole-\/>getMultipole();}
\DoxyCodeLine{00528\ }
\DoxyCodeLine{00529\ \ \ \ \ \ \ \ \ \textcolor{comment}{//Iteration\ over\ the\ eight\ children}}
\DoxyCodeLine{00530\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ idxChild;}
\DoxyCodeLine{00531\ \ \ \ \ \ \ \ \ FReal\ coeff;}
\DoxyCodeLine{00532\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(idxChild=0\ ;\ idxChild<8\ ;\ ++idxChild)}
\DoxyCodeLine{00533\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00534\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(child[idxChild])\{\ \textcolor{comment}{//Test\ if\ child\ exists}}
\DoxyCodeLine{00535\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_f_point}{FPoint<FReal>}}\&\ childCenter\ =\ getCellCenter(child[idxChild]-\/>getCoordinate(),inLevel+1);}
\DoxyCodeLine{00536\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ FReal\ *\ FRestrict\ multChild\ =\ child[idxChild]-\/>getMultipole();}
\DoxyCodeLine{00537\ }
\DoxyCodeLine{00538\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Set\ the\ distance\ between\ centers\ of\ cells}}
\DoxyCodeLine{00539\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ dx\ =\ cellCenter.\mbox{\hyperlink{class_f_point_a58d3859160347552d6a4a94fbdf883c3}{getX}}()\ -\/\ childCenter.\mbox{\hyperlink{class_f_point_a58d3859160347552d6a4a94fbdf883c3}{getX}}();}
\DoxyCodeLine{00540\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ dy\ =\ cellCenter.\mbox{\hyperlink{class_f_point_ae4383512b9b8d216775b3fb92325cfc9}{getY}}()\ -\/\ childCenter.\mbox{\hyperlink{class_f_point_ae4383512b9b8d216775b3fb92325cfc9}{getY}}();}
\DoxyCodeLine{00541\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ dz\ =\ cellCenter.\mbox{\hyperlink{class_f_point_a02208d4db50cbafe597adcbfb152b536}{getZ}}()\ -\/\ childCenter.\mbox{\hyperlink{class_f_point_a02208d4db50cbafe597adcbfb152b536}{getZ}}();}
\DoxyCodeLine{00542\ }
\DoxyCodeLine{00543\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Precompute\ the\ \ arrays\ of\ dx\string^i}}
\DoxyCodeLine{00544\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ arrayDX[0]\ =\ 1.0\ ;}
\DoxyCodeLine{00545\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ arrayDY[0]\ =\ 1.0\ ;}
\DoxyCodeLine{00546\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ arrayDZ[0]\ =\ 1.0\ ;}
\DoxyCodeLine{00547\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 1\ ;\ i\ <=\ P\ ;\ ++i)\ \ \{}
\DoxyCodeLine{00548\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ arrayDX[i]\ =\ dx\ *\ arrayDX[i-\/1]\ ;}
\DoxyCodeLine{00549\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ arrayDY[i]\ =\ dy\ *\ arrayDY[i-\/1]\ ;}
\DoxyCodeLine{00550\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ arrayDZ[i]\ =\ dz\ *\ arrayDZ[i-\/1]\ ;}
\DoxyCodeLine{00551\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00552\ }
\DoxyCodeLine{00553\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ a=0;}
\DoxyCodeLine{00554\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ b=0;}
\DoxyCodeLine{00555\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ c=0;}
\DoxyCodeLine{00556\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ FReal\ value;}
\DoxyCodeLine{00557\ }
\DoxyCodeLine{00558\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Iteration\ over\ parent\ multipole\ array}}
\DoxyCodeLine{00559\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ idxMult\ =\ 0\ ;\ idxMult<SizeVector\ ;\ idxMult++)}
\DoxyCodeLine{00560\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00561\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ value\ =\ 0.0;}
\DoxyCodeLine{00562\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ idMultiChild;}
\DoxyCodeLine{00563\ }
\DoxyCodeLine{00564\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Iteration\ over\ the\ powers\ to\ find\ the\ cell\ multipole}}
\DoxyCodeLine{00565\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//involved\ in\ the\ computation\ of\ the\ parent\ multipole}}
\DoxyCodeLine{00566\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(idx\_a=0\ ;\ idx\_a\ <=\ a\ ;\ ++idx\_a)\{}
\DoxyCodeLine{00567\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(idx\_b=0\ ;\ idx\_b\ <=\ b\ ;\ ++idx\_b)\{}
\DoxyCodeLine{00568\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(idx\_c=0\ ;\ idx\_c\ <=\ c\ ;\ ++idx\_c)\{}
\DoxyCodeLine{00569\ }
\DoxyCodeLine{00570\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Computation}}
\DoxyCodeLine{00571\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Child\ multipole\ involved}}
\DoxyCodeLine{00572\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ idMultiChild\ =\ powerToIdx(a-\/idx\_a,b-\/idx\_b,c-\/idx\_c);}
\DoxyCodeLine{00573\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ coeff\ =\ FReal(1.0)/fact3int(idx\_a,idx\_b,idx\_c);}
\DoxyCodeLine{00574\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ value\ +=\ multChild[idMultiChild]*coeff*arrayDX[idx\_a]*arrayDY[idx\_b]*arrayDZ[idx\_c];}
\DoxyCodeLine{00575\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00576\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00577\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00578\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ mult[idxMult]\ +=\ value;}
\DoxyCodeLine{00579\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ incPowers(\&a,\&b,\&c);}
\DoxyCodeLine{00580\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00581\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00582\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00583\ \ \ \ \ \}}
\DoxyCodeLine{00584\ }
\DoxyCodeLine{00600\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_f_taylor_kernel_a378bade4838fd8f5c8a00a164e2c6999}{M2L}}(CellClass*\ \textcolor{keyword}{const}\ FRestrict\ inLocal,\ \textcolor{keyword}{const}\ CellClass*\ distantNeighbors[],}
\DoxyCodeLine{00601\ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ \textcolor{comment}{/*neighborPositions*/}[],\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ inSize,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ inLevel)\textcolor{keyword}{\ \ override\ }\{}
\DoxyCodeLine{00602\ \ \ \ \ \ \ \ \ \textcolor{comment}{//Iteration\ over\ distantNeighbors}}
\DoxyCodeLine{00603\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_f_point}{FPoint<FReal>}}\ \&\ locCenter\ =\ getCellCenter(inLocal-\/>getCoordinate(),inLevel);}
\DoxyCodeLine{00604\ \ \ \ \ \ \ \ \ FReal\ *\ FRestrict\ iterLocal\ =\ inLocal-\/>getLocal();}
\DoxyCodeLine{00605\ }
\DoxyCodeLine{00606\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ idxExistingNeigh\ =\ 0\ ;\ idxExistingNeigh\ <\ inSize\ ;\ ++idxExistingNeigh)\{}
\DoxyCodeLine{00607\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_f_point}{FPoint<FReal>}}\ curDistCenter\ =\ getCellCenter(distantNeighbors[idxExistingNeigh]-\/>getCoordinate(),inLevel);}
\DoxyCodeLine{00608\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespace_f_mem_utils_a005b2bd1925d50a688606ed5877c5aec}{FMemUtils::memset}}(this-\/>\_PsiVector,0,sizeDerivative*\textcolor{keyword}{sizeof}(FReal(0.0)));}
\DoxyCodeLine{00609\ }
\DoxyCodeLine{00610\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Compute\ derivatives\ on\ \ locCenter\ -\/\ curDistCenter}}
\DoxyCodeLine{00611\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ target\ \ \ \ \ \ \ source}}
\DoxyCodeLine{00612\ \ \ \ \ \ \ \ \ \ \ \ \ FReal\ dx\ =\ locCenter.\mbox{\hyperlink{class_f_point_a58d3859160347552d6a4a94fbdf883c3}{getX}}()\ -\/\ curDistCenter.\mbox{\hyperlink{class_f_point_a58d3859160347552d6a4a94fbdf883c3}{getX}}();}
\DoxyCodeLine{00613\ \ \ \ \ \ \ \ \ \ \ \ \ FReal\ dy\ =\ locCenter.\mbox{\hyperlink{class_f_point_ae4383512b9b8d216775b3fb92325cfc9}{getY}}()\ -\/\ curDistCenter.\mbox{\hyperlink{class_f_point_ae4383512b9b8d216775b3fb92325cfc9}{getY}}();}
\DoxyCodeLine{00614\ \ \ \ \ \ \ \ \ \ \ \ \ FReal\ dz\ =\ locCenter.\mbox{\hyperlink{class_f_point_a02208d4db50cbafe597adcbfb152b536}{getZ}}()\ -\/\ curDistCenter.\mbox{\hyperlink{class_f_point_a02208d4db50cbafe597adcbfb152b536}{getZ}}();}
\DoxyCodeLine{00615\ }
\DoxyCodeLine{00616\ }
\DoxyCodeLine{00617\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Iterative\ Computation\ of\ all\ the\ derivatives\ needed}}
\DoxyCodeLine{00618\ \ \ \ \ \ \ \ \ \ \ \ \ this-\/>computeFullDerivative(dx,dy,dz,this-\/>\_PsiVector);}
\DoxyCodeLine{00619\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ FReal\ *\ multipole\ =\ distantNeighbors[idxExistingNeigh]-\/>getMultipole();}
\DoxyCodeLine{00620\ }
\DoxyCodeLine{00621\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ al=0,bl=0\ \textcolor{comment}{/*,cl=0*/}\ ;\ \ \ \textcolor{comment}{//\ For\ local\ array}}
\DoxyCodeLine{00622\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ am,bm,cm;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ For\ distant\ array}}
\DoxyCodeLine{00623\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ \textcolor{keywordtype}{id}=0;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Index\ of\ iterLocal}}
\DoxyCodeLine{00624\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ i;}
\DoxyCodeLine{00625\ }
\DoxyCodeLine{00626\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Case\ (al,bl,cl)\ ==\ (0,0,0)}}
\DoxyCodeLine{00627\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ j\ =\ 0\ ;\ j\ <\ SizeVector\ ;\ ++j)\{\ \textcolor{comment}{//corresponding\ powers\ am,bm,cm}}
\DoxyCodeLine{00628\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ iterLocal[0]\ +=\ this-\/>\_PsiVector[j]*multipole[j];}
\DoxyCodeLine{00629\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00630\ }
\DoxyCodeLine{00631\ }
\DoxyCodeLine{00632\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(i=1,\ \textcolor{keywordtype}{id}=1\ ;\ i<=P\ ;\ ++i)\{}
\DoxyCodeLine{00633\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Case\ (i,0,0)\ :}}
\DoxyCodeLine{00634\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ FReal\ fctl\ \ \ =\ factorials[i];}
\DoxyCodeLine{00635\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ FReal\ coeffL\ =\ FReal(1.0)/(fctl);}
\DoxyCodeLine{00636\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Iterator\ over\ multipole\ array}}
\DoxyCodeLine{00637\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ FReal\ tmp\ =\ 0.0;}
\DoxyCodeLine{00638\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ am=0;\ \ \ \ \ bm=0;\ \ cm=0;}
\DoxyCodeLine{00639\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ j\ =\ 0\ ;\ j\ <\ SizeVector\ ;\ ++j)\{\ \textcolor{comment}{//corresponding\ powers\ am,bm,cm}}
\DoxyCodeLine{00640\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ idxPsi\ =\ powerToIdx(i+am,bm,cm);}
\DoxyCodeLine{00641\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tmp\ +=\ this-\/>\_PsiVector[idxPsi]*multipole[j];}
\DoxyCodeLine{00642\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ incPowers(\&am,\&bm,\&cm);}
\DoxyCodeLine{00643\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00644\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ iterLocal[id]\ +=\ tmp*coeffL\ ;\ \textcolor{comment}{//access\ to\ iterLocal[\ (i,0,0)\ ]\ is\ inlined.}}
\DoxyCodeLine{00645\ }
\DoxyCodeLine{00646\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Case\ (i-\/1,1,0)\ :}}
\DoxyCodeLine{00647\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ fctl\ =\ factorials[i-\/1];}
\DoxyCodeLine{00648\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ coeffL\ =\ FReal(1.0)/(fctl);}
\DoxyCodeLine{00649\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Iterator\ over\ multipole\ array}}
\DoxyCodeLine{00650\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tmp\ =\ 0.0;}
\DoxyCodeLine{00651\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ am=0;\ \ \ \ \ bm=0;\ \ cm=0;}
\DoxyCodeLine{00652\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ j\ =\ 0\ ;\ j\ <\ SizeVector\ ;\ ++j)\{\ \textcolor{comment}{//corresponding\ powers\ am,bm,cm}}
\DoxyCodeLine{00653\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ idxPsi\ =\ powerToIdx((i-\/1)+am,1+bm,cm);}
\DoxyCodeLine{00654\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tmp\ +=\ this-\/>\_PsiVector[idxPsi]*multipole[j];}
\DoxyCodeLine{00655\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//updating\ a,b,c}}
\DoxyCodeLine{00656\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ incPowers(\&am,\&bm,\&cm);}
\DoxyCodeLine{00657\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00658\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ iterLocal[++id]\ +=\ tmp*coeffL;\ \textcolor{comment}{//access\ to\ iterLocal[\ (i-\/1,1,0)\ ]\ is\ inlined}}
\DoxyCodeLine{00659\ }
\DoxyCodeLine{00660\ }
\DoxyCodeLine{00661\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Case\ (i-\/1,0,1)\ :}}
\DoxyCodeLine{00662\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Values\ of\ fctl\ and\ coeffL\ are\ the\ same\ for\ (i-\/1,1,0)\ and\ (i-\/1,0,1)}}
\DoxyCodeLine{00663\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Iterator\ over\ multipole\ array}}
\DoxyCodeLine{00664\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tmp\ =\ 0.0;}
\DoxyCodeLine{00665\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ am=0;\ \ \ \ \ bm=0;\ \ cm=0;}
\DoxyCodeLine{00666\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ j\ =\ 0\ ;\ j\ <\ SizeVector\ ;\ ++j)\{\ \textcolor{comment}{//corresponding\ powers\ am,bm,cm}}
\DoxyCodeLine{00667\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ idxPsi\ =\ powerToIdx((i-\/1)+am,bm,1+cm);}
\DoxyCodeLine{00668\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tmp\ +=\ this-\/>\_PsiVector[idxPsi]*multipole[j];}
\DoxyCodeLine{00669\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//updating\ a,b,c}}
\DoxyCodeLine{00670\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ incPowers(\&am,\&bm,\&cm);}
\DoxyCodeLine{00671\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00672\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ iterLocal[++id]\ +=\ tmp*coeffL;\ \textcolor{comment}{//access\ to\ iterLocal[\ (i-\/1,0,1)\ ]\ is\ inlined}}
\DoxyCodeLine{00673\ }
\DoxyCodeLine{00674\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//End\ of\ specific\ case}}
\DoxyCodeLine{00675\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Start\ of\ general\ case\ :}}
\DoxyCodeLine{00676\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ++id;}
\DoxyCodeLine{00677\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(al=i-\/2\ ;\ al>=\ 0\ ;\ -\/-\/al)}
\DoxyCodeLine{00678\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00679\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(bl=i-\/al\ ;\ bl>=0\ ;\ -\/-\/bl,\ ++id)}
\DoxyCodeLine{00680\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00681\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ am\ =\ 0\ ;}
\DoxyCodeLine{00682\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ bm\ =\ 0\ ;}
\DoxyCodeLine{00683\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ cm\ =\ 0\ ;}
\DoxyCodeLine{00684\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tmp\ =\ FReal(0);}
\DoxyCodeLine{00685\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ fctl\ =\ fact3int(al,bl,i-\/(al+bl));}
\DoxyCodeLine{00686\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ coeffL\ =\ FReal(1.0)/(fctl);}
\DoxyCodeLine{00687\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ j\ =\ 0\ ;\ j\ <\ SizeVector\ ;\ ++j)\{\ \textcolor{comment}{//corresponding\ powers\ am,bm,cm}}
\DoxyCodeLine{00688\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ idxPsi\ =\ powerToIdx(al+am,bl+bm,(i-\/al-\/bl)+cm);}
\DoxyCodeLine{00689\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tmp\ +=\ this-\/>\_PsiVector[idxPsi]*multipole[j];}
\DoxyCodeLine{00690\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//updating\ a,b,c}}
\DoxyCodeLine{00691\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ incPowers(\&am,\&bm,\&cm);}
\DoxyCodeLine{00692\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00693\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ iterLocal[id]\ +=\ tmp*coeffL;}
\DoxyCodeLine{00694\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00695\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00696\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00697\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00698\ \ \ \ \ \}}
\DoxyCodeLine{00699\ }
\DoxyCodeLine{00700\ }
\DoxyCodeLine{00715\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_f_taylor_kernel_a248a840c8d2064e252e90e1eb0d2e007}{L2L}}(\textcolor{keyword}{const}\ CellClass*\ \textcolor{keyword}{const}\ FRestrict\ fatherCell,}
\DoxyCodeLine{00716\ \ \ \ \ \ \ \ \ \ \ \ \ \ CellClass*\ FRestrict\ *\ \textcolor{keyword}{const}\ FRestrict\ childCell,}
\DoxyCodeLine{00717\ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ inLevel)\textcolor{keyword}{\ override}}
\DoxyCodeLine{00718\ \textcolor{keyword}{\ \ \ \ }\{}
\DoxyCodeLine{00719\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_f_point}{FPoint<FReal>}}\ locCenter\ =\ getCellCenter(fatherCell-\/>getCoordinate(),inLevel);}
\DoxyCodeLine{00720\ }
\DoxyCodeLine{00721\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Get\ father\ local\ expansion}}
\DoxyCodeLine{00722\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ FReal*\ FRestrict\ fatherExpansion\ =\ fatherCell-\/>getLocal()\ \ ;}
\DoxyCodeLine{00723\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ idxFatherLoc;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//index\ of\ Father\ local\ expansion\ to\ be\ read.}}
\DoxyCodeLine{00724\ \ \ \ \ \ \ \ \ FReal\ dx,\ \ dy,\ \ dz,\ coeff;}
\DoxyCodeLine{00725\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ ap,\ bp,\ cp,\ af,\ bf,\ cf;\ \ \ \ \ \textcolor{comment}{//Indexes\ of\ expansion\ for\ father\ and\ child.}}
\DoxyCodeLine{00726\ }
\DoxyCodeLine{00727\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ For\ all\ children}}
\DoxyCodeLine{00728\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ idxChild\ =\ 0\ ;\ idxChild\ <\ 8\ ;\ ++idxChild)\{}
\DoxyCodeLine{00729\ }
\DoxyCodeLine{00730\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(childCell[idxChild])\{\ \textcolor{comment}{//test\ if\ child\ exists}}
\DoxyCodeLine{00731\ }
\DoxyCodeLine{00732\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ FReal*\ FRestrict\ childExpansion\ =\ childCell[idxChild]-\/>getLocal()\ ;}
\DoxyCodeLine{00733\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_f_point}{FPoint<FReal>}}\&\ childCenter\ =\ getCellCenter(childCell[idxChild]-\/>getCoordinate(),inLevel+1);}
\DoxyCodeLine{00734\ }
\DoxyCodeLine{00735\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Set\ the\ distance\ between\ centers\ of\ cells}}
\DoxyCodeLine{00736\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Child\ -\/\ father}}
\DoxyCodeLine{00737\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ dx\ =\ childCenter.\mbox{\hyperlink{class_f_point_a58d3859160347552d6a4a94fbdf883c3}{getX}}()-\/locCenter.\mbox{\hyperlink{class_f_point_a58d3859160347552d6a4a94fbdf883c3}{getX}}();}
\DoxyCodeLine{00738\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ dy\ =\ childCenter.\mbox{\hyperlink{class_f_point_ae4383512b9b8d216775b3fb92325cfc9}{getY}}()-\/locCenter.\mbox{\hyperlink{class_f_point_ae4383512b9b8d216775b3fb92325cfc9}{getY}}();}
\DoxyCodeLine{00739\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ dz\ =\ childCenter.\mbox{\hyperlink{class_f_point_a02208d4db50cbafe597adcbfb152b536}{getZ}}()-\/locCenter.\mbox{\hyperlink{class_f_point_a02208d4db50cbafe597adcbfb152b536}{getZ}}();}
\DoxyCodeLine{00740\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Precompute\ the\ \ arrays\ of\ dx\string^i}}
\DoxyCodeLine{00741\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ arrayDX[0]\ =\ 1.0\ ;}
\DoxyCodeLine{00742\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ arrayDY[0]\ =\ 1.0\ ;}
\DoxyCodeLine{00743\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ arrayDZ[0]\ =\ 1.0\ ;}
\DoxyCodeLine{00744\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 1\ ;\ i\ <=\ P\ ;\ ++i)\ \ \{}
\DoxyCodeLine{00745\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ arrayDX[i]\ =\ dx\ *\ arrayDX[i-\/1]\ ;}
\DoxyCodeLine{00746\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ arrayDY[i]\ =\ dy\ *\ arrayDY[i-\/1]\ ;}
\DoxyCodeLine{00747\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ arrayDZ[i]\ =\ dz\ *\ arrayDZ[i-\/1]\ ;}
\DoxyCodeLine{00748\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00749\ }
\DoxyCodeLine{00750\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//iterator\ over\ child's\ local\ expansion\ (to\ be\ filled)}}
\DoxyCodeLine{00751\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ af=0;\ \ \ bf=0;\ \ \ cf=0;}
\DoxyCodeLine{00752\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ k=0\ ;\ k<SizeVector\ ;\ ++k)\{}
\DoxyCodeLine{00753\ }
\DoxyCodeLine{00754\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Iterator\ over\ parent's\ local\ array}}
\DoxyCodeLine{00755\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(ap=af\ ;\ ap<=P\ ;\ ++ap)}
\DoxyCodeLine{00756\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00757\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(bp=bf\ ;\ bp<=P\ ;\ ++bp)}
\DoxyCodeLine{00758\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00759\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(cp=cf\ ;\ ((cp<=P)\ \&\&\ (ap+bp+cp)\ <=\ P)\ ;\ ++cp)}
\DoxyCodeLine{00760\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00761\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ idxFatherLoc\ =\ powerToIdx(ap,bp,cp);}
\DoxyCodeLine{00762\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ coeff\ =\ combin(ap,af)\ *\ combin(bp,bf)\ *\ combin(cp,cf);}
\DoxyCodeLine{00763\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ childExpansion[k]\ +=\ coeff*fatherExpansion[idxFatherLoc]*arrayDX[ap-\/af]*arrayDY[bp-\/bf]*arrayDZ[cp-\/cf]\ ;}
\DoxyCodeLine{00764\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00765\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00766\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00767\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ incPowers(\&af,\&bf,\&cf);}
\DoxyCodeLine{00768\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00769\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00770\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00771\ \ \ \ \ \}}
\DoxyCodeLine{00772\ }
\DoxyCodeLine{00773\ }
\DoxyCodeLine{00774\ }
\DoxyCodeLine{00775\ }
\DoxyCodeLine{00788\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_f_taylor_kernel_a68f51a6ab1ff33cff3cfe2790735ff2a}{L2P}}(\textcolor{keyword}{const}\ CellClass*\ \textcolor{keyword}{const}\ local,}
\DoxyCodeLine{00789\ \ \ \ \ \ \ \ \ \ \ \ \ \ ContainerClass*\ \textcolor{keyword}{const}\ particles)\textcolor{keyword}{\ override}}
\DoxyCodeLine{00790\ \textcolor{keyword}{\ \ \ \ }\{}
\DoxyCodeLine{00791\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_f_point}{FPoint<FReal>}}\ locCenter\ =\ getLeafCenter(local-\/>getCoordinate());}
\DoxyCodeLine{00792\ \ \ \ \ \ \ \ \ \textcolor{comment}{//Iterator\ over\ particles}}
\DoxyCodeLine{00793\ \ \ \ \ \ \ \ \ FSize\ nbPart\ =\ particles-\/>getNbParticles();}
\DoxyCodeLine{00794\ }
\DoxyCodeLine{00795\ \ \ \ \ \ \ \ \ \textcolor{comment}{//Iteration\ over\ Local\ array}}
\DoxyCodeLine{00796\ \ \ \ \ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{00797\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ FReal\ *\ iterLocal\ =\ local-\/>getLocal();}
\DoxyCodeLine{00798\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ FReal\ *\ \textcolor{keyword}{const}\ *\ positions\ =\ particles-\/>getPositions();}
\DoxyCodeLine{00799\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ FReal\ *\ posX\ =\ positions[0];}
\DoxyCodeLine{00800\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ FReal\ *\ posY\ =\ positions[1];}
\DoxyCodeLine{00801\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ FReal\ *\ posZ\ =\ positions[2];}
\DoxyCodeLine{00802\ }
\DoxyCodeLine{00803\ \ \ \ \ \ \ \ \ FReal\ *\ forceX\ =\ particles-\/>getForcesX();}
\DoxyCodeLine{00804\ \ \ \ \ \ \ \ \ FReal\ *\ forceY\ =\ particles-\/>getForcesY();}
\DoxyCodeLine{00805\ \ \ \ \ \ \ \ \ FReal\ *\ forceZ\ =\ particles-\/>getForcesZ();}
\DoxyCodeLine{00806\ \ \ \ \ \ \ \ \ FReal\ *\ targetsPotentials\ =\ particles-\/>getPotentials();}
\DoxyCodeLine{00807\ \ \ \ \ \ \ \ \ FReal\ *\ phyValues\ =\ particles-\/>getPhysicalValues();}
\DoxyCodeLine{00808\ }
\DoxyCodeLine{00809\ \ \ \ \ \ \ \ \ \textcolor{comment}{//Iteration\ over\ particles}}
\DoxyCodeLine{00810\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(FSize\ i=0\ ;\ i<nbPart\ ;\ ++i)\{}
\DoxyCodeLine{00811\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{00812\ \ \ \ \ \ \ \ \ \ \ \ \ FReal\ dx\ =\ \ posX[i]\ -\/\ locCenter.\mbox{\hyperlink{class_f_point_a58d3859160347552d6a4a94fbdf883c3}{getX}}();}
\DoxyCodeLine{00813\ \ \ \ \ \ \ \ \ \ \ \ \ FReal\ dy\ =\ \ posY[i]\ -\/\ locCenter.\mbox{\hyperlink{class_f_point_ae4383512b9b8d216775b3fb92325cfc9}{getY}}();}
\DoxyCodeLine{00814\ \ \ \ \ \ \ \ \ \ \ \ \ FReal\ dz\ =\ \ posZ[i]\ -\/\ locCenter.\mbox{\hyperlink{class_f_point_a02208d4db50cbafe597adcbfb152b536}{getZ}}();}
\DoxyCodeLine{00815\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Precompute\ an\ arrays\ of\ Array[i]\ =\ dx\string^(i-\/1)}}
\DoxyCodeLine{00816\ \ \ \ \ \ \ \ \ \ \ \ \ arrayDX[0]\ =\ 0.0\ ;}
\DoxyCodeLine{00817\ \ \ \ \ \ \ \ \ \ \ \ \ arrayDY[0]\ =\ 0.0\ ;}
\DoxyCodeLine{00818\ \ \ \ \ \ \ \ \ \ \ \ \ arrayDZ[0]\ =\ 0.0\ ;}
\DoxyCodeLine{00819\ }
\DoxyCodeLine{00820\ \ \ \ \ \ \ \ \ \ \ \ \ arrayDX[1]\ =\ 1.0\ ;}
\DoxyCodeLine{00821\ \ \ \ \ \ \ \ \ \ \ \ \ arrayDY[1]\ =\ 1.0\ ;}
\DoxyCodeLine{00822\ \ \ \ \ \ \ \ \ \ \ \ \ arrayDZ[1]\ =\ 1.0\ ;}
\DoxyCodeLine{00823\ }
\DoxyCodeLine{00824\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ d\ =\ 2\ ;\ d\ <=\ P+1\ ;\ ++d)\{\ \textcolor{comment}{//Array\ is\ staggered\ :\ Array[i]\ =\ dx\string^(i-\/1)}}
\DoxyCodeLine{00825\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ arrayDX[d]\ =\ dx\ *\ arrayDX[d-\/1]\ ;}
\DoxyCodeLine{00826\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ arrayDY[d]\ =\ dy\ *\ arrayDY[d-\/1]\ ;}
\DoxyCodeLine{00827\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ arrayDZ[d]\ =\ dz\ *\ arrayDZ[d-\/1]\ ;}
\DoxyCodeLine{00828\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00829\ \ \ \ \ \ \ \ \ \ \ \ \ FReal\ partPhyValue\ =\ phyValues[i];}
\DoxyCodeLine{00830\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{00831\ \ \ \ \ \ \ \ \ \ \ \ \ FReal\ \ locPot\ =\ 0.0,\ locForceX\ =\ 0.0,\ locForceY\ =\ 0.0,\ locForceZ\ =\ 0.0\ ;}
\DoxyCodeLine{00832\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ a=0,b=0,c=0;}
\DoxyCodeLine{00833\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ j=0\ ;\ j<SizeVector\ ;\ ++j)\{}
\DoxyCodeLine{00834\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ FReal\ locForce\ \ \ \ \ =\ iterLocal[j];}
\DoxyCodeLine{00835\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ compute\ the\ potential}}
\DoxyCodeLine{00836\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ locPot\ +=\ iterLocal[j]*arrayDX[a+1]*arrayDY[b+1]*arrayDZ[c+1];}
\DoxyCodeLine{00837\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Application\ of\ forces}}
\DoxyCodeLine{00838\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ locForceX\ +=\ FReal(a)*locForce*arrayDX[a]*arrayDY[b+1]*arrayDZ[c+1];}
\DoxyCodeLine{00839\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ locForceY\ +=\ FReal(b)*locForce*arrayDX[a+1]*arrayDY[b]*arrayDZ[c+1];}
\DoxyCodeLine{00840\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ locForceZ\ +=\ FReal(c)*locForce*arrayDX[a+1]*arrayDY[b+1]*arrayDZ[c];}
\DoxyCodeLine{00841\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ incPowers(\&a,\&b,\&c);}
\DoxyCodeLine{00842\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00843\ \ \ \ \ \ \ \ \ \ \ \ \ targetsPotentials[i]\ \ +=\textcolor{comment}{/*\ partPhyValue*/}locPot\ ;}
\DoxyCodeLine{00844\ \ \ \ \ \ \ \ \ \ \ \ \ forceX[i]\ \ \ \ \ \ \ \ \ \ \ \ \ +=\ partPhyValue*locForceX\ ;}
\DoxyCodeLine{00845\ \ \ \ \ \ \ \ \ \ \ \ \ forceY[i]\ \ \ \ \ \ \ \ \ \ \ \ \ +=\ partPhyValue*locForceY\ ;}
\DoxyCodeLine{00846\ \ \ \ \ \ \ \ \ \ \ \ \ forceZ[i]\ \ \ \ \ \ \ \ \ \ \ \ \ +=\ partPhyValue*locForceZ\ ;}
\DoxyCodeLine{00847\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00848\ \ \ \ \ \}}
\DoxyCodeLine{00849\ }
\DoxyCodeLine{00856\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_f_taylor_kernel_a92ae46dae23395eabc0af1118309ab87}{P2P}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{class_f_tree_coordinate}{FTreeCoordinate}}\&\ inPosition,}
\DoxyCodeLine{00857\ \ \ \ \ \ \ \ \ \ \ \ \ \ ContainerClass*\ \textcolor{keyword}{const}\ FRestrict\ inTargets,\ \textcolor{keyword}{const}\ ContainerClass*\ \textcolor{keyword}{const}\ FRestrict\ inSources,}
\DoxyCodeLine{00858\ \ \ \ \ \ \ \ \ \ \ \ \ \ ContainerClass*\ \textcolor{keyword}{const}\ inNeighbors[],\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ neighborPositions[],}
\DoxyCodeLine{00859\ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ inSize)\textcolor{keyword}{\ override\ }\{}
\DoxyCodeLine{00860\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(inTargets\ ==\ inSources)\{}
\DoxyCodeLine{00861\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{struct_f_p2_p_r_t}{FP2PRT<FReal>::template}}\ Inner<ContainerClass>(inTargets);}
\DoxyCodeLine{00862\ \ \ \ \ \ \ \ \ \ \ \ \ P2POuter(inPosition,\ inTargets,\ inNeighbors,\ neighborPositions,\ inSize);}
\DoxyCodeLine{00863\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00864\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\{}
\DoxyCodeLine{00865\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ ContainerClass*\ \textcolor{keyword}{const}\ srcPtr[1]\ =\ \{inSources\};}
\DoxyCodeLine{00866\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{struct_f_p2_p_r_t}{FP2PRT<FReal>::template}}\ FullRemote<ContainerClass>(inTargets,srcPtr,1);}
\DoxyCodeLine{00867\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{struct_f_p2_p_r_t}{FP2PRT<FReal>::template}}\ FullRemote<ContainerClass>(inTargets,inNeighbors,inSize);}
\DoxyCodeLine{00868\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00869\ \ \ \ \ \}}
\DoxyCodeLine{00870\ }
\DoxyCodeLine{00871\ \ \ \ \ \textcolor{keywordtype}{void}\ P2POuter(\textcolor{keyword}{const}\ \mbox{\hyperlink{class_f_tree_coordinate}{FTreeCoordinate}}\&\ \textcolor{comment}{/*inLeafPosition*/},}
\DoxyCodeLine{00872\ \ \ \ \ \ \ \ \ \ \ \ \ \ ContainerClass*\ \textcolor{keyword}{const}\ FRestrict\ inTargets,}
\DoxyCodeLine{00873\ \ \ \ \ \ \ \ \ \ \ \ \ \ ContainerClass*\ \textcolor{keyword}{const}\ inNeighbors[],\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ neighborPositions[],}
\DoxyCodeLine{00874\ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ inSize)\textcolor{keyword}{\ override\ }\{}
\DoxyCodeLine{00875\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ nbNeighborsToCompute\ =\ 0;}
\DoxyCodeLine{00876\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{while}(nbNeighborsToCompute\ <\ inSize}
\DoxyCodeLine{00877\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \&\&\ neighborPositions[nbNeighborsToCompute]\ <\ 14)\{}
\DoxyCodeLine{00878\ \ \ \ \ \ \ \ \ \ \ \ \ nbNeighborsToCompute\ +=\ 1;}
\DoxyCodeLine{00879\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00880\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{struct_f_p2_p_r_t}{FP2PRT<FReal>::template}}\ FullMutual<ContainerClass>(inTargets,inNeighbors,nbNeighborsToCompute);}
\DoxyCodeLine{00881\ \ \ \ \ \}}
\DoxyCodeLine{00882\ }
\DoxyCodeLine{00883\ }
\DoxyCodeLine{00885\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_f_taylor_kernel_a4e4d6f0cec1b72903f1a2d2dc6dd7325}{P2PRemote}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{class_f_tree_coordinate}{FTreeCoordinate}}\&\ \textcolor{comment}{/*inPosition*/},}
\DoxyCodeLine{00886\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ContainerClass*\ \textcolor{keyword}{const}\ FRestrict\ inTargets,\ \textcolor{keyword}{const}\ ContainerClass*\ \textcolor{keyword}{const}\ FRestrict\ \textcolor{comment}{/*inSources*/},}
\DoxyCodeLine{00887\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ ContainerClass*\ \textcolor{keyword}{const}\ inNeighbors[],\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ neighborPositions[],}
\DoxyCodeLine{00888\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ inSize)\textcolor{keyword}{\ override\ }\{}
\DoxyCodeLine{00889\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{struct_f_p2_p_r_t}{FP2PRT<FReal>::template}}\ FullRemote<ContainerClass>(inTargets,inNeighbors,inSize);}
\DoxyCodeLine{00890\ \ \ \ \ \}}
\DoxyCodeLine{00891\ }
\DoxyCodeLine{00892\ \};}
\DoxyCodeLine{00893\ }
\DoxyCodeLine{00894\ \textcolor{preprocessor}{\#endif}}

\end{DoxyCode}
