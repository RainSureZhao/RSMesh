\doxysection{FTest\+Kernels.\+hpp}
\hypertarget{_f_test_kernels_8hpp_source}{}\label{_f_test_kernels_8hpp_source}\index{third\_party/ScalFMM/include/ScalFMM/Components/FTestKernels.hpp@{third\_party/ScalFMM/include/ScalFMM/Components/FTestKernels.hpp}}

\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{comment}{//\ See\ LICENCE\ file\ at\ project\ root}}
\DoxyCodeLine{00002\ \textcolor{preprocessor}{\#ifndef\ FTESTKERNELS\_HPP}}
\DoxyCodeLine{00003\ \textcolor{preprocessor}{\#define\ FTESTKERNELS\_HPP}}
\DoxyCodeLine{00004\ }
\DoxyCodeLine{00005\ }
\DoxyCodeLine{00006\ \textcolor{preprocessor}{\#include\ <iostream>}}
\DoxyCodeLine{00007\ }
\DoxyCodeLine{00008\ \textcolor{preprocessor}{\#include\ "{}FAbstractKernels.hpp"{}}}
\DoxyCodeLine{00009\ \textcolor{preprocessor}{\#include\ "{}../Containers/FOctree.hpp"{}}}
\DoxyCodeLine{00010\ \textcolor{preprocessor}{\#include\ "{}../Utils/FGlobal.hpp"{}}}
\DoxyCodeLine{00011\ }
\DoxyCodeLine{00012\ }
\DoxyCodeLine{00013\ }
\DoxyCodeLine{00028\ \textcolor{keyword}{template}<\ \textcolor{keyword}{class}\ CellClass,\ \textcolor{keyword}{class}\ ContainerClass>}
\DoxyCodeLine{00029\ \textcolor{keyword}{class\ }\mbox{\hyperlink{class_f_test_kernels}{FTestKernels}}\ \ :\ \textcolor{keyword}{public}\ \mbox{\hyperlink{class_f_abstract_kernels}{FAbstractKernels}}<CellClass,ContainerClass>\ \{}
\DoxyCodeLine{00030\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00032\ \ \ \ \ \textcolor{keyword}{virtual}\ \mbox{\hyperlink{class_f_test_kernels_a5eb35fed53395edec34c179842b91a1d}{\string~FTestKernels}}()\{}
\DoxyCodeLine{00033\ \ \ \ \ \}}
\DoxyCodeLine{00034\ }
\DoxyCodeLine{00036\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_f_test_kernels_a860ef234c8ca8c59f83fcbc1d0896f07}{P2M}}(CellClass*\ \textcolor{keyword}{const}\ pole,\ \textcolor{keyword}{const}\ ContainerClass*\ \textcolor{keyword}{const}\ particles)\textcolor{keyword}{\ override\ }\{}
\DoxyCodeLine{00037\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ the\ pole\ represents\ all\ particles\ under}}
\DoxyCodeLine{00038\ \ \ \ \ \ \ \ \ pole-\/>setDataUp(pole-\/>getDataUp()\ +\ particles-\/>getNbParticles());}
\DoxyCodeLine{00039\ \ \ \ \ \}}
\DoxyCodeLine{00040\ }
\DoxyCodeLine{00042\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_f_test_kernels_ae98e23ef2bfdde743bbb0086851116fa}{M2M}}(CellClass*\ \textcolor{keyword}{const}\ FRestrict\ pole,\ \textcolor{keyword}{const}\ CellClass\ *\textcolor{keyword}{const}\ FRestrict\ *\textcolor{keyword}{const}\ FRestrict\ child,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ \textcolor{comment}{/*level*/})\textcolor{keyword}{\ override\ }\{}
\DoxyCodeLine{00043\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ A\ parent\ represents\ the\ sum\ of\ the\ child}}
\DoxyCodeLine{00044\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ idx\ =\ 0\ ;\ idx\ <\ 8\ ;\ ++idx)\{}
\DoxyCodeLine{00045\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(child[idx])\{}
\DoxyCodeLine{00046\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ pole-\/>setDataUp(pole-\/>getDataUp()\ +\ child[idx]-\/>getDataUp());}
\DoxyCodeLine{00047\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00048\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00049\ \ \ \ \ \}}
\DoxyCodeLine{00050\ }
\DoxyCodeLine{00052\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_f_test_kernels_a3d806e3b721846d38efcaef32c58c8ca}{M2L}}(CellClass*\ \textcolor{keyword}{const}\ FRestrict\ pole,\ \textcolor{keyword}{const}\ CellClass*\ distantNeighbors[],\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ \textcolor{comment}{/*position*/}[],}
\DoxyCodeLine{00053\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ size,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ \textcolor{comment}{/*level*/})\textcolor{keyword}{\ override\ }\{}
\DoxyCodeLine{00054\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ The\ pole\ is\ impacted\ by\ what\ represent\ other\ poles}}
\DoxyCodeLine{00055\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ idx\ =\ 0\ ;\ idx\ <\ size\ ;\ ++idx)\{}
\DoxyCodeLine{00056\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ pole-\/>setDataDown(pole-\/>getDataDown()\ +\ distantNeighbors[idx]-\/>getDataUp());}
\DoxyCodeLine{00057\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00058\ \ \ \ \ \}}
\DoxyCodeLine{00059\ }
\DoxyCodeLine{00061\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_f_test_kernels_a8e3d706180f96ebeb750656f0c9ab3f5}{L2L}}(\textcolor{keyword}{const}\ CellClass*\textcolor{keyword}{const}\ FRestrict\ local,\ CellClass*\ FRestrict\ *\textcolor{keyword}{const}\ FRestrict\ child,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ \textcolor{comment}{/*level*/})\textcolor{keyword}{\ override\ }\{}
\DoxyCodeLine{00062\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Each\ child\ is\ impacted\ by\ the\ father}}
\DoxyCodeLine{00063\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ idx\ =\ 0\ ;\ idx\ <\ 8\ ;\ ++idx)\{}
\DoxyCodeLine{00064\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(child[idx])\{}
\DoxyCodeLine{00065\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ child[idx]-\/>setDataDown(local-\/>getDataDown()\ +\ child[idx]-\/>getDataDown());}
\DoxyCodeLine{00066\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00067\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00068\ }
\DoxyCodeLine{00069\ \ \ \ \ \}}
\DoxyCodeLine{00070\ }
\DoxyCodeLine{00072\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_f_test_kernels_ab34ed466a21770bdc608f1e415b1f983}{L2P}}(\textcolor{keyword}{const}\ CellClass*\ \textcolor{keyword}{const}\ \ local,\ ContainerClass*\textcolor{keyword}{const}\ particles)\textcolor{keyword}{\ override\ }\{}
\DoxyCodeLine{00073\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ The\ particles\ is\ impacted\ by\ the\ parent\ cell\ \ \ \ \ \ }}
\DoxyCodeLine{00074\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{long}\ \textcolor{keywordtype}{long}\ \textcolor{keywordtype}{int}*\textcolor{keyword}{const}\ particlesAttributes\ =\ particles-\/>getDataDown();}
\DoxyCodeLine{00075\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(FSize\ idxPart\ =\ 0\ ;\ idxPart\ <\ particles-\/>getNbParticles()\ ;\ ++idxPart)\{}
\DoxyCodeLine{00076\ \ \ \ \ \ \ \ \ \ \ \ \ particlesAttributes[idxPart]\ +=\ local-\/>getDataDown();}
\DoxyCodeLine{00077\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00078\ \ \ \ \ \}}
\DoxyCodeLine{00079\ }
\DoxyCodeLine{00080\ }
\DoxyCodeLine{00082\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_f_test_kernels_aff19839a6b2fd710a6ed82e3c5f29018}{P2P}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{class_f_tree_coordinate}{FTreeCoordinate}}\&\ ,}
\DoxyCodeLine{00083\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ContainerClass*\ \textcolor{keyword}{const}\ FRestrict\ targets,\ \textcolor{keyword}{const}\ ContainerClass*\ \textcolor{keyword}{const}\ FRestrict\ sources,}
\DoxyCodeLine{00084\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ContainerClass*\ \textcolor{keyword}{const}\ directNeighborsParticles[],\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ \textcolor{comment}{/*positions*/}[],\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ inSize)\textcolor{keyword}{\ override\ }\{}
\DoxyCodeLine{00085\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Each\ particles\ targeted\ is\ impacted\ by\ the\ particles\ sources}}
\DoxyCodeLine{00086\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{long}\ \textcolor{keywordtype}{long}\ \textcolor{keywordtype}{int}\ inc\ =\ sources-\/>getNbParticles();}
\DoxyCodeLine{00087\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(targets\ ==\ sources)\{}
\DoxyCodeLine{00088\ \ \ \ \ \ \ \ \ \ \ \ \ inc\ -\/=\ 1;}
\DoxyCodeLine{00089\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00090\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ idx\ =\ 0\ ;\ idx\ <\ inSize\ ;\ ++idx)\{}
\DoxyCodeLine{00091\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ inc\ +=\ directNeighborsParticles[idx]-\/>getNbParticles();}
\DoxyCodeLine{00092\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00093\ }
\DoxyCodeLine{00094\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{long}\ \textcolor{keywordtype}{long}\ \textcolor{keywordtype}{int}*\textcolor{keyword}{const}\ particlesAttributes\ =\ targets-\/>getDataDown();}
\DoxyCodeLine{00095\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(FSize\ idxPart\ =\ 0\ ;\ idxPart\ <\ targets-\/>getNbParticles()\ ;\ ++idxPart)\{}
\DoxyCodeLine{00096\ \ \ \ \ \ \ \ \ \ \ \ \ particlesAttributes[idxPart]\ +=\ inc;}
\DoxyCodeLine{00097\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00098\ \ \ \ \ \}}
\DoxyCodeLine{00099\ }
\DoxyCodeLine{00100\ \ \ \ \ \textcolor{keywordtype}{void}\ P2POuter(\textcolor{keyword}{const}\ \mbox{\hyperlink{class_f_tree_coordinate}{FTreeCoordinate}}\&\ \textcolor{comment}{/*inLeafPosition*/},}
\DoxyCodeLine{00101\ \ \ \ \ \ \ \ \ \ \ \ \ \ ContainerClass*\ \textcolor{keyword}{const}\ FRestrict\ targets,}
\DoxyCodeLine{00102\ \ \ \ \ \ \ \ \ \ \ \ \ \ ContainerClass*\ \textcolor{keyword}{const}\ directNeighborsParticles[],\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ neighborPositions[],}
\DoxyCodeLine{00103\ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ inSize)\textcolor{keyword}{\ override\ }\{}
\DoxyCodeLine{00104\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{long}\ \textcolor{keywordtype}{long}\ \textcolor{keywordtype}{int}\ inc\ =\ 0;}
\DoxyCodeLine{00105\ }
\DoxyCodeLine{00106\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ idx\ =\ 0\ ;\ idx\ <\ inSize\ ;\ ++idx)\{}
\DoxyCodeLine{00107\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ inc\ +=\ directNeighborsParticles[idx]-\/>getNbParticles();}
\DoxyCodeLine{00108\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00109\ }
\DoxyCodeLine{00110\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{long}\ \textcolor{keywordtype}{long}\ \textcolor{keywordtype}{int}*\textcolor{keyword}{const}\ particlesAttributes\ =\ targets-\/>getDataDown();}
\DoxyCodeLine{00111\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(FSize\ idxPart\ =\ 0\ ;\ idxPart\ <\ targets-\/>getNbParticles()\ ;\ ++idxPart)\{}
\DoxyCodeLine{00112\ \ \ \ \ \ \ \ \ \ \ \ \ particlesAttributes[idxPart]\ +=\ inc;}
\DoxyCodeLine{00113\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00114\ \ \ \ \ \}}
\DoxyCodeLine{00115\ }
\DoxyCodeLine{00117\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_f_test_kernels_a5268c5f70d42d5bc1803a856660e3abd}{P2PRemote}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{class_f_tree_coordinate}{FTreeCoordinate}}\&\ ,}
\DoxyCodeLine{00118\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ContainerClass*\ \textcolor{keyword}{const}\ FRestrict\ targets,\ \textcolor{keyword}{const}\ ContainerClass*\ \textcolor{keyword}{const}\ FRestrict\ \textcolor{comment}{/*sources*/},}
\DoxyCodeLine{00119\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ ContainerClass*\ \textcolor{keyword}{const}\ directNeighborsParticles[],\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ \textcolor{comment}{/*positions*/}[],\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ inSize)\textcolor{keyword}{\ override\ \ }\{}
\DoxyCodeLine{00120\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Each\ particles\ targeted\ is\ impacted\ by\ the\ particles\ sources}}
\DoxyCodeLine{00121\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{long}\ \textcolor{keywordtype}{long}\ \textcolor{keywordtype}{int}\ inc\ =\ 0;}
\DoxyCodeLine{00122\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ idx\ =\ 0\ ;\ idx\ <\ inSize\ ;\ ++idx)\{}
\DoxyCodeLine{00123\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ inc\ +=\ directNeighborsParticles[idx]-\/>getNbParticles();}
\DoxyCodeLine{00124\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00125\ }
\DoxyCodeLine{00126\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{long}\ \textcolor{keywordtype}{long}\ \textcolor{keywordtype}{int}*\textcolor{keyword}{const}\ particlesAttributes\ =\ targets-\/>getDataDown();}
\DoxyCodeLine{00127\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(FSize\ idxPart\ =\ 0\ ;\ idxPart\ <\ targets-\/>getNbParticles()\ ;\ ++idxPart)\{}
\DoxyCodeLine{00128\ \ \ \ \ \ \ \ \ \ \ \ \ particlesAttributes[idxPart]\ +=\ inc;}
\DoxyCodeLine{00129\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00130\ \ \ \ \ \}}
\DoxyCodeLine{00131\ \};}
\DoxyCodeLine{00132\ }
\DoxyCodeLine{00133\ }
\DoxyCodeLine{00137\ \textcolor{keyword}{template}<\ \textcolor{keyword}{class}\ OctreeClass,\ \textcolor{keyword}{class}\ CellClass,\ \textcolor{keyword}{class}\ ContainerClass,\ \textcolor{keyword}{class}\ LeafClass>}
\DoxyCodeLine{00138\ \textcolor{keywordtype}{void}\ ValidateFMMAlgo(OctreeClass*\ \textcolor{keyword}{const}\ tree)\{}
\DoxyCodeLine{00139\ \ \ \ \ std::cout\ <<\ \textcolor{stringliteral}{"{}Check\ Result\(\backslash\)n"{}};}
\DoxyCodeLine{00140\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ TreeHeight\ =\ tree-\/>getHeight();}
\DoxyCodeLine{00141\ \ \ \ \ \textcolor{keywordtype}{long}\ \textcolor{keywordtype}{long}\ \textcolor{keywordtype}{int}\ NbPart\ =\ 0;}
\DoxyCodeLine{00142\ \ \ \ \ \{\ \textcolor{comment}{//\ Check\ that\ each\ particle\ has\ been\ summed\ with\ all\ other}}
\DoxyCodeLine{00143\ \ \ \ \ \ \ \ \ tree-\/>forEachCellLeaf([\&](CellClass*\ cell,\ LeafClass*\ leaf)\{}
\DoxyCodeLine{00144\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(cell-\/>getDataUp()\ !=\ leaf-\/>getSrc()-\/>getNbParticles()\ )\{}
\DoxyCodeLine{00145\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ std::cout\ <<\ \textcolor{stringliteral}{"{}Problem\ P2M\ :\ "{}}\ <<\ cell-\/>getDataUp()\ <<}
\DoxyCodeLine{00146\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}\ (should\ be\ "{}}\ <<\ leaf-\/>getSrc()-\/>getNbParticles()\ <<\ \textcolor{stringliteral}{"{})\(\backslash\)n"{}};}
\DoxyCodeLine{00147\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00148\ \ \ \ \ \ \ \ \ \ \ \ \ NbPart\ +=\ leaf-\/>getSrc()-\/>getNbParticles();}
\DoxyCodeLine{00149\ \ \ \ \ \ \ \ \ \});}
\DoxyCodeLine{00150\ \ \ \ \ \}}
\DoxyCodeLine{00151\ \ \ \ \ \{\ \textcolor{comment}{//\ Ceck\ if\ there\ is\ number\ of\ NbPart\ summed\ at\ level\ 1}}
\DoxyCodeLine{00152\ \ \ \ \ \ \ \ \ \textcolor{keyword}{typename}\ OctreeClass::Iterator\ octreeIterator(tree);}
\DoxyCodeLine{00153\ \ \ \ \ \ \ \ \ octreeIterator.moveDown();}
\DoxyCodeLine{00154\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{long}\ \textcolor{keywordtype}{long}\ \textcolor{keywordtype}{int}\ res\ =\ 0;}
\DoxyCodeLine{00155\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{do}\{}
\DoxyCodeLine{00156\ \ \ \ \ \ \ \ \ \ \ \ \ res\ +=\ octreeIterator.getCurrentCell()-\/>getDataUp();}
\DoxyCodeLine{00157\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{while}(octreeIterator.moveRight());}
\DoxyCodeLine{00158\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(res\ !=\ NbPart)\{}
\DoxyCodeLine{00159\ \ \ \ \ \ \ \ \ \ \ \ \ std::cout\ <<\ \textcolor{stringliteral}{"{}Problem\ M2M\ at\ level\ 1\ :\ "{}}\ <<\ res\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{00160\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00161\ \ \ \ \ \}}
\DoxyCodeLine{00162\ \ \ \ \ \{\ \textcolor{comment}{//\ Ceck\ if\ there\ is\ number\ of\ NbPart\ summed\ at\ level\ 1}}
\DoxyCodeLine{00163\ \ \ \ \ \ \ \ \ \textcolor{keyword}{typename}\ OctreeClass::Iterator\ octreeIterator(tree);}
\DoxyCodeLine{00164\ \ \ \ \ \ \ \ \ octreeIterator.gotoBottomLeft();}
\DoxyCodeLine{00165\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ idxLevel\ =\ TreeHeight\ -\/\ 1\ ;\ idxLevel\ >\ 1\ ;\ -\/-\/idxLevel\ )\{}
\DoxyCodeLine{00166\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{long}\ \textcolor{keywordtype}{long}\ \textcolor{keywordtype}{int}\ res\ =\ 0;}
\DoxyCodeLine{00167\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{do}\{}
\DoxyCodeLine{00168\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ res\ +=\ octreeIterator.getCurrentCell()-\/>getDataUp();}
\DoxyCodeLine{00169\ \ \ \ \ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{while}(octreeIterator.moveRight());}
\DoxyCodeLine{00170\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(res\ !=\ NbPart)\{}
\DoxyCodeLine{00171\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ std::cout\ <<\ \textcolor{stringliteral}{"{}Problem\ M2M\ at\ level\ "{}}\ <<\ idxLevel\ <<\ \textcolor{stringliteral}{"{}\ :\ "{}}\ <<\ res\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{00172\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00173\ \ \ \ \ \ \ \ \ \ \ \ \ octreeIterator.moveUp();}
\DoxyCodeLine{00174\ \ \ \ \ \ \ \ \ \ \ \ \ octreeIterator.gotoLeft();}
\DoxyCodeLine{00175\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00176\ \ \ \ \ \}}
\DoxyCodeLine{00177\ \ \ \ \ \{\ \textcolor{comment}{//\ Check\ that\ each\ particle\ has\ been\ summed\ with\ all\ other}}
\DoxyCodeLine{00178\ \ \ \ \ \ \ \ \ \textcolor{keyword}{typename}\ OctreeClass::Iterator\ octreeIterator(tree);}
\DoxyCodeLine{00179\ \ \ \ \ \ \ \ \ octreeIterator.gotoBottomLeft();}
\DoxyCodeLine{00180\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{do}\{}
\DoxyCodeLine{00181\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{bool}\ isUsingTsm\ =\ (octreeIterator.getCurrentListTargets()\ !=\ octreeIterator.getCurrentListSrc());}
\DoxyCodeLine{00182\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{long}\ \textcolor{keywordtype}{long}\ \textcolor{keywordtype}{int}*\ dataDown\ =\ octreeIterator.getCurrentListTargets()-\/>getDataDown();}
\DoxyCodeLine{00183\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(FSize\ idxPart\ =\ 0\ ;\ idxPart\ <\ octreeIterator.getCurrentListTargets()-\/>getNbParticles()\ ;\ ++idxPart)\{}
\DoxyCodeLine{00184\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\ (!isUsingTsm\ \&\&\ dataDown[idxPart]\ !=\ NbPart\ -\/\ 1)\ ||}
\DoxyCodeLine{00185\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (isUsingTsm\ \&\&\ dataDown[idxPart]\ !=\ NbPart)\ )\{}
\DoxyCodeLine{00186\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ std::cout\ <<\ \textcolor{stringliteral}{"{}Problem\ L2P\ +\ P2P\ :\ "{}}\ <<\ dataDown[idxPart]\ <<\ \textcolor{stringliteral}{"{},\ "{}}\ <<}
\DoxyCodeLine{00187\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}\ NbPart\ :\ "{}}\ <<\ NbPart\ <<\ \textcolor{stringliteral}{"{},\ "{}}\ <<}
\DoxyCodeLine{00188\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}\ (\ Index\ "{}}\ <<\ octreeIterator.getCurrentGlobalIndex()\ <<\ \textcolor{stringliteral}{"{})\(\backslash\)n"{}};}
\DoxyCodeLine{00189\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00190\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00191\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{while}(octreeIterator.moveRight());}
\DoxyCodeLine{00192\ \ \ \ \ \}}
\DoxyCodeLine{00193\ }
\DoxyCodeLine{00194\ \ \ \ \ std::cout\ <<\ \textcolor{stringliteral}{"{}Done\(\backslash\)n"{}};}
\DoxyCodeLine{00195\ \}}
\DoxyCodeLine{00196\ }
\DoxyCodeLine{00197\ }
\DoxyCodeLine{00198\ }
\DoxyCodeLine{00199\ \textcolor{preprocessor}{\#endif\ }\textcolor{comment}{//FTESTKERNELS\_HPP}}
\DoxyCodeLine{00200\ }
\DoxyCodeLine{00201\ }

\end{DoxyCode}
