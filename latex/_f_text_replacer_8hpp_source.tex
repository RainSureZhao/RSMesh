\doxysection{FText\+Replacer.\+hpp}
\hypertarget{_f_text_replacer_8hpp_source}{}\label{_f_text_replacer_8hpp_source}\index{third\_party/ScalFMM/include/ScalFMM/GroupTree/OpenCl/FTextReplacer.hpp@{third\_party/ScalFMM/include/ScalFMM/GroupTree/OpenCl/FTextReplacer.hpp}}

\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{preprocessor}{\#ifndef\ FTEXTREPLACER\_HPP}}
\DoxyCodeLine{00002\ \textcolor{preprocessor}{\#define\ FTEXTREPLACER\_HPP}}
\DoxyCodeLine{00003\ }
\DoxyCodeLine{00004\ \textcolor{preprocessor}{\#include\ "{}../../Utils/FGlobal.hpp"{}}}
\DoxyCodeLine{00005\ \textcolor{preprocessor}{\#include\ "{}../../Utils/FAssert.hpp"{}}}
\DoxyCodeLine{00006\ }
\DoxyCodeLine{00007\ \textcolor{preprocessor}{\#include\ <sstream>}}
\DoxyCodeLine{00008\ \textcolor{preprocessor}{\#include\ <fstream>}}
\DoxyCodeLine{00009\ \textcolor{preprocessor}{\#include\ <vector>}}
\DoxyCodeLine{00010\ }
\DoxyCodeLine{00011\ \textcolor{preprocessor}{\#include\ <memory>}}
\DoxyCodeLine{00012\ }
\DoxyCodeLine{00013\ \textcolor{preprocessor}{\#include\ <sstream>}}
\DoxyCodeLine{00014\ }
\DoxyCodeLine{00015\ \textcolor{keyword}{class\ }\mbox{\hyperlink{class_f_text_replacer}{FTextReplacer}}\{}
\DoxyCodeLine{00016\ \textcolor{keyword}{protected}:}
\DoxyCodeLine{00017\ \ \ \ \ std::vector<char>\ content;}
\DoxyCodeLine{00018\ }
\DoxyCodeLine{00019\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ replaceCore(\textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\ from,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ keyStr,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\ keyLength,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ valueStr,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\ valueLength)\{}
\DoxyCodeLine{00020\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(keyLength\ ==\ 0)\{}
\DoxyCodeLine{00021\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ content.size();}
\DoxyCodeLine{00022\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00023\ }
\DoxyCodeLine{00024\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ iter\ =\ from;}
\DoxyCodeLine{00025\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{while}(iter\ <\ (content.size()-\/keyLength+1)\ \&\&\ content[iter]\ !=\ keyStr[0])\{}
\DoxyCodeLine{00026\ \ \ \ \ \ \ \ \ \ \ \ \ iter\ +=\ 1;}
\DoxyCodeLine{00027\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00028\ }
\DoxyCodeLine{00029\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(iter\ <\ (content.size()-\/keyLength+1))\{}
\DoxyCodeLine{00030\ \ \ \ \ \ \ \ \ \ \ \ \ FAssertLF(content[iter]\ ==\ keyStr[0]);}
\DoxyCodeLine{00031\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ counter\ =\ 0;}
\DoxyCodeLine{00032\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{while}(counter\ <\ keyLength\ \&\&\ content[iter+counter]\ ==\ keyStr[counter])\{}
\DoxyCodeLine{00033\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ counter\ +=\ 1;}
\DoxyCodeLine{00034\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00035\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(counter\ ==\ keyLength)\{}
\DoxyCodeLine{00036\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Found}}
\DoxyCodeLine{00037\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(keyLength\ <\ valueLength)\{}
\DoxyCodeLine{00038\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\ shift\ =\ valueLength-\/keyLength;}
\DoxyCodeLine{00039\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ content.resize(content.size()\ +\ shift,\ \textcolor{charliteral}{'\(\backslash\)0'});}
\DoxyCodeLine{00040\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t}\ idxCopy\ =\ content.size()-\/1\ ;\ idxCopy\ >=\ iter+shift\ ;\ -\/-\/idxCopy)\{}
\DoxyCodeLine{00041\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ content[idxCopy]\ =\ content[idxCopy-\/shift];}
\DoxyCodeLine{00042\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00043\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00044\ }
\DoxyCodeLine{00045\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Copy\ at\ pos\ iter}}
\DoxyCodeLine{00046\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t}\ idxCopy\ =\ 0\ ;\ idxCopy\ <\ valueLength\ ;\ ++idxCopy)\{}
\DoxyCodeLine{00047\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ content[iter\ +\ idxCopy]\ =\ valueStr[idxCopy];}
\DoxyCodeLine{00048\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00049\ }
\DoxyCodeLine{00050\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ We\ shift\ some\ values}}
\DoxyCodeLine{00051\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(valueLength\ <=\ keyLength)\{}
\DoxyCodeLine{00052\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\ shift\ =\ keyLength-\/valueLength;}
\DoxyCodeLine{00053\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t}\ idxCopy\ =\ iter+valueLength\ ;\ idxCopy\ <\ content.size()-\/shift\ ;\ ++idxCopy)\{}
\DoxyCodeLine{00054\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ content[idxCopy]\ =\ content[idxCopy+shift];}
\DoxyCodeLine{00055\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00056\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ content.resize(content.size()-\/shift);}
\DoxyCodeLine{00057\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00058\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00059\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ iter+1;}
\DoxyCodeLine{00060\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00061\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ content.size();}
\DoxyCodeLine{00062\ \ \ \ \ \}}
\DoxyCodeLine{00063\ }
\DoxyCodeLine{00064\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00065\ \ \ \ \ \mbox{\hyperlink{class_f_text_replacer}{FTextReplacer}}(\textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ inFilename)\{}
\DoxyCodeLine{00066\ \ \ \ \ \ \ \ \ FAssertLF(inFilename);}
\DoxyCodeLine{00067\ \ \ \ \ \ \ \ \ FILE*\ kernelFile\ =\ fopen(inFilename,\ \textcolor{stringliteral}{"{}r"{}});}
\DoxyCodeLine{00068\ \ \ \ \ \ \ \ \ FAssertLF(kernelFile,\ \textcolor{stringliteral}{"{}Cannot\ open\ "{}}\ ,\ inFilename);}
\DoxyCodeLine{00069\ }
\DoxyCodeLine{00070\ \ \ \ \ \ \ \ \ fseek(kernelFile,\ 0,\ SEEK\_END);}
\DoxyCodeLine{00071\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\ kernelFileSize\ =\ ftell(kernelFile);}
\DoxyCodeLine{00072\ }
\DoxyCodeLine{00073\ \ \ \ \ \ \ \ \ content.resize(kernelFileSize+1);}
\DoxyCodeLine{00074\ \ \ \ \ \ \ \ \ content[kernelFileSize]\ =\ \textcolor{charliteral}{'\(\backslash\)0'};}
\DoxyCodeLine{00075\ }
\DoxyCodeLine{00076\ \ \ \ \ \ \ \ \ rewind(kernelFile);}
\DoxyCodeLine{00077\ \ \ \ \ \ \ \ \ FAssertLF(fread(content.data(),\ \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{char}),\ \ kernelFileSize,\ kernelFile)\ ==\ kernelFileSize);}
\DoxyCodeLine{00078\ \ \ \ \ \ \ \ \ fclose(kernelFile);}
\DoxyCodeLine{00079\ \ \ \ \ \}}
\DoxyCodeLine{00080\ }
\DoxyCodeLine{00081\ \ \ \ \ \mbox{\hyperlink{class_f_text_replacer}{FTextReplacer}}(\textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ inData,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\ inLength)\{}
\DoxyCodeLine{00082\ \ \ \ \ \ \ \ \ content.resize(inLength+1);}
\DoxyCodeLine{00083\ \ \ \ \ \ \ \ \ content[inLength]\ =\ \textcolor{charliteral}{'\(\backslash\)0'};}
\DoxyCodeLine{00084\ \ \ \ \ \ \ \ \ memcpy(content.data(),\ inData,\ inLength);}
\DoxyCodeLine{00085\ \ \ \ \ \}}
\DoxyCodeLine{00086\ }
\DoxyCodeLine{00087\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ getLength()\textcolor{keyword}{\ const}\{}
\DoxyCodeLine{00088\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ content.size();}
\DoxyCodeLine{00089\ \ \ \ \ \}}
\DoxyCodeLine{00090\ }
\DoxyCodeLine{00091\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ getContent()\textcolor{keyword}{\ const}\{}
\DoxyCodeLine{00092\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ content.data();}
\DoxyCodeLine{00093\ \ \ \ \ \}}
\DoxyCodeLine{00094\ }
\DoxyCodeLine{00095\ \ \ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{class}\ ValueClass>}
\DoxyCodeLine{00096\ \ \ \ \ \textcolor{keywordtype}{int}\ replaceAll(\textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ keyStr,\ \textcolor{keyword}{const}\ ValueClass\&\ value)\{}
\DoxyCodeLine{00097\ \ \ \ \ \ \ \ \ std::ostringstream\ stream;}
\DoxyCodeLine{00098\ \ \ \ \ \ \ \ \ stream\ <<\ value;}
\DoxyCodeLine{00099\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::string\ streamStr\ =\ stream.str();}
\DoxyCodeLine{00100\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ valueStr\ =\ streamStr.c\_str();}
\DoxyCodeLine{00101\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\ valueLength\ =\ streamStr.size();}
\DoxyCodeLine{00102\ }
\DoxyCodeLine{00103\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\ keyLength\ =\ strlen(keyStr);}
\DoxyCodeLine{00104\ }
\DoxyCodeLine{00105\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ counterOccurence\ =\ 0;}
\DoxyCodeLine{00106\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ from\ =\ 0;}
\DoxyCodeLine{00107\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{while}((from\ =\ replaceCore(from,\ keyStr,\ keyLength,\ valueStr,\ valueLength))\ !=\ content.size())\{}
\DoxyCodeLine{00108\ \ \ \ \ \ \ \ \ \ \ \ \ counterOccurence\ +=\ 1;}
\DoxyCodeLine{00109\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00110\ }
\DoxyCodeLine{00111\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ counterOccurence;}
\DoxyCodeLine{00112\ \ \ \ \ \}}
\DoxyCodeLine{00113\ }
\DoxyCodeLine{00114\ \ \ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{class}\ ValueClass>}
\DoxyCodeLine{00115\ \ \ \ \ \textcolor{keywordtype}{bool}\ replaceOne(\textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ keyStr,\ \textcolor{keyword}{const}\ ValueClass\&\ value)\{}
\DoxyCodeLine{00116\ \ \ \ \ \ \ \ \ std::ostringstream\ stream;}
\DoxyCodeLine{00117\ \ \ \ \ \ \ \ \ stream\ <<\ value;}
\DoxyCodeLine{00118\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::string\ streamStr\ =\ stream.str();}
\DoxyCodeLine{00119\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ valueStr\ =\ streamStr.c\_str();}
\DoxyCodeLine{00120\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\ valueLength\ =\ streamStr.size();}
\DoxyCodeLine{00121\ }
\DoxyCodeLine{00122\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ replaceCore(0,\ keyStr,\ strlen(keyStr),\ valueStr,\ valueLength)\ !=\ content.size();}
\DoxyCodeLine{00123\ \ \ \ \ \}}
\DoxyCodeLine{00124\ }
\DoxyCodeLine{00125\ \ \ \ \ \textcolor{keywordtype}{void}\ clear()\{}
\DoxyCodeLine{00126\ \ \ \ \ \ \ \ \ content.clear();}
\DoxyCodeLine{00127\ \ \ \ \ \}}
\DoxyCodeLine{00128\ \};}
\DoxyCodeLine{00129\ }
\DoxyCodeLine{00130\ \textcolor{preprocessor}{\#endif\ }\textcolor{comment}{//\ FTEXTREPLACER\_HPP}}
\DoxyCodeLine{00131\ }

\end{DoxyCode}
