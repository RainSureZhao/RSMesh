\doxysection{FTree\+Coordinate.\+hpp}
\hypertarget{_f_tree_coordinate_8hpp_source}{}\label{_f_tree_coordinate_8hpp_source}\index{third\_party/ScalFMM/include/ScalFMM/Containers/FTreeCoordinate.hpp@{third\_party/ScalFMM/include/ScalFMM/Containers/FTreeCoordinate.hpp}}

\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{comment}{//\ See\ LICENCE\ file\ at\ project\ root}}
\DoxyCodeLine{00002\ \textcolor{preprocessor}{\#ifndef\ FTREECOORDINATE\_HPP}}
\DoxyCodeLine{00003\ \textcolor{preprocessor}{\#define\ FTREECOORDINATE\_HPP}}
\DoxyCodeLine{00004\ }
\DoxyCodeLine{00005\ \textcolor{preprocessor}{\#include\ <string>}}
\DoxyCodeLine{00006\ }
\DoxyCodeLine{00007\ \textcolor{preprocessor}{\#include\ "{}../Utils/FGlobal.hpp"{}}}
\DoxyCodeLine{00008\ \textcolor{preprocessor}{\#include\ "{}../Utils/FPoint.hpp"{}}}
\DoxyCodeLine{00009\ \textcolor{preprocessor}{\#include\ "{}../Utils/FMath.hpp"{}}}
\DoxyCodeLine{00010\ }
\DoxyCodeLine{00011\ \textcolor{preprocessor}{\#include\ "{}../Components/FAbstractSerializable.hpp"{}}}
\DoxyCodeLine{00012\ }
\DoxyCodeLine{00023\ \textcolor{keyword}{class\ }\mbox{\hyperlink{class_f_tree_coordinate}{FTreeCoordinate}}\ :\ \textcolor{keyword}{public}\ \mbox{\hyperlink{class_f_abstract_serializable}{FAbstractSerializable}},\ \textcolor{keyword}{public}\ \mbox{\hyperlink{class_f_point}{FPoint}}<int,\ 3>\ \{}
\DoxyCodeLine{00024\ \textcolor{keyword}{private}:}
\DoxyCodeLine{00025\ \ \ \textcolor{keyword}{using\ }\mbox{\hyperlink{class_f_point}{point\_t}}\ =\ \mbox{\hyperlink{class_f_point}{FPoint<int,\ 3>}};}
\DoxyCodeLine{00026\ \ \ \ \ \textcolor{keyword}{enum}\ \{Dim\ =\ \mbox{\hyperlink{class_f_point_abe59cd35d83418f915eea5fcebab4a77}{point\_t::Dim}}\};}
\DoxyCodeLine{00027\ }
\DoxyCodeLine{00028\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00030\ \ \ \ \ \mbox{\hyperlink{class_f_tree_coordinate_a136eb96055cb8625db2b2162db539645}{FTreeCoordinate}}():\ \mbox{\hyperlink{class_f_point}{point\_t}}()\ \{\}}
\DoxyCodeLine{00031\ }
\DoxyCodeLine{00033\ \ \ \ \ [[deprecated]]}
\DoxyCodeLine{00034\ \ \ \ \ \textcolor{keyword}{explicit}\ \mbox{\hyperlink{class_f_tree_coordinate_acc375a8eb2f3dabe677884a68b3d8e8e}{FTreeCoordinate}}(\textcolor{keyword}{const}\ MortonIndex\ mindex,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int})\ \{}
\DoxyCodeLine{00035\ \ \ \ \ \ \ \ \ setPositionFromMorton(mindex);}
\DoxyCodeLine{00036\ \ \ \ \ \}}
\DoxyCodeLine{00037\ }
\DoxyCodeLine{00038\ \ \ \ \ \textcolor{keyword}{explicit}\ \mbox{\hyperlink{class_f_tree_coordinate_a136eb96055cb8625db2b2162db539645}{FTreeCoordinate}}(\textcolor{keyword}{const}\ MortonIndex\ mindex)\ \{}
\DoxyCodeLine{00039\ \ \ \ \ \ \ \ \ setPositionFromMorton(mindex);}
\DoxyCodeLine{00040\ \ \ \ \ \}}
\DoxyCodeLine{00041\ }
\DoxyCodeLine{00047\ \ \ \ \ \textcolor{keyword}{explicit}\ \mbox{\hyperlink{class_f_tree_coordinate_a4a628378f0dfb37a0fe678edcf10acfa}{FTreeCoordinate}}(\textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ inX,\textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ inY,\textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ inZ)}
\DoxyCodeLine{00048\ \ \ \ \ \ \ \ \ :\ \mbox{\hyperlink{class_f_point}{point\_t}}(inX,\ inY,\ inZ)}
\DoxyCodeLine{00049\ \ \ \ \ \{\}}
\DoxyCodeLine{00050\ }
\DoxyCodeLine{00051\ \ \ \ \ \textcolor{keyword}{explicit}\ \mbox{\hyperlink{class_f_tree_coordinate_a136eb96055cb8625db2b2162db539645}{FTreeCoordinate}}(\textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ inPosition[3])}
\DoxyCodeLine{00052\ \ \ \ \ \ \ \ \ :\ point\_t(inPosition)}
\DoxyCodeLine{00053\ \ \ \ \ \{\}}
\DoxyCodeLine{00054\ }
\DoxyCodeLine{00058\ \ \ \ \ \textcolor{keyword}{using\ }point\_t::point\_t;}
\DoxyCodeLine{00059\ }
\DoxyCodeLine{00063\ \ \ \ \ \mbox{\hyperlink{class_f_tree_coordinate_a182c4539141f527ff08ca78068936d22}{FTreeCoordinate}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{class_f_tree_coordinate}{FTreeCoordinate}}\&)\ =\ \textcolor{keywordflow}{default};}
\DoxyCodeLine{00064\ }
\DoxyCodeLine{00068\ \ \ \ \ \mbox{\hyperlink{class_f_tree_coordinate_accfd93b15bd50ebfe9c6ce9ff770f234}{FTreeCoordinate}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{class_f_tree_coordinate}{FTreeCoordinate}}\&\ other,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ inOffset)}
\DoxyCodeLine{00069\ \ \ \ \ \ \ \ \ :\ \mbox{\hyperlink{class_f_point}{point\_t}}(other,\ inOffset)}
\DoxyCodeLine{00070\ \ \ \ \ \{\}}
\DoxyCodeLine{00071\ }
\DoxyCodeLine{00077\ \ \ \ \ \mbox{\hyperlink{class_f_tree_coordinate}{FTreeCoordinate}}\&\ \mbox{\hyperlink{class_f_tree_coordinate_ac1ebee695f45468451103ddf10fdebc8}{operator=}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{class_f_tree_coordinate}{FTreeCoordinate}}\&\ other)\ =\ \textcolor{keywordflow}{default};}
\DoxyCodeLine{00078\ }
\DoxyCodeLine{00079\ \ \ \ \ [[deprecated]]}
\DoxyCodeLine{00080\ \ \ \ \ MortonIndex\ \mbox{\hyperlink{class_f_tree_coordinate_acd2c7d85437956a144a48c69b61d7e70}{getMortonIndex}}(\textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ \textcolor{comment}{/*inLevel*/})\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00081\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{class_f_tree_coordinate_acd2c7d85437956a144a48c69b61d7e70}{getMortonIndex}}();}
\DoxyCodeLine{00082\ \ \ \ \ \}}
\DoxyCodeLine{00083\ }
\DoxyCodeLine{00084\ }
\DoxyCodeLine{00091\ \ \ \ \ MortonIndex\ \mbox{\hyperlink{class_f_tree_coordinate_acd2c7d85437956a144a48c69b61d7e70}{getMortonIndex}}()\textcolor{keyword}{\ const}\{}
\DoxyCodeLine{00092\ \ \ \ \ \ \ \ \ MortonIndex\ index\ =\ 0x0LL;}
\DoxyCodeLine{00093\ \ \ \ \ \ \ \ \ MortonIndex\ mask\ =\ 0x1LL;}
\DoxyCodeLine{00094\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ the\ order\ is\ xyz.xyz...}}
\DoxyCodeLine{00095\ \ \ \ \ \ \ \ \ MortonIndex\ mx\ =\ point\_t::data()[0]\ <<\ 2;}
\DoxyCodeLine{00096\ \ \ \ \ \ \ \ \ MortonIndex\ my\ =\ point\_t::data()[1]\ <<\ 1;}
\DoxyCodeLine{00097\ \ \ \ \ \ \ \ \ MortonIndex\ mz\ =\ point\_t::data()[2];}
\DoxyCodeLine{00098\ }
\DoxyCodeLine{00099\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{while}(\ (mask\ <=\ mz)}
\DoxyCodeLine{00100\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ||\ ((mask\ <<\ 1)\ <=\ my)}
\DoxyCodeLine{00101\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ||\ ((mask\ <<\ 2)\ <=\ mx))}
\DoxyCodeLine{00102\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00103\ \ \ \ \ \ \ \ \ \ \ \ \ index\ |=\ (mz\ \&\ mask);}
\DoxyCodeLine{00104\ \ \ \ \ \ \ \ \ \ \ \ \ mask\ <<=\ 1;}
\DoxyCodeLine{00105\ \ \ \ \ \ \ \ \ \ \ \ \ index\ |=\ (my\ \&\ mask);}
\DoxyCodeLine{00106\ \ \ \ \ \ \ \ \ \ \ \ \ mask\ <<=\ 1;}
\DoxyCodeLine{00107\ \ \ \ \ \ \ \ \ \ \ \ \ index\ |=\ (mx\ \&\ mask);}
\DoxyCodeLine{00108\ \ \ \ \ \ \ \ \ \ \ \ \ mask\ <<=\ 1;}
\DoxyCodeLine{00109\ }
\DoxyCodeLine{00110\ \ \ \ \ \ \ \ \ \ \ \ \ mz\ <<=\ 2;}
\DoxyCodeLine{00111\ \ \ \ \ \ \ \ \ \ \ \ \ my\ <<=\ 2;}
\DoxyCodeLine{00112\ \ \ \ \ \ \ \ \ \ \ \ \ mx\ <<=\ 2;}
\DoxyCodeLine{00113\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00114\ }
\DoxyCodeLine{00115\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ index;}
\DoxyCodeLine{00116\ \ \ \ \ \}}
\DoxyCodeLine{00117\ }
\DoxyCodeLine{00118\ \ \ \ \ [[deprecated]]}
\DoxyCodeLine{00119\ \ \ \ \ \textcolor{keywordtype}{void}\ setPositionFromMorton(MortonIndex\ inIndex,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ \textcolor{comment}{/*inLevel*/})\{}
\DoxyCodeLine{00120\ \ \ \ \ \ \ \ \ setPositionFromMorton(inIndex);}
\DoxyCodeLine{00121\ \ \ \ \ \}}
\DoxyCodeLine{00122\ }
\DoxyCodeLine{00126\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_f_tree_coordinate_a509a4cfe3a372efbcc50643c5b02a561}{setPositionFromMorton}}(MortonIndex\ inIndex)\ \{}
\DoxyCodeLine{00127\ \ \ \ \ \ \ \ \ MortonIndex\ mask\ =\ 0x1LL;}
\DoxyCodeLine{00128\ }
\DoxyCodeLine{00129\ \ \ \ \ \ \ \ \ point\_t::data()[0]\ =\ 0;}
\DoxyCodeLine{00130\ \ \ \ \ \ \ \ \ point\_t::data()[1]\ =\ 0;}
\DoxyCodeLine{00131\ \ \ \ \ \ \ \ \ point\_t::data()[2]\ =\ 0;}
\DoxyCodeLine{00132\ }
\DoxyCodeLine{00133\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{while}(inIndex\ >=\ mask)\ \{}
\DoxyCodeLine{00134\ \ \ \ \ \ \ \ \ \ \ \ \ point\_t::data()[2]\ |=\ int(inIndex\ \&\ mask);}
\DoxyCodeLine{00135\ \ \ \ \ \ \ \ \ \ \ \ \ inIndex\ >>=\ 1;}
\DoxyCodeLine{00136\ \ \ \ \ \ \ \ \ \ \ \ \ point\_t::data()[1]\ |=\ int(inIndex\ \&\ mask);}
\DoxyCodeLine{00137\ \ \ \ \ \ \ \ \ \ \ \ \ inIndex\ >>=\ 1;}
\DoxyCodeLine{00138\ \ \ \ \ \ \ \ \ \ \ \ \ point\_t::data()[0]\ |=\ int(inIndex\ \&\ mask);}
\DoxyCodeLine{00139\ }
\DoxyCodeLine{00140\ \ \ \ \ \ \ \ \ \ \ \ \ mask\ <<=\ 1;}
\DoxyCodeLine{00141\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00142\ \ \ \ \ \}}
\DoxyCodeLine{00143\ }
\DoxyCodeLine{00144\ }
\DoxyCodeLine{00149\ \ \ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{class_f_tree_coordinate_a33130628f5d3942da43f0de52fd9fdf8}{equals}}(\textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ inX,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ inY,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ inZ)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00150\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ point\_t::data()[0]\ ==\ inX}
\DoxyCodeLine{00151\ \ \ \ \ \ \ \ \ \ \ \ \ \&\&\ point\_t::data()[1]\ ==\ inY}
\DoxyCodeLine{00152\ \ \ \ \ \ \ \ \ \ \ \ \ \&\&\ point\_t::data()[2]\ ==\ inZ;}
\DoxyCodeLine{00153\ \ \ \ \ \}}
\DoxyCodeLine{00154\ }
\DoxyCodeLine{00156\ \ \ \ \ \textcolor{keyword}{using\ }\mbox{\hyperlink{class_f_point_a6937a56faa6b1c735c541f465e233faa}{point\_t::save}};}
\DoxyCodeLine{00158\ \ \ \ \ \textcolor{keyword}{using\ }\mbox{\hyperlink{class_f_point_aee1d5c3459851e223a069956511e96b2}{point\_t::restore}};}
\DoxyCodeLine{00159\ }
\DoxyCodeLine{00160\ }
\DoxyCodeLine{00162\ \ \ \ \ FSize\ \mbox{\hyperlink{class_f_tree_coordinate_a7b36ce7fc354a3489db59d2a8889c054}{getSavedSize}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00163\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ FSize(3\ *\ \textcolor{keyword}{sizeof}(point\_t::data()[0]));}
\DoxyCodeLine{00164\ \ \ \ \ \}}
\DoxyCodeLine{00165\ }
\DoxyCodeLine{00166\ }
\DoxyCodeLine{00167\ \ \ \ \ \textcolor{keyword}{static}\ std::string\ MortonToBinary(MortonIndex\ index,\ \textcolor{keywordtype}{int}\ level)\{}
\DoxyCodeLine{00168\ \ \ \ \ \ \ \ \ std::string\ str;}
\DoxyCodeLine{00169\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ bits\ =\ 1\ <<\ ((level\ *\ 3)\ -\/\ 1);}
\DoxyCodeLine{00170\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ dim\ =\ 0;}
\DoxyCodeLine{00171\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{while}(bits)\{}
\DoxyCodeLine{00172\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(index\ \&\ bits)\ str.append(\textcolor{stringliteral}{"{}1"{}});}
\DoxyCodeLine{00173\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ str.append(\textcolor{stringliteral}{"{}0"{}});}
\DoxyCodeLine{00174\ \ \ \ \ \ \ \ \ \ \ \ \ bits\ >>=\ 1;}
\DoxyCodeLine{00175\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ we\ put\ a\ dot\ each\ 3\ values}}
\DoxyCodeLine{00176\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(++dim\ ==\ 3)\{}
\DoxyCodeLine{00177\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ str.append(\textcolor{stringliteral}{"{}."{}});}
\DoxyCodeLine{00178\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ dim\ =\ 0;}
\DoxyCodeLine{00179\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00180\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00181\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ str;}
\DoxyCodeLine{00182\ \ \ \ \ \}}
\DoxyCodeLine{00183\ }
\DoxyCodeLine{00189\ \ \ \ \ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{class_f_tree_coordinate_ac74ca299cacd624e1aca5b49e4b62709}{getNeighborsIndexes}}(\textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ OctreeHeight,\ MortonIndex\ indexes[26],\ \textcolor{keywordtype}{int}*\ indexInArray\ =\ \textcolor{keyword}{nullptr})\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00190\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ idxNeig\ =\ 0;}
\DoxyCodeLine{00191\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ limite\ =\ 1\ <<\ (OctreeHeight\ -\/\ 1);}
\DoxyCodeLine{00192\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ We\ test\ all\ cells\ around}}
\DoxyCodeLine{00193\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ idxX\ =\ -\/1\ ;\ idxX\ <=\ 1\ ;\ ++idxX)\{}
\DoxyCodeLine{00194\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(!\mbox{\hyperlink{struct_f_math_a0937a75e6690b78c54e1ea7a07530a81}{FMath::Between}}(this-\/>\mbox{\hyperlink{class_f_point_a58d3859160347552d6a4a94fbdf883c3}{getX}}()\ +\ idxX,0,\ limite))\ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{00195\ }
\DoxyCodeLine{00196\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ idxY\ =\ -\/1\ ;\ idxY\ <=\ 1\ ;\ ++idxY)\{}
\DoxyCodeLine{00197\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(!\mbox{\hyperlink{struct_f_math_a0937a75e6690b78c54e1ea7a07530a81}{FMath::Between}}(this-\/>\mbox{\hyperlink{class_f_point_ae4383512b9b8d216775b3fb92325cfc9}{getY}}()\ +\ idxY,0,\ limite))\ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{00198\ }
\DoxyCodeLine{00199\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ idxZ\ =\ -\/1\ ;\ idxZ\ <=\ 1\ ;\ ++idxZ)\{}
\DoxyCodeLine{00200\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(!\mbox{\hyperlink{struct_f_math_a0937a75e6690b78c54e1ea7a07530a81}{FMath::Between}}(this-\/>\mbox{\hyperlink{class_f_point_a02208d4db50cbafe597adcbfb152b536}{getZ}}()\ +\ idxZ,0,\ limite))\ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{00201\ }
\DoxyCodeLine{00202\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ if\ we\ are\ not\ on\ the\ current\ cell}}
\DoxyCodeLine{00203\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\ idxX\ ||\ idxY\ ||\ idxZ\ )\{}
\DoxyCodeLine{00204\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_f_tree_coordinate}{FTreeCoordinate}}\ other(this-\/>\mbox{\hyperlink{class_f_point_a58d3859160347552d6a4a94fbdf883c3}{getX}}()\ +\ idxX,\ this-\/>\mbox{\hyperlink{class_f_point_ae4383512b9b8d216775b3fb92325cfc9}{getY}}()\ +\ idxY,\ this-\/>\mbox{\hyperlink{class_f_point_a02208d4db50cbafe597adcbfb152b536}{getZ}}()\ +\ idxZ);}
\DoxyCodeLine{00205\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ indexes[\ idxNeig\ ]\ =\ other.getMortonIndex();}
\DoxyCodeLine{00206\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(indexInArray)}
\DoxyCodeLine{00207\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ indexInArray[\ idxNeig\ ]\ =\ ((idxX+1)*3\ +\ (idxY+1))\ *\ 3\ +\ (idxZ+1);}
\DoxyCodeLine{00208\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ++idxNeig;}
\DoxyCodeLine{00209\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00210\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00211\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00212\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00213\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ idxNeig;}
\DoxyCodeLine{00214\ \ \ \ \ \}}
\DoxyCodeLine{00215\ }
\DoxyCodeLine{00219\ \ \ \ \ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{class_f_tree_coordinate_ad9a4eeadc6666916ebfb35fa9f794abd}{getInteractionNeighbors}}(\textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ inLevel,\ MortonIndex\ inNeighbors[\textcolor{comment}{/*189+26+1*/}216],\ \textcolor{keywordtype}{int}*\ inNeighborsPosition,}
\DoxyCodeLine{00220\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ neighSeparation\ =\ 1)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00221\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Then\ take\ each\ child\ of\ the\ parent's\ neighbors\ if\ not\ in\ directNeighbors}}
\DoxyCodeLine{00222\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Father\ coordinate}}
\DoxyCodeLine{00223\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_f_tree_coordinate}{FTreeCoordinate}}\ parentCell(this-\/>\mbox{\hyperlink{class_f_point_a58d3859160347552d6a4a94fbdf883c3}{getX}}()>>1,this-\/>\mbox{\hyperlink{class_f_point_ae4383512b9b8d216775b3fb92325cfc9}{getY}}()>>1,this-\/>\mbox{\hyperlink{class_f_point_a02208d4db50cbafe597adcbfb152b536}{getZ}}()>>1);}
\DoxyCodeLine{00224\ }
\DoxyCodeLine{00225\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Limite\ at\ parent\ level\ number\ of\ box\ (split\ by\ 2\ by\ level)}}
\DoxyCodeLine{00226\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ limite\ =\ \mbox{\hyperlink{struct_f_math_a26cf6a39b9dd3fb24bb8acafa55a321e}{FMath::pow2}}(inLevel-\/1);}
\DoxyCodeLine{00227\ }
\DoxyCodeLine{00228\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ idxNeighbors\ =\ 0;}
\DoxyCodeLine{00229\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ We\ test\ all\ cells\ around}}
\DoxyCodeLine{00230\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ idxX\ =\ -\/1\ ;\ idxX\ <=\ 1\ ;\ ++idxX)\{}
\DoxyCodeLine{00231\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(!\mbox{\hyperlink{struct_f_math_a0937a75e6690b78c54e1ea7a07530a81}{FMath::Between}}(parentCell.\mbox{\hyperlink{class_f_point_a58d3859160347552d6a4a94fbdf883c3}{getX}}()\ +\ idxX,0,limite))\ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{00232\ }
\DoxyCodeLine{00233\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ idxY\ =\ -\/1\ ;\ idxY\ <=\ 1\ ;\ ++idxY)\{}
\DoxyCodeLine{00234\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(!\mbox{\hyperlink{struct_f_math_a0937a75e6690b78c54e1ea7a07530a81}{FMath::Between}}(parentCell.\mbox{\hyperlink{class_f_point_ae4383512b9b8d216775b3fb92325cfc9}{getY}}()\ +\ idxY,0,limite))\ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{00235\ }
\DoxyCodeLine{00236\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ idxZ\ =\ -\/1\ ;\ idxZ\ <=\ 1\ ;\ ++idxZ)\{}
\DoxyCodeLine{00237\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(!\mbox{\hyperlink{struct_f_math_a0937a75e6690b78c54e1ea7a07530a81}{FMath::Between}}(parentCell.\mbox{\hyperlink{class_f_point_a02208d4db50cbafe597adcbfb152b536}{getZ}}()\ +\ idxZ,0,limite))\ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{00238\ }
\DoxyCodeLine{00239\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ if\ we\ are\ not\ on\ the\ current\ cell}}
\DoxyCodeLine{00240\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(neighSeparation<1\ ||\ idxX\ ||\ idxY\ ||\ idxZ\ )\{}
\DoxyCodeLine{00241\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_f_tree_coordinate}{FTreeCoordinate}}\ otherParent(parentCell.\mbox{\hyperlink{class_f_point_a58d3859160347552d6a4a94fbdf883c3}{getX}}()\ +\ idxX,parentCell.\mbox{\hyperlink{class_f_point_ae4383512b9b8d216775b3fb92325cfc9}{getY}}()\ +\ idxY,parentCell.\mbox{\hyperlink{class_f_point_a02208d4db50cbafe597adcbfb152b536}{getZ}}()\ +\ idxZ);}
\DoxyCodeLine{00242\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ MortonIndex\ mortonOther\ =\ otherParent.getMortonIndex();}
\DoxyCodeLine{00243\ }
\DoxyCodeLine{00244\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ For\ each\ child}}
\DoxyCodeLine{00245\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ idxCousin\ =\ 0\ ;\ idxCousin\ <\ 8\ ;\ ++idxCousin)\{}
\DoxyCodeLine{00246\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ xdiff\ \ =\ ((otherParent.\mbox{\hyperlink{class_f_point_a58d3859160347552d6a4a94fbdf883c3}{getX}}()<<1)\ |\ (\ (idxCousin>>2)\ \&\ 1))\ -\/\ this-\/>\mbox{\hyperlink{class_f_point_a58d3859160347552d6a4a94fbdf883c3}{getX}}();}
\DoxyCodeLine{00247\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ ydiff\ \ =\ ((otherParent.\mbox{\hyperlink{class_f_point_ae4383512b9b8d216775b3fb92325cfc9}{getY}}()<<1)\ |\ (\ (idxCousin>>1)\ \&\ 1))\ -\/\ this-\/>\mbox{\hyperlink{class_f_point_ae4383512b9b8d216775b3fb92325cfc9}{getY}}();}
\DoxyCodeLine{00248\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ zdiff\ \ =\ ((otherParent.\mbox{\hyperlink{class_f_point_a02208d4db50cbafe597adcbfb152b536}{getZ}}()<<1)\ |\ (idxCousin\&1))\ -\/\ this-\/>\mbox{\hyperlink{class_f_point_a02208d4db50cbafe597adcbfb152b536}{getZ}}();}
\DoxyCodeLine{00249\ }
\DoxyCodeLine{00250\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Test\ if\ it\ is\ a\ direct\ neighbor}}
\DoxyCodeLine{00251\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{struct_f_math_ac005cd270abc850853ba71d1e38a2f28}{FMath::Abs}}(xdiff)\ >\ neighSeparation\ ||\ \mbox{\hyperlink{struct_f_math_ac005cd270abc850853ba71d1e38a2f28}{FMath::Abs}}(ydiff)\ >\ neighSeparation\ ||\ \mbox{\hyperlink{struct_f_math_ac005cd270abc850853ba71d1e38a2f28}{FMath::Abs}}(zdiff)\ >\ neighSeparation)\{}
\DoxyCodeLine{00252\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ add\ to\ neighbors}}
\DoxyCodeLine{00253\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(inNeighborsPosition)}
\DoxyCodeLine{00254\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ inNeighborsPosition[idxNeighbors]\ =\ (((\ (xdiff+3)\ *\ 7)\ +\ (ydiff+3)))\ *\ 7\ +\ zdiff\ +\ 3;}
\DoxyCodeLine{00255\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ inNeighbors[idxNeighbors++]\ =\ (mortonOther\ <<\ 3)\ |\ idxCousin;}
\DoxyCodeLine{00256\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00257\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00258\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00259\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00260\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00261\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00262\ }
\DoxyCodeLine{00263\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ idxNeighbors;}
\DoxyCodeLine{00264\ \ \ \ \ \}}
\DoxyCodeLine{00265\ }
\DoxyCodeLine{00266\ \ \ \ \ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{class_f_tree_coordinate_ad9a4eeadc6666916ebfb35fa9f794abd}{getInteractionNeighbors}}(\textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ inLevel,\ MortonIndex\ inNeighbors[\textcolor{comment}{/*189+26+1*/}216],\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ neighSeparation\ =\ 1)\textcolor{keyword}{\ const}\{}
\DoxyCodeLine{00267\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{class_f_tree_coordinate_ad9a4eeadc6666916ebfb35fa9f794abd}{getInteractionNeighbors}}(inLevel,\ inNeighbors,\ \textcolor{keyword}{nullptr},\ neighSeparation);}
\DoxyCodeLine{00268\ \ \ \ \ \}}
\DoxyCodeLine{00269\ }
\DoxyCodeLine{00270\ \};}
\DoxyCodeLine{00271\ }
\DoxyCodeLine{00272\ }
\DoxyCodeLine{00273\ }
\DoxyCodeLine{00274\ \textcolor{preprocessor}{\#endif\ }\textcolor{comment}{//FTREECOORDINATE\_HPP}}

\end{DoxyCode}
