\doxysection{FUnif\+Tensor.\+hpp}
\hypertarget{_f_unif_tensor_8hpp_source}{}\label{_f_unif_tensor_8hpp_source}\index{third\_party/ScalFMM/include/ScalFMM/Kernels/Uniform/FUnifTensor.hpp@{third\_party/ScalFMM/include/ScalFMM/Kernels/Uniform/FUnifTensor.hpp}}

\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{comment}{//\ See\ LICENCE\ file\ at\ project\ root}}
\DoxyCodeLine{00002\ \textcolor{comment}{//\ Keep\ in\ private\ GIT}}
\DoxyCodeLine{00003\ }
\DoxyCodeLine{00004\ \textcolor{preprocessor}{\#ifndef\ FUNIFTENSOR\_HPP}}
\DoxyCodeLine{00005\ \textcolor{preprocessor}{\#define\ FUNIFTENSOR\_HPP}}
\DoxyCodeLine{00006\ }
\DoxyCodeLine{00007\ \textcolor{preprocessor}{\#include\ "{}../../Utils/FMath.hpp"{}}}
\DoxyCodeLine{00008\ }
\DoxyCodeLine{00009\ \textcolor{preprocessor}{\#include\ "{}FUnifRoots.hpp"{}}}
\DoxyCodeLine{00010\ \textcolor{preprocessor}{\#include\ "{}../Interpolation/FInterpTensor.hpp"{}}}
\DoxyCodeLine{00011\ }
\DoxyCodeLine{00012\ }
\DoxyCodeLine{00028\ \textcolor{keyword}{template}\ <\textcolor{keyword}{class}\ FReal,\ \textcolor{keywordtype}{int}\ ORDER>}
\DoxyCodeLine{00029\ \textcolor{keyword}{class\ }\mbox{\hyperlink{class_f_unif_tensor}{FUnifTensor}}\ :\ \textcolor{keyword}{public}\ \mbox{\hyperlink{class_f_interp_tensor}{FInterpTensor}}<FReal,\ ORDER,FUnifRoots<FReal,\ ORDER>>}
\DoxyCodeLine{00030\ \{}
\DoxyCodeLine{00031\ \ \ \textcolor{keyword}{enum}\ \{nnodes\ =\ \mbox{\hyperlink{struct_tensor_traits}{TensorTraits<ORDER>::nnodes}},}
\DoxyCodeLine{00032\ \ \ \ \ \ \ \ \ rc\ =\ (2*ORDER-\/1)*(2*ORDER-\/1)*(2*ORDER-\/1)\};}
\DoxyCodeLine{00033\ \ \ \textcolor{keyword}{typedef}\ \mbox{\hyperlink{struct_f_unif_roots}{FUnifRoots<FReal,\ ORDER>}}\ \mbox{\hyperlink{struct_f_unif_roots}{BasisType}};}
\DoxyCodeLine{00034\ \ \ \textcolor{keyword}{typedef}\ \mbox{\hyperlink{class_f_interp_tensor}{FInterpTensor<FReal,\ ORDER,BasisType>}}\ \mbox{\hyperlink{class_f_interp_tensor}{ParentTensor}};}
\DoxyCodeLine{00035\ }
\DoxyCodeLine{00036\ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00037\ }
\DoxyCodeLine{00044\ \ \ \textcolor{keyword}{static}}
\DoxyCodeLine{00045\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_f_unif_tensor_a5242f43bc511dd8023be149812cad075}{setNodeIdsDiff}}(\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ NodeIdsDiff[nnodes*nnodes])}
\DoxyCodeLine{00046\ \ \ \{}
\DoxyCodeLine{00047\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ node\_ids[nnodes][3];}
\DoxyCodeLine{00048\ \ \ \ \ \mbox{\hyperlink{class_f_interp_tensor_aeecba74045a1cd16382c87ab3acdb20a}{ParentTensor::setNodeIds}}(node\_ids);}
\DoxyCodeLine{00049\ }
\DoxyCodeLine{00050\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ i=0;\ i<nnodes;\ ++i)\ \{}
\DoxyCodeLine{00051\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ j=0;\ j<nnodes;\ ++j)\ \{}
\DoxyCodeLine{00052\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ 0\ <=\ id\ <\ 2*ORDER-\/1}}
\DoxyCodeLine{00053\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ idl\ =\ node\_ids[i][0]-\/node\_ids[j][0]+ORDER-\/1;}
\DoxyCodeLine{00054\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ idm\ =\ node\_ids[i][1]-\/node\_ids[j][1]+ORDER-\/1;}
\DoxyCodeLine{00055\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ idn\ =\ node\_ids[i][2]-\/node\_ids[j][2]+ORDER-\/1;}
\DoxyCodeLine{00056\ \ \ \ \ \ \ \ \ NodeIdsDiff[i*nnodes+j]}
\DoxyCodeLine{00057\ \ \ \ \ \ \ \ \ \ \ =\ idn*(2*ORDER-\/1)*(2*ORDER-\/1)\ +\ idm*(2*ORDER-\/1)\ +\ idl;}
\DoxyCodeLine{00058\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00059\ \ \ \ \ \}}
\DoxyCodeLine{00060\ \ \ \}}
\DoxyCodeLine{00061\ }
\DoxyCodeLine{00067\ \ \ \textcolor{keyword}{static}}
\DoxyCodeLine{00068\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_f_unif_tensor_a745acb767f651c86d54ac71a7985bb12}{setNodeIdsPairs}}(\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ NodeIdsPairs[rc][2])}
\DoxyCodeLine{00069\ \ \ \{}
\DoxyCodeLine{00070\ }
\DoxyCodeLine{00071\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ li,lj,mi,mj,ni,nj;}
\DoxyCodeLine{00072\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ ido=0;}
\DoxyCodeLine{00073\ }
\DoxyCodeLine{00074\ \ \ \ \ \textcolor{comment}{//\ If\ the\ diff\ i-\/j\ between\ indices\ is\ <0\ (i.e.\ positive\ counter\ <\ ORDER-\/1)}}
\DoxyCodeLine{00075\ \ \ \ \ \textcolor{comment}{//\ then\ source\ index\ is\ ORDER-\/1\ }}
\DoxyCodeLine{00076\ \ \ \ \ \textcolor{comment}{//\ else\ it\ is\ the\ first}}
\DoxyCodeLine{00077\ \ \ \ \ \textcolor{comment}{//\ we\ deduce\ the\ target\ index\ by\ simply\ considering\ i-\/j=counter-\/(ORDER-\/1)\ }}
\DoxyCodeLine{00078\ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ l=0;\ l<2*ORDER-\/1;\ ++l)\{}
\DoxyCodeLine{00079\ }
\DoxyCodeLine{00080\ \ \ \ \ \ \ \textcolor{comment}{//\ l=0:(2*order-\/1)\ =>\ li-\/lj=-\/(order-\/1):(order-\/1)}}
\DoxyCodeLine{00081\ \ \ \ \ \ \ \textcolor{comment}{//\ Convention:}}
\DoxyCodeLine{00082\ \ \ \ \ \ \ \textcolor{comment}{//\ lj=order-\/1\ \&\ li=0:order-\/1\ =>\ li-\/lj=1-\/order:0}}
\DoxyCodeLine{00083\ \ \ \ \ \ \ \textcolor{comment}{//\ lj=1\ \&\ li=0:order-\/1\ =>\ li-\/lj=1:order-\/1}}
\DoxyCodeLine{00084\ \ \ \ \ \ \ \textcolor{keywordflow}{if}(l<ORDER-\/1)\ lj=ORDER-\/1;\ \textcolor{keywordflow}{else}\ lj=0;}
\DoxyCodeLine{00085\ \ \ \ \ \ \ li=(l-\/(ORDER-\/1))+lj;}
\DoxyCodeLine{00086\ }
\DoxyCodeLine{00087\ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ m=0;\ m<2*ORDER-\/1;\ ++m)\{}
\DoxyCodeLine{00088\ }
\DoxyCodeLine{00089\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(m<ORDER-\/1)\ mj=ORDER-\/1;\ \textcolor{keywordflow}{else}\ mj=0;}
\DoxyCodeLine{00090\ \ \ \ \ \ \ \ \ mi=(m-\/(ORDER-\/1))+mj;}
\DoxyCodeLine{00091\ }
\DoxyCodeLine{00092\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ n=0;\ n<2*ORDER-\/1;\ ++n)\{}
\DoxyCodeLine{00093\ }
\DoxyCodeLine{00094\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(n<ORDER-\/1)\ nj=ORDER-\/1;\ \textcolor{keywordflow}{else}\ nj=0;}
\DoxyCodeLine{00095\ \ \ \ \ \ \ \ \ \ \ ni=(n-\/(ORDER-\/1))+nj;}
\DoxyCodeLine{00096\ }
\DoxyCodeLine{00097\ \ \ \ \ \ \ \ \ \ \ NodeIdsPairs[ido][0]=li*ORDER*ORDER\ +\ mi*ORDER\ +\ ni;}
\DoxyCodeLine{00098\ \ \ \ \ \ \ \ \ \ \ NodeIdsPairs[ido][1]=lj*ORDER*ORDER\ +\ mj*ORDER\ +\ nj;}
\DoxyCodeLine{00099\ }
\DoxyCodeLine{00100\ \ \ \ \ \ \ \ \ \ \ ido++;}
\DoxyCodeLine{00101\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00102\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00103\ \ \ \ \ \}}
\DoxyCodeLine{00104\ }
\DoxyCodeLine{00105\ \ \ \}}
\DoxyCodeLine{00106\ }
\DoxyCodeLine{00112\ \ \ \textcolor{keyword}{static}}
\DoxyCodeLine{00113\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_f_unif_tensor_a463769ece867c39feccd9878f65e5e3e}{setStoragePermutation}}(\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ perm[rc])}
\DoxyCodeLine{00114\ \ \ \{}
\DoxyCodeLine{00115\ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ p=0;\ p<rc;\ ++p)\{}
\DoxyCodeLine{00116\ \ \ \ \ \ \ \textcolor{comment}{//\ permutation\ to\ order\ WHILE\ computing\ the\ entire\ 1st\ row}}
\DoxyCodeLine{00117\ \ \ \ \ \ \ \textcolor{keywordflow}{if}(p<rc-\/1)\ perm[p]=p+1;}
\DoxyCodeLine{00118\ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ perm[p]=p+1-\/rc;}
\DoxyCodeLine{00119\ \ \ \ \ \ \ \textcolor{comment}{//\ \ \ \ std::cout\ <<\ "{}perm["{}<<\ p\ <<\ "{}]="{}<<\ perm[p]\ <<\ std::endl;}}
\DoxyCodeLine{00120\ \ \ \ \ \}}
\DoxyCodeLine{00121\ }
\DoxyCodeLine{00122\ \ \ \}}
\DoxyCodeLine{00123\ }
\DoxyCodeLine{00124\ \};}
\DoxyCodeLine{00125\ }
\DoxyCodeLine{00126\ }
\DoxyCodeLine{00127\ \textcolor{preprocessor}{\#endif\ }\textcolor{comment}{/*FUNIFTENSOR\_HPP*/}\textcolor{preprocessor}{}}

\end{DoxyCode}
