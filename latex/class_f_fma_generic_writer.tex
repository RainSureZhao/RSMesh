\doxysection{FFma\+Generic\+Writer\texorpdfstring{$<$}{<} FReal \texorpdfstring{$>$}{>} 模板类 参考}
\hypertarget{class_f_fma_generic_writer}{}\label{class_f_fma_generic_writer}\index{FFmaGenericWriter$<$ FReal $>$@{FFmaGenericWriter$<$ FReal $>$}}


Writes a set of particles to an FMA formated file.  




{\ttfamily \#include $<$FFma\+Generic\+Loader.\+hpp$>$}

\doxysubsubsection*{Public 成员函数}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{class_f_fma_generic_writer_a14486900e7fcd41dd1ca00cf4a7a8ae7}{FFma\+Generic\+Writer}} (const std\+::string \&filename)
\item 
\mbox{\hyperlink{class_f_fma_generic_writer_a39d67ca1217e369e639cddf437467436}{FFma\+Generic\+Writer}} (const std\+::string \&filename, const bool binary)
\item 
virtual \mbox{\hyperlink{class_f_fma_generic_writer_a114ef4452826ae3dfc2463a2256d11dc}{\texorpdfstring{$\sim$}{\string~}\+FFma\+Generic\+Writer}} ()
\item 
bool \mbox{\hyperlink{class_f_fma_generic_writer_a42bdd8642636b9a3f1e0a6c639f7d8ac}{is\+Open}} () const
\item 
{\footnotesize template$<$class type\+Part $>$ }\\void \mbox{\hyperlink{class_f_fma_generic_writer_a2add3c33baf8308f133807a33cf6ad4a}{write\+Header}} (const \mbox{\hyperlink{class_f_point}{FPoint}}$<$ FReal $>$ \&center\+Of\+Box, const FReal \&box\+Width, const FSize \&nb\+Particles, const type\+Part data)
\item 
void \mbox{\hyperlink{class_f_fma_generic_writer_a7ae6136bfedfed8bb2d9f78fe4990087}{write\+Header}} (const \mbox{\hyperlink{class_f_point}{FPoint}}$<$ FReal $>$ \&center\+Of\+Box, const FReal \&box\+Width, const FSize \&nb\+Particles, const unsigned int data\+Type, const unsigned int nb\+Data\+Per\+Record)
\item 
{\footnotesize template$<$class data\+Part $>$ }\\void \mbox{\hyperlink{class_f_fma_generic_writer_a0445da964b9c9899d1624e00b84f0fd6}{write\+Array\+Of\+Particles}} (const data\+Part \texorpdfstring{$\ast$}{*}data\+To\+Write, const FSize N)
\item 
void \mbox{\hyperlink{class_f_fma_generic_writer_aeaae4528a146243c18f3d2011e3dcf3b}{write\+Array\+Of\+Real}} (const FReal \texorpdfstring{$\ast$}{*}data\+To\+Write, const FSize nb\+Data, const FSize N)
\item 
{\footnotesize template$<$class Toctree $>$ }\\void \mbox{\hyperlink{class_f_fma_generic_writer_a6deaece64bdcf1788e48b72067eeac23}{write\+Distribution\+Of\+Particles\+From\+Octree}} (Toctree \texorpdfstring{$\ast$}{*}tree, const FSize N)
\end{DoxyCompactItemize}
\doxysubsubsection*{Protected 属性}
\begin{DoxyCompactItemize}
\item 
\Hypertarget{class_f_fma_generic_writer_a33d00b42852be0b33a140f7280d1ea06}\label{class_f_fma_generic_writer_a33d00b42852be0b33a140f7280d1ea06} 
std\+::fstream \texorpdfstring{$\ast$}{*} {\bfseries file}
\begin{DoxyCompactList}\small\item\em the stream used to read the file \end{DoxyCompactList}\item 
\Hypertarget{class_f_fma_generic_writer_ad12b5ed29de058897bee57e93fa90a95}\label{class_f_fma_generic_writer_ad12b5ed29de058897bee57e93fa90a95} 
bool {\bfseries binary\+File}
\begin{DoxyCompactList}\small\item\em if true the file to read is in binary mode \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{详细描述}
\subsubsection*{template$<$class FReal$>$\newline
class FFma\+Generic\+Writer$<$ FReal $>$}
Writes a set of particles to an FMA formated file. 

\begin{DoxyWarning}{警告}
This class only works in shared memory (doesn\textquotesingle{}t work with MPI).
\end{DoxyWarning}


The file may be in ASCII or binary mode. The example below shows how to use the class.


\begin{DoxyCode}{0}
\DoxyCodeLine{\textcolor{comment}{//\ Instanciate\ the\ writer\ with\ a\ binary\ fma\ file\ (extension\ .bfma).}}
\DoxyCodeLine{\mbox{\hyperlink{class_f_fma_generic_writer}{FFmaGenericWriter<FReal>}}\ writer\ (\textcolor{stringliteral}{"{}data.bfma"{}});}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{comment}{//\ Write\ the\ header\ of\ the\ file.}}
\DoxyCodeLine{writer.writeHeader(loader.getCenterOfBox(),\ loader.getBoxWidth(),\ NbPoints,\ \textcolor{keyword}{sizeof}(FReal),\ nbData);}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{comment}{//\ Write\ the\ data.\ Here\ particles\ is\ an\ array\ and\ a\ particle\ has\ nbData\ values.}}
\DoxyCodeLine{writer.writeArrayOfReal(particles,\ nbData,\ NbPoints);}

\end{DoxyCode}
 \DoxyHorRuler{0}
 FMA is a simple format to store particles in a file. It is organized as follow.


\begin{DoxyCode}{0}
\DoxyCodeLine{DatatypeSize\ \ Number\_of\_record\_per\_line}
\DoxyCodeLine{NB\_particles\ \ half\_Box\_width\ \ Center\_X\ \ Center\_Y\ \ Center\_Z}
\DoxyCodeLine{Particle\_values}

\end{DoxyCode}


{\ttfamily Datatype\+Size} can have one of two values\+:
\begin{DoxyItemize}
\item 4, float;
\item 8, double.
\end{DoxyItemize}

{\ttfamily Number\+\_\+of\+\_\+records\+\_\+per\+\_\+line} gives the data count for each line of the {\ttfamily Particle\+\_\+values}. For example \+:
\begin{DoxyItemize}
\item 4, the particle values are {\ttfamily X Y Z Q};
\item 8, the particle values are {\ttfamily X Y Z Q P FX FY FZ}. 
\end{DoxyItemize}

\doxysubsection{构造及析构函数说明}
\Hypertarget{class_f_fma_generic_writer_a14486900e7fcd41dd1ca00cf4a7a8ae7}\label{class_f_fma_generic_writer_a14486900e7fcd41dd1ca00cf4a7a8ae7} 
\index{FFmaGenericWriter$<$ FReal $>$@{FFmaGenericWriter$<$ FReal $>$}!FFmaGenericWriter@{FFmaGenericWriter}}
\index{FFmaGenericWriter@{FFmaGenericWriter}!FFmaGenericWriter$<$ FReal $>$@{FFmaGenericWriter$<$ FReal $>$}}
\doxysubsubsection{\texorpdfstring{FFmaGenericWriter()}{FFmaGenericWriter()}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily template$<$class FReal $>$ \\
\mbox{\hyperlink{class_f_fma_generic_writer}{FFma\+Generic\+Writer}}$<$ FReal $>$\mbox{\hyperlink{class_f_fma_generic_writer}{\+::\+FFma\+Generic\+Writer}} (\begin{DoxyParamCaption}\item[{const std\+::string \&}]{filename }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}

This constructor opens a file to be written to.


\begin{DoxyItemize}
\item The opening mode is guessed from the file extension \+: {\ttfamily .fma} will open in ASCII mode, {\ttfamily .bfma} will open in binary mode.
\end{DoxyItemize}


\begin{DoxyParams}{参数}
{\em filename} & the name of the file to open. \\
\hline
\end{DoxyParams}
\Hypertarget{class_f_fma_generic_writer_a39d67ca1217e369e639cddf437467436}\label{class_f_fma_generic_writer_a39d67ca1217e369e639cddf437467436} 
\index{FFmaGenericWriter$<$ FReal $>$@{FFmaGenericWriter$<$ FReal $>$}!FFmaGenericWriter@{FFmaGenericWriter}}
\index{FFmaGenericWriter@{FFmaGenericWriter}!FFmaGenericWriter$<$ FReal $>$@{FFmaGenericWriter$<$ FReal $>$}}
\doxysubsubsection{\texorpdfstring{FFmaGenericWriter()}{FFmaGenericWriter()}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily template$<$class FReal $>$ \\
\mbox{\hyperlink{class_f_fma_generic_writer}{FFma\+Generic\+Writer}}$<$ FReal $>$\mbox{\hyperlink{class_f_fma_generic_writer}{\+::\+FFma\+Generic\+Writer}} (\begin{DoxyParamCaption}\item[{const std\+::string \&}]{filename,  }\item[{const bool}]{binary }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}

This constructor opens a file to be written to.


\begin{DoxyParams}{参数}
{\em filename} & the name of the file to open. \\
\hline
{\em binary} & true if the file to open is in binary mode \\
\hline
\end{DoxyParams}
\Hypertarget{class_f_fma_generic_writer_a114ef4452826ae3dfc2463a2256d11dc}\label{class_f_fma_generic_writer_a114ef4452826ae3dfc2463a2256d11dc} 
\index{FFmaGenericWriter$<$ FReal $>$@{FFmaGenericWriter$<$ FReal $>$}!````~FFmaGenericWriter@{\texorpdfstring{$\sim$}{\string~}FFmaGenericWriter}}
\index{````~FFmaGenericWriter@{\texorpdfstring{$\sim$}{\string~}FFmaGenericWriter}!FFmaGenericWriter$<$ FReal $>$@{FFmaGenericWriter$<$ FReal $>$}}
\doxysubsubsection{\texorpdfstring{\texorpdfstring{$\sim$}{\string~}FFmaGenericWriter()}{\string~FFmaGenericWriter()}}
{\footnotesize\ttfamily template$<$class FReal $>$ \\
virtual \mbox{\hyperlink{class_f_fma_generic_writer}{FFma\+Generic\+Writer}}$<$ FReal $>$\+::\texorpdfstring{$\sim$}{\string~}\mbox{\hyperlink{class_f_fma_generic_writer}{FFma\+Generic\+Writer}} (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [virtual]}}

Default destructor, closes the file. 

\doxysubsection{成员函数说明}
\Hypertarget{class_f_fma_generic_writer_a42bdd8642636b9a3f1e0a6c639f7d8ac}\label{class_f_fma_generic_writer_a42bdd8642636b9a3f1e0a6c639f7d8ac} 
\index{FFmaGenericWriter$<$ FReal $>$@{FFmaGenericWriter$<$ FReal $>$}!isOpen@{isOpen}}
\index{isOpen@{isOpen}!FFmaGenericWriter$<$ FReal $>$@{FFmaGenericWriter$<$ FReal $>$}}
\doxysubsubsection{\texorpdfstring{isOpen()}{isOpen()}}
{\footnotesize\ttfamily template$<$class FReal $>$ \\
bool \mbox{\hyperlink{class_f_fma_generic_writer}{FFma\+Generic\+Writer}}$<$ FReal $>$\+::is\+Open (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}}

To know if file is open and ready to read \begin{DoxyReturn}{返回}
true if loader can work 
\end{DoxyReturn}
\Hypertarget{class_f_fma_generic_writer_a0445da964b9c9899d1624e00b84f0fd6}\label{class_f_fma_generic_writer_a0445da964b9c9899d1624e00b84f0fd6} 
\index{FFmaGenericWriter$<$ FReal $>$@{FFmaGenericWriter$<$ FReal $>$}!writeArrayOfParticles@{writeArrayOfParticles}}
\index{writeArrayOfParticles@{writeArrayOfParticles}!FFmaGenericWriter$<$ FReal $>$@{FFmaGenericWriter$<$ FReal $>$}}
\doxysubsubsection{\texorpdfstring{writeArrayOfParticles()}{writeArrayOfParticles()}}
{\footnotesize\ttfamily template$<$class FReal $>$ \\
template$<$class data\+Part $>$ \\
void \mbox{\hyperlink{class_f_fma_generic_writer}{FFma\+Generic\+Writer}}$<$ FReal $>$\+::write\+Array\+Of\+Particles (\begin{DoxyParamCaption}\item[{const data\+Part \texorpdfstring{$\ast$}{*}}]{data\+To\+Write,  }\item[{const FSize}]{N }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}

Writes an array of particles to the file.

\begin{DoxyWarning}{警告}
data\+Part should be Fma\+Basic\+Particle, Fma\+RParticle or Fma\+Particle or should implement all methods inside \doxylink{class_fma_r_w_particle}{Fma\+RWParticle}.
\end{DoxyWarning}

\begin{DoxyTemplParams}{模板参数}
{\em data\+Part} & The class of the particle array. \\
\hline
\end{DoxyTemplParams}

\begin{DoxyParams}{参数}
{\em data\+To\+Write} & Array of particles of type data\+Part \\
\hline
{\em N} & Number of element in the array\\
\hline
\end{DoxyParams}
Example 1 
\begin{DoxyCode}{0}
\DoxyCodeLine{FmaRParticle\ *\ \ particles\ =\ \textcolor{keyword}{new}\ FmaRParticle[nbParticles];}
\DoxyCodeLine{\mbox{\hyperlink{namespace_f_mem_utils_a005b2bd1925d50a688606ed5877c5aec}{memset}}(particles,\ 0,\ \textcolor{keyword}{sizeof}(FmaRParticle)\ *\ nbParticles)\ ;}
\DoxyCodeLine{...}
\DoxyCodeLine{FFmaGenericWriter<FReal>\ writer(filenameOut)\ ;}
\DoxyCodeLine{Fwriter.writeHeader(Centre,BoxWith,\ nbParticles,*particles)\ ;}
\DoxyCodeLine{Fwriter.writeArrayOfParticles(particles,\ nbParticles);}

\end{DoxyCode}


Example2 
\begin{DoxyCode}{0}
\DoxyCodeLine{FReal\ *\ \ particles\ =\ \textcolor{keyword}{new}\ FReal[4*NbPoints]\ ;\ \textcolor{comment}{//\ store\ 4\ data\ per\ particle}}
\DoxyCodeLine{\mbox{\hyperlink{namespace_f_mem_utils_a005b2bd1925d50a688606ed5877c5aec}{memset}}(particles,\ 0,\ \textcolor{keyword}{sizeof}(FmaRParticle)\ *\ nbParticles)\ ;}
\DoxyCodeLine{...}
\DoxyCodeLine{FmaBasicParticle\ *ppart\ =\ (FmaBasicParticle*)(\&particles[0]);}
\DoxyCodeLine{\mbox{\hyperlink{class_f_fma_generic_writer}{FFmaGenericWriter<FReal>}}\ writer(filenameOut)\ ;}
\DoxyCodeLine{writer.writeHeader(Centre,BoxWith,\ nbParticles,*particles)\ ;}
\DoxyCodeLine{writer.writeArrayOfParticles(particles,\ nbParticles);}

\end{DoxyCode}
 \Hypertarget{class_f_fma_generic_writer_aeaae4528a146243c18f3d2011e3dcf3b}\label{class_f_fma_generic_writer_aeaae4528a146243c18f3d2011e3dcf3b} 
\index{FFmaGenericWriter$<$ FReal $>$@{FFmaGenericWriter$<$ FReal $>$}!writeArrayOfReal@{writeArrayOfReal}}
\index{writeArrayOfReal@{writeArrayOfReal}!FFmaGenericWriter$<$ FReal $>$@{FFmaGenericWriter$<$ FReal $>$}}
\doxysubsubsection{\texorpdfstring{writeArrayOfReal()}{writeArrayOfReal()}}
{\footnotesize\ttfamily template$<$class FReal $>$ \\
void \mbox{\hyperlink{class_f_fma_generic_writer}{FFma\+Generic\+Writer}}$<$ FReal $>$\+::write\+Array\+Of\+Real (\begin{DoxyParamCaption}\item[{const FReal \texorpdfstring{$\ast$}{*}}]{data\+To\+Write,  }\item[{const FSize}]{nb\+Data,  }\item[{const FSize}]{N }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}

Write an array of data in a file Fill


\begin{DoxyParams}{参数}
{\em data\+To\+Write} & array of particles of type FReal \\
\hline
{\em nb\+Data} & number of data per particle \\
\hline
{\em N} & number of particles\\
\hline
\end{DoxyParams}
The size of the array is N\texorpdfstring{$\ast$}{*}nb\+Data

example 
\begin{DoxyCode}{0}
\DoxyCodeLine{FmaRParticle\ *\ \textcolor{keyword}{const}\ particles\ =\ \textcolor{keyword}{new}\ FmaRParticle[nbParticles];}
\DoxyCodeLine{\mbox{\hyperlink{namespace_f_mem_utils_a005b2bd1925d50a688606ed5877c5aec}{memset}}(particles,\ 0,\ \textcolor{keyword}{sizeof}(FmaRParticle)\ *\ nbParticles)\ ;}
\DoxyCodeLine{...}
\DoxyCodeLine{FFmaGenericWriter<FReal>\ writer(filenameOut)\ ;}
\DoxyCodeLine{Fwriter.writeHeader(Centre,BoxWith,\ nbParticles,*particles)\ ;}
\DoxyCodeLine{Fwriter.writeArrayOfReal(particles,\ nbParticles);}

\end{DoxyCode}
 \Hypertarget{class_f_fma_generic_writer_a6deaece64bdcf1788e48b72067eeac23}\label{class_f_fma_generic_writer_a6deaece64bdcf1788e48b72067eeac23} 
\index{FFmaGenericWriter$<$ FReal $>$@{FFmaGenericWriter$<$ FReal $>$}!writeDistributionOfParticlesFromOctree@{writeDistributionOfParticlesFromOctree}}
\index{writeDistributionOfParticlesFromOctree@{writeDistributionOfParticlesFromOctree}!FFmaGenericWriter$<$ FReal $>$@{FFmaGenericWriter$<$ FReal $>$}}
\doxysubsubsection{\texorpdfstring{writeDistributionOfParticlesFromOctree()}{writeDistributionOfParticlesFromOctree()}}
{\footnotesize\ttfamily template$<$class FReal $>$ \\
template$<$class Toctree $>$ \\
void \mbox{\hyperlink{class_f_fma_generic_writer}{FFma\+Generic\+Writer}}$<$ FReal $>$\+::write\+Distribution\+Of\+Particles\+From\+Octree (\begin{DoxyParamCaption}\item[{Toctree \texorpdfstring{$\ast$}{*}}]{tree,  }\item[{const FSize}]{N }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}

Write all particles inside the octree


\begin{DoxyParams}{参数}
{\em tree} & Octree that contains the particles in the leaves \\
\hline
{\em N} & number of particles\\
\hline
\end{DoxyParams}
example 
\begin{DoxyCode}{0}
\DoxyCodeLine{\ OctreeClass\ tree(TreeHeight,\ SubTreeHeight,\ BoxWidth,\ CenterOfBox);}
\DoxyCodeLine{...}
\DoxyCodeLine{FFmaGenericWriter<FReal>\ writer(filenameOut)\ ;}
\DoxyCodeLine{Fwriter.writeHeader(Centre,BoxWith,\ nbParticles,*particles)\ ;}
\DoxyCodeLine{Fwriter.writeDistributionOfParticlesFromOctree(\&tree,\ nbParticles);}

\end{DoxyCode}
 \Hypertarget{class_f_fma_generic_writer_a2add3c33baf8308f133807a33cf6ad4a}\label{class_f_fma_generic_writer_a2add3c33baf8308f133807a33cf6ad4a} 
\index{FFmaGenericWriter$<$ FReal $>$@{FFmaGenericWriter$<$ FReal $>$}!writeHeader@{writeHeader}}
\index{writeHeader@{writeHeader}!FFmaGenericWriter$<$ FReal $>$@{FFmaGenericWriter$<$ FReal $>$}}
\doxysubsubsection{\texorpdfstring{writeHeader()}{writeHeader()}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily template$<$class FReal $>$ \\
template$<$class type\+Part $>$ \\
void \mbox{\hyperlink{class_f_fma_generic_writer}{FFma\+Generic\+Writer}}$<$ FReal $>$\+::write\+Header (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{class_f_point}{FPoint}}$<$ FReal $>$ \&}]{center\+Of\+Box,  }\item[{const FReal \&}]{box\+Width,  }\item[{const FSize \&}]{nb\+Particles,  }\item[{const type\+Part}]{data }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}

Writes the header of the FMA file \begin{DoxyWarning}{警告}
All values inside type\+Part should be of the same type (float or double)
\end{DoxyWarning}

\begin{DoxyParams}{参数}
{\em center\+Of\+Box} & The centre of the Box (\doxylink{class_f_point}{FPoint$<$\+FReal$>$} class) \\
\hline
{\em box\+Width} & The width of the box \\
\hline
{\em nb\+Particles} & Number of particles in the box (or to save) \\
\hline
{\em data} & Data type of the particle class (Fma\+Basic\+Particle, Fma\+RParticle or Fma\+Particle) \\
\hline
\end{DoxyParams}
\Hypertarget{class_f_fma_generic_writer_a7ae6136bfedfed8bb2d9f78fe4990087}\label{class_f_fma_generic_writer_a7ae6136bfedfed8bb2d9f78fe4990087} 
\index{FFmaGenericWriter$<$ FReal $>$@{FFmaGenericWriter$<$ FReal $>$}!writeHeader@{writeHeader}}
\index{writeHeader@{writeHeader}!FFmaGenericWriter$<$ FReal $>$@{FFmaGenericWriter$<$ FReal $>$}}
\doxysubsubsection{\texorpdfstring{writeHeader()}{writeHeader()}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily template$<$class FReal $>$ \\
void \mbox{\hyperlink{class_f_fma_generic_writer}{FFma\+Generic\+Writer}}$<$ FReal $>$\+::write\+Header (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{class_f_point}{FPoint}}$<$ FReal $>$ \&}]{center\+Of\+Box,  }\item[{const FReal \&}]{box\+Width,  }\item[{const FSize \&}]{nb\+Particles,  }\item[{const unsigned int}]{data\+Type,  }\item[{const unsigned int}]{nb\+Data\+Per\+Record }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}

Writes the header of FMA file.

Should be used if we write the particles with write\+Array\+Of\+Real method


\begin{DoxyParams}{参数}
{\em center\+Of\+Box} & The center of the Box (\doxylink{class_f_point}{FPoint$<$\+FReal$>$} class) \\
\hline
{\em box\+Width} & The width of the box \\
\hline
{\em nb\+Particles} & Number of particles in the box (or to save) \\
\hline
{\em data\+Type} & Size of the data type of the values in particle \\
\hline
{\em nb\+Data\+Per\+Record} & Number of record/value per particle \\
\hline
\end{DoxyParams}


该类的文档由以下文件生成\+:\begin{DoxyCompactItemize}
\item 
third\+\_\+party/\+Scal\+FMM/include/\+Scal\+FMM/\+Files/FFma\+Generic\+Loader.\+hpp\end{DoxyCompactItemize}
