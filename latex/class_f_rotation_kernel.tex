\doxysection{FRotation\+Kernel\texorpdfstring{$<$}{<} FReal, Cell\+Class, Container\+Class, P \texorpdfstring{$>$}{>} 模板类 参考}
\hypertarget{class_f_rotation_kernel}{}\label{class_f_rotation_kernel}\index{FRotationKernel$<$ FReal, CellClass, ContainerClass, P $>$@{FRotationKernel$<$ FReal, CellClass, ContainerClass, P $>$}}


This kernels is a complete rotation based kernel with spherical harmonic.  




{\ttfamily \#include $<$FRotation\+Kernel.\+hpp$>$}

类 FRotation\+Kernel\texorpdfstring{$<$}{<} FReal, Cell\+Class, Container\+Class, P \texorpdfstring{$>$}{>} 继承关系图\+:\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=2.000000cm]{class_f_rotation_kernel}
\end{center}
\end{figure}
\doxysubsubsection*{Public 成员函数}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{class_f_rotation_kernel_a05c11b13ee0e82f13e856b07dd073eef}{FRotation\+Kernel}} (const int in\+Tree\+Height, const FReal in\+Box\+Width, const \mbox{\hyperlink{class_f_point}{FPoint}}$<$ FReal $>$ \&in\+Box\+Center)
\item 
virtual \mbox{\hyperlink{class_f_rotation_kernel_af1232888c2aebe298ce655be26760f91}{\texorpdfstring{$\sim$}{\string~}\+FRotation\+Kernel}} ()
\item 
void \mbox{\hyperlink{class_f_rotation_kernel_a9f7db1dbd219cf309df8109f3fc6742d}{P2M}} (Cell\+Class \texorpdfstring{$\ast$}{*}const in\+Pole, const Container\+Class \texorpdfstring{$\ast$}{*}const in\+Particles) override
\item 
void \mbox{\hyperlink{class_f_rotation_kernel_ae78b63b631e54bd8e54bd608ed4a6781}{M2M}} (Cell\+Class \texorpdfstring{$\ast$}{*}const FRestrict in\+Pole, const Cell\+Class \texorpdfstring{$\ast$}{*}const FRestrict \texorpdfstring{$\ast$}{*}const FRestrict in\+Children, const int in\+Level) override
\item 
void \mbox{\hyperlink{class_f_rotation_kernel_a191d061112a9cfbad72ca951da1bafe6}{M2L}} (Cell\+Class \texorpdfstring{$\ast$}{*}const FRestrict in\+Local, const Cell\+Class \texorpdfstring{$\ast$}{*}in\+Interactions\mbox{[}$\,$\mbox{]}, const int, const int in\+Level)
\item 
\Hypertarget{class_f_rotation_kernel_a7c57f74daa9ba24c56c338e924f0d852}\label{class_f_rotation_kernel_a7c57f74daa9ba24c56c338e924f0d852} 
void {\bfseries M2L} (Cell\+Class \texorpdfstring{$\ast$}{*}const FRestrict in\+Local, const Cell\+Class \texorpdfstring{$\ast$}{*}in\+Interactions\mbox{[}$\,$\mbox{]}, const int neighbor\+Positions\mbox{[}$\,$\mbox{]}, const int in\+Size, const int in\+Level) override
\item 
void \mbox{\hyperlink{class_f_rotation_kernel_a468fd3298053b990413b08989589cd08}{L2L}} (const Cell\+Class \texorpdfstring{$\ast$}{*}const FRestrict in\+Local, Cell\+Class \texorpdfstring{$\ast$}{*}FRestrict \texorpdfstring{$\ast$}{*}const FRestrict in\+Children, const int in\+Level) override
\item 
void \mbox{\hyperlink{class_f_rotation_kernel_ad4e45b04f2f5bff1a6a66ef9d1244275}{L2P}} (const Cell\+Class \texorpdfstring{$\ast$}{*}const in\+Local, Container\+Class \texorpdfstring{$\ast$}{*}const in\+Particles) override
\item 
void \mbox{\hyperlink{class_f_rotation_kernel_a1e794ed5f203d3237015de73850b21d4}{P2P}} (const \mbox{\hyperlink{class_f_tree_coordinate}{FTree\+Coordinate}} \&in\+Position, Container\+Class \texorpdfstring{$\ast$}{*}const FRestrict in\+Targets, const Container\+Class \texorpdfstring{$\ast$}{*}const FRestrict in\+Sources, Container\+Class \texorpdfstring{$\ast$}{*}const in\+Neighbors\mbox{[}$\,$\mbox{]}, const int neighbor\+Positions\mbox{[}$\,$\mbox{]}, const int in\+Size) override
\item 
\Hypertarget{class_f_rotation_kernel_a2d61b20c4bf4f196510754c71312504b}\label{class_f_rotation_kernel_a2d61b20c4bf4f196510754c71312504b} 
void {\bfseries P2\+POuter} (const \mbox{\hyperlink{class_f_tree_coordinate}{FTree\+Coordinate}} \&, Container\+Class \texorpdfstring{$\ast$}{*}const FRestrict in\+Targets, Container\+Class \texorpdfstring{$\ast$}{*}const in\+Neighbors\mbox{[}$\,$\mbox{]}, const int neighbor\+Positions\mbox{[}$\,$\mbox{]}, const int in\+Size) override
\item 
void \mbox{\hyperlink{class_f_rotation_kernel_afb4e60f36b353afbe0cc318e6947099a}{P2\+PRemote}} (const \mbox{\hyperlink{class_f_tree_coordinate}{FTree\+Coordinate}} \&, Container\+Class \texorpdfstring{$\ast$}{*}const FRestrict in\+Targets, const Container\+Class \texorpdfstring{$\ast$}{*}const FRestrict, const Container\+Class \texorpdfstring{$\ast$}{*}const in\+Neighbors\mbox{[}$\,$\mbox{]}, const int neighbor\+Positions\mbox{[}$\,$\mbox{]}, const int in\+Size) override
\end{DoxyCompactItemize}


\doxysubsection{详细描述}
\subsubsection*{template$<$class FReal, class Cell\+Class, class Container\+Class, int P$>$\newline
class FRotation\+Kernel$<$ FReal, Cell\+Class, Container\+Class, P $>$}
This kernels is a complete rotation based kernel with spherical harmonic. 

\begin{DoxyAuthor}{作者}
Berenger Bramas (\href{mailto:berenger.bramas@inria.fr}{\texttt{ berenger.\+bramas@inria.\+fr}})
\end{DoxyAuthor}


Here is the optimizated kernel, please refer to \doxylink{class_f_rotation_original_kernel}{FRotation\+Original\+Kernel} to see the non optimized easy to understand kernel. 

\doxysubsection{构造及析构函数说明}
\Hypertarget{class_f_rotation_kernel_a05c11b13ee0e82f13e856b07dd073eef}\label{class_f_rotation_kernel_a05c11b13ee0e82f13e856b07dd073eef} 
\index{FRotationKernel$<$ FReal, CellClass, ContainerClass, P $>$@{FRotationKernel$<$ FReal, CellClass, ContainerClass, P $>$}!FRotationKernel@{FRotationKernel}}
\index{FRotationKernel@{FRotationKernel}!FRotationKernel$<$ FReal, CellClass, ContainerClass, P $>$@{FRotationKernel$<$ FReal, CellClass, ContainerClass, P $>$}}
\doxysubsubsection{\texorpdfstring{FRotationKernel()}{FRotationKernel()}}
{\footnotesize\ttfamily template$<$class FReal , class Cell\+Class , class Container\+Class , int P$>$ \\
\mbox{\hyperlink{class_f_rotation_kernel}{FRotation\+Kernel}}$<$ FReal, Cell\+Class, Container\+Class, P $>$\mbox{\hyperlink{class_f_rotation_kernel}{\+::\+FRotation\+Kernel}} (\begin{DoxyParamCaption}\item[{const int}]{in\+Tree\+Height,  }\item[{const FReal}]{in\+Box\+Width,  }\item[{const \mbox{\hyperlink{class_f_point}{FPoint}}$<$ FReal $>$ \&}]{in\+Box\+Center }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}

Constructor, needs system information \Hypertarget{class_f_rotation_kernel_af1232888c2aebe298ce655be26760f91}\label{class_f_rotation_kernel_af1232888c2aebe298ce655be26760f91} 
\index{FRotationKernel$<$ FReal, CellClass, ContainerClass, P $>$@{FRotationKernel$<$ FReal, CellClass, ContainerClass, P $>$}!````~FRotationKernel@{\texorpdfstring{$\sim$}{\string~}FRotationKernel}}
\index{````~FRotationKernel@{\texorpdfstring{$\sim$}{\string~}FRotationKernel}!FRotationKernel$<$ FReal, CellClass, ContainerClass, P $>$@{FRotationKernel$<$ FReal, CellClass, ContainerClass, P $>$}}
\doxysubsubsection{\texorpdfstring{\texorpdfstring{$\sim$}{\string~}FRotationKernel()}{\string~FRotationKernel()}}
{\footnotesize\ttfamily template$<$class FReal , class Cell\+Class , class Container\+Class , int P$>$ \\
virtual \mbox{\hyperlink{class_f_rotation_kernel}{FRotation\+Kernel}}$<$ FReal, Cell\+Class, Container\+Class, P $>$\+::\texorpdfstring{$\sim$}{\string~}\mbox{\hyperlink{class_f_rotation_kernel}{FRotation\+Kernel}} (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [virtual]}}

Default destructor 

\doxysubsection{成员函数说明}
\Hypertarget{class_f_rotation_kernel_a468fd3298053b990413b08989589cd08}\label{class_f_rotation_kernel_a468fd3298053b990413b08989589cd08} 
\index{FRotationKernel$<$ FReal, CellClass, ContainerClass, P $>$@{FRotationKernel$<$ FReal, CellClass, ContainerClass, P $>$}!L2L@{L2L}}
\index{L2L@{L2L}!FRotationKernel$<$ FReal, CellClass, ContainerClass, P $>$@{FRotationKernel$<$ FReal, CellClass, ContainerClass, P $>$}}
\doxysubsubsection{\texorpdfstring{L2L()}{L2L()}}
{\footnotesize\ttfamily template$<$class FReal , class Cell\+Class , class Container\+Class , int P$>$ \\
void \mbox{\hyperlink{class_f_rotation_kernel}{FRotation\+Kernel}}$<$ FReal, Cell\+Class, Container\+Class, P $>$\+::\+L2L (\begin{DoxyParamCaption}\item[{const Cell\+Class \texorpdfstring{$\ast$}{*}const FRestrict}]{in\+Local,  }\item[{Cell\+Class \texorpdfstring{$\ast$}{*}FRestrict \texorpdfstring{$\ast$}{*}const FRestrict}]{in\+Children,  }\item[{const int}]{in\+Level }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [override]}}

L2L The operator C has been taken from \+: Implementation of rotation-\/based operators for Fast Multipole Method in X10 At page 5 .1 as the operator C  \[
M_{l,m}(a-b\textnormal{\textquotesingle}) = \sum_{j=l}^{\infty}{ \frac{ b^{j-l} }{ (j-l)! } M_{j,m}(a) } , \textrm{j bounded by P}
\] As describe in the paper, when need first to rotate the SH then transfer using the formula and finaly rotate back. \Hypertarget{class_f_rotation_kernel_ad4e45b04f2f5bff1a6a66ef9d1244275}\label{class_f_rotation_kernel_ad4e45b04f2f5bff1a6a66ef9d1244275} 
\index{FRotationKernel$<$ FReal, CellClass, ContainerClass, P $>$@{FRotationKernel$<$ FReal, CellClass, ContainerClass, P $>$}!L2P@{L2P}}
\index{L2P@{L2P}!FRotationKernel$<$ FReal, CellClass, ContainerClass, P $>$@{FRotationKernel$<$ FReal, CellClass, ContainerClass, P $>$}}
\doxysubsubsection{\texorpdfstring{L2P()}{L2P()}}
{\footnotesize\ttfamily template$<$class FReal , class Cell\+Class , class Container\+Class , int P$>$ \\
void \mbox{\hyperlink{class_f_rotation_kernel}{FRotation\+Kernel}}$<$ FReal, Cell\+Class, Container\+Class, P $>$\+::\+L2P (\begin{DoxyParamCaption}\item[{const Cell\+Class \texorpdfstring{$\ast$}{*}const}]{in\+Local,  }\item[{Container\+Class \texorpdfstring{$\ast$}{*}const}]{in\+Particles }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [override]}}

L2P Equation are coming from the PhD report of Pierre Fortin. We have two different computations, one for the potential (end of function) the other for the forces.

The potential use the fallowing formula, page 36, formula 2.\+14 + 1\+:  \[
 \Phi = \sum_{j=0}^P{\left( u_{j,0} I_{j,0}(r, \theta, \phi) + \sum_{k=1}^j{2 Re(u_{j,k} I_{j,k}(r, \theta, \phi))} \right)},
 \textrm{since } u_{l,-m} = (-1)^m \overline{ u_{l,m} }
\]

The forces are coming form the formulas, page 37, formulas 2.\+14 + 3\+:  \[
F_r = -\frac{1}{r} \left( \sum_{j=1}^P{j u_{j,0} I_{j,0}(r, \theta, \phi) } + \sum_{k=1}^j{2 j Re(u_{j,k} I_{j,k}(r, \theta, \phi))} \right)
F_{ \theta } = -\frac{1}{r} \left( \sum_{j=0}^P{j u_{j,0} \frac{ \partial I_{j,0}(r, \theta, \phi) }{ \partial \theta } } + \sum_{k=1}^j{2 Re(u_{j,k} \frac{ \partial I_{j,k}(r, \theta, \phi) }{ \partial \theta })} \right)
F_{ \phi } = -\frac{1}{r sin \phi} \sum_{j=0}^P \sum_{k=1}^j{(-2k) Im(u_{j,k} I_{j,k}(r, \theta, \phi)) }
\] \Hypertarget{class_f_rotation_kernel_a191d061112a9cfbad72ca951da1bafe6}\label{class_f_rotation_kernel_a191d061112a9cfbad72ca951da1bafe6} 
\index{FRotationKernel$<$ FReal, CellClass, ContainerClass, P $>$@{FRotationKernel$<$ FReal, CellClass, ContainerClass, P $>$}!M2L@{M2L}}
\index{M2L@{M2L}!FRotationKernel$<$ FReal, CellClass, ContainerClass, P $>$@{FRotationKernel$<$ FReal, CellClass, ContainerClass, P $>$}}
\doxysubsubsection{\texorpdfstring{M2L()}{M2L()}}
{\footnotesize\ttfamily template$<$class FReal , class Cell\+Class , class Container\+Class , int P$>$ \\
void \mbox{\hyperlink{class_f_rotation_kernel}{FRotation\+Kernel}}$<$ FReal, Cell\+Class, Container\+Class, P $>$\+::\+M2L (\begin{DoxyParamCaption}\item[{Cell\+Class \texorpdfstring{$\ast$}{*}const FRestrict}]{in\+Local,  }\item[{const Cell\+Class \texorpdfstring{$\ast$}{*}}]{in\+Interactions\mbox{[}$\,$\mbox{]},  }\item[{const int}]{,  }\item[{const int}]{in\+Level }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}

M2L The operator B has been taken from \+: Implementation of rotation-\/based operators for Fast Multipole Method in X10 At page 5 .1 as the operator B  \[
M_{l,m}(a-b\textnormal{\textquotesingle}) = \sum_{j=|m|}^{\infty}{ \frac{ (j+l)! } { b^{j+l+1} } O_{j,-m}(a) } , \mbox{\textrm{ j bounded by P-l } }
\] As describe in the paper, when need first to rotate the SH then transfer using the formula and finaly rotate back. \Hypertarget{class_f_rotation_kernel_ae78b63b631e54bd8e54bd608ed4a6781}\label{class_f_rotation_kernel_ae78b63b631e54bd8e54bd608ed4a6781} 
\index{FRotationKernel$<$ FReal, CellClass, ContainerClass, P $>$@{FRotationKernel$<$ FReal, CellClass, ContainerClass, P $>$}!M2M@{M2M}}
\index{M2M@{M2M}!FRotationKernel$<$ FReal, CellClass, ContainerClass, P $>$@{FRotationKernel$<$ FReal, CellClass, ContainerClass, P $>$}}
\doxysubsubsection{\texorpdfstring{M2M()}{M2M()}}
{\footnotesize\ttfamily template$<$class FReal , class Cell\+Class , class Container\+Class , int P$>$ \\
void \mbox{\hyperlink{class_f_rotation_kernel}{FRotation\+Kernel}}$<$ FReal, Cell\+Class, Container\+Class, P $>$\+::\+M2M (\begin{DoxyParamCaption}\item[{Cell\+Class \texorpdfstring{$\ast$}{*}const FRestrict}]{in\+Pole,  }\item[{const Cell\+Class \texorpdfstring{$\ast$}{*}const FRestrict \texorpdfstring{$\ast$}{*}const FRestrict}]{in\+Children,  }\item[{const int}]{in\+Level }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [override]}}

M2M The operator A has been taken from \+: Implementation of rotation-\/based operators for Fast Multipole Method in X10 At page 5 .1 as the operator A  \[
O_{l,m}(a+b\textnormal{\textquotesingle}) = \sum_{j=|m|}^l{ \frac{ b^{l-j} }{ (l-j)! } O_{j,m}(a) }
\] As describe in the paper, when need first to rotate the SH then transfer using the formula and finaly rotate back. \Hypertarget{class_f_rotation_kernel_a9f7db1dbd219cf309df8109f3fc6742d}\label{class_f_rotation_kernel_a9f7db1dbd219cf309df8109f3fc6742d} 
\index{FRotationKernel$<$ FReal, CellClass, ContainerClass, P $>$@{FRotationKernel$<$ FReal, CellClass, ContainerClass, P $>$}!P2M@{P2M}}
\index{P2M@{P2M}!FRotationKernel$<$ FReal, CellClass, ContainerClass, P $>$@{FRotationKernel$<$ FReal, CellClass, ContainerClass, P $>$}}
\doxysubsubsection{\texorpdfstring{P2M()}{P2M()}}
{\footnotesize\ttfamily template$<$class FReal , class Cell\+Class , class Container\+Class , int P$>$ \\
void \mbox{\hyperlink{class_f_rotation_kernel}{FRotation\+Kernel}}$<$ FReal, Cell\+Class, Container\+Class, P $>$\+::\+P2M (\begin{DoxyParamCaption}\item[{Cell\+Class \texorpdfstring{$\ast$}{*}const}]{in\+Pole,  }\item[{const Container\+Class \texorpdfstring{$\ast$}{*}const}]{in\+Particles }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [override]}}

P2M The computation is based on the paper \+: Parallelization of the fast multipole method Formula number 10, page 3  \[
\omega (q,a) = q \frac{a^{l}}{(l+|m|)!} P_{lm}(cos( \alpha ) )e^{-im \beta}
\] \Hypertarget{class_f_rotation_kernel_a1e794ed5f203d3237015de73850b21d4}\label{class_f_rotation_kernel_a1e794ed5f203d3237015de73850b21d4} 
\index{FRotationKernel$<$ FReal, CellClass, ContainerClass, P $>$@{FRotationKernel$<$ FReal, CellClass, ContainerClass, P $>$}!P2P@{P2P}}
\index{P2P@{P2P}!FRotationKernel$<$ FReal, CellClass, ContainerClass, P $>$@{FRotationKernel$<$ FReal, CellClass, ContainerClass, P $>$}}
\doxysubsubsection{\texorpdfstring{P2P()}{P2P()}}
{\footnotesize\ttfamily template$<$class FReal , class Cell\+Class , class Container\+Class , int P$>$ \\
void \mbox{\hyperlink{class_f_rotation_kernel}{FRotation\+Kernel}}$<$ FReal, Cell\+Class, Container\+Class, P $>$\+::\+P2P (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{class_f_tree_coordinate}{FTree\+Coordinate}} \&}]{in\+Position,  }\item[{Container\+Class \texorpdfstring{$\ast$}{*}const FRestrict}]{in\+Targets,  }\item[{const Container\+Class \texorpdfstring{$\ast$}{*}const FRestrict}]{in\+Sources,  }\item[{Container\+Class \texorpdfstring{$\ast$}{*}const}]{in\+Neighbors\mbox{[}$\,$\mbox{]},  }\item[{const int}]{neighbor\+Positions\mbox{[}$\,$\mbox{]},  }\item[{const int}]{in\+Size }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [override]}}

P2P This function proceed the P2P using particles\+Mutual\+Interaction The computation is done for interactions with an index \texorpdfstring{$<$}{<}= 13. (13 means current leaf (x;y;z) = (0;0;0)). Calling this method in multi thread should be done carrefully. \Hypertarget{class_f_rotation_kernel_afb4e60f36b353afbe0cc318e6947099a}\label{class_f_rotation_kernel_afb4e60f36b353afbe0cc318e6947099a} 
\index{FRotationKernel$<$ FReal, CellClass, ContainerClass, P $>$@{FRotationKernel$<$ FReal, CellClass, ContainerClass, P $>$}!P2PRemote@{P2PRemote}}
\index{P2PRemote@{P2PRemote}!FRotationKernel$<$ FReal, CellClass, ContainerClass, P $>$@{FRotationKernel$<$ FReal, CellClass, ContainerClass, P $>$}}
\doxysubsubsection{\texorpdfstring{P2PRemote()}{P2PRemote()}}
{\footnotesize\ttfamily template$<$class FReal , class Cell\+Class , class Container\+Class , int P$>$ \\
void \mbox{\hyperlink{class_f_rotation_kernel}{FRotation\+Kernel}}$<$ FReal, Cell\+Class, Container\+Class, P $>$\+::\+P2\+PRemote (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{class_f_tree_coordinate}{FTree\+Coordinate}} \&}]{,  }\item[{Container\+Class \texorpdfstring{$\ast$}{*}const FRestrict}]{in\+Targets,  }\item[{const Container\+Class \texorpdfstring{$\ast$}{*}const}]{FRestrict,  }\item[{const Container\+Class \texorpdfstring{$\ast$}{*}const}]{in\+Neighbors\mbox{[}$\,$\mbox{]},  }\item[{const int}]{neighbor\+Positions\mbox{[}$\,$\mbox{]},  }\item[{const int}]{in\+Size }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [override]}}

Use mutual even if it not useful and call particles\+Mutual\+Interaction 

该类的文档由以下文件生成\+:\begin{DoxyCompactItemize}
\item 
third\+\_\+party/\+Scal\+FMM/include/\+Scal\+FMM/\+Kernels/\+Rotation/FRotation\+Kernel.\+hpp\end{DoxyCompactItemize}
