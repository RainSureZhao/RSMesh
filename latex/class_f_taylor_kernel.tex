\doxysection{FTaylor\+Kernel\texorpdfstring{$<$}{<} FReal, Cell\+Class, Container\+Class, P, order \texorpdfstring{$>$}{>} 模板类 参考}
\hypertarget{class_f_taylor_kernel}{}\label{class_f_taylor_kernel}\index{FTaylorKernel$<$ FReal, CellClass, ContainerClass, P, order $>$@{FTaylorKernel$<$ FReal, CellClass, ContainerClass, P, order $>$}}


This kernel is an implementation of the different operators needed to compute the Fast Multipole Method using Taylor Expansion for the Far fields interaction.  




{\ttfamily \#include $<$FTaylor\+Kernel.\+hpp$>$}

类 FTaylor\+Kernel\texorpdfstring{$<$}{<} FReal, Cell\+Class, Container\+Class, P, order \texorpdfstring{$>$}{>} 继承关系图\+:\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=1.505376cm]{class_f_taylor_kernel}
\end{center}
\end{figure}
\doxysubsubsection*{Public 成员函数}
\begin{DoxyCompactItemize}
\item 
\Hypertarget{class_f_taylor_kernel_af0bd6363b8ee2008e67617def2ff9c8c}\label{class_f_taylor_kernel_af0bd6363b8ee2008e67617def2ff9c8c} 
{\bfseries FTaylor\+Kernel} (const int in\+Tree\+Height, const FReal in\+Box\+Width, const \mbox{\hyperlink{class_f_point}{FPoint}}$<$ FReal $>$ \&in\+Box\+Center)
\item 
void \mbox{\hyperlink{class_f_taylor_kernel_ad504e923e718ebd25dd83f11d7a99b33}{P2M}} (Cell\+Class \texorpdfstring{$\ast$}{*}const pole, const Container\+Class \texorpdfstring{$\ast$}{*}const particles) override
\begin{DoxyCompactList}\small\item\em Fill the Multipole with the field created by the cell particles. \end{DoxyCompactList}\item 
\Hypertarget{class_f_taylor_kernel_ac9974eee68de43cd44f5c229fc6f8c11}\label{class_f_taylor_kernel_ac9974eee68de43cd44f5c229fc6f8c11} 
void {\bfseries M2M} (Cell\+Class \texorpdfstring{$\ast$}{*}const FRestrict pole, const Cell\+Class \texorpdfstring{$\ast$}{*}const FRestrict \texorpdfstring{$\ast$}{*}const FRestrict child, const int in\+Level) override
\begin{DoxyCompactList}\small\item\em Fill the parent multipole with the 8 values of child multipoles \end{DoxyCompactList}\item 
void \mbox{\hyperlink{class_f_taylor_kernel_a517b6fcc317f2ce9e2a37690cc7c6c3c}{M2L}} (Cell\+Class \texorpdfstring{$\ast$}{*}const FRestrict in\+Local, const Cell\+Class \texorpdfstring{$\ast$}{*}distant\+Neighbors\mbox{[}$\,$\mbox{]}, const int neighbor\+Positions\mbox{[}$\,$\mbox{]}, const int in\+Size, const int in\+Level) override
\begin{DoxyCompactList}\small\item\em Convert the multipole expansion into local expansion The operator do not use symmetries. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{class_f_taylor_kernel_a248a840c8d2064e252e90e1eb0d2e007}{L2L}} (const Cell\+Class \texorpdfstring{$\ast$}{*}const FRestrict father\+Cell, Cell\+Class \texorpdfstring{$\ast$}{*}FRestrict \texorpdfstring{$\ast$}{*}const FRestrict child\+Cell, const int in\+Level) override
\begin{DoxyCompactList}\small\item\em Translate the local expansion of parent cell to child cell \end{DoxyCompactList}\item 
void \mbox{\hyperlink{class_f_taylor_kernel_a68f51a6ab1ff33cff3cfe2790735ff2a}{L2P}} (const Cell\+Class \texorpdfstring{$\ast$}{*}const local, Container\+Class \texorpdfstring{$\ast$}{*}const particles) override
\begin{DoxyCompactList}\small\item\em Apply on the particles the force computed from the local expansion to all particles in the cell \end{DoxyCompactList}\item 
void \mbox{\hyperlink{class_f_taylor_kernel_a92ae46dae23395eabc0af1118309ab87}{P2P}} (const \mbox{\hyperlink{class_f_tree_coordinate}{FTree\+Coordinate}} \&in\+Position, Container\+Class \texorpdfstring{$\ast$}{*}const FRestrict in\+Targets, const Container\+Class \texorpdfstring{$\ast$}{*}const FRestrict in\+Sources, Container\+Class \texorpdfstring{$\ast$}{*}const in\+Neighbors\mbox{[}$\,$\mbox{]}, const int neighbor\+Positions\mbox{[}$\,$\mbox{]}, const int in\+Size) override
\item 
\Hypertarget{class_f_taylor_kernel_a9055ff841186ce013c1e7d31c3734532}\label{class_f_taylor_kernel_a9055ff841186ce013c1e7d31c3734532} 
void {\bfseries P2\+POuter} (const \mbox{\hyperlink{class_f_tree_coordinate}{FTree\+Coordinate}} \&, Container\+Class \texorpdfstring{$\ast$}{*}const FRestrict in\+Targets, Container\+Class \texorpdfstring{$\ast$}{*}const in\+Neighbors\mbox{[}$\,$\mbox{]}, const int neighbor\+Positions\mbox{[}$\,$\mbox{]}, const int in\+Size) override
\item 
void \mbox{\hyperlink{class_f_taylor_kernel_a4e4d6f0cec1b72903f1a2d2dc6dd7325}{P2\+PRemote}} (const \mbox{\hyperlink{class_f_tree_coordinate}{FTree\+Coordinate}} \&, Container\+Class \texorpdfstring{$\ast$}{*}const FRestrict in\+Targets, const Container\+Class \texorpdfstring{$\ast$}{*}const FRestrict, const Container\+Class \texorpdfstring{$\ast$}{*}const in\+Neighbors\mbox{[}$\,$\mbox{]}, const int neighbor\+Positions\mbox{[}$\,$\mbox{]}, const int in\+Size) override
\item 
\Hypertarget{class_f_taylor_kernel_af0bd6363b8ee2008e67617def2ff9c8c}\label{class_f_taylor_kernel_af0bd6363b8ee2008e67617def2ff9c8c} 
{\bfseries FTaylor\+Kernel} (const int in\+Tree\+Height, const FReal in\+Box\+Width, const \mbox{\hyperlink{class_f_point}{FPoint}}$<$ FReal $>$ \&in\+Box\+Center)
\item 
void \mbox{\hyperlink{class_f_taylor_kernel_ad504e923e718ebd25dd83f11d7a99b33}{P2M}} (Cell\+Class \texorpdfstring{$\ast$}{*}const pole, const Container\+Class \texorpdfstring{$\ast$}{*}const particles) override
\begin{DoxyCompactList}\small\item\em Fill the Multipole with the field created by the cell particles. \end{DoxyCompactList}\item 
\Hypertarget{class_f_taylor_kernel_ac9974eee68de43cd44f5c229fc6f8c11}\label{class_f_taylor_kernel_ac9974eee68de43cd44f5c229fc6f8c11} 
void {\bfseries M2M} (Cell\+Class \texorpdfstring{$\ast$}{*}const FRestrict pole, const Cell\+Class \texorpdfstring{$\ast$}{*}const FRestrict \texorpdfstring{$\ast$}{*}const FRestrict child, const int in\+Level) override
\begin{DoxyCompactList}\small\item\em Fill the parent multipole with the 8 values of child multipoles \end{DoxyCompactList}\item 
void \mbox{\hyperlink{class_f_taylor_kernel_a378bade4838fd8f5c8a00a164e2c6999}{M2L}} (Cell\+Class \texorpdfstring{$\ast$}{*}const FRestrict in\+Local, const Cell\+Class \texorpdfstring{$\ast$}{*}distant\+Neighbors\mbox{[}$\,$\mbox{]}, const int\mbox{[}$\,$\mbox{]}, const int in\+Size, const int in\+Level) override
\begin{DoxyCompactList}\small\item\em Convert the multipole expansion into local expansion The operator do not use symmetries. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{class_f_taylor_kernel_a248a840c8d2064e252e90e1eb0d2e007}{L2L}} (const Cell\+Class \texorpdfstring{$\ast$}{*}const FRestrict father\+Cell, Cell\+Class \texorpdfstring{$\ast$}{*}FRestrict \texorpdfstring{$\ast$}{*}const FRestrict child\+Cell, const int in\+Level) override
\begin{DoxyCompactList}\small\item\em Translate the local expansion of parent cell to child cell \end{DoxyCompactList}\item 
void \mbox{\hyperlink{class_f_taylor_kernel_a68f51a6ab1ff33cff3cfe2790735ff2a}{L2P}} (const Cell\+Class \texorpdfstring{$\ast$}{*}const local, Container\+Class \texorpdfstring{$\ast$}{*}const particles) override
\begin{DoxyCompactList}\small\item\em Apply on the particles the force computed from the local expansion to all particles in the cell \end{DoxyCompactList}\item 
void \mbox{\hyperlink{class_f_taylor_kernel_a92ae46dae23395eabc0af1118309ab87}{P2P}} (const \mbox{\hyperlink{class_f_tree_coordinate}{FTree\+Coordinate}} \&in\+Position, Container\+Class \texorpdfstring{$\ast$}{*}const FRestrict in\+Targets, const Container\+Class \texorpdfstring{$\ast$}{*}const FRestrict in\+Sources, Container\+Class \texorpdfstring{$\ast$}{*}const in\+Neighbors\mbox{[}$\,$\mbox{]}, const int neighbor\+Positions\mbox{[}$\,$\mbox{]}, const int in\+Size) override
\item 
\Hypertarget{class_f_taylor_kernel_a9055ff841186ce013c1e7d31c3734532}\label{class_f_taylor_kernel_a9055ff841186ce013c1e7d31c3734532} 
void {\bfseries P2\+POuter} (const \mbox{\hyperlink{class_f_tree_coordinate}{FTree\+Coordinate}} \&, Container\+Class \texorpdfstring{$\ast$}{*}const FRestrict in\+Targets, Container\+Class \texorpdfstring{$\ast$}{*}const in\+Neighbors\mbox{[}$\,$\mbox{]}, const int neighbor\+Positions\mbox{[}$\,$\mbox{]}, const int in\+Size) override
\item 
void \mbox{\hyperlink{class_f_taylor_kernel_a4e4d6f0cec1b72903f1a2d2dc6dd7325}{P2\+PRemote}} (const \mbox{\hyperlink{class_f_tree_coordinate}{FTree\+Coordinate}} \&, Container\+Class \texorpdfstring{$\ast$}{*}const FRestrict in\+Targets, const Container\+Class \texorpdfstring{$\ast$}{*}const FRestrict, const Container\+Class \texorpdfstring{$\ast$}{*}const in\+Neighbors\mbox{[}$\,$\mbox{]}, const int neighbor\+Positions\mbox{[}$\,$\mbox{]}, const int in\+Size) override
\end{DoxyCompactItemize}


\doxysubsection{详细描述}
\subsubsection*{template$<$class FReal, class Cell\+Class, class Container\+Class, int P, int order$>$\newline
class FTaylor\+Kernel$<$ FReal, Cell\+Class, Container\+Class, P, order $>$}
This kernel is an implementation of the different operators needed to compute the Fast Multipole Method using Taylor Expansion for the Far fields interaction. 

\begin{DoxyAuthor}{作者}
Cyrille Piacibello 
\end{DoxyAuthor}


\doxysubsection{成员函数说明}
\Hypertarget{class_f_taylor_kernel_a248a840c8d2064e252e90e1eb0d2e007}\label{class_f_taylor_kernel_a248a840c8d2064e252e90e1eb0d2e007} 
\index{FTaylorKernel$<$ FReal, CellClass, ContainerClass, P, order $>$@{FTaylorKernel$<$ FReal, CellClass, ContainerClass, P, order $>$}!L2L@{L2L}}
\index{L2L@{L2L}!FTaylorKernel$<$ FReal, CellClass, ContainerClass, P, order $>$@{FTaylorKernel$<$ FReal, CellClass, ContainerClass, P, order $>$}}
\doxysubsubsection{\texorpdfstring{L2L()}{L2L()}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily template$<$class FReal , class Cell\+Class , class Container\+Class , int P, int order$>$ \\
void \mbox{\hyperlink{class_f_taylor_kernel}{FTaylor\+Kernel}}$<$ FReal, Cell\+Class, Container\+Class, P, order $>$\+::\+L2L (\begin{DoxyParamCaption}\item[{const Cell\+Class \texorpdfstring{$\ast$}{*}const FRestrict}]{father\+Cell,  }\item[{Cell\+Class \texorpdfstring{$\ast$}{*}FRestrict \texorpdfstring{$\ast$}{*}const FRestrict}]{child\+Cell,  }\item[{const int}]{in\+Level }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [override]}}



Translate the local expansion of parent cell to child cell 

One need to translate the local expansion on a father cell centered in $\mathbf{x}_p$ to its eight daughters centered in $\mathbf{x}_p$ .

Local expansion for the daughters will be \+: \[ \sum_{\mathbf{k}=0}^{|k|<P} L_k * (\mathbf{x}-\mathbf{x}_f)^{\mathbf{k}} \] with \+:

\[ L_{n} = \sum_{\mathbf{k}=\mathbf{n}}^{|k|<P} C_{\mathbf{k}}^{\mathbf{n}} * (\mathbf{x}_f-\mathbf{x}_p)^{\mathbf{k}-\mathbf{n}} \] \Hypertarget{class_f_taylor_kernel_a248a840c8d2064e252e90e1eb0d2e007}\label{class_f_taylor_kernel_a248a840c8d2064e252e90e1eb0d2e007} 
\index{FTaylorKernel$<$ FReal, CellClass, ContainerClass, P, order $>$@{FTaylorKernel$<$ FReal, CellClass, ContainerClass, P, order $>$}!L2L@{L2L}}
\index{L2L@{L2L}!FTaylorKernel$<$ FReal, CellClass, ContainerClass, P, order $>$@{FTaylorKernel$<$ FReal, CellClass, ContainerClass, P, order $>$}}
\doxysubsubsection{\texorpdfstring{L2L()}{L2L()}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily template$<$class FReal , class Cell\+Class , class Container\+Class , int P, int order$>$ \\
void \mbox{\hyperlink{class_f_taylor_kernel}{FTaylor\+Kernel}}$<$ FReal, Cell\+Class, Container\+Class, P, order $>$\+::\+L2L (\begin{DoxyParamCaption}\item[{const Cell\+Class \texorpdfstring{$\ast$}{*}const FRestrict}]{father\+Cell,  }\item[{Cell\+Class \texorpdfstring{$\ast$}{*}FRestrict \texorpdfstring{$\ast$}{*}const FRestrict}]{child\+Cell,  }\item[{const int}]{in\+Level }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [override]}}



Translate the local expansion of parent cell to child cell 

One need to translate the local expansion on a father cell centered in $\mathbf{x}_p$ to its eight daughters centered in $\mathbf{x}_p$ .

Local expansion for the daughters will be \+: \[ \sum_{\mathbf{k}=0}^{|k|<P} L_k * (\mathbf{x}-\mathbf{x}_f)^{\mathbf{k}} \] with \+:

\[ L_{n} = \sum_{\mathbf{k}=\mathbf{n}}^{|k|<P} C_{\mathbf{k}}^{\mathbf{n}} * (\mathbf{x}_f-\mathbf{x}_p)^{\mathbf{k}-\mathbf{n}} \] \Hypertarget{class_f_taylor_kernel_a68f51a6ab1ff33cff3cfe2790735ff2a}\label{class_f_taylor_kernel_a68f51a6ab1ff33cff3cfe2790735ff2a} 
\index{FTaylorKernel$<$ FReal, CellClass, ContainerClass, P, order $>$@{FTaylorKernel$<$ FReal, CellClass, ContainerClass, P, order $>$}!L2P@{L2P}}
\index{L2P@{L2P}!FTaylorKernel$<$ FReal, CellClass, ContainerClass, P, order $>$@{FTaylorKernel$<$ FReal, CellClass, ContainerClass, P, order $>$}}
\doxysubsubsection{\texorpdfstring{L2P()}{L2P()}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily template$<$class FReal , class Cell\+Class , class Container\+Class , int P, int order$>$ \\
void \mbox{\hyperlink{class_f_taylor_kernel}{FTaylor\+Kernel}}$<$ FReal, Cell\+Class, Container\+Class, P, order $>$\+::\+L2P (\begin{DoxyParamCaption}\item[{const Cell\+Class \texorpdfstring{$\ast$}{*}const}]{local,  }\item[{Container\+Class \texorpdfstring{$\ast$}{*}const}]{particles }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [override]}}



Apply on the particles the force computed from the local expansion to all particles in the cell 

L2P 

Formula \+:  \[
   Potential = \sum_{j=0}^{nb_{particles}}{q_j \sum_{k=0}^{P}{ L_k * (x_j-x_c)^{k}}}
 \]

where $x_c$ is the centre of the local cell and $x_j$ the $j^{th}$ particles and $q_j$ its charge. \Hypertarget{class_f_taylor_kernel_a68f51a6ab1ff33cff3cfe2790735ff2a}\label{class_f_taylor_kernel_a68f51a6ab1ff33cff3cfe2790735ff2a} 
\index{FTaylorKernel$<$ FReal, CellClass, ContainerClass, P, order $>$@{FTaylorKernel$<$ FReal, CellClass, ContainerClass, P, order $>$}!L2P@{L2P}}
\index{L2P@{L2P}!FTaylorKernel$<$ FReal, CellClass, ContainerClass, P, order $>$@{FTaylorKernel$<$ FReal, CellClass, ContainerClass, P, order $>$}}
\doxysubsubsection{\texorpdfstring{L2P()}{L2P()}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily template$<$class FReal , class Cell\+Class , class Container\+Class , int P, int order$>$ \\
void \mbox{\hyperlink{class_f_taylor_kernel}{FTaylor\+Kernel}}$<$ FReal, Cell\+Class, Container\+Class, P, order $>$\+::\+L2P (\begin{DoxyParamCaption}\item[{const Cell\+Class \texorpdfstring{$\ast$}{*}const}]{local,  }\item[{Container\+Class \texorpdfstring{$\ast$}{*}const}]{particles }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [override]}}



Apply on the particles the force computed from the local expansion to all particles in the cell 

L2P 

Formula \+:  \[
   Potential = \sum_{j=0}^{nb_{particles}}{q_j \sum_{k=0}^{P}{ L_k * (x_j-x_c)^{k}}}
 \]

where $x_c$ is the centre of the local cell and $x_j$ the $j^{th}$ particles and $q_j$ its charge. \Hypertarget{class_f_taylor_kernel_a517b6fcc317f2ce9e2a37690cc7c6c3c}\label{class_f_taylor_kernel_a517b6fcc317f2ce9e2a37690cc7c6c3c} 
\index{FTaylorKernel$<$ FReal, CellClass, ContainerClass, P, order $>$@{FTaylorKernel$<$ FReal, CellClass, ContainerClass, P, order $>$}!M2L@{M2L}}
\index{M2L@{M2L}!FTaylorKernel$<$ FReal, CellClass, ContainerClass, P, order $>$@{FTaylorKernel$<$ FReal, CellClass, ContainerClass, P, order $>$}}
\doxysubsubsection{\texorpdfstring{M2L()}{M2L()}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily template$<$class FReal , class Cell\+Class , class Container\+Class , int P, int order$>$ \\
void \mbox{\hyperlink{class_f_taylor_kernel}{FTaylor\+Kernel}}$<$ FReal, Cell\+Class, Container\+Class, P, order $>$\+::\+M2L (\begin{DoxyParamCaption}\item[{Cell\+Class \texorpdfstring{$\ast$}{*}const FRestrict}]{in\+Local,  }\item[{const Cell\+Class \texorpdfstring{$\ast$}{*}}]{distant\+Neighbors\mbox{[}$\,$\mbox{]},  }\item[{const int}]{neighbor\+Positions\mbox{[}$\,$\mbox{]},  }\item[{const int}]{in\+Size,  }\item[{const int}]{in\+Level }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [override]}}



Convert the multipole expansion into local expansion The operator do not use symmetries. 

Formula \+: \[ L_{\mathbf{n}}^{c} = \frac{|n|!}{n! n!}
 \sum_{\mathbf{k}=0}^{p} \left [ M_\mathbf{k}^c \,
 \Psi_{\mathbf{,n+k}}( \mathbf{x}_c^{target})\right ] \] and \[ \Psi_{\mathbf{,i}}^{c}(\mathbf{x}) =
 \frac{\partial^i}{\partial x^i} \frac{1}{|x-x_c^{src}|} =  \frac{\partial^{i_1}}{\partial x_1^{i_1}} \frac{\partial^{i_2}}{\partial x_2^{i_2}} \frac{\partial^{i_3}}{\partial x_3^{i_3}} \frac{1}{|x-x_c^{src}|}\]

Where $x_c^{src}$ is the centre of the cell where the multiplole are considered, $x_c^{target}$ is the centre of the current cell. The cell where we compute the local expansion. \Hypertarget{class_f_taylor_kernel_a378bade4838fd8f5c8a00a164e2c6999}\label{class_f_taylor_kernel_a378bade4838fd8f5c8a00a164e2c6999} 
\index{FTaylorKernel$<$ FReal, CellClass, ContainerClass, P, order $>$@{FTaylorKernel$<$ FReal, CellClass, ContainerClass, P, order $>$}!M2L@{M2L}}
\index{M2L@{M2L}!FTaylorKernel$<$ FReal, CellClass, ContainerClass, P, order $>$@{FTaylorKernel$<$ FReal, CellClass, ContainerClass, P, order $>$}}
\doxysubsubsection{\texorpdfstring{M2L()}{M2L()}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily template$<$class FReal , class Cell\+Class , class Container\+Class , int P, int order$>$ \\
void \mbox{\hyperlink{class_f_taylor_kernel}{FTaylor\+Kernel}}$<$ FReal, Cell\+Class, Container\+Class, P, order $>$\+::\+M2L (\begin{DoxyParamCaption}\item[{Cell\+Class \texorpdfstring{$\ast$}{*}const FRestrict}]{in\+Local,  }\item[{const Cell\+Class \texorpdfstring{$\ast$}{*}}]{distant\+Neighbors\mbox{[}$\,$\mbox{]},  }\item[{const int}]{\mbox{[}$\,$\mbox{]},  }\item[{const int}]{in\+Size,  }\item[{const int}]{in\+Level }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [override]}}



Convert the multipole expansion into local expansion The operator do not use symmetries. 

Formula \+: \[ L_{\mathbf{n}}^{c} = \frac{|n|!}{n! n!}
 \sum_{\mathbf{k}=0}^{p} \left [ M_\mathbf{k}^c \,
 \Psi_{\mathbf{,n+k}}( \mathbf{x}_c^{target})\right ] \] and \[ \Psi_{\mathbf{,i}}^{c}(\mathbf{x}) =
 \frac{\partial^i}{\partial x^i} \frac{1}{|x-x_c^{src}|} =  \frac{\partial^{i_1}}{\partial x_1^{i_1}} \frac{\partial^{i_2}}{\partial x_2^{i_2}} \frac{\partial^{i_3}}{\partial x_3^{i_3}} \frac{1}{|x-x_c^{src}|}\]

Where $x_c^{src}$ is the centre of the cell where the multiplole are considered, $x_c^{target}$ is the centre of the current cell. The cell where we compute the local expansion. \Hypertarget{class_f_taylor_kernel_ad504e923e718ebd25dd83f11d7a99b33}\label{class_f_taylor_kernel_ad504e923e718ebd25dd83f11d7a99b33} 
\index{FTaylorKernel$<$ FReal, CellClass, ContainerClass, P, order $>$@{FTaylorKernel$<$ FReal, CellClass, ContainerClass, P, order $>$}!P2M@{P2M}}
\index{P2M@{P2M}!FTaylorKernel$<$ FReal, CellClass, ContainerClass, P, order $>$@{FTaylorKernel$<$ FReal, CellClass, ContainerClass, P, order $>$}}
\doxysubsubsection{\texorpdfstring{P2M()}{P2M()}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily template$<$class FReal , class Cell\+Class , class Container\+Class , int P, int order$>$ \\
void \mbox{\hyperlink{class_f_taylor_kernel}{FTaylor\+Kernel}}$<$ FReal, Cell\+Class, Container\+Class, P, order $>$\+::\+P2M (\begin{DoxyParamCaption}\item[{Cell\+Class \texorpdfstring{$\ast$}{*}const}]{pole,  }\item[{const Container\+Class \texorpdfstring{$\ast$}{*}const}]{particles }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [override]}}



Fill the Multipole with the field created by the cell particles. 

P2M 

Formula \+:  \[
  M_{k} = \frac{|k|!}{k! k!} \sum_{j=0}^{N}{ q_j   (x_c-x_j)^{k}}
\] where $x_c$ is the centre of the cell and $x_j$ the $j^{th}$ particles and $q_j$ its charge and $N$ the particle number. \Hypertarget{class_f_taylor_kernel_ad504e923e718ebd25dd83f11d7a99b33}\label{class_f_taylor_kernel_ad504e923e718ebd25dd83f11d7a99b33} 
\index{FTaylorKernel$<$ FReal, CellClass, ContainerClass, P, order $>$@{FTaylorKernel$<$ FReal, CellClass, ContainerClass, P, order $>$}!P2M@{P2M}}
\index{P2M@{P2M}!FTaylorKernel$<$ FReal, CellClass, ContainerClass, P, order $>$@{FTaylorKernel$<$ FReal, CellClass, ContainerClass, P, order $>$}}
\doxysubsubsection{\texorpdfstring{P2M()}{P2M()}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily template$<$class FReal , class Cell\+Class , class Container\+Class , int P, int order$>$ \\
void \mbox{\hyperlink{class_f_taylor_kernel}{FTaylor\+Kernel}}$<$ FReal, Cell\+Class, Container\+Class, P, order $>$\+::\+P2M (\begin{DoxyParamCaption}\item[{Cell\+Class \texorpdfstring{$\ast$}{*}const}]{pole,  }\item[{const Container\+Class \texorpdfstring{$\ast$}{*}const}]{particles }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [override]}}



Fill the Multipole with the field created by the cell particles. 

P2M 

Formula \+:  \[
  M_{k} = \frac{|k|!}{k! k!} \sum_{j=0}^{N}{ q_j   (x_c-x_j)^{k}}
\] where $x_c$ is the centre of the cell and $x_j$ the $j^{th}$ particles and $q_j$ its charge and $N$ the particle number. \Hypertarget{class_f_taylor_kernel_a92ae46dae23395eabc0af1118309ab87}\label{class_f_taylor_kernel_a92ae46dae23395eabc0af1118309ab87} 
\index{FTaylorKernel$<$ FReal, CellClass, ContainerClass, P, order $>$@{FTaylorKernel$<$ FReal, CellClass, ContainerClass, P, order $>$}!P2P@{P2P}}
\index{P2P@{P2P}!FTaylorKernel$<$ FReal, CellClass, ContainerClass, P, order $>$@{FTaylorKernel$<$ FReal, CellClass, ContainerClass, P, order $>$}}
\doxysubsubsection{\texorpdfstring{P2P()}{P2P()}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily template$<$class FReal , class Cell\+Class , class Container\+Class , int P, int order$>$ \\
void \mbox{\hyperlink{class_f_taylor_kernel}{FTaylor\+Kernel}}$<$ FReal, Cell\+Class, Container\+Class, P, order $>$\+::\+P2P (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{class_f_tree_coordinate}{FTree\+Coordinate}} \&}]{in\+Position,  }\item[{Container\+Class \texorpdfstring{$\ast$}{*}const FRestrict}]{in\+Targets,  }\item[{const Container\+Class \texorpdfstring{$\ast$}{*}const FRestrict}]{in\+Sources,  }\item[{Container\+Class \texorpdfstring{$\ast$}{*}const}]{in\+Neighbors\mbox{[}$\,$\mbox{]},  }\item[{const int}]{neighbor\+Positions\mbox{[}$\,$\mbox{]},  }\item[{const int}]{in\+Size }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [override]}}

P2P This function proceed the P2P using particles\+Mutual\+Interaction The computation is done for interactions with an index \texorpdfstring{$<$}{<}= 13. (13 means current leaf (x;y;z) = (0;0;0)). Calling this method in multi thread should be done carrefully. \Hypertarget{class_f_taylor_kernel_a92ae46dae23395eabc0af1118309ab87}\label{class_f_taylor_kernel_a92ae46dae23395eabc0af1118309ab87} 
\index{FTaylorKernel$<$ FReal, CellClass, ContainerClass, P, order $>$@{FTaylorKernel$<$ FReal, CellClass, ContainerClass, P, order $>$}!P2P@{P2P}}
\index{P2P@{P2P}!FTaylorKernel$<$ FReal, CellClass, ContainerClass, P, order $>$@{FTaylorKernel$<$ FReal, CellClass, ContainerClass, P, order $>$}}
\doxysubsubsection{\texorpdfstring{P2P()}{P2P()}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily template$<$class FReal , class Cell\+Class , class Container\+Class , int P, int order$>$ \\
void \mbox{\hyperlink{class_f_taylor_kernel}{FTaylor\+Kernel}}$<$ FReal, Cell\+Class, Container\+Class, P, order $>$\+::\+P2P (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{class_f_tree_coordinate}{FTree\+Coordinate}} \&}]{in\+Position,  }\item[{Container\+Class \texorpdfstring{$\ast$}{*}const FRestrict}]{in\+Targets,  }\item[{const Container\+Class \texorpdfstring{$\ast$}{*}const FRestrict}]{in\+Sources,  }\item[{Container\+Class \texorpdfstring{$\ast$}{*}const}]{in\+Neighbors\mbox{[}$\,$\mbox{]},  }\item[{const int}]{neighbor\+Positions\mbox{[}$\,$\mbox{]},  }\item[{const int}]{in\+Size }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [override]}}

P2P This function proceed the P2P using particles\+Mutual\+Interaction The computation is done for interactions with an index \texorpdfstring{$<$}{<}= 13. (13 means current leaf (x;y;z) = (0;0;0)). Calling this method in multi thread should be done carrefully. \Hypertarget{class_f_taylor_kernel_a4e4d6f0cec1b72903f1a2d2dc6dd7325}\label{class_f_taylor_kernel_a4e4d6f0cec1b72903f1a2d2dc6dd7325} 
\index{FTaylorKernel$<$ FReal, CellClass, ContainerClass, P, order $>$@{FTaylorKernel$<$ FReal, CellClass, ContainerClass, P, order $>$}!P2PRemote@{P2PRemote}}
\index{P2PRemote@{P2PRemote}!FTaylorKernel$<$ FReal, CellClass, ContainerClass, P, order $>$@{FTaylorKernel$<$ FReal, CellClass, ContainerClass, P, order $>$}}
\doxysubsubsection{\texorpdfstring{P2PRemote()}{P2PRemote()}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily template$<$class FReal , class Cell\+Class , class Container\+Class , int P, int order$>$ \\
void \mbox{\hyperlink{class_f_taylor_kernel}{FTaylor\+Kernel}}$<$ FReal, Cell\+Class, Container\+Class, P, order $>$\+::\+P2\+PRemote (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{class_f_tree_coordinate}{FTree\+Coordinate}} \&}]{,  }\item[{Container\+Class \texorpdfstring{$\ast$}{*}const FRestrict}]{in\+Targets,  }\item[{const Container\+Class \texorpdfstring{$\ast$}{*}const}]{FRestrict,  }\item[{const Container\+Class \texorpdfstring{$\ast$}{*}const}]{in\+Neighbors\mbox{[}$\,$\mbox{]},  }\item[{const int}]{neighbor\+Positions\mbox{[}$\,$\mbox{]},  }\item[{const int}]{in\+Size }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [override]}}

Use mutual even if it not useful and call particles\+Mutual\+Interaction \Hypertarget{class_f_taylor_kernel_a4e4d6f0cec1b72903f1a2d2dc6dd7325}\label{class_f_taylor_kernel_a4e4d6f0cec1b72903f1a2d2dc6dd7325} 
\index{FTaylorKernel$<$ FReal, CellClass, ContainerClass, P, order $>$@{FTaylorKernel$<$ FReal, CellClass, ContainerClass, P, order $>$}!P2PRemote@{P2PRemote}}
\index{P2PRemote@{P2PRemote}!FTaylorKernel$<$ FReal, CellClass, ContainerClass, P, order $>$@{FTaylorKernel$<$ FReal, CellClass, ContainerClass, P, order $>$}}
\doxysubsubsection{\texorpdfstring{P2PRemote()}{P2PRemote()}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily template$<$class FReal , class Cell\+Class , class Container\+Class , int P, int order$>$ \\
void \mbox{\hyperlink{class_f_taylor_kernel}{FTaylor\+Kernel}}$<$ FReal, Cell\+Class, Container\+Class, P, order $>$\+::\+P2\+PRemote (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{class_f_tree_coordinate}{FTree\+Coordinate}} \&}]{,  }\item[{Container\+Class \texorpdfstring{$\ast$}{*}const FRestrict}]{in\+Targets,  }\item[{const Container\+Class \texorpdfstring{$\ast$}{*}const}]{FRestrict,  }\item[{const Container\+Class \texorpdfstring{$\ast$}{*}const}]{in\+Neighbors\mbox{[}$\,$\mbox{]},  }\item[{const int}]{neighbor\+Positions\mbox{[}$\,$\mbox{]},  }\item[{const int}]{in\+Size }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [override]}}

Use mutual even if it not useful and call particles\+Mutual\+Interaction 

该类的文档由以下文件生成\+:\begin{DoxyCompactItemize}
\item 
third\+\_\+party/\+Scal\+FMM/include/\+Scal\+FMM/\+Kernels/\+Taylor/FTaylor\+Kernel.\+hpp\item 
third\+\_\+party/\+Scal\+FMM/include/\+Scal\+FMM/\+Kernels/\+Taylor/FTaylor\+Kernel\+Simple.\+hpp\end{DoxyCompactItemize}
