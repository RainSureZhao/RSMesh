\doxysection{rmt\+\_\+node.\+h}
\hypertarget{rmt__node_8h_source}{}\label{rmt__node_8h_source}\index{include/isosurface/rmt\_node.h@{include/isosurface/rmt\_node.h}}

\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{rmt__node_8h_source_l00001}00001\ \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{rmt__node_8h_source_l00002}00002\ \textcolor{comment}{//\ Created\ by\ RainSure\ on\ 2024/2/23.}}
\DoxyCodeLine{\Hypertarget{rmt__node_8h_source_l00003}00003\ \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{rmt__node_8h_source_l00004}00004\ }
\DoxyCodeLine{\Hypertarget{rmt__node_8h_source_l00005}00005\ \textcolor{preprocessor}{\#ifndef\ RSMESH\_RMT\_NODE\_H}}
\DoxyCodeLine{\Hypertarget{rmt__node_8h_source_l00006}00006\ \textcolor{preprocessor}{\#define\ RSMESH\_RMT\_NODE\_H}}
\DoxyCodeLine{\Hypertarget{rmt__node_8h_source_l00007}00007\ }
\DoxyCodeLine{\Hypertarget{rmt__node_8h_source_l00008}00008\ \textcolor{preprocessor}{\#include\ <array>}}
\DoxyCodeLine{\Hypertarget{rmt__node_8h_source_l00009}00009\ \textcolor{preprocessor}{\#include\ <cmath>}}
\DoxyCodeLine{\Hypertarget{rmt__node_8h_source_l00010}00010\ \textcolor{preprocessor}{\#include\ <memory>}}
\DoxyCodeLine{\Hypertarget{rmt__node_8h_source_l00011}00011\ \textcolor{preprocessor}{\#include\ <unordered\_map>}}
\DoxyCodeLine{\Hypertarget{rmt__node_8h_source_l00012}00012\ \textcolor{preprocessor}{\#include\ <utility>}}
\DoxyCodeLine{\Hypertarget{rmt__node_8h_source_l00013}00013\ \textcolor{preprocessor}{\#include\ <vector>}}
\DoxyCodeLine{\Hypertarget{rmt__node_8h_source_l00014}00014\ \textcolor{preprocessor}{\#include\ <optional>}}
\DoxyCodeLine{\Hypertarget{rmt__node_8h_source_l00015}00015\ \textcolor{preprocessor}{\#include\ "{}geometry/point3d.h"{}}}
\DoxyCodeLine{\Hypertarget{rmt__node_8h_source_l00016}00016\ \textcolor{preprocessor}{\#include\ "{}isosurface/bit.h"{}}}
\DoxyCodeLine{\Hypertarget{rmt__node_8h_source_l00017}00017\ \textcolor{preprocessor}{\#include\ "{}isosurface/isosurface\_types.h"{}}}
\DoxyCodeLine{\Hypertarget{rmt__node_8h_source_l00018}00018\ \textcolor{preprocessor}{\#include\ "{}common/macros.h"{}}}
\DoxyCodeLine{\Hypertarget{rmt__node_8h_source_l00019}00019\ }
\DoxyCodeLine{\Hypertarget{rmt__node_8h_source_l00020}00020\ \textcolor{keyword}{namespace\ }\mbox{\hyperlink{namespacersmesh_1_1isosurface}{rsmesh::isosurface}}\ \{}
\DoxyCodeLine{\Hypertarget{rmt__node_8h_source_l00021}00021\ }
\DoxyCodeLine{\Hypertarget{rmt__node_8h_source_l00022}00022\ \ \ \ \ \textcolor{comment}{//\ Encodes\ 0\ or\ 1\ on\ 14\ outgoing\ halfedges\ for\ each\ node.}}
\DoxyCodeLine{\Hypertarget{rmt__node_8h_source_l00023}00023\ \ \ \ \ \textcolor{keyword}{using\ }edge\_bitset\ =\ std::uint16\_t;}
\DoxyCodeLine{\Hypertarget{rmt__node_8h_source_l00024}00024\ }
\DoxyCodeLine{\Hypertarget{rmt__node_8h_source_l00025}00025\ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{constexpr}\ edge\_bitset\ EdgeSetMask\ =\ 0x3fff;}
\DoxyCodeLine{\Hypertarget{rmt__node_8h_source_l00026}00026\ }
\DoxyCodeLine{\Hypertarget{rmt__node_8h_source_l00027}00027\ \textcolor{comment}{//\ Edge\ index\ per\ node:\ 0\ -\/\ 13}}
\DoxyCodeLine{\Hypertarget{rmt__node_8h_source_l00028}00028\ \ \ \ \ \textcolor{keyword}{using\ }edge\_index\ =\ int;}
\DoxyCodeLine{\Hypertarget{rmt__node_8h_source_l00029}00029\ }
\DoxyCodeLine{\Hypertarget{rmt__node_8h_source_l00030}00030\ \textcolor{comment}{//\ Adjacent\ edges\ (4\ or\ 6)\ of\ each\ edge.}}
\DoxyCodeLine{\Hypertarget{rmt__node_8h_source_l00031}00031\ \ \ \ \ \textcolor{keyword}{inline}\ \textcolor{keyword}{const}\ std::array<edge\_bitset,\ 14>\ NeighborMasks\{0x321a,\ 0x2015,\ 0x24b2,\ 0x0251,\ 0x006f,}
\DoxyCodeLine{\Hypertarget{rmt__node_8h_source_l00032}00032\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 0x00d4,\ 0x03b8,\ 0x0d64,\ 0x0ac0,\ 0x1949,}
\DoxyCodeLine{\Hypertarget{rmt__node_8h_source_l00033}00033\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 0x2884,\ 0x3780,\ 0x2a01,\ 0x1c07\};}
\DoxyCodeLine{\Hypertarget{rmt__node_8h_source_l00034}00034\ }
\DoxyCodeLine{\Hypertarget{rmt__node_8h_source_l00035}00035\ \ \ \ \ \textcolor{keyword}{enum}\ binary\_sign\ \{\ Pos\ =\ 0,\ Neg\ =\ 1\ \};}
\DoxyCodeLine{\Hypertarget{rmt__node_8h_source_l00036}00036\ }
\DoxyCodeLine{\Hypertarget{rmt__node_8h_source_l00037}\mbox{\hyperlink{classrsmesh_1_1isosurface_1_1rmt__node}{00037}}\ \ \ \ \ \textcolor{keyword}{class\ }\mbox{\hyperlink{classrsmesh_1_1isosurface_1_1rmt__node}{rmt\_node}}\ \{}
\DoxyCodeLine{\Hypertarget{rmt__node_8h_source_l00038}00038\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacersmesh_1_1geometry_a5a8298c925fa95dd2345ab74c96efaf8}{geometry::point3d}}\ position\_;}
\DoxyCodeLine{\Hypertarget{rmt__node_8h_source_l00039}00039\ \ \ \ \ \ \ \ \ std::optional<double>\ value\_;}
\DoxyCodeLine{\Hypertarget{rmt__node_8h_source_l00040}00040\ }
\DoxyCodeLine{\Hypertarget{rmt__node_8h_source_l00041}00041\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ The\ corresponding\ bit\ is\ set\ if\ an\ edge\ crosses\ the\ isosurface}}
\DoxyCodeLine{\Hypertarget{rmt__node_8h_source_l00042}00042\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ at\ a\ point\ nearer\ than\ the\ midpoint.}}
\DoxyCodeLine{\Hypertarget{rmt__node_8h_source_l00043}00043\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Such\ intersections\ are\ called\ "{}near\ intersections"{}.}}
\DoxyCodeLine{\Hypertarget{rmt__node_8h_source_l00044}00044\ \ \ \ \ \ \ \ \ edge\_bitset\ intersections\_\{\};}
\DoxyCodeLine{\Hypertarget{rmt__node_8h_source_l00045}00045\ }
\DoxyCodeLine{\Hypertarget{rmt__node_8h_source_l00046}00046\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ The\ corresponding\ bit\ is\ set\ if\ an\ edge\ crosses\ the\ isosurface.}}
\DoxyCodeLine{\Hypertarget{rmt__node_8h_source_l00047}00047\ \ \ \ \ \ \ \ \ edge\_bitset\ all\_intersections\_\{\};}
\DoxyCodeLine{\Hypertarget{rmt__node_8h_source_l00048}00048\ }
\DoxyCodeLine{\Hypertarget{rmt__node_8h_source_l00049}00049\ \ \ \ \ \ \ \ \ std::unique\_ptr<std::vector<vertex\_index>>\ vis\_;}
\DoxyCodeLine{\Hypertarget{rmt__node_8h_source_l00050}00050\ }
\DoxyCodeLine{\Hypertarget{rmt__node_8h_source_l00051}00051\ \ \ \ \ \ \ \ \ std::unique\_ptr<std::array<rmt\_node*,\ 14>>\ neighbors\_;}
\DoxyCodeLine{\Hypertarget{rmt__node_8h_source_l00052}00052\ }
\DoxyCodeLine{\Hypertarget{rmt__node_8h_source_l00053}00053\ \ \ \ \ \ \ \ \ \textcolor{keyword}{static}\ std::vector<edge\_bitset>\ connected\_components(edge\_bitset\ edge\_set)\ \{}
\DoxyCodeLine{\Hypertarget{rmt__node_8h_source_l00054}00054\ \ \ \ \ \ \ \ \ \ \ \ \ std::vector<edge\_bitset>\ components;}
\DoxyCodeLine{\Hypertarget{rmt__node_8h_source_l00055}00055\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{while}\ (edge\_set\ !=\ 0)\ \{}
\DoxyCodeLine{\Hypertarget{rmt__node_8h_source_l00056}00056\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ edge\_bitset\ component\{\};}
\DoxyCodeLine{\Hypertarget{rmt__node_8h_source_l00057}00057\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ edge\_bitset\ queue\ =\ 1\ <<\ bit\_peek(edge\_set);}
\DoxyCodeLine{\Hypertarget{rmt__node_8h_source_l00058}00058\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{while}\ (queue\ !=\ 0)\ \{}
\DoxyCodeLine{\Hypertarget{rmt__node_8h_source_l00059}00059\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ e\ =\ bit\_pop(\&queue);}
\DoxyCodeLine{\Hypertarget{rmt__node_8h_source_l00060}00060\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ component\ |=\ 1\ <<\ e;}
\DoxyCodeLine{\Hypertarget{rmt__node_8h_source_l00061}00061\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ edge\_set\ \string^=\ 1\ <<\ e;}
\DoxyCodeLine{\Hypertarget{rmt__node_8h_source_l00062}00062\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ queue\ |=\ NeighborMasks.at(e)\ \&\ edge\_set;}
\DoxyCodeLine{\Hypertarget{rmt__node_8h_source_l00063}00063\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{rmt__node_8h_source_l00064}00064\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ components.push\_back(component);}
\DoxyCodeLine{\Hypertarget{rmt__node_8h_source_l00065}00065\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{rmt__node_8h_source_l00066}00066\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ components;}
\DoxyCodeLine{\Hypertarget{rmt__node_8h_source_l00067}00067\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{rmt__node_8h_source_l00068}00068\ }
\DoxyCodeLine{\Hypertarget{rmt__node_8h_source_l00069}00069\ \ \ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{\Hypertarget{rmt__node_8h_source_l00070}00070\ \ \ \ \ \ \ \ \ \textcolor{keyword}{explicit}\ \mbox{\hyperlink{classrsmesh_1_1isosurface_1_1rmt__node}{rmt\_node}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{namespacersmesh_1_1geometry_a5a8298c925fa95dd2345ab74c96efaf8}{geometry::point3d}}\&\ position)\ :\ position\_(position)\ \{\}}
\DoxyCodeLine{\Hypertarget{rmt__node_8h_source_l00071}00071\ }
\DoxyCodeLine{\Hypertarget{rmt__node_8h_source_l00072}00072\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{void}\ cluster(std::vector<geometry::point3d>\&\ vertices,}
\DoxyCodeLine{\Hypertarget{rmt__node_8h_source_l00073}00073\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ std::unordered\_map<vertex\_index,\ vertex\_index>\&\ cluster\_map)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{\Hypertarget{rmt__node_8h_source_l00074}00074\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ surfaces\ =\ connected\_components(intersections\_);}
\DoxyCodeLine{\Hypertarget{rmt__node_8h_source_l00075}00075\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{auto}\ \mbox{\hyperlink{classrsmesh_1_1isosurface_1_1surface}{surface}}\ :\ surfaces)\ \{}
\DoxyCodeLine{\Hypertarget{rmt__node_8h_source_l00076}00076\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ holes\ =\ connected\_components(\mbox{\hyperlink{classrsmesh_1_1isosurface_1_1surface}{surface}}\ \string^\ EdgeSetMask);}
\DoxyCodeLine{\Hypertarget{rmt__node_8h_source_l00077}00077\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (holes.size()\ !=\ 1)\ \{}
\DoxyCodeLine{\Hypertarget{rmt__node_8h_source_l00078}00078\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ holes.size()\ ==\ 0\ -\/>\ closed\ surface}}
\DoxyCodeLine{\Hypertarget{rmt__node_8h_source_l00079}00079\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ holes.size()\ >=\ 2\ -\/>\ holes\ in\ the\ surface}}
\DoxyCodeLine{\Hypertarget{rmt__node_8h_source_l00080}00080\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{rmt__node_8h_source_l00081}00081\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{rmt__node_8h_source_l00082}00082\ }
\DoxyCodeLine{\Hypertarget{rmt__node_8h_source_l00083}00083\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ n\ =\ bit\_count(\mbox{\hyperlink{classrsmesh_1_1isosurface_1_1surface}{surface}});}
\DoxyCodeLine{\Hypertarget{rmt__node_8h_source_l00084}00084\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ new\_vi\ =\ \textcolor{keyword}{static\_cast<}vertex\_index\textcolor{keyword}{>}(vertices.size());}
\DoxyCodeLine{\Hypertarget{rmt__node_8h_source_l00085}00085\ }
\DoxyCodeLine{\Hypertarget{rmt__node_8h_source_l00086}00086\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacersmesh_1_1geometry_a5a8298c925fa95dd2345ab74c96efaf8}{geometry::point3d}}\ clustered\ =\ geometry::point3d::Zero();}
\DoxyCodeLine{\Hypertarget{rmt__node_8h_source_l00087}00087\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{while}\ (\mbox{\hyperlink{classrsmesh_1_1isosurface_1_1surface}{surface}}\ !=\ 0)\ \{}
\DoxyCodeLine{\Hypertarget{rmt__node_8h_source_l00088}00088\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ edge\_idx\ =\ bit\_pop(\&\mbox{\hyperlink{classrsmesh_1_1isosurface_1_1surface}{surface}});}
\DoxyCodeLine{\Hypertarget{rmt__node_8h_source_l00089}00089\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ vi\ =\ vertex\_on\_edge(edge\_idx);}
\DoxyCodeLine{\Hypertarget{rmt__node_8h_source_l00090}00090\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ clustered\ +=\ vertices.at(vi);}
\DoxyCodeLine{\Hypertarget{rmt__node_8h_source_l00091}00091\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ cluster\_map.emplace(vi,\ new\_vi);}
\DoxyCodeLine{\Hypertarget{rmt__node_8h_source_l00092}00092\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{rmt__node_8h_source_l00093}00093\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ clustered\ /=\ \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{double}\textcolor{keyword}{>}(n);}
\DoxyCodeLine{\Hypertarget{rmt__node_8h_source_l00094}00094\ }
\DoxyCodeLine{\Hypertarget{rmt__node_8h_source_l00095}00095\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ vertices.push\_back(clustered);}
\DoxyCodeLine{\Hypertarget{rmt__node_8h_source_l00096}00096\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{rmt__node_8h_source_l00097}00097\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{rmt__node_8h_source_l00098}00098\ }
\DoxyCodeLine{\Hypertarget{rmt__node_8h_source_l00099}00099\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ has\_intersection(edge\_index\ edge\_idx)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{\Hypertarget{rmt__node_8h_source_l00100}00100\ \ \ \ \ \ \ \ \ \ \ \ \ edge\_bitset\ edge\_bit\ =\ 1\ <<\ edge\_idx;}
\DoxyCodeLine{\Hypertarget{rmt__node_8h_source_l00101}00101\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ (intersections\_\ \&\ edge\_bit)\ !=\ 0;}
\DoxyCodeLine{\Hypertarget{rmt__node_8h_source_l00102}00102\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{rmt__node_8h_source_l00103}00103\ }
\DoxyCodeLine{\Hypertarget{rmt__node_8h_source_l00104}00104\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ has\_neighbor(edge\_index\ edge)\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ neighbors\_-\/>at(edge)\ !=\ \textcolor{keyword}{nullptr};\ \}}
\DoxyCodeLine{\Hypertarget{rmt__node_8h_source_l00105}00105\ }
\DoxyCodeLine{\Hypertarget{rmt__node_8h_source_l00106}00106\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{void}\ insert\_vertex(vertex\_index\ vi,\ edge\_index\ edge\_idx)\ \{}
\DoxyCodeLine{\Hypertarget{rmt__node_8h_source_l00107}00107\ \ \ \ \ \ \ \ \ \ \ \ \ RSMESH\_ASSERT(!has\_intersection(edge\_idx));}
\DoxyCodeLine{\Hypertarget{rmt__node_8h_source_l00108}00108\ }
\DoxyCodeLine{\Hypertarget{rmt__node_8h_source_l00109}00109\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!vis\_)\ \{}
\DoxyCodeLine{\Hypertarget{rmt__node_8h_source_l00110}00110\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ vis\_\ =\ std::make\_unique<std::vector<vertex\_index>>();}
\DoxyCodeLine{\Hypertarget{rmt__node_8h_source_l00111}00111\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{rmt__node_8h_source_l00112}00112\ }
\DoxyCodeLine{\Hypertarget{rmt__node_8h_source_l00113}00113\ \ \ \ \ \ \ \ \ \ \ \ \ edge\_bitset\ edge\_bit\ =\ 1\ <<\ edge\_idx;}
\DoxyCodeLine{\Hypertarget{rmt__node_8h_source_l00114}00114\ \ \ \ \ \ \ \ \ \ \ \ \ edge\_bitset\ edge\_count\_mask\ =\ edge\_bit\ -\/\ 1;}
\DoxyCodeLine{\Hypertarget{rmt__node_8h_source_l00115}00115\ }
\DoxyCodeLine{\Hypertarget{rmt__node_8h_source_l00116}00116\ \ \ \ \ \ \ \ \ \ \ \ \ intersections\_\ |=\ edge\_bit;}
\DoxyCodeLine{\Hypertarget{rmt__node_8h_source_l00117}00117\ }
\DoxyCodeLine{\Hypertarget{rmt__node_8h_source_l00118}00118\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ it\ =\ vis\_-\/>begin()\ +\ bit\_count(\textcolor{keyword}{static\_cast<}edge\_bitset\textcolor{keyword}{>}(intersections\_\ \&\ edge\_count\_mask));}
\DoxyCodeLine{\Hypertarget{rmt__node_8h_source_l00119}00119\ \ \ \ \ \ \ \ \ \ \ \ \ vis\_-\/>insert(it,\ vi);}
\DoxyCodeLine{\Hypertarget{rmt__node_8h_source_l00120}00120\ }
\DoxyCodeLine{\Hypertarget{rmt__node_8h_source_l00121}00121\ \ \ \ \ \ \ \ \ \ \ \ \ RSMESH\_ASSERT(vertex\_on\_edge(edge\_idx)\ ==\ vi);}
\DoxyCodeLine{\Hypertarget{rmt__node_8h_source_l00122}00122\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{rmt__node_8h_source_l00123}00123\ }
\DoxyCodeLine{\Hypertarget{rmt__node_8h_source_l00124}00124\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ is\_free()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ all\_intersections\_\ ==\ 0;\ \}}
\DoxyCodeLine{\Hypertarget{rmt__node_8h_source_l00125}00125\ }
\DoxyCodeLine{\Hypertarget{rmt__node_8h_source_l00126}00126\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classrsmesh_1_1isosurface_1_1rmt__node}{rmt\_node}}\&\ neighbor(edge\_index\ edge)\ \{}
\DoxyCodeLine{\Hypertarget{rmt__node_8h_source_l00127}00127\ \ \ \ \ \ \ \ \ \ \ \ \ RSMESH\_ASSERT(has\_neighbor(edge));}
\DoxyCodeLine{\Hypertarget{rmt__node_8h_source_l00128}00128\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ *neighbors\_-\/>at(edge);}
\DoxyCodeLine{\Hypertarget{rmt__node_8h_source_l00129}00129\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{rmt__node_8h_source_l00130}00130\ }
\DoxyCodeLine{\Hypertarget{rmt__node_8h_source_l00131}00131\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classrsmesh_1_1isosurface_1_1rmt__node}{rmt\_node}}\&\ neighbor(edge\_index\ edge)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{\Hypertarget{rmt__node_8h_source_l00132}00132\ \ \ \ \ \ \ \ \ \ \ \ \ RSMESH\_ASSERT(has\_neighbor(edge));}
\DoxyCodeLine{\Hypertarget{rmt__node_8h_source_l00133}00133\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ *neighbors\_-\/>at(edge);}
\DoxyCodeLine{\Hypertarget{rmt__node_8h_source_l00134}00134\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{rmt__node_8h_source_l00135}00135\ }
\DoxyCodeLine{\Hypertarget{rmt__node_8h_source_l00136}00136\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{namespacersmesh_1_1geometry_a5a8298c925fa95dd2345ab74c96efaf8}{geometry::point3d}}\&\ position()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ position\_;\ \}}
\DoxyCodeLine{\Hypertarget{rmt__node_8h_source_l00137}00137\ }
\DoxyCodeLine{\Hypertarget{rmt__node_8h_source_l00138}00138\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{void}\ set\_intersection(edge\_index\ edge\_idx)\ \{}
\DoxyCodeLine{\Hypertarget{rmt__node_8h_source_l00139}00139\ \ \ \ \ \ \ \ \ \ \ \ \ edge\_bitset\ edge\_bit\ =\ 1\ <<\ edge\_idx;}
\DoxyCodeLine{\Hypertarget{rmt__node_8h_source_l00140}00140\ }
\DoxyCodeLine{\Hypertarget{rmt__node_8h_source_l00141}00141\ \ \ \ \ \ \ \ \ \ \ \ \ all\_intersections\_\ |=\ edge\_bit;}
\DoxyCodeLine{\Hypertarget{rmt__node_8h_source_l00142}00142\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{rmt__node_8h_source_l00143}00143\ }
\DoxyCodeLine{\Hypertarget{rmt__node_8h_source_l00144}00144\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{void}\ set\_neighbors(std::unique\_ptr<std::array<rmt\_node*,\ 14>>\ neighbors)\ \{}
\DoxyCodeLine{\Hypertarget{rmt__node_8h_source_l00145}00145\ \ \ \ \ \ \ \ \ \ \ \ \ neighbors\_.swap(neighbors);}
\DoxyCodeLine{\Hypertarget{rmt__node_8h_source_l00146}00146\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{rmt__node_8h_source_l00147}00147\ }
\DoxyCodeLine{\Hypertarget{rmt__node_8h_source_l00148}00148\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{void}\ set\_value(\textcolor{keywordtype}{double}\ value)\ \{}
\DoxyCodeLine{\Hypertarget{rmt__node_8h_source_l00149}00149\ \ \ \ \ \ \ \ \ \ \ \ \ RSMESH\_ASSERT(!value\_.has\_value());}
\DoxyCodeLine{\Hypertarget{rmt__node_8h_source_l00150}00150\ \ \ \ \ \ \ \ \ \ \ \ \ value\_\ =\ value;}
\DoxyCodeLine{\Hypertarget{rmt__node_8h_source_l00151}00151\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{rmt__node_8h_source_l00152}00152\ }
\DoxyCodeLine{\Hypertarget{rmt__node_8h_source_l00153}00153\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ value()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{\Hypertarget{rmt__node_8h_source_l00154}00154\ \ \ \ \ \ \ \ \ \ \ \ \ RSMESH\_ASSERT(value\_.has\_value());}
\DoxyCodeLine{\Hypertarget{rmt__node_8h_source_l00155}00155\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ *value\_;}
\DoxyCodeLine{\Hypertarget{rmt__node_8h_source_l00156}00156\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{rmt__node_8h_source_l00157}00157\ }
\DoxyCodeLine{\Hypertarget{rmt__node_8h_source_l00158}00158\ \ \ \ \ \ \ \ \ binary\_sign\ value\_sign()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ value()\ <\ 0\ ?\ Neg\ :\ Pos;\ \}}
\DoxyCodeLine{\Hypertarget{rmt__node_8h_source_l00159}00159\ }
\DoxyCodeLine{\Hypertarget{rmt__node_8h_source_l00160}00160\ \ \ \ \ \ \ \ \ vertex\_index\ vertex\_on\_edge(edge\_index\ edge\_idx)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{\Hypertarget{rmt__node_8h_source_l00161}00161\ \ \ \ \ \ \ \ \ \ \ \ \ RSMESH\_ASSERT(has\_intersection(edge\_idx));}
\DoxyCodeLine{\Hypertarget{rmt__node_8h_source_l00162}00162\ }
\DoxyCodeLine{\Hypertarget{rmt__node_8h_source_l00163}00163\ \ \ \ \ \ \ \ \ \ \ \ \ edge\_bitset\ edge\_bit\ =\ 1\ <<\ edge\_idx;}
\DoxyCodeLine{\Hypertarget{rmt__node_8h_source_l00164}00164\ \ \ \ \ \ \ \ \ \ \ \ \ edge\_bitset\ edge\_count\_mask\ =\ edge\_bit\ -\/\ 1;}
\DoxyCodeLine{\Hypertarget{rmt__node_8h_source_l00165}00165\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ vis\_-\/>at(bit\_count(\textcolor{keyword}{static\_cast<}edge\_bitset\textcolor{keyword}{>}(intersections\_\ \&\ edge\_count\_mask)));}
\DoxyCodeLine{\Hypertarget{rmt__node_8h_source_l00166}00166\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{rmt__node_8h_source_l00167}00167\ \ \ \ \ \};}
\DoxyCodeLine{\Hypertarget{rmt__node_8h_source_l00168}00168\ \}}
\DoxyCodeLine{\Hypertarget{rmt__node_8h_source_l00169}00169\ }
\DoxyCodeLine{\Hypertarget{rmt__node_8h_source_l00170}00170\ \textcolor{preprocessor}{\#endif\ }\textcolor{comment}{//RSMESH\_RMT\_NODE\_H}}

\end{DoxyCode}
